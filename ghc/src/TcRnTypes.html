<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006-2012
(c) The GRASP Project, Glasgow University, 1992-2002


Various types used during typechecking, please see TcRnMonad as well for
operations on these types. You probably want to import it, instead of this
module.

All the monads exported here are built on top of the same IOEnv monad. The
monad functions like a Reader monad in the way it passes the environment
around. This is done to allow the environment to be manipulated in a stack
like fashion when entering expressions... ect.

For state that is global and should be returned at the end (e.g not part
of the stack mechanism), you should use an TcRef (= IORef) to store them.
-}</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-pragma">{-# LANGUAGE CPP, ExistentialQuantification, GeneralizedNewtypeDeriving,
             ViewPatterns #-}</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcRnTypes</span><span class="hs-special">(</span><span>
</span><a name="line-23"></a><span>        </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#IfM"><span class="hs-identifier hs-type">IfM</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#IfG"><span class="hs-identifier hs-type">IfG</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- The monad is opaque outside this module</span><span>
</span><a name="line-24"></a><span>        </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span>        </span><span class="hs-comment">-- The environment types</span><span>
</span><a name="line-27"></a><span>        </span><a href="TcRnTypes.html#Env"><span class="hs-identifier hs-type">Env</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>        </span><a href="TcRnTypes.html#IfGblEnv"><span class="hs-identifier hs-type">IfGblEnv</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#IfLclEnv"><span class="hs-identifier hs-type">IfLclEnv</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>        </span><a href="TcRnTypes.html#tcVisibleOrphanMods"><span class="hs-identifier hs-var">tcVisibleOrphanMods</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span>        </span><span class="hs-comment">-- Frontend types (shouldn't really be here)</span><span>
</span><a name="line-33"></a><span>        </span><a href="TcRnTypes.html#FrontendResult"><span class="hs-identifier hs-type">FrontendResult</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>        </span><span class="hs-comment">-- Renamer types</span><span>
</span><a name="line-36"></a><span>        </span><a href="TcRnTypes.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#RecFieldEnv"><span class="hs-identifier hs-type">RecFieldEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>        </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#emptyImportAvails"><span class="hs-identifier hs-var">emptyImportAvails</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#plusImportAvails"><span class="hs-identifier hs-var">plusImportAvails</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>        </span><a href="TcRnTypes.html#WhereFrom"><span class="hs-identifier hs-type">WhereFrom</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#mkModDeps"><span class="hs-identifier hs-var">mkModDeps</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span>        </span><span class="hs-comment">-- Typechecker types</span><span>
</span><a name="line-41"></a><span>        </span><a href="TcRnTypes.html#TcTypeEnv"><span class="hs-identifier hs-type">TcTypeEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcIdBinderStack"><span class="hs-identifier hs-type">TcIdBinderStack</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcIdBinder"><span class="hs-identifier hs-type">TcIdBinder</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><a href="TcRnTypes.html#TcTyThing"><span class="hs-identifier hs-type">TcTyThing</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#PromotionErr"><span class="hs-identifier hs-type">PromotionErr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><a href="TcRnTypes.html#SelfBootInfo"><span class="hs-identifier hs-type">SelfBootInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>        </span><a href="TcRnTypes.html#pprTcTyThingCategory"><span class="hs-identifier hs-var">pprTcTyThingCategory</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pprPECategory"><span class="hs-identifier hs-var">pprPECategory</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>        </span><span class="hs-comment">-- Desugaring types</span><span>
</span><a name="line-47"></a><span>        </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#DsLclEnv"><span class="hs-identifier hs-type">DsLclEnv</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#DsGblEnv"><span class="hs-identifier hs-type">DsGblEnv</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#PArrBuiltin"><span class="hs-identifier hs-type">PArrBuiltin</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>        </span><a href="TcRnTypes.html#DsMetaEnv"><span class="hs-identifier hs-type">DsMetaEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#DsMetaVal"><span class="hs-identifier hs-type">DsMetaVal</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span>        </span><span class="hs-comment">-- Template Haskell</span><span>
</span><a name="line-51"></a><span>        </span><a href="TcRnTypes.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#SpliceType"><span class="hs-identifier hs-type">SpliceType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#PendingStuff"><span class="hs-identifier hs-type">PendingStuff</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>        </span><a href="TcRnTypes.html#topStage"><span class="hs-identifier hs-var">topStage</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#topAnnStage"><span class="hs-identifier hs-var">topAnnStage</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#topSpliceStage"><span class="hs-identifier hs-var">topSpliceStage</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>        </span><a href="TcRnTypes.html#ThLevel"><span class="hs-identifier hs-type">ThLevel</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#impLevel"><span class="hs-identifier hs-var">impLevel</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#outerLevel"><span class="hs-identifier hs-var">outerLevel</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#thLevel"><span class="hs-identifier hs-var">thLevel</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>        </span><span class="hs-comment">-- Arrows</span><span>
</span><a name="line-56"></a><span>        </span><a href="TcRnTypes.html#ArrowCtxt"><span class="hs-identifier hs-type">ArrowCtxt</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>        </span><span class="hs-comment">-- TcSigInfo</span><span>
</span><a name="line-59"></a><span>        </span><a href="TcRnTypes.html#TcSigFun"><span class="hs-identifier hs-type">TcSigFun</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>        </span><a href="TcRnTypes.html#TcPatSynInfo"><span class="hs-identifier hs-type">TcPatSynInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcIdSigBndr"><span class="hs-identifier hs-type">TcIdSigBndr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>        </span><a href="TcRnTypes.html#findScopedTyVars"><span class="hs-identifier hs-var">findScopedTyVars</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isPartialSig"><span class="hs-identifier hs-var">isPartialSig</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#noCompleteSig"><span class="hs-identifier hs-var">noCompleteSig</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#tcSigInfoName"><span class="hs-identifier hs-var">tcSigInfoName</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>        </span><a href="TcRnTypes.html#completeIdSigPolyId"><span class="hs-identifier hs-var">completeIdSigPolyId</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#completeSigPolyId_maybe"><span class="hs-identifier hs-var">completeSigPolyId_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>        </span><a href="TcRnTypes.html#completeIdSigPolyId_maybe"><span class="hs-identifier hs-var">completeIdSigPolyId_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>        </span><span class="hs-comment">-- Canonical constraints</span><span>
</span><a name="line-66"></a><span>        </span><a href="TcRnTypes.html#Xi"><span class="hs-identifier hs-type">Xi</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#emptyCts"><span class="hs-identifier hs-var">emptyCts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#andCts"><span class="hs-identifier hs-var">andCts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#andManyCts"><span class="hs-identifier hs-var">andManyCts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pprCts"><span class="hs-identifier hs-var">pprCts</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>        </span><a href="TcRnTypes.html#singleCt"><span class="hs-identifier hs-var">singleCt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#listToCts"><span class="hs-identifier hs-var">listToCts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctsElts"><span class="hs-identifier hs-var">ctsElts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#consCts"><span class="hs-identifier hs-var">consCts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#snocCts"><span class="hs-identifier hs-var">snocCts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#extendCtsList"><span class="hs-identifier hs-var">extendCtsList</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>        </span><a href="TcRnTypes.html#isEmptyCts"><span class="hs-identifier hs-var">isEmptyCts</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isCTyEqCan"><span class="hs-identifier hs-var">isCTyEqCan</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isCFunEqCan"><span class="hs-identifier hs-var">isCFunEqCan</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>        </span><a href="TcRnTypes.html#isPendingScDict"><span class="hs-identifier hs-var">isPendingScDict</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#superClassesMightHelp"><span class="hs-identifier hs-var">superClassesMightHelp</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>        </span><a href="TcRnTypes.html#isCDictCan_Maybe"><span class="hs-identifier hs-var">isCDictCan_Maybe</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isCFunEqCan_maybe"><span class="hs-identifier hs-var">isCFunEqCan_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>        </span><a href="TcRnTypes.html#isCIrredEvCan"><span class="hs-identifier hs-var">isCIrredEvCan</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isCNonCanonical"><span class="hs-identifier hs-var">isCNonCanonical</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isWantedCt"><span class="hs-identifier hs-var">isWantedCt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isDerivedCt"><span class="hs-identifier hs-var">isDerivedCt</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>        </span><a href="TcRnTypes.html#isGivenCt"><span class="hs-identifier hs-var">isGivenCt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isHoleCt"><span class="hs-identifier hs-var">isHoleCt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isOutOfScopeCt"><span class="hs-identifier hs-var">isOutOfScopeCt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isExprHoleCt"><span class="hs-identifier hs-var">isExprHoleCt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isTypeHoleCt"><span class="hs-identifier hs-var">isTypeHoleCt</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>        </span><a href="TcRnTypes.html#isUserTypeErrorCt"><span class="hs-identifier hs-var">isUserTypeErrorCt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isCallStackDict"><span class="hs-identifier hs-var">isCallStackDict</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#getUserTypeErrorMsg"><span class="hs-identifier hs-var">getUserTypeErrorMsg</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>        </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#setCtLoc"><span class="hs-identifier hs-var">setCtLoc</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctFlavour"><span class="hs-identifier hs-var">ctFlavour</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEqRel"><span class="hs-identifier hs-var">ctEqRel</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>        </span><a href="TcRnTypes.html#mkTcEqPredLikeEv"><span class="hs-identifier hs-var">mkTcEqPredLikeEv</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>        </span><a href="TcRnTypes.html#mkNonCanonical"><span class="hs-identifier hs-var">mkNonCanonical</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#mkNonCanonicalCt"><span class="hs-identifier hs-var">mkNonCanonicalCt</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>        </span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEvLoc"><span class="hs-identifier hs-var">ctEvLoc</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEvOrigin"><span class="hs-identifier hs-var">ctEvOrigin</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEvEqRel"><span class="hs-identifier hs-var">ctEvEqRel</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>        </span><a href="TcRnTypes.html#ctEvTerm"><span class="hs-identifier hs-var">ctEvTerm</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEvCoercion"><span class="hs-identifier hs-var">ctEvCoercion</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEvId"><span class="hs-identifier hs-var">ctEvId</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>        </span><a href="TcRnTypes.html#tyCoVarsOfCt"><span class="hs-identifier hs-var">tyCoVarsOfCt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#tyCoVarsOfCts"><span class="hs-identifier hs-var">tyCoVarsOfCts</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>        </span><a href="TcRnTypes.html#tyCoVarsOfCtList"><span class="hs-identifier hs-var">tyCoVarsOfCtList</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#tyCoVarsOfCtsList"><span class="hs-identifier hs-var">tyCoVarsOfCtsList</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>        </span><a href="TcRnTypes.html#toDerivedCt"><span class="hs-identifier hs-var">toDerivedCt</span></a><span class="hs-special">,</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>        </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#insolubleWC"><span class="hs-identifier hs-var">insolubleWC</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#emptyWC"><span class="hs-identifier hs-var">emptyWC</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isEmptyWC"><span class="hs-identifier hs-var">isEmptyWC</span></a><span class="hs-special">,</span><span>
</span><a name="line-84"></a><span>        </span><a href="TcRnTypes.html#toDerivedWC"><span class="hs-identifier hs-var">toDerivedWC</span></a><span class="hs-special">,</span><span>
</span><a name="line-85"></a><span>        </span><a href="TcRnTypes.html#andWC"><span class="hs-identifier hs-var">andWC</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#unionsWC"><span class="hs-identifier hs-var">unionsWC</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#mkSimpleWC"><span class="hs-identifier hs-var">mkSimpleWC</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#mkImplicWC"><span class="hs-identifier hs-var">mkImplicWC</span></a><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>        </span><a href="TcRnTypes.html#addInsols"><span class="hs-identifier hs-var">addInsols</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#addSimples"><span class="hs-identifier hs-var">addSimples</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#addImplics"><span class="hs-identifier hs-var">addImplics</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>        </span><a href="TcRnTypes.html#tyCoVarsOfWC"><span class="hs-identifier hs-var">tyCoVarsOfWC</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#dropDerivedWC"><span class="hs-identifier hs-var">dropDerivedWC</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#dropDerivedSimples"><span class="hs-identifier hs-var">dropDerivedSimples</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#dropDerivedInsols"><span class="hs-identifier hs-var">dropDerivedInsols</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>        </span><a href="TcRnTypes.html#isDroppableDerivedLoc"><span class="hs-identifier hs-var">isDroppableDerivedLoc</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#insolubleImplic"><span class="hs-identifier hs-var">insolubleImplic</span></a><span class="hs-special">,</span><span>
</span><a name="line-89"></a><span>        </span><a href="TcRnTypes.html#arisesFromGivens"><span class="hs-identifier hs-var">arisesFromGivens</span></a><span class="hs-special">,</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span>        </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ImplicStatus"><span class="hs-identifier hs-type">ImplicStatus</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isInsolubleStatus"><span class="hs-identifier hs-var">isInsolubleStatus</span></a><span class="hs-special">,</span><span>
</span><a name="line-92"></a><span>        </span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-type">SubGoalDepth</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#initialSubGoalDepth"><span class="hs-identifier hs-var">initialSubGoalDepth</span></a><span class="hs-special">,</span><span>
</span><a name="line-93"></a><span>        </span><a href="TcRnTypes.html#bumpSubGoalDepth"><span class="hs-identifier hs-var">bumpSubGoalDepth</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#subGoalDepthExceeded"><span class="hs-identifier hs-var">subGoalDepthExceeded</span></a><span class="hs-special">,</span><span>
</span><a name="line-94"></a><span>        </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctLocSpan"><span class="hs-identifier hs-var">ctLocSpan</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctLocLevel"><span class="hs-identifier hs-var">ctLocLevel</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span class="hs-special">,</span><span>
</span><a name="line-95"></a><span>        </span><a href="TcRnTypes.html#ctLocTypeOrKind_maybe"><span class="hs-identifier hs-var">ctLocTypeOrKind_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-96"></a><span>        </span><a href="TcRnTypes.html#ctLocDepth"><span class="hs-identifier hs-var">ctLocDepth</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#bumpCtLocDepth"><span class="hs-identifier hs-var">bumpCtLocDepth</span></a><span class="hs-special">,</span><span>
</span><a name="line-97"></a><span>        </span><a href="TcRnTypes.html#setCtLocOrigin"><span class="hs-identifier hs-var">setCtLocOrigin</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#setCtLocEnv"><span class="hs-identifier hs-var">setCtLocEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#setCtLocSpan"><span class="hs-identifier hs-var">setCtLocSpan</span></a><span class="hs-special">,</span><span>
</span><a name="line-98"></a><span>        </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#matchesCtOrigin"><span class="hs-identifier hs-var">matchesCtOrigin</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#grhssCtOrigin"><span class="hs-identifier hs-var">grhssCtOrigin</span></a><span class="hs-special">,</span><span>
</span><a name="line-99"></a><span>        </span><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier hs-type">ErrorThing</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#mkErrorThing"><span class="hs-identifier hs-var">mkErrorThing</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#errorThingNumArgs_maybe"><span class="hs-identifier hs-var">errorThingNumArgs_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-100"></a><span>        </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isTypeLevel"><span class="hs-identifier hs-var">isTypeLevel</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isKindLevel"><span class="hs-identifier hs-var">isKindLevel</span></a><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>        </span><a href="TcRnTypes.html#pprCtOrigin"><span class="hs-identifier hs-var">pprCtOrigin</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pprCtLoc"><span class="hs-identifier hs-var">pprCtLoc</span></a><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>        </span><a href="TcRnTypes.html#pushErrCtxt"><span class="hs-identifier hs-var">pushErrCtxt</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pushErrCtxtSameOrigin"><span class="hs-identifier hs-var">pushErrCtxtSameOrigin</span></a><span class="hs-special">,</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>        </span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pprSigSkolInfo"><span class="hs-identifier hs-var">pprSigSkolInfo</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pprSkolInfo"><span class="hs-identifier hs-var">pprSkolInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>        </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcEvDest"><span class="hs-identifier hs-type">TcEvDest</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-107"></a><span>        </span><a href="TcRnTypes.html#mkGivenLoc"><span class="hs-identifier hs-var">mkGivenLoc</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#mkKindLoc"><span class="hs-identifier hs-var">mkKindLoc</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#toKindLoc"><span class="hs-identifier hs-var">toKindLoc</span></a><span class="hs-special">,</span><span>
</span><a name="line-108"></a><span>        </span><a href="TcRnTypes.html#isWanted"><span class="hs-identifier hs-var">isWanted</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isGiven"><span class="hs-identifier hs-var">isGiven</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#isDerived"><span class="hs-identifier hs-var">isDerived</span></a><span class="hs-special">,</span><span>
</span><a name="line-109"></a><span>        </span><a href="TcRnTypes.html#ctEvRole"><span class="hs-identifier hs-var">ctEvRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span>        </span><span class="hs-comment">-- Constraint solver plugins</span><span>
</span><a name="line-112"></a><span>        </span><a href="TcRnTypes.html#TcPlugin"><span class="hs-identifier hs-type">TcPlugin</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcPluginResult"><span class="hs-identifier hs-type">TcPluginResult</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcPluginSolver"><span class="hs-identifier hs-type">TcPluginSolver</span></a><span class="hs-special">,</span><span>
</span><a name="line-113"></a><span>        </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#runTcPluginM"><span class="hs-identifier hs-var">runTcPluginM</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#unsafeTcPluginTcM"><span class="hs-identifier hs-var">unsafeTcPluginTcM</span></a><span class="hs-special">,</span><span>
</span><a name="line-114"></a><span>        </span><a href="TcRnTypes.html#getEvBindsTcPluginM_maybe"><span class="hs-identifier hs-var">getEvBindsTcPluginM_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span>        </span><a href="TcRnTypes.html#CtFlavour"><span class="hs-identifier hs-type">CtFlavour</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEvFlavour"><span class="hs-identifier hs-var">ctEvFlavour</span></a><span class="hs-special">,</span><span>
</span><a name="line-117"></a><span>        </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier hs-var">ctEvFlavourRole</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctFlavourRole"><span class="hs-identifier hs-var">ctFlavourRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-118"></a><span>        </span><a href="TcRnTypes.html#eqCanRewrite"><span class="hs-identifier hs-var">eqCanRewrite</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#eqCanRewriteFR"><span class="hs-identifier hs-var">eqCanRewriteFR</span></a><span class="hs-special">,</span><span>  </span><a href="TcRnTypes.html#eqCanDischarge"><span class="hs-identifier hs-var">eqCanDischarge</span></a><span class="hs-special">,</span><span>
</span><a name="line-119"></a><span>        </span><a href="TcRnTypes.html#funEqCanDischarge"><span class="hs-identifier hs-var">funEqCanDischarge</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#funEqCanDischargeFR"><span class="hs-identifier hs-var">funEqCanDischargeFR</span></a><span class="hs-special">,</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>        </span><span class="hs-comment">-- Pretty printing</span><span>
</span><a name="line-122"></a><span>        </span><a href="TcRnTypes.html#pprEvVarTheta"><span class="hs-identifier hs-var">pprEvVarTheta</span></a><span class="hs-special">,</span><span>
</span><a name="line-123"></a><span>        </span><a href="TcRnTypes.html#pprEvVars"><span class="hs-identifier hs-var">pprEvVars</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pprEvVarWithType"><span class="hs-identifier hs-var">pprEvVarWithType</span></a><span class="hs-special">,</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>        </span><span class="hs-comment">-- Misc other types</span><span>
</span><a name="line-126"></a><span>        </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcIdSet"><span class="hs-identifier hs-type">TcIdSet</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#HoleSort"><span class="hs-identifier hs-type">HoleSort</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-133"></a><span class="hs-keyword">import</span><span> </span><a href="CoreSyn.html"><span class="hs-identifier">CoreSyn</span></a><span>
</span><a name="line-134"></a><span class="hs-keyword">import</span><span> </span><a href="HscTypes.html"><span class="hs-identifier">HscTypes</span></a><span>
</span><a name="line-135"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>
</span><a name="line-136"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-137"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkHoleCo"><span class="hs-identifier hs-var">mkHoleCo</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConUserType"><span class="hs-identifier hs-var">dataConUserType</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span class="hs-keyword">import</span><span> </span><a href="PatSyn.html"><span class="hs-identifier">PatSyn</span></a><span>   </span><span class="hs-special">(</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#patSynType"><span class="hs-identifier hs-var">patSynType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="PrelNames.html#callStackTyConKey"><span class="hs-identifier hs-var">callStackTyConKey</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#ipClassKey"><span class="hs-identifier hs-var">ipClassKey</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span class="hs-keyword">import</span><span> </span><a href="FieldLabel.html"><span class="hs-identifier">FieldLabel</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-148"></a><span class="hs-keyword">import</span><span> </span><a href="Annotations.html"><span class="hs-identifier">Annotations</span></a><span>
</span><a name="line-149"></a><span class="hs-keyword">import</span><span> </span><a href="InstEnv.html"><span class="hs-identifier">InstEnv</span></a><span>
</span><a name="line-150"></a><span class="hs-keyword">import</span><span> </span><a href="FamInstEnv.html"><span class="hs-identifier">FamInstEnv</span></a><span>
</span><a name="line-151"></a><span class="hs-keyword">import</span><span> </span><a href="PmExpr.html"><span class="hs-identifier">PmExpr</span></a><span>
</span><a name="line-152"></a><span class="hs-keyword">import</span><span> </span><a href="IOEnv.html"><span class="hs-identifier">IOEnv</span></a><span>
</span><a name="line-153"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span>
</span><a name="line-154"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-155"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-156"></a><span class="hs-keyword">import</span><span> </span><a href="NameSet.html"><span class="hs-identifier">NameSet</span></a><span>
</span><a name="line-157"></a><span class="hs-keyword">import</span><span> </span><a href="Avail.html"><span class="hs-identifier">Avail</span></a><span>
</span><a name="line-158"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-159"></a><span class="hs-keyword">import</span><span> </span><a href="FV.html"><span class="hs-identifier">FV</span></a><span>
</span><a name="line-160"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-161"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-162"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-163"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-164"></a><span class="hs-keyword">import</span><span> </span><a href="ErrUtils.html"><span class="hs-identifier">ErrUtils</span></a><span>
</span><a name="line-165"></a><span class="hs-keyword">import</span><span> </span><a href="UniqFM.html"><span class="hs-identifier">UniqFM</span></a><span>
</span><a name="line-166"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSupply.html"><span class="hs-identifier">UniqSupply</span></a><span>
</span><a name="line-167"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-168"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-169"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-170"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-171"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>
</span><a name="line-172"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-173"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Fingerprint.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Fingerprint</span></a><span>
</span><a name="line-174"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">LanguageExtensions</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LangExt</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#ap"><span class="hs-identifier hs-var">ap</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#msum"><span class="hs-identifier hs-var">msum</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710</span><span>
</span><a name="line-178"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Fail</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">MonadFail</span><span>
</span><a name="line-179"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-cpp">#ifdef GHCI</span><span>
</span><a name="line-182"></a><span class="hs-keyword">import</span><span> </span><a href="../containers-0.5.7.1/src/%{MODULE/./-}.html#%{NAME}/Data.Map.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span></a><span>      </span><span class="hs-special">(</span><span> </span><a href="../containers-0.5.7.1/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Base.html#Map"><span class="hs-identifier hs-type">Map</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Dynamic.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Dynamic</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Dynamic.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#TypeRep"><span class="hs-identifier hs-type">TypeRep</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span class="hs-keyword">import</span><span> </span><a href="../ghci-8.1/src/%{MODULE/./-}.html#%{NAME}/GHCi.Message.html"><span class="hs-identifier">GHCi</span><span class="hs-operator">.</span><span class="hs-identifier">Message</span></a><span>
</span><a name="line-186"></a><span class="hs-keyword">import</span><span> </span><a href="../ghci-8.1/src/%{MODULE/./-}.html#%{NAME}/GHCi.RemoteTypes.html"><span class="hs-identifier">GHCi</span><span class="hs-operator">.</span><span class="hs-identifier">RemoteTypes</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../template-haskell-2.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Language.Haskell.TH.html"><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TH</span><span>
</span><a name="line-189"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
               Standard monad definition for TcRn
    All the combinators for the monad can be found in TcRnMonad
*                                                                      *
************************************************************************

The monad itself has to be defined here, because it is mentioned by ErrCtxt
-}</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-keyword">type</span><span> </span><a name="TcRnIf"><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier">TcRnIf</span></a></a><span> </span><a name="local-1627933662"><a href="#local-1627933662"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627933663"><a href="#local-1627933663"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="IOEnv.html#IOEnv"><span class="hs-identifier hs-type">IOEnv</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Env"><span class="hs-identifier hs-type">Env</span></a><span> </span><a href="#local-1627933662"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627933663"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span class="hs-keyword">type</span><span> </span><a name="TcRn"><a href="TcRnTypes.html#TcRn"><span class="hs-identifier">TcRn</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span>    </span><span class="hs-comment">-- Type inference</span><span>
</span><a name="line-204"></a><span class="hs-keyword">type</span><span> </span><a name="IfM"><a href="TcRnTypes.html#IfM"><span class="hs-identifier">IfM</span></a></a><span> </span><a name="local-1627933661"><a href="#local-1627933661"><span class="hs-identifier">lcl</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="TcRnTypes.html#IfGblEnv"><span class="hs-identifier hs-type">IfGblEnv</span></a><span> </span><a href="#local-1627933661"><span class="hs-identifier hs-type">lcl</span></a><span>         </span><span class="hs-comment">-- Iface stuff</span><span>
</span><a name="line-205"></a><span class="hs-keyword">type</span><span> </span><a name="IfG"><a href="TcRnTypes.html#IfG"><span class="hs-identifier">IfG</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#IfM"><span class="hs-identifier hs-type">IfM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>                      </span><span class="hs-comment">--    Top level</span><span>
</span><a name="line-206"></a><span class="hs-keyword">type</span><span> </span><a name="IfL"><a href="TcRnTypes.html#IfL"><span class="hs-identifier">IfL</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#IfM"><span class="hs-identifier hs-type">IfM</span></a><span> </span><a href="TcRnTypes.html#IfLclEnv"><span class="hs-identifier hs-type">IfLclEnv</span></a><span>                </span><span class="hs-comment">--    Nested</span><span>
</span><a name="line-207"></a><span class="hs-keyword">type</span><span> </span><a name="DsM"><a href="TcRnTypes.html#DsM"><span class="hs-identifier">DsM</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="TcRnTypes.html#DsGblEnv"><span class="hs-identifier hs-type">DsGblEnv</span></a><span> </span><a href="TcRnTypes.html#DsLclEnv"><span class="hs-identifier hs-type">DsLclEnv</span></a><span>    </span><span class="hs-comment">-- Desugaring</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- TcRn is the type-checking and renaming monad: the main monad that</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- most type-checking takes place in.  The global environment is</span><span>
</span><a name="line-211"></a><span class="hs-comment">-- 'TcGblEnv', which tracks all of the top-level type-checking</span><span>
</span><a name="line-212"></a><span class="hs-comment">-- information we've accumulated while checking a module, while the</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- local environment is 'TcLclEnv', which tracks local information as</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- we move inside expressions.</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-comment">-- | Historical &quot;renaming monad&quot; (now it's just 'TcRn').</span><span>
</span><a name="line-217"></a><span class="hs-keyword">type</span><span> </span><a name="RnM"><a href="TcRnTypes.html#RnM"><span class="hs-identifier">RnM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- | Historical &quot;type-checking monad&quot; (now it's just 'TcRn').</span><span>
</span><a name="line-220"></a><span class="hs-keyword">type</span><span> </span><a name="TcM"><a href="TcRnTypes.html#TcM"><span class="hs-identifier">TcM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">-- We 'stack' these envs through the Reader like monad infrastructure</span><span>
</span><a name="line-223"></a><span class="hs-comment">-- as we move into an expression (although the change is focused in</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- the lcl type).</span><span>
</span><a name="line-225"></a><span class="hs-keyword">data</span><span> </span><a name="Env"><a href="TcRnTypes.html#Env"><span class="hs-identifier">Env</span></a></a><span> </span><a name="local-1627933659"><a href="#local-1627933659"><span class="hs-identifier">gbl</span></a></a><span> </span><a name="local-1627933660"><a href="#local-1627933660"><span class="hs-identifier">lcl</span></a></a><span>
</span><a name="line-226"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Env"><a href="TcRnTypes.html#Env"><span class="hs-identifier">Env</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-227"></a><span>        </span><a href="TcRnTypes.html#env_top"><span class="hs-identifier">env_top</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- Top-level stuff that never changes</span><span>
</span><a name="line-228"></a><span>                             </span><span class="hs-comment">-- Includes all info about imported things</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span>        </span><a href="TcRnTypes.html#env_us"><span class="hs-identifier">env_us</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a><span> </span><a href="UniqSupply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-231"></a><span>                             </span><span class="hs-comment">-- Unique supply for local variables</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span>        </span><a href="TcRnTypes.html#env_gbl"><span class="hs-identifier">env_gbl</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627933659"><span class="hs-identifier hs-type">gbl</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Info about things defined at the top level</span><span>
</span><a name="line-234"></a><span>                             </span><span class="hs-comment">-- of the module being compiled</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span>        </span><a href="TcRnTypes.html#env_lcl"><span class="hs-identifier">env_lcl</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627933660"><span class="hs-identifier hs-type">lcl</span></a><span>      </span><span class="hs-comment">-- Nested stuff; changes as we go into</span><span>
</span><a name="line-237"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-keyword">instance</span><span> </span><a href="DynFlags.html#ContainsDynFlags"><span class="hs-identifier hs-type">ContainsDynFlags</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Env"><span class="hs-identifier hs-type">Env</span></a><span> </span><a href="#local-1627934003"><span class="hs-identifier hs-type">gbl</span></a><span> </span><a href="#local-1627934004"><span class="hs-identifier hs-type">lcl</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-240"></a><span>    </span><a name="local-1912741862"><a href="DynFlags.html#extractDynFlags"><span class="hs-identifier">extractDynFlags</span></a></a><span> </span><a name="local-1627934005"><a href="#local-1627934005"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsc_dflags</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">env_top</span><span> </span><a href="#local-1627934005"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-keyword">instance</span><span> </span><a href="Module.html#ContainsModule"><span class="hs-identifier hs-type">ContainsModule</span></a><span> </span><a href="#local-1627934000"><span class="hs-identifier hs-type">gbl</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Module.html#ContainsModule"><span class="hs-identifier hs-type">ContainsModule</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Env"><span class="hs-identifier hs-type">Env</span></a><span> </span><a href="#local-1627934000"><span class="hs-identifier hs-type">gbl</span></a><span> </span><a href="#local-1627934001"><span class="hs-identifier hs-type">lcl</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-243"></a><span>    </span><a name="local-1912733518"><a href="Module.html#extractModule"><span class="hs-identifier">extractModule</span></a></a><span> </span><a name="local-1627934002"><a href="#local-1627934002"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#extractModule"><span class="hs-identifier hs-var">extractModule</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">env_gbl</span><span> </span><a href="#local-1627934002"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                The interface environments
              Used when dealing with IfaceDecls
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-keyword">data</span><span> </span><a name="IfGblEnv"><a href="TcRnTypes.html#IfGblEnv"><span class="hs-identifier">IfGblEnv</span></a></a><span>
</span><a name="line-256"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="IfGblEnv"><a href="TcRnTypes.html#IfGblEnv"><span class="hs-identifier">IfGblEnv</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-257"></a><span>        </span><span class="hs-comment">-- The type environment for the module being compiled,</span><span>
</span><a name="line-258"></a><span>        </span><span class="hs-comment">-- in case the interface refers back to it via a reference that</span><span>
</span><a name="line-259"></a><span>        </span><span class="hs-comment">-- was originally a hi-boot file.</span><span>
</span><a name="line-260"></a><span>        </span><span class="hs-comment">-- We need the module name so we can test when it's appropriate</span><span>
</span><a name="line-261"></a><span>        </span><span class="hs-comment">-- to look in this env.</span><span>
</span><a name="line-262"></a><span>        </span><a href="TcRnTypes.html#if_rec_types"><span class="hs-identifier">if_rec_types</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#IfG"><span class="hs-identifier hs-type">IfG</span></a><span> </span><a href="HscTypes.html#TypeEnv"><span class="hs-identifier hs-type">TypeEnv</span></a><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>                </span><span class="hs-comment">-- Allows a read effect, so it can be in a mutable</span><span>
</span><a name="line-264"></a><span>                </span><span class="hs-comment">-- variable; c.f. handling the external package type env</span><span>
</span><a name="line-265"></a><span>                </span><span class="hs-comment">-- Nothing =&gt; interactive stuff, no loops possible</span><span>
</span><a name="line-266"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-keyword">data</span><span> </span><a name="IfLclEnv"><a href="TcRnTypes.html#IfLclEnv"><span class="hs-identifier">IfLclEnv</span></a></a><span>
</span><a name="line-269"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="IfLclEnv"><a href="TcRnTypes.html#IfLclEnv"><span class="hs-identifier">IfLclEnv</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-270"></a><span>        </span><span class="hs-comment">-- The module for the current IfaceDecl</span><span>
</span><a name="line-271"></a><span>        </span><span class="hs-comment">-- So if we see   f = \x -&gt; x</span><span>
</span><a name="line-272"></a><span>        </span><span class="hs-comment">-- it means M.f = \x -&gt; x, where M is the if_mod</span><span>
</span><a name="line-273"></a><span>        </span><a href="TcRnTypes.html#if_mod"><span class="hs-identifier">if_mod</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span class="hs-special">,</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span>        </span><span class="hs-comment">-- The field is used only for error reporting</span><span>
</span><a name="line-276"></a><span>        </span><span class="hs-comment">-- if (say) there's a Lint error in it</span><span>
</span><a name="line-277"></a><span>        </span><a href="TcRnTypes.html#if_loc"><span class="hs-identifier">if_loc</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">,</span><span>
</span><a name="line-278"></a><span>                </span><span class="hs-comment">-- Where the interface came from:</span><span>
</span><a name="line-279"></a><span>                </span><span class="hs-comment">--      .hi file, or GHCi state, or ext core</span><span>
</span><a name="line-280"></a><span>                </span><span class="hs-comment">-- plus which bit is currently being examined</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span>        </span><a href="TcRnTypes.html#if_tv_env"><span class="hs-identifier">if_tv_env</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="UniqFM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Nested tyvar bindings</span><span>
</span><a name="line-283"></a><span>        </span><a href="TcRnTypes.html#if_id_env"><span class="hs-identifier">if_id_env</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="UniqFM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>         </span><span class="hs-comment">-- Nested id binding</span><span>
</span><a name="line-284"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Desugarer monad
*                                                                      *
************************************************************************

Now the mondo monad magic (yes, @DsM@ is a silly name)---carry around
a @UniqueSupply@ and some annotations, which
presumably include source-file location information:
-}</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">-- If '-XParallelArrays' is given, the desugarer populates this table with the corresponding</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- variables found in 'Data.Array.Parallel'.</span><span>
</span><a name="line-300"></a><span class="hs-comment">--</span><span>
</span><a name="line-301"></a><span class="hs-keyword">data</span><span> </span><a name="PArrBuiltin"><a href="TcRnTypes.html#PArrBuiltin"><span class="hs-identifier">PArrBuiltin</span></a></a><span>
</span><a name="line-302"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a name="PArrBuiltin"><a href="TcRnTypes.html#PArrBuiltin"><span class="hs-identifier">PArrBuiltin</span></a></a><span>
</span><a name="line-303"></a><span>        </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#lengthPVar"><span class="hs-identifier">lengthPVar</span></a><span>         </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ lengthP</span><span>
</span><a name="line-304"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#replicatePVar"><span class="hs-identifier">replicatePVar</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ replicateP</span><span>
</span><a name="line-305"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#singletonPVar"><span class="hs-identifier">singletonPVar</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ singletonP</span><span>
</span><a name="line-306"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#mapPVar"><span class="hs-identifier">mapPVar</span></a><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ mapP</span><span>
</span><a name="line-307"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#filterPVar"><span class="hs-identifier">filterPVar</span></a><span>         </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ filterP</span><span>
</span><a name="line-308"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#zipPVar"><span class="hs-identifier">zipPVar</span></a><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ zipP</span><span>
</span><a name="line-309"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#crossMapPVar"><span class="hs-identifier">crossMapPVar</span></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ crossMapP</span><span>
</span><a name="line-310"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#indexPVar"><span class="hs-identifier">indexPVar</span></a><span>          </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ (!:)</span><span>
</span><a name="line-311"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#emptyPVar"><span class="hs-identifier">emptyPVar</span></a><span>          </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ emptyP</span><span>
</span><a name="line-312"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#appPVar"><span class="hs-identifier">appPVar</span></a><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ (+:+)</span><span>
</span><a name="line-313"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#enumFromToPVar"><span class="hs-identifier">enumFromToPVar</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ enumFromToP</span><span>
</span><a name="line-314"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#enumFromThenToPVar"><span class="hs-identifier">enumFromThenToPVar</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- ^ enumFromThenToP</span><span>
</span><a name="line-315"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-keyword">data</span><span> </span><a name="DsGblEnv"><a href="TcRnTypes.html#DsGblEnv"><span class="hs-identifier">DsGblEnv</span></a></a><span>
</span><a name="line-318"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a name="DsGblEnv"><a href="TcRnTypes.html#DsGblEnv"><span class="hs-identifier">DsGblEnv</span></a></a><span>
</span><a name="line-319"></a><span>        </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#ds_mod"><span class="hs-identifier">ds_mod</span></a><span>          </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span>             </span><span class="hs-comment">-- For SCC profiling</span><span>
</span><a name="line-320"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ds_fam_inst_env"><span class="hs-identifier">ds_fam_inst_env</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnv"><span class="hs-identifier hs-type">FamInstEnv</span></a><span>         </span><span class="hs-comment">-- Like tcg_fam_inst_env</span><span>
</span><a name="line-321"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ds_unqual"><span class="hs-identifier">ds_unqual</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#PrintUnqualified"><span class="hs-identifier hs-type">PrintUnqualified</span></a><span>
</span><a name="line-322"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ds_msgs"><span class="hs-identifier">ds_msgs</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a><span> </span><a href="ErrUtils.html#Messages"><span class="hs-identifier hs-type">Messages</span></a><span>          </span><span class="hs-comment">-- Warning messages</span><span>
</span><a name="line-323"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ds_if_env"><span class="hs-identifier">ds_if_env</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#IfGblEnv"><span class="hs-identifier hs-type">IfGblEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#IfLclEnv"><span class="hs-identifier hs-type">IfLclEnv</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Used for looking up global,</span><span>
</span><a name="line-324"></a><span>                                                </span><span class="hs-comment">-- possibly-imported things</span><span>
</span><a name="line-325"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ds_dph_env"><span class="hs-identifier">ds_dph_env</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span>            </span><span class="hs-comment">-- exported entities of 'Data.Array.Parallel.Prim'</span><span>
</span><a name="line-326"></a><span>                                                </span><span class="hs-comment">-- iff '-fvectorise' flag was given as well as</span><span>
</span><a name="line-327"></a><span>                                                </span><span class="hs-comment">-- exported entities of 'Data.Array.Parallel' iff</span><span>
</span><a name="line-328"></a><span>                                                </span><span class="hs-comment">-- '-XParallelArrays' was given; otherwise, empty</span><span>
</span><a name="line-329"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ds_parr_bi"><span class="hs-identifier">ds_parr_bi</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#PArrBuiltin"><span class="hs-identifier hs-type">PArrBuiltin</span></a><span>             </span><span class="hs-comment">-- desugarar names for '-XParallelArrays'</span><span>
</span><a name="line-330"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ds_static_binds"><span class="hs-identifier">ds_static_binds</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-331"></a><span>          </span><span class="hs-comment">-- ^ Bindings resulted from floating static forms</span><span>
</span><a name="line-332"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-keyword">instance</span><span> </span><a href="Module.html#ContainsModule"><span class="hs-identifier hs-type">ContainsModule</span></a><span> </span><a href="TcRnTypes.html#DsGblEnv"><span class="hs-identifier hs-type">DsGblEnv</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-335"></a><span>    </span><a name="local-1912733518"><a href="Module.html#extractModule"><span class="hs-identifier">extractModule</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ds_mod</span><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-keyword">data</span><span> </span><a name="DsLclEnv"><a href="TcRnTypes.html#DsLclEnv"><span class="hs-identifier">DsLclEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DsLclEnv"><a href="TcRnTypes.html#DsLclEnv"><span class="hs-identifier">DsLclEnv</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-338"></a><span>        </span><a href="TcRnTypes.html#dsl_meta"><span class="hs-identifier">dsl_meta</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#DsMetaEnv"><span class="hs-identifier hs-type">DsMetaEnv</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- Template Haskell bindings</span><span>
</span><a name="line-339"></a><span>        </span><a href="TcRnTypes.html#dsl_loc"><span class="hs-identifier">dsl_loc</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- To put in pattern-matching error msgs</span><span>
</span><a name="line-340"></a><span>        </span><a href="TcRnTypes.html#dsl_dicts"><span class="hs-identifier">dsl_dicts</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- Constraints from GADT pattern-matching</span><span>
</span><a name="line-341"></a><span>        </span><a href="TcRnTypes.html#dsl_tm_cs"><span class="hs-identifier">dsl_tm_cs</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="PmExpr.html#SimpleEq"><span class="hs-identifier hs-type">SimpleEq</span></a><span class="hs-special">,</span><span>
</span><a name="line-342"></a><span>        </span><a href="TcRnTypes.html#dsl_pm_iter"><span class="hs-identifier">dsl_pm_iter</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>         </span><span class="hs-comment">-- no iterations for pmcheck</span><span>
</span><a name="line-343"></a><span>     </span><span class="hs-special">}</span><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-comment">-- Inside [| |] brackets, the desugarer looks</span><span>
</span><a name="line-346"></a><span class="hs-comment">-- up variables in the DsMetaEnv</span><span>
</span><a name="line-347"></a><span class="hs-keyword">type</span><span> </span><a name="DsMetaEnv"><a href="TcRnTypes.html#DsMetaEnv"><span class="hs-identifier">DsMetaEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><a href="TcRnTypes.html#DsMetaVal"><span class="hs-identifier hs-type">DsMetaVal</span></a><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-keyword">data</span><span> </span><a name="DsMetaVal"><a href="TcRnTypes.html#DsMetaVal"><span class="hs-identifier">DsMetaVal</span></a></a><span>
</span><a name="line-350"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a name="DsBound"><a href="TcRnTypes.html#DsBound"><span class="hs-identifier">DsBound</span></a></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>         </span><span class="hs-comment">-- Bound by a pattern inside the [| |].</span><span>
</span><a name="line-351"></a><span>                        </span><span class="hs-comment">-- Will be dynamically alpha renamed.</span><span>
</span><a name="line-352"></a><span>                        </span><span class="hs-comment">-- The Id has type THSyntax.Var</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="DsSplice"><a href="TcRnTypes.html#DsSplice"><span class="hs-identifier">DsSplice</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- These bindings are introduced by</span><span>
</span><a name="line-355"></a><span>                          </span><span class="hs-comment">-- the PendingSplices on a HsBracketOut</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Global typechecker environment
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | 'FrontendResult' describes the result of running the</span><span>
</span><a name="line-367"></a><span class="hs-comment">-- frontend of a Haskell module.  Usually, you'll get</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- a 'FrontendTypecheck', since running the frontend involves</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- typechecking a program, but for an hs-boot merge you'll</span><span>
</span><a name="line-370"></a><span class="hs-comment">-- just get a ModIface, since no actual typechecking occurred.</span><span>
</span><a name="line-371"></a><span class="hs-comment">--</span><span>
</span><a name="line-372"></a><span class="hs-comment">-- This data type really should be in HscTypes, but it needs</span><span>
</span><a name="line-373"></a><span class="hs-comment">-- to have a TcGblEnv which is only defined here.</span><span>
</span><a name="line-374"></a><span class="hs-keyword">data</span><span> </span><a name="FrontendResult"><a href="TcRnTypes.html#FrontendResult"><span class="hs-identifier">FrontendResult</span></a></a><span>
</span><a name="line-375"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a name="FrontendTypecheck"><a href="TcRnTypes.html#FrontendTypecheck"><span class="hs-identifier">FrontendTypecheck</span></a></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">-- | 'TcGblEnv' describes the top-level of the module at the</span><span>
</span><a name="line-378"></a><span class="hs-comment">-- point at which the typechecker is finished work.</span><span>
</span><a name="line-379"></a><span class="hs-comment">-- It is this structure that is handed on to the desugarer</span><span>
</span><a name="line-380"></a><span class="hs-comment">-- For state that needs to be updated during the typechecking</span><span>
</span><a name="line-381"></a><span class="hs-comment">-- phase and returned at end, use a 'TcRef' (= 'IORef').</span><span>
</span><a name="line-382"></a><span class="hs-keyword">data</span><span> </span><a name="TcGblEnv"><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier">TcGblEnv</span></a></a><span>
</span><a name="line-383"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TcGblEnv"><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier">TcGblEnv</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-384"></a><span>        </span><a href="TcRnTypes.html#tcg_mod"><span class="hs-identifier">tcg_mod</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- ^ Module being compiled</span><span>
</span><a name="line-385"></a><span>        </span><a href="TcRnTypes.html#tcg_src"><span class="hs-identifier">tcg_src</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="DriverPhases.html#HscSource"><span class="hs-identifier hs-type">HscSource</span></a><span class="hs-special">,</span><span>
</span><a name="line-386"></a><span>          </span><span class="hs-comment">-- ^ What kind of module (regular Haskell, hs-boot, hsig)</span><span>
</span><a name="line-387"></a><span>        </span><a href="TcRnTypes.html#tcg_sig_of"><span class="hs-identifier">tcg_sig_of</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span class="hs-special">,</span><span>
</span><a name="line-388"></a><span>          </span><span class="hs-comment">-- ^ Are we being compiled as a signature of an implementation?</span><span>
</span><a name="line-389"></a><span>        </span><a href="TcRnTypes.html#tcg_impl_rdr_env"><span class="hs-identifier">tcg_impl_rdr_env</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-390"></a><span>          </span><span class="hs-comment">-- ^ Environment used only during -sig-of for resolving top level</span><span>
</span><a name="line-391"></a><span>          </span><span class="hs-comment">-- bindings.  See Note [Signature parameters in TcGblEnv and DynFlags]</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span>        </span><a href="TcRnTypes.html#tcg_rdr_env"><span class="hs-identifier">tcg_rdr_env</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ Top level envt; used during renaming</span><span>
</span><a name="line-394"></a><span>        </span><a href="TcRnTypes.html#tcg_default"><span class="hs-identifier">tcg_default</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-395"></a><span>          </span><span class="hs-comment">-- ^ Types used for defaulting. @Nothing@ =&gt; no @default@ decl</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span>        </span><a href="TcRnTypes.html#tcg_fix_env"><span class="hs-identifier">tcg_fix_env</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#FixityEnv"><span class="hs-identifier hs-type">FixityEnv</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ^ Just for things in this module</span><span>
</span><a name="line-398"></a><span>        </span><a href="TcRnTypes.html#tcg_field_env"><span class="hs-identifier">tcg_field_env</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#RecFieldEnv"><span class="hs-identifier hs-type">RecFieldEnv</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ Just for things in this module</span><span>
</span><a name="line-399"></a><span>                                        </span><span class="hs-comment">-- See Note [The interactive package] in HscTypes</span><span>
</span><a name="line-400"></a><span>
</span><a name="line-401"></a><span>        </span><a href="TcRnTypes.html#tcg_type_env"><span class="hs-identifier">tcg_type_env</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#TypeEnv"><span class="hs-identifier hs-type">TypeEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-402"></a><span>          </span><span class="hs-comment">-- ^ Global type env for the module we are compiling now.  All</span><span>
</span><a name="line-403"></a><span>          </span><span class="hs-comment">-- TyCons and Classes (for this module) end up in here right away,</span><span>
</span><a name="line-404"></a><span>          </span><span class="hs-comment">-- along with their derived constructors, selectors.</span><span>
</span><a name="line-405"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-406"></a><span>          </span><span class="hs-comment">-- (Ids defined in this module start in the local envt, though they</span><span>
</span><a name="line-407"></a><span>          </span><span class="hs-comment">--  move to the global envt during zonking)</span><span>
</span><a name="line-408"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-409"></a><span>          </span><span class="hs-comment">-- NB: for what &quot;things in this module&quot; means, see</span><span>
</span><a name="line-410"></a><span>          </span><span class="hs-comment">-- Note [The interactive package] in HscTypes</span><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span>        </span><a href="TcRnTypes.html#tcg_type_env_var"><span class="hs-identifier">tcg_type_env_var</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="HscTypes.html#TypeEnv"><span class="hs-identifier hs-type">TypeEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-413"></a><span>                </span><span class="hs-comment">-- Used only to initialise the interface-file</span><span>
</span><a name="line-414"></a><span>                </span><span class="hs-comment">-- typechecker in initIfaceTcRn, so that it can see stuff</span><span>
</span><a name="line-415"></a><span>                </span><span class="hs-comment">-- bound in this module when dealing with hi-boot recursions</span><span>
</span><a name="line-416"></a><span>                </span><span class="hs-comment">-- Updated at intervals (e.g. after dealing with types and classes)</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span>        </span><a href="TcRnTypes.html#tcg_inst_env"><span class="hs-identifier">tcg_inst_env</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="InstEnv.html#InstEnv"><span class="hs-identifier hs-type">InstEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-419"></a><span>          </span><span class="hs-comment">-- ^ Instance envt for all /home-package/ modules;</span><span>
</span><a name="line-420"></a><span>          </span><span class="hs-comment">-- Includes the dfuns in tcg_insts</span><span>
</span><a name="line-421"></a><span>        </span><a href="TcRnTypes.html#tcg_fam_inst_env"><span class="hs-identifier">tcg_fam_inst_env</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnv"><span class="hs-identifier hs-type">FamInstEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Ditto for family instances</span><span>
</span><a name="line-422"></a><span>        </span><a href="TcRnTypes.html#tcg_ann_env"><span class="hs-identifier">tcg_ann_env</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Annotations.html#AnnEnv"><span class="hs-identifier hs-type">AnnEnv</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ^ And for annotations</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span>                </span><span class="hs-comment">-- Now a bunch of things about this module that are simply</span><span>
</span><a name="line-425"></a><span>                </span><span class="hs-comment">-- accumulated, but never consulted until the end.</span><span>
</span><a name="line-426"></a><span>                </span><span class="hs-comment">-- Nevertheless, it's convenient to accumulate them along</span><span>
</span><a name="line-427"></a><span>                </span><span class="hs-comment">-- with the rest of the info from this module.</span><span>
</span><a name="line-428"></a><span>        </span><a href="TcRnTypes.html#tcg_exports"><span class="hs-identifier">tcg_exports</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ^ What is exported</span><span>
</span><a name="line-429"></a><span>        </span><a href="TcRnTypes.html#tcg_imports"><span class="hs-identifier">tcg_imports</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span class="hs-special">,</span><span>
</span><a name="line-430"></a><span>          </span><span class="hs-comment">-- ^ Information about what was imported from where, including</span><span>
</span><a name="line-431"></a><span>          </span><span class="hs-comment">-- things bound in this module. Also store Safe Haskell info</span><span>
</span><a name="line-432"></a><span>          </span><span class="hs-comment">-- here about transative trusted packaage requirements.</span><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span>        </span><a href="TcRnTypes.html#tcg_dus"><span class="hs-identifier">tcg_dus</span></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="NameSet.html#DefUses"><span class="hs-identifier hs-type">DefUses</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ What is defined in this module and what is used.</span><span>
</span><a name="line-435"></a><span>        </span><a href="TcRnTypes.html#tcg_used_gres"><span class="hs-identifier">tcg_used_gres</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ^ Records occurrences of imported entities</span><span>
</span><a name="line-436"></a><span>          </span><span class="hs-comment">-- See Note [Tracking unused binding and imports]</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span>        </span><a href="TcRnTypes.html#tcg_keep"><span class="hs-identifier">tcg_keep</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-439"></a><span>          </span><span class="hs-comment">-- ^ Locally-defined top-level names to keep alive.</span><span>
</span><a name="line-440"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-441"></a><span>          </span><span class="hs-comment">-- &quot;Keep alive&quot; means give them an Exported flag, so that the</span><span>
</span><a name="line-442"></a><span>          </span><span class="hs-comment">-- simplifier does not discard them as dead code, and so that they</span><span>
</span><a name="line-443"></a><span>          </span><span class="hs-comment">-- are exposed in the interface file (but not to export to the</span><span>
</span><a name="line-444"></a><span>          </span><span class="hs-comment">-- user).</span><span>
</span><a name="line-445"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-446"></a><span>          </span><span class="hs-comment">-- Some things, like dict-fun Ids and default-method Ids are &quot;born&quot;</span><span>
</span><a name="line-447"></a><span>          </span><span class="hs-comment">-- with the Exported flag on, for exactly the above reason, but some</span><span>
</span><a name="line-448"></a><span>          </span><span class="hs-comment">-- we only discover as we go.  Specifically:</span><span>
</span><a name="line-449"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-450"></a><span>          </span><span class="hs-comment">--   * The to/from functions for generic data types</span><span>
</span><a name="line-451"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-452"></a><span>          </span><span class="hs-comment">--   * Top-level variables appearing free in the RHS of an orphan</span><span>
</span><a name="line-453"></a><span>          </span><span class="hs-comment">--     rule</span><span>
</span><a name="line-454"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-455"></a><span>          </span><span class="hs-comment">--   * Top-level variables appearing free in a TH bracket</span><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span>        </span><a href="TcRnTypes.html#tcg_th_used"><span class="hs-identifier">tcg_th_used</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>
</span><a name="line-458"></a><span>          </span><span class="hs-comment">-- ^ @True@ &lt;=&gt; Template Haskell syntax used.</span><span>
</span><a name="line-459"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-460"></a><span>          </span><span class="hs-comment">-- We need this so that we can generate a dependency on the</span><span>
</span><a name="line-461"></a><span>          </span><span class="hs-comment">-- Template Haskell package, because the desugarer is going</span><span>
</span><a name="line-462"></a><span>          </span><span class="hs-comment">-- to emit loads of references to TH symbols.  The reference</span><span>
</span><a name="line-463"></a><span>          </span><span class="hs-comment">-- is implicit rather than explicit, so we have to zap a</span><span>
</span><a name="line-464"></a><span>          </span><span class="hs-comment">-- mutable variable.</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span>        </span><a href="TcRnTypes.html#tcg_th_splice_used"><span class="hs-identifier">tcg_th_splice_used</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>
</span><a name="line-467"></a><span>          </span><span class="hs-comment">-- ^ @True@ &lt;=&gt; A Template Haskell splice was used.</span><span>
</span><a name="line-468"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-469"></a><span>          </span><span class="hs-comment">-- Splices disable recompilation avoidance (see #481)</span><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span>        </span><a href="TcRnTypes.html#tcg_dfun_n"><span class="hs-identifier">tcg_dfun_n</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-472"></a><span>          </span><span class="hs-comment">-- ^ Allows us to choose unique DFun names.</span><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span>        </span><span class="hs-comment">-- The next fields accumulate the payload of the module</span><span>
</span><a name="line-475"></a><span>        </span><span class="hs-comment">-- The binds, rules and foreign-decl fields are collected</span><span>
</span><a name="line-476"></a><span>        </span><span class="hs-comment">-- initially in un-zonked form and are finally zonked in tcRnSrcDecls</span><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span>        </span><a href="TcRnTypes.html#tcg_rn_exports"><span class="hs-identifier">tcg_rn_exports</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-479"></a><span>                </span><span class="hs-comment">-- Nothing &lt;=&gt; no explicit export list</span><span>
</span><a name="line-480"></a><span>                </span><span class="hs-comment">-- Is always Nothing if we don't want to retain renamed</span><span>
</span><a name="line-481"></a><span>                </span><span class="hs-comment">-- exports</span><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span>        </span><a href="TcRnTypes.html#tcg_rn_imports"><span class="hs-identifier">tcg_rn_imports</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-484"></a><span>                </span><span class="hs-comment">-- Keep the renamed imports regardless.  They are not</span><span>
</span><a name="line-485"></a><span>                </span><span class="hs-comment">-- voluminous and are needed if you want to report unused imports</span><span>
</span><a name="line-486"></a><span>
</span><a name="line-487"></a><span>        </span><a href="TcRnTypes.html#tcg_rn_decls"><span class="hs-identifier">tcg_rn_decls</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-488"></a><span>          </span><span class="hs-comment">-- ^ Renamed decls, maybe.  @Nothing@ &lt;=&gt; Don't retain renamed</span><span>
</span><a name="line-489"></a><span>          </span><span class="hs-comment">-- decls.</span><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span>        </span><a href="TcRnTypes.html#tcg_dependent_files"><span class="hs-identifier">tcg_dependent_files</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">[</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ dependencies from addDependentFile</span><span>
</span><a name="line-492"></a><span>
</span><a name="line-493"></a><span class="hs-cpp">#ifdef GHCI</span><span>
</span><a name="line-494"></a><span>        </span><a href="TcRnTypes.html#tcg_th_topdecls"><span class="hs-identifier">tcg_th_topdecls</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-495"></a><span>        </span><span class="hs-comment">-- ^ Top-level declarations from addTopDecls</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span>        </span><a href="TcRnTypes.html#tcg_th_topnames"><span class="hs-identifier">tcg_th_topnames</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-498"></a><span>        </span><span class="hs-comment">-- ^ Exact names bound in top-level declarations in tcg_th_topdecls</span><span>
</span><a name="line-499"></a><span>
</span><a name="line-500"></a><span>        </span><a href="TcRnTypes.html#tcg_th_modfinalizers"><span class="hs-identifier">tcg_th_modfinalizers</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">[</span><a href="../template-haskell-2.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Language.Haskell.TH.Syntax.html#Q"><span class="hs-identifier hs-type">TH</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-501"></a><span>        </span><span class="hs-comment">-- ^ Template Haskell module finalizers</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span>        </span><a href="TcRnTypes.html#tcg_th_state"><span class="hs-identifier">tcg_th_state</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">(</span><a href="../containers-0.5.7.1/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Base.html#Map"><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#TypeRep"><span class="hs-identifier hs-type">TypeRep</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Dynamic.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-504"></a><span>        </span><a href="TcRnTypes.html#tcg_th_remote_state"><span class="hs-identifier">tcg_th_remote_state</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../ghci-8.1/src/%{MODULE/./-}.html#%{NAME}/GHCi.RemoteTypes.html#ForeignRef"><span class="hs-identifier hs-type">ForeignRef</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a><span> </span><a href="../ghci-8.1/src/%{MODULE/./-}.html#%{NAME}/GHCi.Message.html#QState"><span class="hs-identifier hs-type">QState</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-505"></a><span>        </span><span class="hs-comment">-- ^ Template Haskell state</span><span>
</span><a name="line-506"></a><span class="hs-cpp">#endif /* GHCI */</span><span>
</span><a name="line-507"></a><span>
</span><a name="line-508"></a><span>        </span><a href="TcRnTypes.html#tcg_ev_binds"><span class="hs-identifier">tcg_ev_binds</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- Top-level evidence bindings</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span>        </span><span class="hs-comment">-- Things defined in this module, or (in GHCi)</span><span>
</span><a name="line-511"></a><span>        </span><span class="hs-comment">-- in the declarations for a single GHCi command.</span><span>
</span><a name="line-512"></a><span>        </span><span class="hs-comment">-- For the latter, see Note [The interactive package] in HscTypes</span><span>
</span><a name="line-513"></a><span>        </span><a href="TcRnTypes.html#tcg_tr_module"><span class="hs-identifier">tcg_tr_module</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- Id for $trModule :: GHC.Types.Module</span><span>
</span><a name="line-514"></a><span>                                             </span><span class="hs-comment">-- for which every module has a top-level defn</span><span>
</span><a name="line-515"></a><span>                                             </span><span class="hs-comment">-- except in GHCi in which case we have Nothing</span><span>
</span><a name="line-516"></a><span>        </span><a href="TcRnTypes.html#tcg_binds"><span class="hs-identifier">tcg_binds</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- Value bindings in this module</span><span>
</span><a name="line-517"></a><span>        </span><a href="TcRnTypes.html#tcg_sigs"><span class="hs-identifier">tcg_sigs</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ...Top-level names that *lack* a signature</span><span>
</span><a name="line-518"></a><span>        </span><a href="TcRnTypes.html#tcg_imp_specs"><span class="hs-identifier">tcg_imp_specs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- ...SPECIALISE prags for imported Ids</span><span>
</span><a name="line-519"></a><span>        </span><a href="TcRnTypes.html#tcg_warns"><span class="hs-identifier">tcg_warns</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#Warnings"><span class="hs-identifier hs-type">Warnings</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- ...Warnings and deprecations</span><span>
</span><a name="line-520"></a><span>        </span><a href="TcRnTypes.html#tcg_anns"><span class="hs-identifier">tcg_anns</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Annotations.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- ...Annotations</span><span>
</span><a name="line-521"></a><span>        </span><a href="TcRnTypes.html#tcg_tcs"><span class="hs-identifier">tcg_tcs</span></a><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ...TyCons and Classes</span><span>
</span><a name="line-522"></a><span>        </span><a href="TcRnTypes.html#tcg_insts"><span class="hs-identifier">tcg_insts</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="InstEnv.html#ClsInst"><span class="hs-identifier hs-type">ClsInst</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- ...Instances</span><span>
</span><a name="line-523"></a><span>        </span><a href="TcRnTypes.html#tcg_fam_insts"><span class="hs-identifier">tcg_fam_insts</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="FamInstEnv.html#FamInst"><span class="hs-identifier hs-type">FamInst</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- ...Family instances</span><span>
</span><a name="line-524"></a><span>        </span><a href="TcRnTypes.html#tcg_rules"><span class="hs-identifier">tcg_rules</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ...Rules</span><span>
</span><a name="line-525"></a><span>        </span><a href="TcRnTypes.html#tcg_fords"><span class="hs-identifier">tcg_fords</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ...Foreign import &amp; exports</span><span>
</span><a name="line-526"></a><span>        </span><a href="TcRnTypes.html#tcg_vects"><span class="hs-identifier">tcg_vects</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ...Vectorisation declarations</span><span>
</span><a name="line-527"></a><span>        </span><a href="TcRnTypes.html#tcg_patsyns"><span class="hs-identifier">tcg_patsyns</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- ...Pattern synonyms</span><span>
</span><a name="line-528"></a><span>
</span><a name="line-529"></a><span>        </span><a href="TcRnTypes.html#tcg_doc_hdr"><span class="hs-identifier">tcg_doc_hdr</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="HsDoc.html#LHsDocString"><span class="hs-identifier hs-type">LHsDocString</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Maybe Haddock header docs</span><span>
</span><a name="line-530"></a><span>        </span><a href="TcRnTypes.html#tcg_hpc"><span class="hs-identifier">tcg_hpc</span></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#AnyHpcUsage"><span class="hs-identifier hs-type">AnyHpcUsage</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- ^ @True@ if any part of the</span><span>
</span><a name="line-531"></a><span>                                             </span><span class="hs-comment">--  prog uses hpc instrumentation.</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span>        </span><a href="TcRnTypes.html#tcg_self_boot"><span class="hs-identifier">tcg_self_boot</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#SelfBootInfo"><span class="hs-identifier hs-type">SelfBootInfo</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- ^ Whether this module has a</span><span>
</span><a name="line-534"></a><span>                                             </span><span class="hs-comment">-- corresponding hi-boot file</span><span>
</span><a name="line-535"></a><span>
</span><a name="line-536"></a><span>        </span><a href="TcRnTypes.html#tcg_main"><span class="hs-identifier">tcg_main</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- ^ The Name of the main</span><span>
</span><a name="line-537"></a><span>                                             </span><span class="hs-comment">-- function, if this module is</span><span>
</span><a name="line-538"></a><span>                                             </span><span class="hs-comment">-- the main module.</span><span>
</span><a name="line-539"></a><span>
</span><a name="line-540"></a><span>        </span><a href="TcRnTypes.html#tcg_safeInfer"><span class="hs-identifier">tcg_safeInfer</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a href="ErrUtils.html#WarningMessages"><span class="hs-identifier hs-type">WarningMessages</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-541"></a><span>        </span><span class="hs-comment">-- ^ Has the typechecker inferred this module as -XSafe (Safe Haskell)</span><span>
</span><a name="line-542"></a><span>        </span><span class="hs-comment">-- See Note [Safe Haskell Overlapping Instances Implementation],</span><span>
</span><a name="line-543"></a><span>        </span><span class="hs-comment">-- although this is used for more than just that failure case.</span><span>
</span><a name="line-544"></a><span>
</span><a name="line-545"></a><span>        </span><a href="TcRnTypes.html#tcg_tc_plugins"><span class="hs-identifier">tcg_tc_plugins</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcPluginSolver"><span class="hs-identifier hs-type">TcPluginSolver</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-546"></a><span>        </span><span class="hs-comment">-- ^ A list of user-defined plugins for the constraint solver.</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span>        </span><a href="TcRnTypes.html#tcg_static_wc"><span class="hs-identifier">tcg_static_wc</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-549"></a><span>          </span><span class="hs-comment">-- ^ Wanted constraints of static forms.</span><span>
</span><a name="line-550"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-identifier">tcVisibleOrphanMods</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#ModuleSet"><span class="hs-identifier hs-type">ModuleSet</span></a><span>
</span><a name="line-553"></a><a name="tcVisibleOrphanMods"><a href="TcRnTypes.html#tcVisibleOrphanMods"><span class="hs-identifier">tcVisibleOrphanMods</span></a></a><span> </span><a name="local-1627933669"><a href="#local-1627933669"><span class="hs-identifier">tcg_env</span></a></a><span>
</span><a name="line-554"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#mkModuleSet"><span class="hs-identifier hs-var">mkModuleSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcg_mod</span><span> </span><a href="#local-1627933669"><span class="hs-identifier hs-var">tcg_env</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">imp_orphs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcg_imports</span><span> </span><a href="#local-1627933669"><span class="hs-identifier hs-var">tcg_env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-555"></a><span>
</span><a name="line-556"></a><span class="hs-comment">-- Note [Signature parameters in TcGblEnv and DynFlags]</span><span>
</span><a name="line-557"></a><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><a name="line-558"></a><span class="hs-comment">-- When compiling signature files, we need to know which implementation</span><span>
</span><a name="line-559"></a><span class="hs-comment">-- we've actually linked against the signature.  There are three seemingly</span><span>
</span><a name="line-560"></a><span class="hs-comment">-- redundant places where this information is stored: in DynFlags, there</span><span>
</span><a name="line-561"></a><span class="hs-comment">-- is sigOf, and in TcGblEnv, there is tcg_sig_of and tcg_impl_rdr_env.</span><span>
</span><a name="line-562"></a><span class="hs-comment">-- Here's the difference between each of them:</span><span>
</span><a name="line-563"></a><span class="hs-comment">--</span><span>
</span><a name="line-564"></a><span class="hs-comment">-- * DynFlags.sigOf is global per invocation of GHC.  If we are compiling</span><span>
</span><a name="line-565"></a><span class="hs-comment">--   with --make, there may be multiple signature files being compiled; in</span><span>
</span><a name="line-566"></a><span class="hs-comment">--   which case this parameter is a map from local module name to implementing</span><span>
</span><a name="line-567"></a><span class="hs-comment">--   Module.</span><span>
</span><a name="line-568"></a><span class="hs-comment">--</span><span>
</span><a name="line-569"></a><span class="hs-comment">-- * HscEnv.tcg_sig_of is global per the compilation of a single file, so</span><span>
</span><a name="line-570"></a><span class="hs-comment">--   it is simply the result of looking up tcg_mod in the DynFlags.sigOf</span><span>
</span><a name="line-571"></a><span class="hs-comment">--   parameter.  It's setup in TcRnMonad.initTc.  This prevents us</span><span>
</span><a name="line-572"></a><span class="hs-comment">--   from having to repeatedly do a lookup in DynFlags.sigOf.</span><span>
</span><a name="line-573"></a><span class="hs-comment">--</span><span>
</span><a name="line-574"></a><span class="hs-comment">-- * HscEnv.tcg_impl_rdr_env is a RdrEnv that lets us look up names</span><span>
</span><a name="line-575"></a><span class="hs-comment">--   according to the sig-of module.  It's setup in TcRnDriver.tcRnSignature.</span><span>
</span><a name="line-576"></a><span class="hs-comment">--   Here is an example showing why we need this map:</span><span>
</span><a name="line-577"></a><span class="hs-comment">--</span><span>
</span><a name="line-578"></a><span class="hs-comment">--  module A where</span><span>
</span><a name="line-579"></a><span class="hs-comment">--      a = True</span><span>
</span><a name="line-580"></a><span class="hs-comment">--</span><span>
</span><a name="line-581"></a><span class="hs-comment">--  module ASig where</span><span>
</span><a name="line-582"></a><span class="hs-comment">--      import B</span><span>
</span><a name="line-583"></a><span class="hs-comment">--      a :: Bool</span><span>
</span><a name="line-584"></a><span class="hs-comment">--</span><span>
</span><a name="line-585"></a><span class="hs-comment">--  module B where</span><span>
</span><a name="line-586"></a><span class="hs-comment">--      b = False</span><span>
</span><a name="line-587"></a><span class="hs-comment">--</span><span>
</span><a name="line-588"></a><span class="hs-comment">-- When we compile ASig --sig-of main:A, the default</span><span>
</span><a name="line-589"></a><span class="hs-comment">-- global RdrEnv (tcg_rdr_env) has an entry for b, but not for a</span><span>
</span><a name="line-590"></a><span class="hs-comment">-- (we never imported A).  So we have to look in a different environment</span><span>
</span><a name="line-591"></a><span class="hs-comment">-- to actually get the original name.</span><span>
</span><a name="line-592"></a><span class="hs-comment">--</span><span>
</span><a name="line-593"></a><span class="hs-comment">-- By the way, why do we need to do the lookup; can't we just use A:a</span><span>
</span><a name="line-594"></a><span class="hs-comment">-- as the name directly?  Well, if A is reexporting the entity from another</span><span>
</span><a name="line-595"></a><span class="hs-comment">-- module, then the original name needs to be the real original name:</span><span>
</span><a name="line-596"></a><span class="hs-comment">--</span><span>
</span><a name="line-597"></a><span class="hs-comment">--  module C where</span><span>
</span><a name="line-598"></a><span class="hs-comment">--      a = True</span><span>
</span><a name="line-599"></a><span class="hs-comment">--</span><span>
</span><a name="line-600"></a><span class="hs-comment">--  module A(a) where</span><span>
</span><a name="line-601"></a><span class="hs-comment">--      import C</span><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><span class="hs-keyword">instance</span><span> </span><a href="Module.html#ContainsModule"><span class="hs-identifier hs-type">ContainsModule</span></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-604"></a><span>    </span><a name="local-1912733518"><a href="Module.html#extractModule"><span class="hs-identifier">extractModule</span></a></a><span> </span><a name="local-1627933999"><a href="#local-1627933999"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tcg_mod</span><span> </span><a href="#local-1627933999"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span class="hs-keyword">type</span><span> </span><a name="RecFieldEnv"><a href="TcRnTypes.html#RecFieldEnv"><span class="hs-identifier">RecFieldEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span>
</span><a name="line-607"></a><span>        </span><span class="hs-comment">-- Maps a constructor name *in this module*</span><span>
</span><a name="line-608"></a><span>        </span><span class="hs-comment">-- to the fields for that constructor.</span><span>
</span><a name="line-609"></a><span>        </span><span class="hs-comment">-- This is used when dealing with &quot;..&quot; notation in record</span><span>
</span><a name="line-610"></a><span>        </span><span class="hs-comment">-- construction and pattern matching.</span><span>
</span><a name="line-611"></a><span>        </span><span class="hs-comment">-- The FieldEnv deals *only* with constructors defined in *this*</span><span>
</span><a name="line-612"></a><span>        </span><span class="hs-comment">-- module.  For imported modules, we get the same info from the</span><span>
</span><a name="line-613"></a><span>        </span><span class="hs-comment">-- TypeEnv</span><span>
</span><a name="line-614"></a><span>
</span><a name="line-615"></a><span class="hs-keyword">data</span><span> </span><a name="SelfBootInfo"><a href="TcRnTypes.html#SelfBootInfo"><span class="hs-identifier">SelfBootInfo</span></a></a><span>
</span><a name="line-616"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="NoSelfBoot"><a href="TcRnTypes.html#NoSelfBoot"><span class="hs-identifier">NoSelfBoot</span></a></a><span>    </span><span class="hs-comment">-- No corresponding hi-boot file</span><span>
</span><a name="line-617"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SelfBoot"><a href="TcRnTypes.html#SelfBoot"><span class="hs-identifier">SelfBoot</span></a></a><span>
</span><a name="line-618"></a><span>       </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#sb_mds"><span class="hs-identifier">sb_mds</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#ModDetails"><span class="hs-identifier hs-type">ModDetails</span></a><span>   </span><span class="hs-comment">-- There was a hi-boot file,</span><span>
</span><a name="line-619"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sb_tcs"><span class="hs-identifier">sb_tcs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>      </span><span class="hs-comment">-- defining these TyCons,</span><span>
</span><a name="line-620"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sb_ids"><span class="hs-identifier">sb_ids</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span> </span><span class="hs-special">}</span><span>    </span><span class="hs-comment">-- and these Ids</span><span>
</span><a name="line-621"></a><span>  </span><span class="hs-comment">-- We need this info to compute a safe approximation to</span><span>
</span><a name="line-622"></a><span>  </span><span class="hs-comment">-- recursive loops, to avoid infinite inlinings</span><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span class="hs-comment">{- Note [Tracking unused binding and imports]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We gather two sorts of usage information

 * tcg_dus (defs/uses)
      Records *defined* Names (local, top-level)
          and *used*    Names (local or imported)

      Used (a) to report &quot;defined but not used&quot;
               (see RnNames.reportUnusedNames)
           (b) to generate version-tracking usage info in interface
               files (see MkIface.mkUsedNames)
   This usage info is mainly gathered by the renamer's
   gathering of free-variables

 * tcg_used_gres
      Used only to report unused import declarations

      Records each *occurrence* an *imported* (not locally-defined) entity.
      The occurrence is recorded by keeping a GlobalRdrElt for it.
      These is not the GRE that is in the GlobalRdrEnv; rather it
      is recorded *after* the filtering done by pickGREs.  So it reflect
      /how that occurrence is in scope/.   See Note [GRE filtering] in
      RdrName.


************************************************************************
*                                                                      *
                The local typechecker environment
*                                                                      *
************************************************************************

Note [The Global-Env/Local-Env story]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
During type checking, we keep in the tcg_type_env
        * All types and classes
        * All Ids derived from types and classes (constructors, selectors)

At the end of type checking, we zonk the local bindings,
and as we do so we add to the tcg_type_env
        * Locally defined top-level Ids

Why?  Because they are now Ids not TcIds.  This final GlobalEnv is
        a) fed back (via the knot) to typechecking the
           unfoldings of interface signatures
        b) used in the ModDetails of this module
-}</span><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span class="hs-keyword">data</span><span> </span><a name="TcLclEnv"><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier">TcLclEnv</span></a></a><span>           </span><span class="hs-comment">-- Changes as we move inside an expression</span><span>
</span><a name="line-673"></a><span>                        </span><span class="hs-comment">-- Discarded after typecheck/rename; not passed on to desugarer</span><span>
</span><a name="line-674"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TcLclEnv"><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier">TcLclEnv</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-675"></a><span>        </span><a href="TcRnTypes.html#tcl_loc"><span class="hs-identifier">tcl_loc</span></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Source span</span><span>
</span><a name="line-676"></a><span>        </span><a href="TcRnTypes.html#tcl_ctxt"><span class="hs-identifier">tcl_ctxt</span></a><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Error context, innermost on top</span><span>
</span><a name="line-677"></a><span>        </span><a href="TcRnTypes.html#tcl_tclvl"><span class="hs-identifier">tcl_tclvl</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- Birthplace for new unification variables</span><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span>        </span><a href="TcRnTypes.html#tcl_th_ctxt"><span class="hs-identifier">tcl_th_ctxt</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- Template Haskell context</span><span>
</span><a name="line-680"></a><span>        </span><a href="TcRnTypes.html#tcl_th_bndrs"><span class="hs-identifier">tcl_th_bndrs</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ThBindEnv"><span class="hs-identifier hs-type">ThBindEnv</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Binding level of in-scope Names</span><span>
</span><a name="line-681"></a><span>                                           </span><span class="hs-comment">-- defined in this module (not imported)</span><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span>        </span><a href="TcRnTypes.html#tcl_arrow_ctxt"><span class="hs-identifier">tcl_arrow_ctxt</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ArrowCtxt"><span class="hs-identifier hs-type">ArrowCtxt</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Arrow-notation context</span><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span>        </span><a href="TcRnTypes.html#tcl_rdr"><span class="hs-identifier">tcl_rdr</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- Local name envt</span><span>
</span><a name="line-686"></a><span>                </span><span class="hs-comment">-- Maintained during renaming, of course, but also during</span><span>
</span><a name="line-687"></a><span>                </span><span class="hs-comment">-- type checking, solely so that when renaming a Template-Haskell</span><span>
</span><a name="line-688"></a><span>                </span><span class="hs-comment">-- splice we have the right environment for the renamer.</span><span>
</span><a name="line-689"></a><span>                </span><span class="hs-comment">--</span><span>
</span><a name="line-690"></a><span>                </span><span class="hs-comment">--   Does *not* include global name envt; may shadow it</span><span>
</span><a name="line-691"></a><span>                </span><span class="hs-comment">--   Includes both ordinary variables and type variables;</span><span>
</span><a name="line-692"></a><span>                </span><span class="hs-comment">--   they are kept distinct because tyvar have a different</span><span>
</span><a name="line-693"></a><span>                </span><span class="hs-comment">--   occurrence contructor (Name.TvOcc)</span><span>
</span><a name="line-694"></a><span>                </span><span class="hs-comment">-- We still need the unsullied global name env so that</span><span>
</span><a name="line-695"></a><span>                </span><span class="hs-comment">--   we can look up record field names</span><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span>        </span><a href="TcRnTypes.html#tcl_env"><span class="hs-identifier">tcl_env</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcTypeEnv"><span class="hs-identifier hs-type">TcTypeEnv</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- The local type environment:</span><span>
</span><a name="line-698"></a><span>                                  </span><span class="hs-comment">-- Ids and TyVars defined in this module</span><span>
</span><a name="line-699"></a><span>
</span><a name="line-700"></a><span>        </span><a href="TcRnTypes.html#tcl_bndrs"><span class="hs-identifier">tcl_bndrs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcIdBinderStack"><span class="hs-identifier hs-type">TcIdBinderStack</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- Used for reporting relevant bindings</span><span>
</span><a name="line-701"></a><span>
</span><a name="line-702"></a><span>        </span><a href="TcRnTypes.html#tcl_tidy"><span class="hs-identifier">tcl_tidy</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- Used for tidying types; contains all</span><span>
</span><a name="line-703"></a><span>                                  </span><span class="hs-comment">-- in-scope type variables (but not term variables)</span><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span>        </span><a href="TcRnTypes.html#tcl_tyvars"><span class="hs-identifier">tcl_tyvars</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="TcType.html#TcTyVarSet"><span class="hs-identifier hs-type">TcTyVarSet</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- The &quot;global tyvars&quot;</span><span>
</span><a name="line-706"></a><span>                        </span><span class="hs-comment">-- Namely, the in-scope TyVars bound in tcl_env,</span><span>
</span><a name="line-707"></a><span>                        </span><span class="hs-comment">-- plus the tyvars mentioned in the types of Ids bound</span><span>
</span><a name="line-708"></a><span>                        </span><span class="hs-comment">-- in tcl_lenv.</span><span>
</span><a name="line-709"></a><span>                        </span><span class="hs-comment">-- Why mutable? see notes with tcGetGlobalTyCoVars</span><span>
</span><a name="line-710"></a><span>
</span><a name="line-711"></a><span>        </span><a href="TcRnTypes.html#tcl_lie"><span class="hs-identifier">tcl_lie</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Place to accumulate type constraints</span><span>
</span><a name="line-712"></a><span>        </span><a href="TcRnTypes.html#tcl_errs"><span class="hs-identifier">tcl_errs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="ErrUtils.html#Messages"><span class="hs-identifier hs-type">Messages</span></a><span>              </span><span class="hs-comment">-- Place to accumulate errors</span><span>
</span><a name="line-713"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-714"></a><span>
</span><a name="line-715"></a><span class="hs-keyword">type</span><span> </span><a name="TcTypeEnv"><a href="TcRnTypes.html#TcTypeEnv"><span class="hs-identifier">TcTypeEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><a href="TcRnTypes.html#TcTyThing"><span class="hs-identifier hs-type">TcTyThing</span></a><span>
</span><a name="line-716"></a><span>
</span><a name="line-717"></a><span class="hs-keyword">type</span><span> </span><a name="ThBindEnv"><a href="TcRnTypes.html#ThBindEnv"><span class="hs-identifier">ThBindEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ThLevel"><span class="hs-identifier hs-type">ThLevel</span></a><span class="hs-special">)</span><span>
</span><a name="line-718"></a><span>   </span><span class="hs-comment">-- Domain = all Ids bound in this module (ie not imported)</span><span>
</span><a name="line-719"></a><span>   </span><span class="hs-comment">-- The TopLevelFlag tells if the binding is syntactically top level.</span><span>
</span><a name="line-720"></a><span>   </span><span class="hs-comment">-- We need to know this, because the cross-stage persistence story allows</span><span>
</span><a name="line-721"></a><span>   </span><span class="hs-comment">-- cross-stage at arbitrary types if the Id is bound at top level.</span><span>
</span><a name="line-722"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-723"></a><span>   </span><span class="hs-comment">-- Nota bene: a ThLevel of 'outerLevel' is *not* the same as being</span><span>
</span><a name="line-724"></a><span>   </span><span class="hs-comment">-- bound at top level!  See Note [Template Haskell levels] in TcSplice</span><span>
</span><a name="line-725"></a><span>
</span><a name="line-726"></a><span class="hs-comment">{- Note [Given Insts]
   ~~~~~~~~~~~~~~~~~~
Because of GADTs, we have to pass inwards the Insts provided by type signatures
and existential contexts. Consider
        data T a where { T1 :: b -&gt; b -&gt; T [b] }
        f :: Eq a =&gt; T a -&gt; Bool
        f (T1 x y) = [x]==[y]

The constructor T1 binds an existential variable 'b', and we need Eq [b].
Well, we have it, because Eq a refines to Eq [b], but we can only spot that if we
pass it inwards.

-}</span><span>
</span><a name="line-739"></a><span>
</span><a name="line-740"></a><span class="hs-comment">-- | Type alias for 'IORef'; the convention is we'll use this for mutable</span><span>
</span><a name="line-741"></a><span class="hs-comment">-- bits of data in 'TcGblEnv' which are updated during typechecking and</span><span>
</span><a name="line-742"></a><span class="hs-comment">-- returned at the end.</span><span>
</span><a name="line-743"></a><span class="hs-keyword">type</span><span> </span><a name="TcRef"><a href="TcRnTypes.html#TcRef"><span class="hs-identifier">TcRef</span></a></a><span> </span><a name="local-1627933658"><a href="#local-1627933658"><span class="hs-identifier">a</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a><span> </span><a href="#local-1627933658"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-744"></a><span class="hs-comment">-- ToDo: when should I refer to it as a 'TcId' instead of an 'Id'?</span><span>
</span><a name="line-745"></a><span class="hs-keyword">type</span><span> </span><a name="TcId"><a href="TcRnTypes.html#TcId"><span class="hs-identifier">TcId</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-746"></a><span class="hs-keyword">type</span><span> </span><a name="TcIdSet"><a href="TcRnTypes.html#TcIdSet"><span class="hs-identifier">TcIdSet</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#IdSet"><span class="hs-identifier hs-type">IdSet</span></a><span>
</span><a name="line-747"></a><span>
</span><a name="line-748"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-749"></a><span class="hs-comment">-- The TcIdBinderStack</span><span>
</span><a name="line-750"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-751"></a><span>
</span><a name="line-752"></a><span class="hs-keyword">type</span><span> </span><a name="TcIdBinderStack"><a href="TcRnTypes.html#TcIdBinderStack"><span class="hs-identifier">TcIdBinderStack</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcIdBinder"><span class="hs-identifier hs-type">TcIdBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-753"></a><span>   </span><span class="hs-comment">-- This is a stack of locally-bound ids, innermost on top</span><span>
</span><a name="line-754"></a><span>   </span><span class="hs-comment">-- Used ony in error reporting (relevantBindings in TcError)</span><span>
</span><a name="line-755"></a><span>
</span><a name="line-756"></a><span class="hs-keyword">data</span><span> </span><a name="TcIdBinder"><a href="TcRnTypes.html#TcIdBinder"><span class="hs-identifier">TcIdBinder</span></a></a><span>
</span><a name="line-757"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TcIdBndr"><a href="TcRnTypes.html#TcIdBndr"><span class="hs-identifier">TcIdBndr</span></a></a><span>
</span><a name="line-758"></a><span>       </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-759"></a><span>       </span><a href="BasicTypes.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a><span>    </span><span class="hs-comment">-- Tells whether the bindind is syntactically top-level</span><span>
</span><a name="line-760"></a><span>                       </span><span class="hs-comment">-- (The monomorphic Ids for a recursive group count</span><span>
</span><a name="line-761"></a><span>                       </span><span class="hs-comment">--  as not-top-level for this purpose.)</span><span>
</span><a name="line-762"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TcIdBndr_ExpType"><a href="TcRnTypes.html#TcIdBndr_ExpType"><span class="hs-identifier">TcIdBndr_ExpType</span></a></a><span>  </span><span class="hs-comment">-- Variant that allows the type to be specified as</span><span>
</span><a name="line-763"></a><span>                      </span><span class="hs-comment">-- an ExpType</span><span>
</span><a name="line-764"></a><span>       </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-765"></a><span>       </span><a href="TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a><span>
</span><a name="line-766"></a><span>       </span><a href="BasicTypes.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a><span>
</span><a name="line-767"></a><span>
</span><a name="line-768"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#TcIdBinder"><span class="hs-identifier hs-type">TcIdBinder</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-769"></a><span>   </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcIdBndr"><span class="hs-identifier hs-var">TcIdBndr</span></a><span> </span><a name="local-1627933995"><a href="#local-1627933995"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-1627933996"><a href="#local-1627933996"><span class="hs-identifier">top_lvl</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933995"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933996"><span class="hs-identifier hs-var">top_lvl</span></a><span class="hs-special">)</span><span>
</span><a name="line-770"></a><span>   </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcIdBndr_ExpType"><span class="hs-identifier hs-var">TcIdBndr_ExpType</span></a><span> </span><a name="local-1627933997"><a href="#local-1627933997"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933998"><a href="#local-1627933998"><span class="hs-identifier">top_lvl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933997"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933998"><span class="hs-identifier hs-var">top_lvl</span></a><span class="hs-special">)</span><span>
</span><a name="line-771"></a><span>
</span><a name="line-772"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-773"></a><span class="hs-comment">-- Template Haskell stages and levels</span><span>
</span><a name="line-774"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-775"></a><span>
</span><a name="line-776"></a><span class="hs-keyword">data</span><span> </span><a name="SpliceType"><a href="TcRnTypes.html#SpliceType"><span class="hs-identifier">SpliceType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Typed"><a href="TcRnTypes.html#Typed"><span class="hs-identifier">Typed</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Untyped"><a href="TcRnTypes.html#Untyped"><span class="hs-identifier">Untyped</span></a></a><span>
</span><a name="line-777"></a><span>
</span><a name="line-778"></a><span class="hs-keyword">data</span><span> </span><a name="ThStage"><a href="TcRnTypes.html#ThStage"><span class="hs-identifier">ThStage</span></a></a><span>    </span><span class="hs-comment">-- See Note [Template Haskell state diagram] in TcSplice</span><span>
</span><a name="line-779"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Splice"><a href="TcRnTypes.html#Splice"><span class="hs-identifier">Splice</span></a></a><span> </span><a href="TcRnTypes.html#SpliceType"><span class="hs-identifier hs-type">SpliceType</span></a><span> </span><span class="hs-comment">-- Inside a top-level splice</span><span>
</span><a name="line-780"></a><span>                      </span><span class="hs-comment">-- This code will be run *at compile time*;</span><span>
</span><a name="line-781"></a><span>                      </span><span class="hs-comment">--   the result replaces the splice</span><span>
</span><a name="line-782"></a><span>                      </span><span class="hs-comment">-- Binding level = 0</span><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Comp"><a href="TcRnTypes.html#Comp"><span class="hs-identifier">Comp</span></a></a><span>        </span><span class="hs-comment">-- Ordinary Haskell code</span><span>
</span><a name="line-785"></a><span>                </span><span class="hs-comment">-- Binding level = 1</span><span>
</span><a name="line-786"></a><span>
</span><a name="line-787"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Brack"><a href="TcRnTypes.html#Brack"><span class="hs-identifier">Brack</span></a></a><span>                       </span><span class="hs-comment">-- Inside brackets</span><span>
</span><a name="line-788"></a><span>      </span><a href="TcRnTypes.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a><span>                   </span><span class="hs-comment">--   Enclosing stage</span><span>
</span><a name="line-789"></a><span>      </span><a href="TcRnTypes.html#PendingStuff"><span class="hs-identifier hs-type">PendingStuff</span></a><span>
</span><a name="line-790"></a><span>
</span><a name="line-791"></a><span class="hs-keyword">data</span><span> </span><a name="PendingStuff"><a href="TcRnTypes.html#PendingStuff"><span class="hs-identifier">PendingStuff</span></a></a><span>
</span><a name="line-792"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="RnPendingUntyped"><a href="TcRnTypes.html#RnPendingUntyped"><span class="hs-identifier">RnPendingUntyped</span></a></a><span>              </span><span class="hs-comment">-- Renaming the inside of an *untyped* bracket</span><span>
</span><a name="line-793"></a><span>      </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">[</span><a href="HsExpr.html#PendingRnSplice"><span class="hs-identifier hs-type">PendingRnSplice</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Pending splices in here</span><span>
</span><a name="line-794"></a><span>
</span><a name="line-795"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RnPendingTyped"><a href="TcRnTypes.html#RnPendingTyped"><span class="hs-identifier">RnPendingTyped</span></a></a><span>                </span><span class="hs-comment">-- Renaming the inside of a *typed* bracket</span><span>
</span><a name="line-796"></a><span>
</span><a name="line-797"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TcPending"><a href="TcRnTypes.html#TcPending"><span class="hs-identifier">TcPending</span></a></a><span>                     </span><span class="hs-comment">-- Typechecking the inside of a typed bracket</span><span>
</span><a name="line-798"></a><span>      </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><span class="hs-special">[</span><a href="HsExpr.html#PendingTcSplice"><span class="hs-identifier hs-type">PendingTcSplice</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">--   Accumulate pending splices here</span><span>
</span><a name="line-799"></a><span>      </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span class="hs-special">)</span><span>   </span><span class="hs-comment">--     and type constraints here</span><span>
</span><a name="line-800"></a><span>
</span><a name="line-801"></a><span class="hs-identifier">topStage</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">topAnnStage</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">topSpliceStage</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a><span>
</span><a name="line-802"></a><a name="topStage"><a href="TcRnTypes.html#topStage"><span class="hs-identifier">topStage</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Comp"><span class="hs-identifier hs-var">Comp</span></a><span>
</span><a name="line-803"></a><a name="topAnnStage"><a href="TcRnTypes.html#topAnnStage"><span class="hs-identifier">topAnnStage</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Splice"><span class="hs-identifier hs-var">Splice</span></a><span> </span><a href="TcRnTypes.html#Untyped"><span class="hs-identifier hs-var">Untyped</span></a><span>
</span><a name="line-804"></a><a name="topSpliceStage"><a href="TcRnTypes.html#topSpliceStage"><span class="hs-identifier">topSpliceStage</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Splice"><span class="hs-identifier hs-var">Splice</span></a><span> </span><a href="TcRnTypes.html#Untyped"><span class="hs-identifier hs-var">Untyped</span></a><span>
</span><a name="line-805"></a><span>
</span><a name="line-806"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-807"></a><span>   </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Splice"><span class="hs-identifier hs-var">Splice</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Splice&quot;</span><span>
</span><a name="line-808"></a><span>   </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#Comp"><span class="hs-identifier hs-var">Comp</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Comp&quot;</span><span>
</span><a name="line-809"></a><span>   </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Brack"><span class="hs-identifier hs-var">Brack</span></a><span> </span><a name="local-1627933994"><a href="#local-1627933994"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Brack&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933994"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-810"></a><span>
</span><a name="line-811"></a><span class="hs-keyword">type</span><span> </span><a name="ThLevel"><a href="TcRnTypes.html#ThLevel"><span class="hs-identifier">ThLevel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-812"></a><span>    </span><span class="hs-comment">-- NB: see Note [Template Haskell levels] in TcSplice</span><span>
</span><a name="line-813"></a><span>    </span><span class="hs-comment">-- Incremented when going inside a bracket,</span><span>
</span><a name="line-814"></a><span>    </span><span class="hs-comment">-- decremented when going inside a splice</span><span>
</span><a name="line-815"></a><span>    </span><span class="hs-comment">-- NB: ThLevel is one greater than the 'n' in Fig 2 of the</span><span>
</span><a name="line-816"></a><span>    </span><span class="hs-comment">--     original &quot;Template meta-programming for Haskell&quot; paper</span><span>
</span><a name="line-817"></a><span>
</span><a name="line-818"></a><span class="hs-identifier">impLevel</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">outerLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ThLevel"><span class="hs-identifier hs-type">ThLevel</span></a><span>
</span><a name="line-819"></a><a name="impLevel"><a href="TcRnTypes.html#impLevel"><span class="hs-identifier">impLevel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-comment">-- Imported things; they can be used inside a top level splice</span><span>
</span><a name="line-820"></a><a name="outerLevel"><a href="TcRnTypes.html#outerLevel"><span class="hs-identifier">outerLevel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>  </span><span class="hs-comment">-- Things defined outside brackets</span><span>
</span><a name="line-821"></a><span>
</span><a name="line-822"></a><span class="hs-identifier">thLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#ThLevel"><span class="hs-identifier hs-type">ThLevel</span></a><span>
</span><a name="line-823"></a><a name="thLevel"><a href="TcRnTypes.html#thLevel"><span class="hs-identifier">thLevel</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Splice"><span class="hs-identifier hs-var">Splice</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-824"></a><span class="hs-identifier">thLevel</span><span> </span><a href="TcRnTypes.html#Comp"><span class="hs-identifier hs-var">Comp</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-825"></a><span class="hs-identifier">thLevel</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Brack"><span class="hs-identifier hs-var">Brack</span></a><span> </span><a name="local-1627933670"><a href="#local-1627933670"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#thLevel"><span class="hs-identifier hs-var">thLevel</span></a><span> </span><a href="#local-1627933670"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-826"></a><span>
</span><a name="line-827"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-828"></a><span class="hs-comment">-- Arrow-notation context</span><span>
</span><a name="line-829"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span class="hs-comment">{- Note [Escaping the arrow scope]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In arrow notation, a variable bound by a proc (or enclosed let/kappa)
is not in scope to the left of an arrow tail (-&lt;) or the head of (|..|).
For example

        proc x -&gt; (e1 -&lt; e2)

Here, x is not in scope in e1, but it is in scope in e2.  This can get
a bit complicated:

        let x = 3 in
        proc y -&gt; (proc z -&gt; e1) -&lt; e2

Here, x and z are in scope in e1, but y is not.

We implement this by
recording the environment when passing a proc (using newArrowScope),
and returning to that (using escapeArrowScope) on the left of -&lt; and the
head of (|..|).

All this can be dealt with by the *renamer*. But the type checker needs
to be involved too.  Example (arrowfail001)
  class Foo a where foo :: a -&gt; ()
  data Bar = forall a. Foo a =&gt; Bar a
  get :: Bar -&gt; ()
  get = proc x -&gt; case x of Bar a -&gt; foo -&lt; a
Here the call of 'foo' gives rise to a (Foo a) constraint that should not
be captured by the pattern match on 'Bar'.  Rather it should join the
constraints from further out.  So we must capture the constraint bag
from further out in the ArrowCtxt that we push inwards.
-}</span><span>
</span><a name="line-863"></a><span>
</span><a name="line-864"></a><span class="hs-keyword">data</span><span> </span><a name="ArrowCtxt"><a href="TcRnTypes.html#ArrowCtxt"><span class="hs-identifier">ArrowCtxt</span></a></a><span>   </span><span class="hs-comment">-- Note [Escaping the arrow scope]</span><span>
</span><a name="line-865"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="NoArrowCtxt"><a href="TcRnTypes.html#NoArrowCtxt"><span class="hs-identifier">NoArrowCtxt</span></a></a><span>
</span><a name="line-866"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ArrowCtxt"><a href="TcRnTypes.html#ArrowCtxt"><span class="hs-identifier">ArrowCtxt</span></a></a><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span class="hs-special">)</span><span>
</span><a name="line-867"></a><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-870"></a><span class="hs-comment">-- TcTyThing</span><span>
</span><a name="line-871"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-872"></a><span>
</span><a name="line-873"></a><span class="hs-comment">-- | A typecheckable thing available in a local context.  Could be</span><span>
</span><a name="line-874"></a><span class="hs-comment">-- 'AGlobal' 'TyThing', but also lexically scoped variables, etc.</span><span>
</span><a name="line-875"></a><span class="hs-comment">-- See 'TcEnv' for how to retrieve a 'TyThing' given a 'Name'.</span><span>
</span><a name="line-876"></a><span class="hs-keyword">data</span><span> </span><a name="TcTyThing"><a href="TcRnTypes.html#TcTyThing"><span class="hs-identifier">TcTyThing</span></a></a><span>
</span><a name="line-877"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="AGlobal"><a href="TcRnTypes.html#AGlobal"><span class="hs-identifier">AGlobal</span></a></a><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span>             </span><span class="hs-comment">-- Used only in the return type of a lookup</span><span>
</span><a name="line-878"></a><span>
</span><a name="line-879"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ATcId"><a href="TcRnTypes.html#ATcId"><span class="hs-identifier">ATcId</span></a></a><span>   </span><span class="hs-special">{</span><span>           </span><span class="hs-comment">-- Ids defined in this module; may not be fully zonked</span><span>
</span><a name="line-880"></a><span>        </span><a href="TcRnTypes.html#tct_id"><span class="hs-identifier">tct_id</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">,</span><span>
</span><a name="line-881"></a><span>        </span><a href="TcRnTypes.html#tct_closed"><span class="hs-identifier">tct_closed</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a><span> </span><span class="hs-special">}</span><span>   </span><span class="hs-comment">-- See Note [Bindings with closed types]</span><span>
</span><a name="line-882"></a><span>
</span><a name="line-883"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ATyVar"><a href="TcRnTypes.html#ATyVar"><span class="hs-identifier">ATyVar</span></a></a><span>  </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span>        </span><span class="hs-comment">-- The type variable to which the lexically scoped type</span><span>
</span><a name="line-884"></a><span>                                </span><span class="hs-comment">-- variable is bound. We only need the Name</span><span>
</span><a name="line-885"></a><span>                                </span><span class="hs-comment">-- for error-message purposes; it is the corresponding</span><span>
</span><a name="line-886"></a><span>                                </span><span class="hs-comment">-- Name in the domain of the envt</span><span>
</span><a name="line-887"></a><span>
</span><a name="line-888"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ATcTyCon"><a href="TcRnTypes.html#ATcTyCon"><span class="hs-identifier">ATcTyCon</span></a></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>   </span><span class="hs-comment">-- Used temporarily, during kind checking, for the</span><span>
</span><a name="line-889"></a><span>                     </span><span class="hs-comment">-- tycons and clases in this recursive group</span><span>
</span><a name="line-890"></a><span>                     </span><span class="hs-comment">-- The TyCon is always a TcTyCon.  Its kind</span><span>
</span><a name="line-891"></a><span>                     </span><span class="hs-comment">-- can be a mono-kind or a poly-kind; in TcTyClsDcls see</span><span>
</span><a name="line-892"></a><span>                     </span><span class="hs-comment">-- Note [Type checking recursive type and class declarations]</span><span>
</span><a name="line-893"></a><span>
</span><a name="line-894"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="APromotionErr"><a href="TcRnTypes.html#APromotionErr"><span class="hs-identifier">APromotionErr</span></a></a><span> </span><a href="TcRnTypes.html#PromotionErr"><span class="hs-identifier hs-type">PromotionErr</span></a><span>
</span><a name="line-895"></a><span>
</span><a name="line-896"></a><span class="hs-keyword">data</span><span> </span><a name="PromotionErr"><a href="TcRnTypes.html#PromotionErr"><span class="hs-identifier">PromotionErr</span></a></a><span>
</span><a name="line-897"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TyConPE"><a href="TcRnTypes.html#TyConPE"><span class="hs-identifier">TyConPE</span></a></a><span>          </span><span class="hs-comment">-- TyCon used in a kind before we are ready</span><span>
</span><a name="line-898"></a><span>                     </span><span class="hs-comment">--     data T :: T -&gt; * where ...</span><span>
</span><a name="line-899"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ClassPE"><a href="TcRnTypes.html#ClassPE"><span class="hs-identifier">ClassPE</span></a></a><span>          </span><span class="hs-comment">-- Ditto Class</span><span>
</span><a name="line-900"></a><span>
</span><a name="line-901"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FamDataConPE"><a href="TcRnTypes.html#FamDataConPE"><span class="hs-identifier">FamDataConPE</span></a></a><span>     </span><span class="hs-comment">-- Data constructor for a data family</span><span>
</span><a name="line-902"></a><span>                     </span><span class="hs-comment">-- See Note [AFamDataCon: not promoting data family constructors] in TcRnDriver</span><span>
</span><a name="line-903"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PatSynPE"><a href="TcRnTypes.html#PatSynPE"><span class="hs-identifier">PatSynPE</span></a></a><span>         </span><span class="hs-comment">-- Pattern synonyms</span><span>
</span><a name="line-904"></a><span>                     </span><span class="hs-comment">-- See Note [Don't promote pattern synonyms] in TcEnv</span><span>
</span><a name="line-905"></a><span>
</span><a name="line-906"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RecDataConPE"><a href="TcRnTypes.html#RecDataConPE"><span class="hs-identifier">RecDataConPE</span></a></a><span>     </span><span class="hs-comment">-- Data constructor in a recursive loop</span><span>
</span><a name="line-907"></a><span>                     </span><span class="hs-comment">-- See Note [ARecDataCon: recusion and promoting data constructors] in TcTyClsDecls</span><span>
</span><a name="line-908"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NoDataKindsTC"><a href="TcRnTypes.html#NoDataKindsTC"><span class="hs-identifier">NoDataKindsTC</span></a></a><span>    </span><span class="hs-comment">-- -XDataKinds not enabled (for a tycon)</span><span>
</span><a name="line-909"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NoDataKindsDC"><a href="TcRnTypes.html#NoDataKindsDC"><span class="hs-identifier">NoDataKindsDC</span></a></a><span>    </span><span class="hs-comment">-- -XDataKinds not enabled (for a datacon)</span><span>
</span><a name="line-910"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NoTypeInTypeTC"><a href="TcRnTypes.html#NoTypeInTypeTC"><span class="hs-identifier">NoTypeInTypeTC</span></a></a><span>   </span><span class="hs-comment">-- -XTypeInType not enabled (for a tycon)</span><span>
</span><a name="line-911"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NoTypeInTypeDC"><a href="TcRnTypes.html#NoTypeInTypeDC"><span class="hs-identifier">NoTypeInTypeDC</span></a></a><span>   </span><span class="hs-comment">-- -XTypeInType not enabled (for a datacon)</span><span>
</span><a name="line-912"></a><span>
</span><a name="line-913"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#TcTyThing"><span class="hs-identifier hs-type">TcTyThing</span></a><span> </span><span class="hs-keyword">where</span><span>     </span><span class="hs-comment">-- Debugging only</span><span>
</span><a name="line-914"></a><span>   </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#AGlobal"><span class="hs-identifier hs-var">AGlobal</span></a><span> </span><a name="local-1627933988"><a href="#local-1627933988"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#pprTyThing"><span class="hs-identifier hs-var">pprTyThing</span></a><span> </span><a href="#local-1627933988"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-915"></a><span>   </span><span class="hs-identifier">ppr</span><span> </span><a name="local-1627933989"><a href="#local-1627933989"><span class="hs-identifier">elt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#ATcId"><span class="hs-identifier hs-var">ATcId</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Identifier&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span>
</span><a name="line-916"></a><span>                          </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tct_id</span><span> </span><a href="#local-1627933989"><span class="hs-identifier hs-var">elt</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span>
</span><a name="line-917"></a><span>                                 </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tct_id</span><span> </span><a href="#local-1627933989"><span class="hs-identifier hs-var">elt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span>
</span><a name="line-918"></a><span>                                 </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tct_closed</span><span> </span><a href="#local-1627933989"><span class="hs-identifier hs-var">elt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-919"></a><span>   </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ATyVar"><span class="hs-identifier hs-var">ATyVar</span></a><span> </span><a name="local-1627933990"><a href="#local-1627933990"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627933991"><a href="#local-1627933991"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933990"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933991"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-920"></a><span>   </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ATcTyCon"><span class="hs-identifier hs-var">ATcTyCon</span></a><span> </span><a name="local-1627933992"><a href="#local-1627933992"><span class="hs-identifier">tc</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;ATcTyCon&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933992"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-921"></a><span>   </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#APromotionErr"><span class="hs-identifier hs-var">APromotionErr</span></a><span> </span><a name="local-1627933993"><a href="#local-1627933993"><span class="hs-identifier">err</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;APromotionErr&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933993"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-922"></a><span>
</span><a name="line-923"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#PromotionErr"><span class="hs-identifier hs-type">PromotionErr</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-924"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="TcRnTypes.html#ClassPE"><span class="hs-identifier hs-var">ClassPE</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;ClassPE&quot;</span><span>
</span><a name="line-925"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#TyConPE"><span class="hs-identifier hs-var">TyConPE</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TyConPE&quot;</span><span>
</span><a name="line-926"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#PatSynPE"><span class="hs-identifier hs-var">PatSynPE</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;PatSynPE&quot;</span><span>
</span><a name="line-927"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#FamDataConPE"><span class="hs-identifier hs-var">FamDataConPE</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;FamDataConPE&quot;</span><span>
</span><a name="line-928"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#RecDataConPE"><span class="hs-identifier hs-var">RecDataConPE</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RecDataConPE&quot;</span><span>
</span><a name="line-929"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#NoDataKindsTC"><span class="hs-identifier hs-var">NoDataKindsTC</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NoDataKindsTC&quot;</span><span>
</span><a name="line-930"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#NoDataKindsDC"><span class="hs-identifier hs-var">NoDataKindsDC</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NoDataKindsDC&quot;</span><span>
</span><a name="line-931"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#NoTypeInTypeTC"><span class="hs-identifier hs-var">NoTypeInTypeTC</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NoTypeInTypeTC&quot;</span><span>
</span><a name="line-932"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#NoTypeInTypeDC"><span class="hs-identifier hs-var">NoTypeInTypeDC</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NoTypeInTypeDC&quot;</span><span>
</span><a name="line-933"></a><span>
</span><a name="line-934"></a><span class="hs-identifier">pprTcTyThingCategory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcTyThing"><span class="hs-identifier hs-type">TcTyThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-935"></a><a name="pprTcTyThingCategory"><a href="TcRnTypes.html#pprTcTyThingCategory"><span class="hs-identifier">pprTcTyThingCategory</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#AGlobal"><span class="hs-identifier hs-var">AGlobal</span></a><span> </span><a name="local-1627933671"><a href="#local-1627933671"><span class="hs-identifier">thing</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#pprTyThingCategory"><span class="hs-identifier hs-var">pprTyThingCategory</span></a><span> </span><a href="#local-1627933671"><span class="hs-identifier hs-var">thing</span></a><span>
</span><a name="line-936"></a><span class="hs-identifier">pprTcTyThingCategory</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ATyVar"><span class="hs-identifier hs-var">ATyVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type variable&quot;</span><span>
</span><a name="line-937"></a><span class="hs-identifier">pprTcTyThingCategory</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ATcId"><span class="hs-identifier hs-var">ATcId</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Local identifier&quot;</span><span>
</span><a name="line-938"></a><span class="hs-identifier">pprTcTyThingCategory</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ATcTyCon"><span class="hs-identifier hs-var">ATcTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Local tycon&quot;</span><span>
</span><a name="line-939"></a><span class="hs-identifier">pprTcTyThingCategory</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#APromotionErr"><span class="hs-identifier hs-var">APromotionErr</span></a><span> </span><a name="local-1627933672"><a href="#local-1627933672"><span class="hs-identifier">pe</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#pprPECategory"><span class="hs-identifier hs-var">pprPECategory</span></a><span> </span><a href="#local-1627933672"><span class="hs-identifier hs-var">pe</span></a><span>
</span><a name="line-940"></a><span>
</span><a name="line-941"></a><span class="hs-identifier">pprPECategory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#PromotionErr"><span class="hs-identifier hs-type">PromotionErr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-942"></a><a name="pprPECategory"><a href="TcRnTypes.html#pprPECategory"><span class="hs-identifier">pprPECategory</span></a></a><span> </span><a href="TcRnTypes.html#ClassPE"><span class="hs-identifier hs-var">ClassPE</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Class&quot;</span><span>
</span><a name="line-943"></a><span class="hs-identifier">pprPECategory</span><span> </span><a href="TcRnTypes.html#TyConPE"><span class="hs-identifier hs-var">TyConPE</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type constructor&quot;</span><span>
</span><a name="line-944"></a><span class="hs-identifier">pprPECategory</span><span> </span><a href="TcRnTypes.html#PatSynPE"><span class="hs-identifier hs-var">PatSynPE</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Pattern synonym&quot;</span><span>
</span><a name="line-945"></a><span class="hs-identifier">pprPECategory</span><span> </span><a href="TcRnTypes.html#FamDataConPE"><span class="hs-identifier hs-var">FamDataConPE</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data constructor&quot;</span><span>
</span><a name="line-946"></a><span class="hs-identifier">pprPECategory</span><span> </span><a href="TcRnTypes.html#RecDataConPE"><span class="hs-identifier hs-var">RecDataConPE</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data constructor&quot;</span><span>
</span><a name="line-947"></a><span class="hs-identifier">pprPECategory</span><span> </span><a href="TcRnTypes.html#NoDataKindsTC"><span class="hs-identifier hs-var">NoDataKindsTC</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type constructor&quot;</span><span>
</span><a name="line-948"></a><span class="hs-identifier">pprPECategory</span><span> </span><a href="TcRnTypes.html#NoDataKindsDC"><span class="hs-identifier hs-var">NoDataKindsDC</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data constructor&quot;</span><span>
</span><a name="line-949"></a><span class="hs-identifier">pprPECategory</span><span> </span><a href="TcRnTypes.html#NoTypeInTypeTC"><span class="hs-identifier hs-var">NoTypeInTypeTC</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type constructor&quot;</span><span>
</span><a name="line-950"></a><span class="hs-identifier">pprPECategory</span><span> </span><a href="TcRnTypes.html#NoTypeInTypeDC"><span class="hs-identifier hs-var">NoTypeInTypeDC</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data constructor&quot;</span><span>
</span><a name="line-951"></a><span>
</span><a name="line-952"></a><span class="hs-comment">{- Note [Bindings with closed types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider

  f x = let g ys = map not ys
        in ...

Can we generalise 'g' under the OutsideIn algorithm?  Yes,
because all g's free variables are top-level; that is they themselves
have no free type variables, and it is the type variables in the
environment that makes things tricky for OutsideIn generalisation.

Definition:
   A variable is &quot;closed&quot;, and has tct_closed set to TopLevel,
iff
   a) all its free variables are imported, or are let-bound with closed types
   b) generalisation is not restricted by the monomorphism restriction

Invariant: a closed variable has no free type variables in its type.

Under OutsideIn we are free to generalise a closed let-binding.
This is an extension compared to the JFP paper on OutsideIn, which
used &quot;top-level&quot; as a proxy for &quot;closed&quot;.  (It's not a good proxy
anyway -- the MR can make a top-level binding with a free type
variable.)

Note that:
  * A top-level binding may not be closed, if it suffers from the MR

  * A nested binding may be closed (eg 'g' in the example we started with)
    Indeed, that's the point; whether a function is defined at top level
    or nested is orthogonal to the question of whether or not it is closed

  * A binding may be non-closed because it mentions a lexically scoped
    *type variable*  Eg
        f :: forall a. blah
        f x = let g y = ...(y::a)...

-}</span><span>
</span><a name="line-991"></a><span>
</span><a name="line-992"></a><span class="hs-keyword">type</span><span> </span><a name="ErrCtxt"><a href="TcRnTypes.html#ErrCtxt"><span class="hs-identifier">ErrCtxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a href="VarEnv.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a><span class="hs-special">,</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-993"></a><span>        </span><span class="hs-comment">-- Monadic so that we have a chance</span><span>
</span><a name="line-994"></a><span>        </span><span class="hs-comment">-- to deal with bound type variables just before error</span><span>
</span><a name="line-995"></a><span>        </span><span class="hs-comment">-- message construction</span><span>
</span><a name="line-996"></a><span>
</span><a name="line-997"></a><span>        </span><span class="hs-comment">-- Bool:  True &lt;=&gt; this is a landmark context; do not</span><span>
</span><a name="line-998"></a><span>        </span><span class="hs-comment">--                 discard it when trimming for display</span><span>
</span><a name="line-999"></a><span>
</span><a name="line-1000"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Operations over ImportAvails
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1007"></a><span>
</span><a name="line-1008"></a><span class="hs-comment">-- | 'ImportAvails' summarises what was imported from where, irrespective of</span><span>
</span><a name="line-1009"></a><span class="hs-comment">-- whether the imported things are actually used or not.  It is used:</span><span>
</span><a name="line-1010"></a><span class="hs-comment">--</span><span>
</span><a name="line-1011"></a><span class="hs-comment">--  * when processing the export list,</span><span>
</span><a name="line-1012"></a><span class="hs-comment">--</span><span>
</span><a name="line-1013"></a><span class="hs-comment">--  * when constructing usage info for the interface file,</span><span>
</span><a name="line-1014"></a><span class="hs-comment">--</span><span>
</span><a name="line-1015"></a><span class="hs-comment">--  * to identify the list of directly imported modules for initialisation</span><span>
</span><a name="line-1016"></a><span class="hs-comment">--    purposes and for optimised overlap checking of family instances,</span><span>
</span><a name="line-1017"></a><span class="hs-comment">--</span><span>
</span><a name="line-1018"></a><span class="hs-comment">--  * when figuring out what things are really unused</span><span>
</span><a name="line-1019"></a><span class="hs-comment">--</span><span>
</span><a name="line-1020"></a><span class="hs-keyword">data</span><span> </span><a name="ImportAvails"><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier">ImportAvails</span></a></a><span>
</span><a name="line-1021"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a name="ImportAvails"><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier">ImportAvails</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1022"></a><span>        </span><a href="TcRnTypes.html#imp_mods"><span class="hs-identifier">imp_mods</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#ImportedMods"><span class="hs-identifier hs-type">ImportedMods</span></a><span class="hs-special">,</span><span>
</span><a name="line-1023"></a><span>          </span><span class="hs-comment">--      = ModuleEnv [ImportedModsVal],</span><span>
</span><a name="line-1024"></a><span>          </span><span class="hs-comment">-- ^ Domain is all directly-imported modules</span><span>
</span><a name="line-1025"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-1026"></a><span>          </span><span class="hs-comment">-- See the documentaion on ImportedModsVal in HscTypes for the</span><span>
</span><a name="line-1027"></a><span>          </span><span class="hs-comment">-- meaning of the fields.</span><span>
</span><a name="line-1028"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-1029"></a><span>          </span><span class="hs-comment">-- We need a full ModuleEnv rather than a ModuleNameEnv here,</span><span>
</span><a name="line-1030"></a><span>          </span><span class="hs-comment">-- because we might be importing modules of the same name from</span><span>
</span><a name="line-1031"></a><span>          </span><span class="hs-comment">-- different packages. (currently not the case, but might be in the</span><span>
</span><a name="line-1032"></a><span>          </span><span class="hs-comment">-- future).</span><span>
</span><a name="line-1033"></a><span>
</span><a name="line-1034"></a><span>        </span><a href="TcRnTypes.html#imp_dep_mods"><span class="hs-identifier">imp_dep_mods</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#ModuleNameEnv"><span class="hs-identifier hs-type">ModuleNameEnv</span></a><span> </span><span class="hs-special">(</span><a href="Module.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a><span class="hs-special">,</span><span> </span><a href="HscTypes.html#IsBootInterface"><span class="hs-identifier hs-type">IsBootInterface</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1035"></a><span>          </span><span class="hs-comment">-- ^ Home-package modules needed by the module being compiled</span><span>
</span><a name="line-1036"></a><span>          </span><span class="hs-comment">--</span><span>
</span><a name="line-1037"></a><span>          </span><span class="hs-comment">-- It doesn't matter whether any of these dependencies</span><span>
</span><a name="line-1038"></a><span>          </span><span class="hs-comment">-- are actually /used/ when compiling the module; they</span><span>
</span><a name="line-1039"></a><span>          </span><span class="hs-comment">-- are listed if they are below it at all.  For</span><span>
</span><a name="line-1040"></a><span>          </span><span class="hs-comment">-- example, suppose M imports A which imports X.  Then</span><span>
</span><a name="line-1041"></a><span>          </span><span class="hs-comment">-- compiling M might not need to consult X.hi, but X</span><span>
</span><a name="line-1042"></a><span>          </span><span class="hs-comment">-- is still listed in M's dependencies.</span><span>
</span><a name="line-1043"></a><span>
</span><a name="line-1044"></a><span>        </span><a href="TcRnTypes.html#imp_dep_pkgs"><span class="hs-identifier">imp_dep_pkgs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Module.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1045"></a><span>          </span><span class="hs-comment">-- ^ Packages needed by the module being compiled, whether directly,</span><span>
</span><a name="line-1046"></a><span>          </span><span class="hs-comment">-- or via other modules in this package, or via modules imported</span><span>
</span><a name="line-1047"></a><span>          </span><span class="hs-comment">-- from other packages.</span><span>
</span><a name="line-1048"></a><span>
</span><a name="line-1049"></a><span>        </span><a href="TcRnTypes.html#imp_trust_pkgs"><span class="hs-identifier">imp_trust_pkgs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Module.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1050"></a><span>          </span><span class="hs-comment">-- ^ This is strictly a subset of imp_dep_pkgs and records the</span><span>
</span><a name="line-1051"></a><span>          </span><span class="hs-comment">-- packages the current module needs to trust for Safe Haskell</span><span>
</span><a name="line-1052"></a><span>          </span><span class="hs-comment">-- compilation to succeed. A package is required to be trusted if</span><span>
</span><a name="line-1053"></a><span>          </span><span class="hs-comment">-- we are dependent on a trustworthy module in that package.</span><span>
</span><a name="line-1054"></a><span>          </span><span class="hs-comment">-- While perhaps making imp_dep_pkgs a tuple of (UnitId, Bool)</span><span>
</span><a name="line-1055"></a><span>          </span><span class="hs-comment">-- where True for the bool indicates the package is required to be</span><span>
</span><a name="line-1056"></a><span>          </span><span class="hs-comment">-- trusted is the more logical  design, doing so complicates a lot</span><span>
</span><a name="line-1057"></a><span>          </span><span class="hs-comment">-- of code not concerned with Safe Haskell.</span><span>
</span><a name="line-1058"></a><span>          </span><span class="hs-comment">-- See Note [RnNames . Tracking Trust Transitively]</span><span>
</span><a name="line-1059"></a><span>
</span><a name="line-1060"></a><span>        </span><a href="TcRnTypes.html#imp_trust_own_pkg"><span class="hs-identifier">imp_trust_own_pkg</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>
</span><a name="line-1061"></a><span>          </span><span class="hs-comment">-- ^ Do we require that our own package is trusted?</span><span>
</span><a name="line-1062"></a><span>          </span><span class="hs-comment">-- This is to handle efficiently the case where a Safe module imports</span><span>
</span><a name="line-1063"></a><span>          </span><span class="hs-comment">-- a Trustworthy module that resides in the same package as it.</span><span>
</span><a name="line-1064"></a><span>          </span><span class="hs-comment">-- See Note [RnNames . Trust Own Package]</span><span>
</span><a name="line-1065"></a><span>
</span><a name="line-1066"></a><span>        </span><a href="TcRnTypes.html#imp_orphs"><span class="hs-identifier">imp_orphs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1067"></a><span>          </span><span class="hs-comment">-- ^ Orphan modules below us in the import tree (and maybe including</span><span>
</span><a name="line-1068"></a><span>          </span><span class="hs-comment">-- us for imported modules)</span><span>
</span><a name="line-1069"></a><span>
</span><a name="line-1070"></a><span>        </span><a href="TcRnTypes.html#imp_finsts"><span class="hs-identifier">imp_finsts</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span class="hs-special">]</span><span>
</span><a name="line-1071"></a><span>          </span><span class="hs-comment">-- ^ Family instance modules below us in the import tree (and maybe</span><span>
</span><a name="line-1072"></a><span>          </span><span class="hs-comment">-- including us for imported modules)</span><span>
</span><a name="line-1073"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-1074"></a><span>
</span><a name="line-1075"></a><span class="hs-identifier">mkModDeps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Module.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a><span class="hs-special">,</span><span> </span><a href="HscTypes.html#IsBootInterface"><span class="hs-identifier hs-type">IsBootInterface</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1076"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#ModuleNameEnv"><span class="hs-identifier hs-type">ModuleNameEnv</span></a><span> </span><span class="hs-special">(</span><a href="Module.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a><span class="hs-special">,</span><span> </span><a href="HscTypes.html#IsBootInterface"><span class="hs-identifier hs-type">IsBootInterface</span></a><span class="hs-special">)</span><span>
</span><a name="line-1077"></a><a name="mkModDeps"><a href="TcRnTypes.html#mkModDeps"><span class="hs-identifier">mkModDeps</span></a></a><span> </span><a name="local-1627933673"><a href="#local-1627933673"><span class="hs-identifier">deps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-1627933674"><span class="hs-identifier hs-var">add</span></a><span> </span><a href="UniqFM.html#emptyUFM"><span class="hs-identifier hs-var">emptyUFM</span></a><span> </span><a href="#local-1627933673"><span class="hs-identifier hs-var">deps</span></a><span>
</span><a name="line-1078"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1079"></a><span>                 </span><a name="local-1627933674"><a href="#local-1627933674"><span class="hs-identifier">add</span></a></a><span> </span><a name="local-1627933675"><a href="#local-1627933675"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627933676"><a href="#local-1627933676"><span class="hs-identifier">elt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-1627933677"><a href="#local-1627933677"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#addToUFM"><span class="hs-identifier hs-var">addToUFM</span></a><span> </span><a href="#local-1627933675"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627933677"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1627933676"><span class="hs-identifier hs-var">elt</span></a><span>
</span><a name="line-1080"></a><span>
</span><a name="line-1081"></a><span class="hs-identifier">emptyImportAvails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span>
</span><a name="line-1082"></a><a name="emptyImportAvails"><a href="TcRnTypes.html#emptyImportAvails"><span class="hs-identifier">emptyImportAvails</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-var">ImportAvails</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">imp_mods</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#emptyModuleEnv"><span class="hs-identifier hs-var">emptyModuleEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-1083"></a><span>                                   </span><span class="hs-identifier">imp_dep_mods</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#emptyUFM"><span class="hs-identifier hs-var">emptyUFM</span></a><span class="hs-special">,</span><span>
</span><a name="line-1084"></a><span>                                   </span><span class="hs-identifier">imp_dep_pkgs</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1085"></a><span>                                   </span><span class="hs-identifier">imp_trust_pkgs</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1086"></a><span>                                   </span><span class="hs-identifier">imp_trust_own_pkg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>
</span><a name="line-1087"></a><span>                                   </span><span class="hs-identifier">imp_orphs</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1088"></a><span>                                   </span><span class="hs-identifier">imp_finsts</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1089"></a><span>
</span><a name="line-1090"></a><span class="hs-comment">-- | Union two ImportAvails</span><span>
</span><a name="line-1091"></a><span class="hs-comment">--</span><span>
</span><a name="line-1092"></a><span class="hs-comment">-- This function is a key part of Import handling, basically</span><span>
</span><a name="line-1093"></a><span class="hs-comment">-- for each import we create a separate ImportAvails structure</span><span>
</span><a name="line-1094"></a><span class="hs-comment">-- and then union them all together with this function.</span><span>
</span><a name="line-1095"></a><span class="hs-identifier">plusImportAvails</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span>
</span><a name="line-1096"></a><a name="plusImportAvails"><a href="TcRnTypes.html#plusImportAvails"><span class="hs-identifier">plusImportAvails</span></a></a><span>
</span><a name="line-1097"></a><span>  </span><span class="hs-special">(</span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-var">ImportAvails</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">imp_mods</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933678"><a href="#local-1627933678"><span class="hs-identifier">mods1</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1098"></a><span>                  </span><span class="hs-identifier">imp_dep_mods</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933679"><a href="#local-1627933679"><span class="hs-identifier">dmods1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">imp_dep_pkgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933680"><a href="#local-1627933680"><span class="hs-identifier">dpkgs1</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1099"></a><span>                  </span><span class="hs-identifier">imp_trust_pkgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933681"><a href="#local-1627933681"><span class="hs-identifier">tpkgs1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">imp_trust_own_pkg</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933682"><a href="#local-1627933682"><span class="hs-identifier">tself1</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1100"></a><span>                  </span><span class="hs-identifier">imp_orphs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933683"><a href="#local-1627933683"><span class="hs-identifier">orphs1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">imp_finsts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933684"><a href="#local-1627933684"><span class="hs-identifier">finsts1</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1101"></a><span>  </span><span class="hs-special">(</span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-var">ImportAvails</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">imp_mods</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933685"><a href="#local-1627933685"><span class="hs-identifier">mods2</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1102"></a><span>                  </span><span class="hs-identifier">imp_dep_mods</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933686"><a href="#local-1627933686"><span class="hs-identifier">dmods2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">imp_dep_pkgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933687"><a href="#local-1627933687"><span class="hs-identifier">dpkgs2</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1103"></a><span>                  </span><span class="hs-identifier">imp_trust_pkgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933688"><a href="#local-1627933688"><span class="hs-identifier">tpkgs2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">imp_trust_own_pkg</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933689"><a href="#local-1627933689"><span class="hs-identifier">tself2</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1104"></a><span>                  </span><span class="hs-identifier">imp_orphs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933690"><a href="#local-1627933690"><span class="hs-identifier">orphs2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">imp_finsts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933691"><a href="#local-1627933691"><span class="hs-identifier">finsts2</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1105"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-var">ImportAvails</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">imp_mods</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#plusModuleEnv_C"><span class="hs-identifier hs-var">plusModuleEnv_C</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627933678"><span class="hs-identifier hs-var">mods1</span></a><span> </span><a href="#local-1627933685"><span class="hs-identifier hs-var">mods2</span></a><span class="hs-special">,</span><span>
</span><a name="line-1106"></a><span>                   </span><span class="hs-identifier">imp_dep_mods</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#plusUFM_C"><span class="hs-identifier hs-var">plusUFM_C</span></a><span> </span><a href="#local-1627933692"><span class="hs-identifier hs-var">plus_mod_dep</span></a><span> </span><a href="#local-1627933679"><span class="hs-identifier hs-var">dmods1</span></a><span> </span><a href="#local-1627933686"><span class="hs-identifier hs-var">dmods2</span></a><span class="hs-special">,</span><span>
</span><a name="line-1107"></a><span>                   </span><span class="hs-identifier">imp_dep_pkgs</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933680"><span class="hs-identifier hs-var">dpkgs1</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#unionLists"><span class="hs-identifier hs-var">unionLists</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933687"><span class="hs-identifier hs-var">dpkgs2</span></a><span class="hs-special">,</span><span>
</span><a name="line-1108"></a><span>                   </span><span class="hs-identifier">imp_trust_pkgs</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933681"><span class="hs-identifier hs-var">tpkgs1</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#unionLists"><span class="hs-identifier hs-var">unionLists</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933688"><span class="hs-identifier hs-var">tpkgs2</span></a><span class="hs-special">,</span><span>
</span><a name="line-1109"></a><span>                   </span><span class="hs-identifier">imp_trust_own_pkg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933682"><span class="hs-identifier hs-var">tself1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627933689"><span class="hs-identifier hs-var">tself2</span></a><span class="hs-special">,</span><span>
</span><a name="line-1110"></a><span>                   </span><span class="hs-identifier">imp_orphs</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933683"><span class="hs-identifier hs-var">orphs1</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#unionLists"><span class="hs-identifier hs-var">unionLists</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933690"><span class="hs-identifier hs-var">orphs2</span></a><span class="hs-special">,</span><span>
</span><a name="line-1111"></a><span>                   </span><span class="hs-identifier">imp_finsts</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933684"><span class="hs-identifier hs-var">finsts1</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#unionLists"><span class="hs-identifier hs-var">unionLists</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933691"><span class="hs-identifier hs-var">finsts2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1112"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1113"></a><span>    </span><a name="local-1627933692"><a href="#local-1627933692"><span class="hs-identifier">plus_mod_dep</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627933693"><a href="#local-1627933693"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627933694"><a href="#local-1627933694"><span class="hs-identifier">boot1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1627933695"><a href="#local-1627933695"><span class="hs-identifier">m2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627933696"><a href="#local-1627933696"><span class="hs-identifier">boot2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1114"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><a href="Outputable.html#warnPprTrace"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#warnPprTrace"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier hs-var">m2</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ppr</span><span> </span><a href="#local-1627933695"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">m2</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">boot1</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">boot2</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1115"></a><span>                </span><span class="hs-comment">-- Check mod-names match</span><span>
</span><a name="line-1116"></a><span>          </span><span class="hs-special">(</span><a href="#local-1627933693"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627933694"><span class="hs-identifier hs-var">boot1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1627933696"><span class="hs-identifier hs-var">boot2</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- If either side can &quot;see&quot; a non-hi-boot interface, use that</span><span>
</span><a name="line-1117"></a><span>
</span><a name="line-1118"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Where from}
*                                                                      *
************************************************************************

The @WhereFrom@ type controls where the renamer looks for an interface file
-}</span><span>
</span><a name="line-1127"></a><span>
</span><a name="line-1128"></a><span class="hs-keyword">data</span><span> </span><a name="WhereFrom"><a href="TcRnTypes.html#WhereFrom"><span class="hs-identifier">WhereFrom</span></a></a><span>
</span><a name="line-1129"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ImportByUser"><a href="TcRnTypes.html#ImportByUser"><span class="hs-identifier">ImportByUser</span></a></a><span> </span><a href="HscTypes.html#IsBootInterface"><span class="hs-identifier hs-type">IsBootInterface</span></a><span>        </span><span class="hs-comment">-- Ordinary user import (perhaps {-# SOURCE #-})</span><span>
</span><a name="line-1130"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ImportBySystem"><a href="TcRnTypes.html#ImportBySystem"><span class="hs-identifier">ImportBySystem</span></a></a><span>                      </span><span class="hs-comment">-- Non user import.</span><span>
</span><a name="line-1131"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ImportByPlugin"><a href="TcRnTypes.html#ImportByPlugin"><span class="hs-identifier">ImportByPlugin</span></a></a><span>                      </span><span class="hs-comment">-- Importing a plugin;</span><span>
</span><a name="line-1132"></a><span>                                        </span><span class="hs-comment">-- See Note [Care with plugin imports] in LoadIface</span><span>
</span><a name="line-1133"></a><span>
</span><a name="line-1134"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#WhereFrom"><span class="hs-identifier hs-type">WhereFrom</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1135"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ImportByUser"><span class="hs-identifier hs-var">ImportByUser</span></a><span> </span><a name="local-1627933987"><a href="#local-1627933987"><span class="hs-identifier">is_boot</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627933987"><span class="hs-identifier hs-var">is_boot</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;{- SOURCE -}&quot;</span><span>
</span><a name="line-1136"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1137"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#ImportBySystem"><span class="hs-identifier hs-var">ImportBySystem</span></a><span>                       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;{- SYSTEM -}&quot;</span><span>
</span><a name="line-1138"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#ImportByPlugin"><span class="hs-identifier hs-var">ImportByPlugin</span></a><span>                       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;{- PLUGIN -}&quot;</span><span>
</span><a name="line-1139"></a><span>
</span><a name="line-1140"></a><span>
</span><a name="line-1141"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
                Type signatures
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-1146"></a><span>
</span><a name="line-1147"></a><span class="hs-keyword">type</span><span> </span><a name="TcSigFun"><a href="TcRnTypes.html#TcSigFun"><span class="hs-identifier">TcSigFun</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a><span>
</span><a name="line-1148"></a><span>
</span><a name="line-1149"></a><span class="hs-keyword">data</span><span> </span><a name="TcSigInfo"><a href="TcRnTypes.html#TcSigInfo"><span class="hs-identifier">TcSigInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TcIdSig"><a href="TcRnTypes.html#TcIdSig"><span class="hs-identifier">TcIdSig</span></a></a><span>     </span><a href="TcRnTypes.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a><span>
</span><a name="line-1150"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="TcPatSynSig"><a href="TcRnTypes.html#TcPatSynSig"><span class="hs-identifier">TcPatSynSig</span></a></a><span> </span><a href="TcRnTypes.html#TcPatSynInfo"><span class="hs-identifier hs-type">TcPatSynInfo</span></a><span>
</span><a name="line-1151"></a><span>
</span><a name="line-1152"></a><span class="hs-keyword">data</span><span> </span><a name="TcIdSigInfo"><a href="TcRnTypes.html#TcIdSigInfo"><span class="hs-identifier">TcIdSigInfo</span></a></a><span>
</span><a name="line-1153"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TISI"><a href="TcRnTypes.html#TISI"><span class="hs-identifier">TISI</span></a></a><span>
</span><a name="line-1154"></a><span>      </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#sig_bndr"><span class="hs-identifier">sig_bndr</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcIdSigBndr"><span class="hs-identifier hs-type">TcIdSigBndr</span></a><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sig_skols"><span class="hs-identifier">sig_skols</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1157"></a><span>            </span><span class="hs-comment">-- Instantiated type and kind variables SKOLEMS</span><span>
</span><a name="line-1158"></a><span>            </span><span class="hs-comment">-- The Name is the Name that the renamer chose;</span><span>
</span><a name="line-1159"></a><span>            </span><span class="hs-comment">--   but the TcTyVar may come from instantiating</span><span>
</span><a name="line-1160"></a><span>            </span><span class="hs-comment">--   the type and hence have a different unique.</span><span>
</span><a name="line-1161"></a><span>            </span><span class="hs-comment">-- No need to keep track of whether they are truly lexically</span><span>
</span><a name="line-1162"></a><span>            </span><span class="hs-comment">--   scoped because the renamer has named them uniquely</span><span>
</span><a name="line-1163"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-1164"></a><span>            </span><span class="hs-comment">-- For Partial signatures, this list /excludes/ any wildcards</span><span>
</span><a name="line-1165"></a><span>            </span><span class="hs-comment">--   the named wildcards scope over the binding, and hence</span><span>
</span><a name="line-1166"></a><span>            </span><span class="hs-comment">--   their Names may appear in renamed type signatures</span><span>
</span><a name="line-1167"></a><span>            </span><span class="hs-comment">--   in the binding; get them from sig_bndr</span><span>
</span><a name="line-1168"></a><span>            </span><span class="hs-comment">-- See Note [Binding scoped type variables]</span><span>
</span><a name="line-1169"></a><span>
</span><a name="line-1170"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sig_theta"><span class="hs-identifier">sig_theta</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcThetaType"><span class="hs-identifier hs-type">TcThetaType</span></a><span>   </span><span class="hs-comment">-- Instantiated theta.  In the case of a</span><span>
</span><a name="line-1171"></a><span>                                    </span><span class="hs-comment">-- PartialSig, sig_theta does not include</span><span>
</span><a name="line-1172"></a><span>                                    </span><span class="hs-comment">-- the extra-constraints wildcard</span><span>
</span><a name="line-1173"></a><span>
</span><a name="line-1174"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sig_tau"><span class="hs-identifier">sig_tau</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a><span>   </span><span class="hs-comment">-- Instantiated tau</span><span>
</span><a name="line-1175"></a><span>                                    </span><span class="hs-comment">-- See Note [sig_tau may be polymorphic]</span><span>
</span><a name="line-1176"></a><span>
</span><a name="line-1177"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sig_ctxt"><span class="hs-identifier">sig_ctxt</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#UserTypeCtxt"><span class="hs-identifier hs-type">UserTypeCtxt</span></a><span>  </span><span class="hs-comment">-- In the case of type-class default methods,</span><span>
</span><a name="line-1178"></a><span>                                    </span><span class="hs-comment">-- the Name in the FunSigCtxt is not the same</span><span>
</span><a name="line-1179"></a><span>                                    </span><span class="hs-comment">-- as the TcId; the former is 'op', while the</span><span>
</span><a name="line-1180"></a><span>                                    </span><span class="hs-comment">-- latter is '$dmop' or some such</span><span>
</span><a name="line-1181"></a><span>
</span><a name="line-1182"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sig_loc"><span class="hs-identifier">sig_loc</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>       </span><span class="hs-comment">-- Location of the type signature</span><span>
</span><a name="line-1183"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1184"></a><span>
</span><a name="line-1185"></a><span class="hs-keyword">data</span><span> </span><a name="TcIdSigBndr"><a href="TcRnTypes.html#TcIdSigBndr"><span class="hs-identifier">TcIdSigBndr</span></a></a><span>   </span><span class="hs-comment">-- See Note [Complete and partial type signatures]</span><span>
</span><a name="line-1186"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="CompleteSig"><a href="TcRnTypes.html#CompleteSig"><span class="hs-identifier">CompleteSig</span></a></a><span>    </span><span class="hs-comment">-- A complete signature with no wildcards,</span><span>
</span><a name="line-1187"></a><span>                   </span><span class="hs-comment">-- so the complete polymorphic type is known.</span><span>
</span><a name="line-1188"></a><span>        </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>          </span><span class="hs-comment">-- The polymorphic Id with that type</span><span>
</span><a name="line-1189"></a><span>
</span><a name="line-1190"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PartialSig"><a href="TcRnTypes.html#PartialSig"><span class="hs-identifier">PartialSig</span></a></a><span>     </span><span class="hs-comment">-- A partial type signature (i.e. includes one or more</span><span>
</span><a name="line-1191"></a><span>                   </span><span class="hs-comment">-- wildcards). In this case it doesn't make sense to give</span><span>
</span><a name="line-1192"></a><span>                   </span><span class="hs-comment">-- the polymorphic Id, because we are going to /infer/ its</span><span>
</span><a name="line-1193"></a><span>                   </span><span class="hs-comment">-- type, so we can't make the polymorphic Id ab-initio</span><span>
</span><a name="line-1194"></a><span>       </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#sig_name"><span class="hs-identifier">sig_name</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>              </span><span class="hs-comment">-- Name of the function; used when report wildcards</span><span>
</span><a name="line-1195"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sig_hs_ty"><span class="hs-identifier">sig_hs_ty</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>      </span><span class="hs-comment">-- The original partial signature</span><span>
</span><a name="line-1196"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sig_wcs"><span class="hs-identifier">sig_wcs</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Instantiated wildcard variables (named and anonymous)</span><span>
</span><a name="line-1197"></a><span>                                        </span><span class="hs-comment">-- The Name is what the user wrote, such as '_',</span><span>
</span><a name="line-1198"></a><span>                                        </span><span class="hs-comment">--   including SrcSpan for the error message;</span><span>
</span><a name="line-1199"></a><span>                                        </span><span class="hs-comment">-- The TcTyVar is just an ordinary unification variable</span><span>
</span><a name="line-1200"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#sig_cts"><span class="hs-identifier">sig_cts</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>     </span><span class="hs-comment">-- Just loc &lt;=&gt; An extra-constraints wildcard was present</span><span>
</span><a name="line-1201"></a><span>       </span><span class="hs-special">}</span><span>                                </span><span class="hs-comment">--              at location loc</span><span>
</span><a name="line-1202"></a><span>                                        </span><span class="hs-comment">--   e.g.   f :: (Eq a, _) =&gt; a -&gt; a</span><span>
</span><a name="line-1203"></a><span>
</span><a name="line-1204"></a><span class="hs-keyword">data</span><span> </span><a name="TcPatSynInfo"><a href="TcRnTypes.html#TcPatSynInfo"><span class="hs-identifier">TcPatSynInfo</span></a></a><span>
</span><a name="line-1205"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TPSI"><a href="TcRnTypes.html#TPSI"><span class="hs-identifier">TPSI</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1206"></a><span>        </span><a href="TcRnTypes.html#patsig_name"><span class="hs-identifier">patsig_name</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1207"></a><span>        </span><a href="TcRnTypes.html#patsig_univ_tvs"><span class="hs-identifier">patsig_univ_tvs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1208"></a><span>        </span><a href="TcRnTypes.html#patsig_req"><span class="hs-identifier">patsig_req</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcThetaType"><span class="hs-identifier hs-type">TcThetaType</span></a><span class="hs-special">,</span><span>
</span><a name="line-1209"></a><span>        </span><a href="TcRnTypes.html#patsig_ex_tvs"><span class="hs-identifier">patsig_ex_tvs</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1210"></a><span>        </span><a href="TcRnTypes.html#patsig_prov"><span class="hs-identifier">patsig_prov</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcThetaType"><span class="hs-identifier hs-type">TcThetaType</span></a><span class="hs-special">,</span><span>
</span><a name="line-1211"></a><span>        </span><a href="TcRnTypes.html#patsig_arg_tys"><span class="hs-identifier">patsig_arg_tys</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1212"></a><span>        </span><a href="TcRnTypes.html#patsig_body_ty"><span class="hs-identifier">patsig_body_ty</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a><span>
</span><a name="line-1213"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1214"></a><span>
</span><a name="line-1215"></a><span class="hs-identifier">findScopedTyVars</span><span>  </span><span class="hs-comment">-- See Note [Binding scoped type variables]</span><span>
</span><a name="line-1216"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>             </span><span class="hs-comment">-- The Type: its forall'd variables are a superset</span><span>
</span><a name="line-1217"></a><span>                        </span><span class="hs-comment">--   of the lexically scoped variables</span><span>
</span><a name="line-1218"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- The instantiated forall variables of the TcType</span><span>
</span><a name="line-1219"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- In 1-1 correspondence with the instantiated vars</span><span>
</span><a name="line-1220"></a><a name="findScopedTyVars"><a href="TcRnTypes.html#findScopedTyVars"><span class="hs-identifier">findScopedTyVars</span></a></a><span> </span><a name="local-1627933697"><a href="#local-1627933697"><span class="hs-identifier">sig_ty</span></a></a><span> </span><a name="local-1627933698"><a href="#local-1627933698"><span class="hs-identifier">inst_tvs</span></a></a><span>
</span><a name="line-1221"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><a href="#local-1627933699"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-1627933700"><span class="hs-identifier hs-var">sig_tvs</span></a><span> </span><a href="#local-1627933698"><span class="hs-identifier hs-var">inst_tvs</span></a><span>
</span><a name="line-1222"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1223"></a><span>    </span><a name="local-1627933699"><a href="#local-1627933699"><span class="hs-identifier">find</span></a></a><span> </span><a name="local-1627933701"><a href="#local-1627933701"><span class="hs-identifier">sig_tv</span></a></a><span> </span><a name="local-1627933702"><a href="#local-1627933702"><span class="hs-identifier">inst_tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a><span> </span><a href="#local-1627933701"><span class="hs-identifier hs-var">sig_tv</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627933702"><span class="hs-identifier hs-var">inst_tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1224"></a><span>    </span><span class="hs-special">(</span><a name="local-1627933700"><a href="#local-1627933700"><span class="hs-identifier">sig_tvs</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#tcSplitForAllTys"><span class="hs-identifier hs-var">tcSplitForAllTys</span></a><span> </span><a href="#local-1627933697"><span class="hs-identifier hs-var">sig_ty</span></a><span>
</span><a name="line-1225"></a><span>
</span><a name="line-1226"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1227"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcIdSig"><span class="hs-identifier hs-var">TcIdSig</span></a><span>     </span><a name="local-1627933985"><a href="#local-1627933985"><span class="hs-identifier">idsi</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933985"><span class="hs-identifier hs-var">idsi</span></a><span>
</span><a name="line-1228"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcPatSynSig"><span class="hs-identifier hs-var">TcPatSynSig</span></a><span> </span><a name="local-1627933986"><a href="#local-1627933986"><span class="hs-identifier">tpsi</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TcPatSynInfo&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933986"><span class="hs-identifier hs-var">tpsi</span></a><span>
</span><a name="line-1229"></a><span>
</span><a name="line-1230"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1231"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TISI"><span class="hs-identifier hs-var">TISI</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sig_bndr</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933981"><a href="#local-1627933981"><span class="hs-identifier">bndr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sig_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933982"><a href="#local-1627933982"><span class="hs-identifier">tyvars</span></a></a><span>
</span><a name="line-1232"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sig_theta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933983"><a href="#local-1627933983"><span class="hs-identifier">theta</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sig_tau</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933984"><a href="#local-1627933984"><span class="hs-identifier">tau</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1233"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#tcIdSigBndrName"><span class="hs-identifier hs-var">tcIdSigBndrName</span></a><span> </span><a href="#local-1627933981"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1234"></a><span>          </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="TyCoRep.html#pprSigmaType"><span class="hs-identifier hs-var">pprSigmaType</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="#local-1627933982"><span class="hs-identifier hs-var">tyvars</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627933983"><span class="hs-identifier hs-var">theta</span></a><span> </span><a href="#local-1627933984"><span class="hs-identifier hs-var">tau</span></a><span class="hs-special">)</span><span>
</span><a name="line-1235"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="#local-1627933982"><span class="hs-identifier hs-var">tyvars</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1236"></a><span>
</span><a name="line-1237"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#TcIdSigBndr"><span class="hs-identifier hs-type">TcIdSigBndr</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1238"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CompleteSig"><span class="hs-identifier hs-var">CompleteSig</span></a><span> </span><a name="local-1627933979"><a href="#local-1627933979"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CompleteSig&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933979"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1239"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#PartialSig"><span class="hs-identifier hs-var">PartialSig</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sig_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933980"><a href="#local-1627933980"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;PartialSig&quot;</span><span>  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933980"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1240"></a><span>
</span><a name="line-1241"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#TcPatSynInfo"><span class="hs-identifier hs-type">TcPatSynInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1242"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TPSI"><span class="hs-identifier hs-var">TPSI</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">patsig_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933978"><a href="#local-1627933978"><span class="hs-identifier">name</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933978"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1243"></a><span>
</span><a name="line-1244"></a><span class="hs-identifier">isPartialSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1245"></a><a name="isPartialSig"><a href="TcRnTypes.html#isPartialSig"><span class="hs-identifier">isPartialSig</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TISI"><span class="hs-identifier hs-var">TISI</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sig_bndr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#PartialSig"><span class="hs-identifier hs-var">PartialSig</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1246"></a><span class="hs-identifier">isPartialSig</span><span> </span><span class="hs-identifier">_</span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1247"></a><span>
</span><a name="line-1248"></a><span class="hs-comment">-- | No signature or a partial signature</span><span>
</span><a name="line-1249"></a><span class="hs-identifier">noCompleteSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1250"></a><a name="noCompleteSig"><a href="TcRnTypes.html#noCompleteSig"><span class="hs-identifier">noCompleteSig</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcIdSig"><span class="hs-identifier hs-var">TcIdSig</span></a><span> </span><a name="local-1627933703"><a href="#local-1627933703"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isPartialSig"><span class="hs-identifier hs-var">isPartialSig</span></a><span> </span><a href="#local-1627933703"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-1251"></a><span class="hs-identifier">noCompleteSig</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1252"></a><span>
</span><a name="line-1253"></a><span class="hs-identifier">tcIdSigBndrName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcIdSigBndr"><span class="hs-identifier hs-type">TcIdSigBndr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1254"></a><a name="tcIdSigBndrName"><a href="TcRnTypes.html#tcIdSigBndrName"><span class="hs-identifier">tcIdSigBndrName</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CompleteSig"><span class="hs-identifier hs-var">CompleteSig</span></a><span> </span><a name="local-1627933704"><a href="#local-1627933704"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-1627933704"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-1255"></a><span class="hs-identifier">tcIdSigBndrName</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#PartialSig"><span class="hs-identifier hs-var">PartialSig</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sig_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933705"><a href="#local-1627933705"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933705"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1256"></a><span>
</span><a name="line-1257"></a><span class="hs-identifier">tcSigInfoName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1258"></a><a name="tcSigInfoName"><a href="TcRnTypes.html#tcSigInfoName"><span class="hs-identifier">tcSigInfoName</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcIdSig"><span class="hs-identifier hs-var">TcIdSig</span></a><span>     </span><a name="local-1627933706"><a href="#local-1627933706"><span class="hs-identifier">idsi</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#tcIdSigBndrName"><span class="hs-identifier hs-var">tcIdSigBndrName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sig_bndr</span><span> </span><a href="#local-1627933706"><span class="hs-identifier hs-var">idsi</span></a><span class="hs-special">)</span><span>
</span><a name="line-1259"></a><span class="hs-identifier">tcSigInfoName</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcPatSynSig"><span class="hs-identifier hs-var">TcPatSynSig</span></a><span> </span><a name="local-1627933707"><a href="#local-1627933707"><span class="hs-identifier">tpsi</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">patsig_name</span><span> </span><a href="#local-1627933707"><span class="hs-identifier hs-var">tpsi</span></a><span>
</span><a name="line-1260"></a><span>
</span><a name="line-1261"></a><span class="hs-comment">-- Helper for cases when we know for sure we have a complete type</span><span>
</span><a name="line-1262"></a><span class="hs-comment">-- signature, e.g. class methods.</span><span>
</span><a name="line-1263"></a><span class="hs-identifier">completeIdSigPolyId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-1264"></a><a name="completeIdSigPolyId"><a href="TcRnTypes.html#completeIdSigPolyId"><span class="hs-identifier">completeIdSigPolyId</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TISI"><span class="hs-identifier hs-var">TISI</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sig_bndr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#CompleteSig"><span class="hs-identifier hs-var">CompleteSig</span></a><span> </span><a name="local-1627933708"><a href="#local-1627933708"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933708"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-1265"></a><span class="hs-identifier">completeIdSigPolyId</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;completeSigPolyId&quot;</span><span>
</span><a name="line-1266"></a><span>
</span><a name="line-1267"></a><span class="hs-identifier">completeIdSigPolyId_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-1268"></a><a name="completeIdSigPolyId_maybe"><a href="TcRnTypes.html#completeIdSigPolyId_maybe"><span class="hs-identifier">completeIdSigPolyId_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TISI"><span class="hs-identifier hs-var">TISI</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sig_bndr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#CompleteSig"><span class="hs-identifier hs-var">CompleteSig</span></a><span> </span><a name="local-1627933709"><a href="#local-1627933709"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627933709"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-1269"></a><span class="hs-identifier">completeIdSigPolyId_maybe</span><span> </span><span class="hs-identifier">_</span><span>                                    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1270"></a><span>
</span><a name="line-1271"></a><span class="hs-identifier">completeSigPolyId_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-1272"></a><a name="completeSigPolyId_maybe"><a href="TcRnTypes.html#completeSigPolyId_maybe"><span class="hs-identifier">completeSigPolyId_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcIdSig"><span class="hs-identifier hs-var">TcIdSig</span></a><span> </span><a name="local-1627933710"><a href="#local-1627933710"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#completeIdSigPolyId_maybe"><span class="hs-identifier hs-var">completeIdSigPolyId_maybe</span></a><span> </span><a href="#local-1627933710"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-1273"></a><span class="hs-identifier">completeSigPolyId_maybe</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcPatSynSig"><span class="hs-identifier hs-var">TcPatSynSig</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1274"></a><span>
</span><a name="line-1275"></a><span class="hs-comment">{-
Note [Binding scoped type variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The type variables *brought into lexical scope* by a type signature may
be a subset of the *quantified type variables* of the signatures, for two reasons:

* With kind polymorphism a signature like
    f :: forall f a. f a -&gt; f a
  may actually give rise to
    f :: forall k. forall (f::k -&gt; *) (a:k). f a -&gt; f a
  So the sig_tvs will be [k,f,a], but only f,a are scoped.
  NB: the scoped ones are not necessarily the *inital* ones!

* Even aside from kind polymorphism, there may be more instantiated
  type variables than lexically-scoped ones.  For example:
        type T a = forall b. b -&gt; (a,b)
        f :: forall c. T c
  Here, the signature for f will have one scoped type variable, c,
  but two instantiated type variables, c' and b'.

The function findScopedTyVars takes
  * hs_ty:    the original HsForAllTy
  * sig_ty:   the corresponding Type (which is guaranteed to use the same Names
              as the HsForAllTy)
  * inst_tvs: the skolems instantiated from the forall's in sig_ty
It returns a [(Maybe Name, TcTyVar)], in 1-1 correspondence with inst_tvs
but with a (Just n) for the lexically scoped name of each in-scope tyvar.

Note [sig_tau may be polymorphic]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Note that &quot;sig_tau&quot; might actually be a polymorphic type,
if the original function had a signature like
   forall a. Eq a =&gt; forall b. Ord b =&gt; ....
But that's ok: tcMatchesFun (called by tcRhs) can deal with that
It happens, too!  See Note [Polymorphic methods] in TcClassDcl.

Note [Existential check]
~~~~~~~~~~~~~~~~~~~~~~~~
Lazy patterns can't bind existentials.  They arise in two ways:
  * Let bindings      let { C a b = e } in b
  * Twiddle patterns  f ~(C a b) = e
The pe_lazy field of PatEnv says whether we are inside a lazy
pattern (perhaps deeply)

If we aren't inside a lazy pattern then we can bind existentials,
but we need to be careful about &quot;extra&quot; tyvars. Consider
    (\C x -&gt; d) : pat_ty -&gt; res_ty
When looking for existential escape we must check that the existential
bound by C don't unify with the free variables of pat_ty, OR res_ty
(or of course the environment).   Hence we need to keep track of the
res_ty free vars.

Note [Complete and partial type signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A type signature is partial when it contains one or more wildcards
(= type holes).  The wildcard can either be:
* A (type) wildcard occurring in sig_theta or sig_tau. These are
  stored in sig_wcs.
      f :: Bool -&gt; _
      g :: Eq _a =&gt; _a -&gt; _a -&gt; Bool
* Or an extra-constraints wildcard, stored in sig_cts:
      h :: (Num a, _) =&gt; a -&gt; a

A type signature is a complete type signature when there are no
wildcards in the type signature, i.e. iff sig_wcs is empty and
sig_extra_cts is Nothing. -}</span><span>
</span><a name="line-1341"></a><span>
</span><a name="line-1342"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
*                       Canonical constraints                          *
*                                                                      *
*   These are the constraints the low-level simplifier works with      *
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1351"></a><span>
</span><a name="line-1352"></a><span class="hs-comment">-- The syntax of xi types:</span><span>
</span><a name="line-1353"></a><span class="hs-comment">-- xi ::= a | T xis | xis -&gt; xis | ... | forall a. tau</span><span>
</span><a name="line-1354"></a><span class="hs-comment">-- Two important notes:</span><span>
</span><a name="line-1355"></a><span class="hs-comment">--      (i) No type families, unless we are under a ForAll</span><span>
</span><a name="line-1356"></a><span class="hs-comment">--      (ii) Note that xi types can contain unexpanded type synonyms;</span><span>
</span><a name="line-1357"></a><span class="hs-comment">--           however, the (transitive) expansions of those type synonyms</span><span>
</span><a name="line-1358"></a><span class="hs-comment">--           will not contain any type functions, unless we are under a ForAll.</span><span>
</span><a name="line-1359"></a><span class="hs-comment">-- We enforce the structure of Xi types when we flatten (TcCanonical)</span><span>
</span><a name="line-1360"></a><span>
</span><a name="line-1361"></a><span class="hs-keyword">type</span><span> </span><a name="Xi"><a href="TcRnTypes.html#Xi"><span class="hs-identifier">Xi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>       </span><span class="hs-comment">-- In many comments, &quot;xi&quot; ranges over Xi</span><span>
</span><a name="line-1362"></a><span>
</span><a name="line-1363"></a><span class="hs-keyword">type</span><span> </span><a name="Cts"><a href="TcRnTypes.html#Cts"><span class="hs-identifier">Cts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1364"></a><span>
</span><a name="line-1365"></a><span class="hs-keyword">data</span><span> </span><a name="Ct"><a href="TcRnTypes.html#Ct"><span class="hs-identifier">Ct</span></a></a><span>
</span><a name="line-1366"></a><span>  </span><span class="hs-comment">-- Atomic canonical constraints</span><span>
</span><a name="line-1367"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="CDictCan"><a href="TcRnTypes.html#CDictCan"><span class="hs-identifier">CDictCan</span></a></a><span> </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- e.g.  Num xi</span><span>
</span><a name="line-1368"></a><span>      </span><a href="TcRnTypes.html#cc_ev"><span class="hs-identifier">cc_ev</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- See Note [Ct/evidence invariant]</span><span>
</span><a name="line-1369"></a><span>      </span><a href="TcRnTypes.html#cc_class"><span class="hs-identifier">cc_class</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span class="hs-special">,</span><span>
</span><a name="line-1370"></a><span>      </span><a href="TcRnTypes.html#cc_tyargs"><span class="hs-identifier">cc_tyargs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Xi"><span class="hs-identifier hs-type">Xi</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- cc_tyargs are function-free, hence Xi</span><span>
</span><a name="line-1371"></a><span>      </span><a href="TcRnTypes.html#cc_pend_sc"><span class="hs-identifier">cc_pend_sc</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>       </span><span class="hs-comment">-- True &lt;=&gt; (a) cc_class has superclasses</span><span>
</span><a name="line-1372"></a><span>                               </span><span class="hs-comment">--          (b) we have not (yet) added those</span><span>
</span><a name="line-1373"></a><span>                               </span><span class="hs-comment">--              superclasses as Givens</span><span>
</span><a name="line-1374"></a><span>           </span><span class="hs-comment">-- NB: cc_pend_sc is used for G/W/D.  For W/D the reason</span><span>
</span><a name="line-1375"></a><span>           </span><span class="hs-comment">--     we need superclasses is to expose possible improvement</span><span>
</span><a name="line-1376"></a><span>           </span><span class="hs-comment">--     via fundeps</span><span>
</span><a name="line-1377"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1378"></a><span>
</span><a name="line-1379"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CIrredEvCan"><a href="TcRnTypes.html#CIrredEvCan"><span class="hs-identifier">CIrredEvCan</span></a></a><span> </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- These stand for yet-unusable predicates</span><span>
</span><a name="line-1380"></a><span>      </span><a href="TcRnTypes.html#cc_ev"><span class="hs-identifier">cc_ev</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span>   </span><span class="hs-comment">-- See Note [Ct/evidence invariant]</span><span>
</span><a name="line-1381"></a><span>        </span><span class="hs-comment">-- The ctev_pred of the evidence is</span><span>
</span><a name="line-1382"></a><span>        </span><span class="hs-comment">-- of form   (tv xi1 xi2 ... xin)</span><span>
</span><a name="line-1383"></a><span>        </span><span class="hs-comment">--      or   (tv1 ~ ty2)   where the CTyEqCan  kind invariant fails</span><span>
</span><a name="line-1384"></a><span>        </span><span class="hs-comment">--      or   (F tys ~ ty)  where the CFunEqCan kind invariant fails</span><span>
</span><a name="line-1385"></a><span>        </span><span class="hs-comment">-- See Note [CIrredEvCan constraints]</span><span>
</span><a name="line-1386"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1387"></a><span>
</span><a name="line-1388"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CTyEqCan"><a href="TcRnTypes.html#CTyEqCan"><span class="hs-identifier">CTyEqCan</span></a></a><span> </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- tv ~ rhs</span><span>
</span><a name="line-1389"></a><span>       </span><span class="hs-comment">-- Invariants:</span><span>
</span><a name="line-1390"></a><span>       </span><span class="hs-comment">--   * See Note [Applying the inert substitution] in TcFlatten</span><span>
</span><a name="line-1391"></a><span>       </span><span class="hs-comment">--   * tv not in tvs(rhs)   (occurs check)</span><span>
</span><a name="line-1392"></a><span>       </span><span class="hs-comment">--   * If tv is a TauTv, then rhs has no foralls</span><span>
</span><a name="line-1393"></a><span>       </span><span class="hs-comment">--       (this avoids substituting a forall for the tyvar in other types)</span><span>
</span><a name="line-1394"></a><span>       </span><span class="hs-comment">--   * typeKind ty `tcEqKind` typeKind tv</span><span>
</span><a name="line-1395"></a><span>       </span><span class="hs-comment">--   * rhs may have at most one top-level cast</span><span>
</span><a name="line-1396"></a><span>       </span><span class="hs-comment">--   * rhs (perhaps under the one cast) is not necessarily function-free,</span><span>
</span><a name="line-1397"></a><span>       </span><span class="hs-comment">--       but it has no top-level function.</span><span>
</span><a name="line-1398"></a><span>       </span><span class="hs-comment">--     E.g. a ~ [F b]  is fine</span><span>
</span><a name="line-1399"></a><span>       </span><span class="hs-comment">--     but  a ~ F b    is not</span><span>
</span><a name="line-1400"></a><span>       </span><span class="hs-comment">--   * If the equality is representational, rhs has no top-level newtype</span><span>
</span><a name="line-1401"></a><span>       </span><span class="hs-comment">--     See Note [No top-level newtypes on RHS of representational</span><span>
</span><a name="line-1402"></a><span>       </span><span class="hs-comment">--     equalities] in TcCanonical</span><span>
</span><a name="line-1403"></a><span>       </span><span class="hs-comment">--   * If rhs (perhaps under the cast) is also a tv, then it is oriented</span><span>
</span><a name="line-1404"></a><span>       </span><span class="hs-comment">--     to give best chance of</span><span>
</span><a name="line-1405"></a><span>       </span><span class="hs-comment">--     unification happening; eg if rhs is touchable then lhs is too</span><span>
</span><a name="line-1406"></a><span>      </span><a href="TcRnTypes.html#cc_ev"><span class="hs-identifier">cc_ev</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- See Note [Ct/evidence invariant]</span><span>
</span><a name="line-1407"></a><span>      </span><a href="TcRnTypes.html#cc_tyvar"><span class="hs-identifier">cc_tyvar</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-1408"></a><span>      </span><a href="TcRnTypes.html#cc_rhs"><span class="hs-identifier">cc_rhs</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Not necessarily function-free (hence not Xi)</span><span>
</span><a name="line-1409"></a><span>                               </span><span class="hs-comment">-- See invariants above</span><span>
</span><a name="line-1410"></a><span>      </span><a href="TcRnTypes.html#cc_eq_rel"><span class="hs-identifier">cc_eq_rel</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span>
</span><a name="line-1411"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1412"></a><span>
</span><a name="line-1413"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CFunEqCan"><a href="TcRnTypes.html#CFunEqCan"><span class="hs-identifier">CFunEqCan</span></a></a><span> </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- F xis ~ fsk</span><span>
</span><a name="line-1414"></a><span>       </span><span class="hs-comment">-- Invariants:</span><span>
</span><a name="line-1415"></a><span>       </span><span class="hs-comment">--   * isTypeFamilyTyCon cc_fun</span><span>
</span><a name="line-1416"></a><span>       </span><span class="hs-comment">--   * typeKind (F xis) = tyVarKind fsk</span><span>
</span><a name="line-1417"></a><span>       </span><span class="hs-comment">--   * always Nominal role</span><span>
</span><a name="line-1418"></a><span>      </span><a href="TcRnTypes.html#cc_ev"><span class="hs-identifier">cc_ev</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- See Note [Ct/evidence invariant]</span><span>
</span><a name="line-1419"></a><span>      </span><a href="TcRnTypes.html#cc_fun"><span class="hs-identifier">cc_fun</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- A type function</span><span>
</span><a name="line-1420"></a><span>
</span><a name="line-1421"></a><span>      </span><a href="TcRnTypes.html#cc_tyargs"><span class="hs-identifier">cc_tyargs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Xi"><span class="hs-identifier hs-type">Xi</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- cc_tyargs are function-free (hence Xi)</span><span>
</span><a name="line-1422"></a><span>        </span><span class="hs-comment">-- Either under-saturated or exactly saturated</span><span>
</span><a name="line-1423"></a><span>        </span><span class="hs-comment">--    *never* over-saturated (because if so</span><span>
</span><a name="line-1424"></a><span>        </span><span class="hs-comment">--    we should have decomposed)</span><span>
</span><a name="line-1425"></a><span>
</span><a name="line-1426"></a><span>      </span><a href="TcRnTypes.html#cc_fsk"><span class="hs-identifier">cc_fsk</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span>  </span><span class="hs-comment">-- [Given]  always a FlatSkol skolem</span><span>
</span><a name="line-1427"></a><span>                            </span><span class="hs-comment">-- [Wanted] always a FlatMetaTv unification variable</span><span>
</span><a name="line-1428"></a><span>        </span><span class="hs-comment">-- See Note [The flattening story] in TcFlatten</span><span>
</span><a name="line-1429"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1430"></a><span>
</span><a name="line-1431"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CNonCanonical"><a href="TcRnTypes.html#CNonCanonical"><span class="hs-identifier">CNonCanonical</span></a></a><span> </span><span class="hs-special">{</span><span>        </span><span class="hs-comment">-- See Note [NonCanonical Semantics] in TcSMonad</span><span>
</span><a name="line-1432"></a><span>      </span><a href="TcRnTypes.html#cc_ev"><span class="hs-identifier">cc_ev</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span>
</span><a name="line-1433"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1434"></a><span>
</span><a name="line-1435"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CHoleCan"><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier">CHoleCan</span></a></a><span> </span><span class="hs-special">{</span><span>             </span><span class="hs-comment">-- See Note [Hole constraints]</span><span>
</span><a name="line-1436"></a><span>       </span><span class="hs-comment">-- Treated as an &quot;insoluble&quot; constraint</span><span>
</span><a name="line-1437"></a><span>       </span><span class="hs-comment">-- See Note [Insoluble constraints]</span><span>
</span><a name="line-1438"></a><span>      </span><a href="TcRnTypes.html#cc_ev"><span class="hs-identifier">cc_ev</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span class="hs-special">,</span><span>
</span><a name="line-1439"></a><span>      </span><a href="TcRnTypes.html#cc_occ"><span class="hs-identifier">cc_occ</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- The name of this hole</span><span>
</span><a name="line-1440"></a><span>      </span><a href="TcRnTypes.html#cc_hole"><span class="hs-identifier">cc_hole</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#HoleSort"><span class="hs-identifier hs-type">HoleSort</span></a><span>   </span><span class="hs-comment">-- The sort of this hole (expr, type, ...)</span><span>
</span><a name="line-1441"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1442"></a><span>
</span><a name="line-1443"></a><span class="hs-comment">-- | Used to indicate which sort of hole we have.</span><span>
</span><a name="line-1444"></a><span class="hs-keyword">data</span><span> </span><a name="HoleSort"><a href="TcRnTypes.html#HoleSort"><span class="hs-identifier">HoleSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ExprHole"><a href="TcRnTypes.html#ExprHole"><span class="hs-identifier">ExprHole</span></a></a><span>  </span><span class="hs-comment">-- ^ A hole in an expression (TypedHoles)</span><span>
</span><a name="line-1445"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="TypeHole"><a href="TcRnTypes.html#TypeHole"><span class="hs-identifier">TypeHole</span></a></a><span>  </span><span class="hs-comment">-- ^ A hole in a type (PartialTypeSignatures)</span><span>
</span><a name="line-1446"></a><span>
</span><a name="line-1447"></a><span class="hs-comment">{-
Note [Hole constraints]
~~~~~~~~~~~~~~~~~~~~~~~
CHoleCan constraints are used for two kinds of holes,
distinguished by cc_hole:

  * For holes in expressions
    e.g.   f x = g _ x

  * For holes in type signatures
    e.g.   f :: _ -&gt; _
           f x = [x,True]

Note [CIrredEvCan constraints]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
CIrredEvCan constraints are used for constraints that are &quot;stuck&quot;
   - we can't solve them (yet)
   - we can't use them to solve other constraints
   - but they may become soluble if we substitute for some
     of the type variables in the constraint

Example 1:  (c Int), where c :: * -&gt; Constraint.  We can't do anything
            with this yet, but if later c := Num, *then* we can solve it

Example 2:  a ~ b, where a :: *, b :: k, where k is a kind variable
            We don't want to use this to substitute 'b' for 'a', in case
            'k' is subequently unifed with (say) *-&gt;*, because then
            we'd have ill-kinded types floating about.  Rather we want
            to defer using the equality altogether until 'k' get resolved.

Note [Ct/evidence invariant]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If  ct :: Ct, then extra fields of 'ct' cache precisely the ctev_pred field
of (cc_ev ct), and is fully rewritten wrt the substitution.   Eg for CDictCan,
   ctev_pred (cc_ev ct) = (cc_class ct) (cc_tyargs ct)
This holds by construction; look at the unique place where CDictCan is
built (in TcCanonical).

In contrast, the type of the evidence *term* (ccev_evtm or ctev_evar/dest) in
the evidence may *not* be fully zonked; we are careful not to look at it
during constraint solving.  See Note [Evidence field of CtEvidence]
-}</span><span>
</span><a name="line-1489"></a><span>
</span><a name="line-1490"></a><span class="hs-identifier">mkNonCanonical</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1491"></a><a name="mkNonCanonical"><a href="TcRnTypes.html#mkNonCanonical"><span class="hs-identifier">mkNonCanonical</span></a></a><span> </span><a name="local-1627933711"><a href="#local-1627933711"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#CNonCanonical"><span class="hs-identifier hs-var">CNonCanonical</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_ev</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933711"><span class="hs-identifier hs-var">ev</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1492"></a><span>
</span><a name="line-1493"></a><span class="hs-identifier">mkNonCanonicalCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1494"></a><a name="mkNonCanonicalCt"><a href="TcRnTypes.html#mkNonCanonicalCt"><span class="hs-identifier">mkNonCanonicalCt</span></a></a><span> </span><a name="local-1627933712"><a href="#local-1627933712"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#CNonCanonical"><span class="hs-identifier hs-var">CNonCanonical</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_ev</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cc_ev</span><span> </span><a href="#local-1627933712"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1495"></a><span>
</span><a name="line-1496"></a><span class="hs-identifier">ctEvidence</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span>
</span><a name="line-1497"></a><a name="ctEvidence"><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier">ctEvidence</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cc_ev</span><span>
</span><a name="line-1498"></a><span>
</span><a name="line-1499"></a><span class="hs-identifier">ctLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-1500"></a><a name="ctLoc"><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier">ctLoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvLoc"><span class="hs-identifier hs-var">ctEvLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span>
</span><a name="line-1501"></a><span>
</span><a name="line-1502"></a><span class="hs-identifier">setCtLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1503"></a><a name="setCtLoc"><a href="TcRnTypes.html#setCtLoc"><span class="hs-identifier">setCtLoc</span></a></a><span> </span><a name="local-1627933713"><a href="#local-1627933713"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1627933714"><a href="#local-1627933714"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933713"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_ev</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cc_ev</span><span> </span><a href="#local-1627933713"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933714"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1504"></a><span>
</span><a name="line-1505"></a><span class="hs-identifier">ctOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>
</span><a name="line-1506"></a><a name="ctOrigin"><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier">ctOrigin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span>
</span><a name="line-1507"></a><span>
</span><a name="line-1508"></a><span class="hs-identifier">ctPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span>
</span><a name="line-1509"></a><span class="hs-comment">-- See Note [Ct/evidence invariant]</span><span>
</span><a name="line-1510"></a><a name="ctPred"><a href="TcRnTypes.html#ctPred"><span class="hs-identifier">ctPred</span></a></a><span> </span><a name="local-1627933715"><a href="#local-1627933715"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cc_ev</span><span> </span><a href="#local-1627933715"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-1511"></a><span>
</span><a name="line-1512"></a><span class="hs-comment">-- | Convert a Wanted to a Derived</span><span>
</span><a name="line-1513"></a><span class="hs-identifier">toDerivedCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1514"></a><a name="toDerivedCt"><a href="TcRnTypes.html#toDerivedCt"><span class="hs-identifier">toDerivedCt</span></a></a><span> </span><a name="local-1627933716"><a href="#local-1627933716"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-1515"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span> </span><a href="#local-1627933716"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1516"></a><span>      </span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_pred</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933717"><a href="#local-1627933717"><span class="hs-identifier">pred</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctev_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933718"><a href="#local-1627933718"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1517"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627933716"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cc_ev</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#CtDerived"><span class="hs-identifier hs-var">CtDerived</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">ctev_pred</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933717"><span class="hs-identifier hs-var">pred</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctev_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933718"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-1518"></a><span>
</span><a name="line-1519"></a><span>      </span><a href="TcRnTypes.html#CtDerived"><span class="hs-identifier hs-var">CtDerived</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627933716"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1520"></a><span>      </span><a href="TcRnTypes.html#CtGiven"><span class="hs-identifier hs-var">CtGiven</span></a><span>   </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;to_derived&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933716"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-1521"></a><span>
</span><a name="line-1522"></a><span class="hs-comment">-- | Makes a new equality predicate with the same role as the given</span><span>
</span><a name="line-1523"></a><span class="hs-comment">-- evidence.</span><span>
</span><a name="line-1524"></a><span class="hs-identifier">mkTcEqPredLikeEv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>
</span><a name="line-1525"></a><a name="mkTcEqPredLikeEv"><a href="TcRnTypes.html#mkTcEqPredLikeEv"><span class="hs-identifier">mkTcEqPredLikeEv</span></a></a><span> </span><a name="local-1627933719"><a href="#local-1627933719"><span class="hs-identifier">ev</span></a></a><span>
</span><a name="line-1526"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#predTypeEqRel"><span class="hs-identifier hs-var">predTypeEqRel</span></a><span> </span><a href="#local-1627933720"><span class="hs-identifier hs-var">pred</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1527"></a><span>      </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#mkPrimEqPred"><span class="hs-identifier hs-var">mkPrimEqPred</span></a><span>
</span><a name="line-1528"></a><span>      </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#mkReprPrimEqPred"><span class="hs-identifier hs-var">mkReprPrimEqPred</span></a><span>
</span><a name="line-1529"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1530"></a><span>    </span><a name="local-1627933720"><a href="#local-1627933720"><span class="hs-identifier">pred</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><a href="#local-1627933719"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-1531"></a><span>
</span><a name="line-1532"></a><span class="hs-comment">-- | Get the flavour of the given 'Ct'</span><span>
</span><a name="line-1533"></a><span class="hs-identifier">ctFlavour</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtFlavour"><span class="hs-identifier hs-type">CtFlavour</span></a><span>
</span><a name="line-1534"></a><a name="ctFlavour"><a href="TcRnTypes.html#ctFlavour"><span class="hs-identifier">ctFlavour</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvFlavour"><span class="hs-identifier hs-var">ctEvFlavour</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span>
</span><a name="line-1535"></a><span>
</span><a name="line-1536"></a><span class="hs-comment">-- | Get the equality relation for the given 'Ct'</span><span>
</span><a name="line-1537"></a><span class="hs-identifier">ctEqRel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span>
</span><a name="line-1538"></a><a name="ctEqRel"><a href="TcRnTypes.html#ctEqRel"><span class="hs-identifier">ctEqRel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvEqRel"><span class="hs-identifier hs-var">ctEvEqRel</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span>
</span><a name="line-1539"></a><span>
</span><a name="line-1540"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1541"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-1627933974"><a href="#local-1627933974"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cc_ev</span><span> </span><a href="#local-1627933974"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><a href="#local-1627933975"><span class="hs-identifier hs-var">pp_sort</span></a><span>
</span><a name="line-1542"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1543"></a><span>      </span><a name="local-1627933975"><a href="#local-1627933975"><span class="hs-identifier">pp_sort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627933974"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1544"></a><span>         </span><a href="TcRnTypes.html#CTyEqCan"><span class="hs-identifier hs-var">CTyEqCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CTyEqCan&quot;</span><span>
</span><a name="line-1545"></a><span>         </span><a href="TcRnTypes.html#CFunEqCan"><span class="hs-identifier hs-var">CFunEqCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CFunEqCan&quot;</span><span>
</span><a name="line-1546"></a><span>         </span><a href="TcRnTypes.html#CNonCanonical"><span class="hs-identifier hs-var">CNonCanonical</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CNonCanonical&quot;</span><span>
</span><a name="line-1547"></a><span>         </span><a href="TcRnTypes.html#CDictCan"><span class="hs-identifier hs-var">CDictCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_pend_sc</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933976"><a href="#local-1627933976"><span class="hs-identifier">pend_sc</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1548"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627933976"><span class="hs-identifier hs-var">pend_sc</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CDictCan(psc)&quot;</span><span>
</span><a name="line-1549"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CDictCan&quot;</span><span>
</span><a name="line-1550"></a><span>         </span><a href="TcRnTypes.html#CIrredEvCan"><span class="hs-identifier hs-var">CIrredEvCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CIrredEvCan&quot;</span><span>
</span><a name="line-1551"></a><span>         </span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933977"><a href="#local-1627933977"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CHoleCan:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933977"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1552"></a><span>
</span><a name="line-1553"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Simple functions over evidence variables
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1560"></a><span>
</span><a name="line-1561"></a><span class="hs-comment">---------------- Getting free tyvars -------------------------</span><span>
</span><a name="line-1562"></a><span>
</span><a name="line-1563"></a><span class="hs-comment">-- | Returns free variables of constraints as a non-deterministic set</span><span>
</span><a name="line-1564"></a><span class="hs-identifier">tyCoVarsOfCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyCoVarSet"><span class="hs-identifier hs-type">TcTyCoVarSet</span></a><span>
</span><a name="line-1565"></a><a name="tyCoVarsOfCt"><a href="TcRnTypes.html#tyCoVarsOfCt"><span class="hs-identifier">tyCoVarsOfCt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FV.html#runFVSet"><span class="hs-identifier hs-var">runFVSet</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#tyCoVarsOfCtAcc"><span class="hs-identifier hs-var">tyCoVarsOfCtAcc</span></a><span>
</span><a name="line-1566"></a><span>
</span><a name="line-1567"></a><span class="hs-comment">-- | Returns free variables of constraints as a deterministically ordered.</span><span>
</span><a name="line-1568"></a><span class="hs-comment">-- list. See Note [Deterministic FV] in FV.</span><span>
</span><a name="line-1569"></a><span class="hs-identifier">tyCoVarsOfCtList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyCoVar"><span class="hs-identifier hs-type">TcTyCoVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1570"></a><a name="tyCoVarsOfCtList"><a href="TcRnTypes.html#tyCoVarsOfCtList"><span class="hs-identifier">tyCoVarsOfCtList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FV.html#runFVList"><span class="hs-identifier hs-var">runFVList</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#tyCoVarsOfCtAcc"><span class="hs-identifier hs-var">tyCoVarsOfCtAcc</span></a><span>
</span><a name="line-1571"></a><span>
</span><a name="line-1572"></a><span class="hs-comment">-- | Returns free variables of constraints as a composable FV computation.</span><span>
</span><a name="line-1573"></a><span class="hs-comment">-- See Note [Deterministic FV] in FV.</span><span>
</span><a name="line-1574"></a><span class="hs-identifier">tyCoVarsOfCtAcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FV.html#FV"><span class="hs-identifier hs-type">FV</span></a><span>
</span><a name="line-1575"></a><a name="tyCoVarsOfCtAcc"><a href="TcRnTypes.html#tyCoVarsOfCtAcc"><span class="hs-identifier">tyCoVarsOfCtAcc</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CTyEqCan"><span class="hs-identifier hs-var">CTyEqCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_tyvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933721"><a href="#local-1627933721"><span class="hs-identifier">tv</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cc_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933722"><a href="#local-1627933722"><span class="hs-identifier">xi</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1576"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypeAcc</span></a><span> </span><a href="#local-1627933722"><span class="hs-identifier hs-var">xi</span></a><span> </span><span class="hs-special">`</span><a href="FV.html#unionFV"><span class="hs-identifier hs-var">unionFV</span></a><span class="hs-special">`</span><span> </span><a href="FV.html#oneVar"><span class="hs-identifier hs-var">oneVar</span></a><span> </span><a href="#local-1627933721"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="FV.html#unionFV"><span class="hs-identifier hs-var">unionFV</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypeAcc</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627933721"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1577"></a><span class="hs-identifier">tyCoVarsOfCtAcc</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CFunEqCan"><span class="hs-identifier hs-var">CFunEqCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_tyargs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933723"><a href="#local-1627933723"><span class="hs-identifier">tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cc_fsk</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933724"><a href="#local-1627933724"><span class="hs-identifier">fsk</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1578"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypesAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypesAcc</span></a><span> </span><a href="#local-1627933723"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="FV.html#unionFV"><span class="hs-identifier hs-var">unionFV</span></a><span class="hs-special">`</span><span> </span><a href="FV.html#oneVar"><span class="hs-identifier hs-var">oneVar</span></a><span> </span><a href="#local-1627933724"><span class="hs-identifier hs-var">fsk</span></a><span> </span><span class="hs-special">`</span><a href="FV.html#unionFV"><span class="hs-identifier hs-var">unionFV</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypeAcc</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627933724"><span class="hs-identifier hs-var">fsk</span></a><span class="hs-special">)</span><span>
</span><a name="line-1579"></a><span class="hs-identifier">tyCoVarsOfCtAcc</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CDictCan"><span class="hs-identifier hs-var">CDictCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_tyargs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933725"><a href="#local-1627933725"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypesAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypesAcc</span></a><span> </span><a href="#local-1627933725"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1580"></a><span class="hs-identifier">tyCoVarsOfCtAcc</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CIrredEvCan"><span class="hs-identifier hs-var">CIrredEvCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_ev</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933726"><a href="#local-1627933726"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypeAcc</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><a href="#local-1627933726"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">)</span><span>
</span><a name="line-1581"></a><span class="hs-identifier">tyCoVarsOfCtAcc</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_ev</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933727"><a href="#local-1627933727"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypeAcc</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><a href="#local-1627933727"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">)</span><span>
</span><a name="line-1582"></a><span class="hs-identifier">tyCoVarsOfCtAcc</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CNonCanonical"><span class="hs-identifier hs-var">CNonCanonical</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_ev</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933728"><a href="#local-1627933728"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypeAcc</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><a href="#local-1627933728"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">)</span><span>
</span><a name="line-1583"></a><span>
</span><a name="line-1584"></a><span class="hs-comment">-- | Returns free variables of a bag of constraints as a non-deterministic</span><span>
</span><a name="line-1585"></a><span class="hs-comment">-- set. See Note [Deterministic FV] in FV.</span><span>
</span><a name="line-1586"></a><span class="hs-identifier">tyCoVarsOfCts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyCoVarSet"><span class="hs-identifier hs-type">TcTyCoVarSet</span></a><span>
</span><a name="line-1587"></a><a name="tyCoVarsOfCts"><a href="TcRnTypes.html#tyCoVarsOfCts"><span class="hs-identifier">tyCoVarsOfCts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FV.html#runFVSet"><span class="hs-identifier hs-var">runFVSet</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#tyCoVarsOfCtsAcc"><span class="hs-identifier hs-var">tyCoVarsOfCtsAcc</span></a><span>
</span><a name="line-1588"></a><span>
</span><a name="line-1589"></a><span class="hs-comment">-- | Returns free variables of a bag of constraints as a deterministically</span><span>
</span><a name="line-1590"></a><span class="hs-comment">-- odered list. See Note [Deterministic FV] in FV.</span><span>
</span><a name="line-1591"></a><span class="hs-identifier">tyCoVarsOfCtsList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyCoVar"><span class="hs-identifier hs-type">TcTyCoVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1592"></a><a name="tyCoVarsOfCtsList"><a href="TcRnTypes.html#tyCoVarsOfCtsList"><span class="hs-identifier">tyCoVarsOfCtsList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FV.html#runFVList"><span class="hs-identifier hs-var">runFVList</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#tyCoVarsOfCtsAcc"><span class="hs-identifier hs-var">tyCoVarsOfCtsAcc</span></a><span>
</span><a name="line-1593"></a><span>
</span><a name="line-1594"></a><span class="hs-comment">-- | Returns free variables of a bag of constraints as a composable FV</span><span>
</span><a name="line-1595"></a><span class="hs-comment">-- computation. See Note [Deterministic FV] in FV.</span><span>
</span><a name="line-1596"></a><span class="hs-identifier">tyCoVarsOfCtsAcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FV.html#FV"><span class="hs-identifier hs-type">FV</span></a><span>
</span><a name="line-1597"></a><a name="tyCoVarsOfCtsAcc"><a href="TcRnTypes.html#tyCoVarsOfCtsAcc"><span class="hs-identifier">tyCoVarsOfCtsAcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><span class="hs-special">(</span><a href="FV.html#unionFV"><span class="hs-identifier hs-var">unionFV</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#tyCoVarsOfCtAcc"><span class="hs-identifier hs-var">tyCoVarsOfCtAcc</span></a><span class="hs-special">)</span><span> </span><a href="FV.html#noVars"><span class="hs-identifier hs-var">noVars</span></a><span>
</span><a name="line-1598"></a><span>
</span><a name="line-1599"></a><span class="hs-identifier">tyCoVarsOfWC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-1600"></a><span class="hs-comment">-- Only called on *zonked* things, hence no need to worry about flatten-skolems</span><span>
</span><a name="line-1601"></a><a name="tyCoVarsOfWC"><a href="TcRnTypes.html#tyCoVarsOfWC"><span class="hs-identifier">tyCoVarsOfWC</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933729"><a href="#local-1627933729"><span class="hs-identifier">simple</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933730"><a href="#local-1627933730"><span class="hs-identifier">implic</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933731"><a href="#local-1627933731"><span class="hs-identifier">insol</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1602"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#tyCoVarsOfCts"><span class="hs-identifier hs-var">tyCoVarsOfCts</span></a><span> </span><a href="#local-1627933729"><span class="hs-identifier hs-var">simple</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span>
</span><a name="line-1603"></a><span>    </span><a href="TcRnTypes.html#tyCoVarsOfBag"><span class="hs-identifier hs-var">tyCoVarsOfBag</span></a><span> </span><a href="TcRnTypes.html#tyCoVarsOfImplic"><span class="hs-identifier hs-var">tyCoVarsOfImplic</span></a><span> </span><a href="#local-1627933730"><span class="hs-identifier hs-var">implic</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span>
</span><a name="line-1604"></a><span>    </span><a href="TcRnTypes.html#tyCoVarsOfCts"><span class="hs-identifier hs-var">tyCoVarsOfCts</span></a><span> </span><a href="#local-1627933731"><span class="hs-identifier hs-var">insol</span></a><span>
</span><a name="line-1605"></a><span>
</span><a name="line-1606"></a><span class="hs-identifier">tyCoVarsOfImplic</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-1607"></a><span class="hs-comment">-- Only called on *zonked* things, hence no need to worry about flatten-skolems</span><span>
</span><a name="line-1608"></a><a name="tyCoVarsOfImplic"><a href="TcRnTypes.html#tyCoVarsOfImplic"><span class="hs-identifier">tyCoVarsOfImplic</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933732"><a href="#local-1627933732"><span class="hs-identifier">skols</span></a></a><span>
</span><a name="line-1609"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933733"><a href="#local-1627933733"><span class="hs-identifier">givens</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_wanted</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933734"><a href="#local-1627933734"><span class="hs-identifier">wanted</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1610"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#tyCoVarsOfWC"><span class="hs-identifier hs-var">tyCoVarsOfWC</span></a><span> </span><a href="#local-1627933734"><span class="hs-identifier hs-var">wanted</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcType.html#evVarPred"><span class="hs-identifier hs-var">evVarPred</span></a><span> </span><a href="#local-1627933733"><span class="hs-identifier hs-var">givens</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1611"></a><span>    </span><span class="hs-special">`</span><a href="VarSet.html#delVarSetList"><span class="hs-identifier hs-var">delVarSetList</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933732"><span class="hs-identifier hs-var">skols</span></a><span>
</span><a name="line-1612"></a><span>
</span><a name="line-1613"></a><span class="hs-identifier">tyCoVarsOfBag</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627933668"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="#local-1627933668"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-1614"></a><a name="tyCoVarsOfBag"><a href="TcRnTypes.html#tyCoVarsOfBag"><span class="hs-identifier">tyCoVarsOfBag</span></a></a><span> </span><a name="local-1627933735"><a href="#local-1627933735"><span class="hs-identifier">tvs_of</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><span class="hs-special">(</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-1627933735"><span class="hs-identifier hs-var">tvs_of</span></a><span class="hs-special">)</span><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span>
</span><a name="line-1615"></a><span>
</span><a name="line-1616"></a><span class="hs-comment">--------------------------</span><span>
</span><a name="line-1617"></a><span class="hs-identifier">dropDerivedSimples</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1618"></a><a name="dropDerivedSimples"><a href="TcRnTypes.html#dropDerivedSimples"><span class="hs-identifier">dropDerivedSimples</span></a></a><span> </span><a name="local-1627933736"><a href="#local-1627933736"><span class="hs-identifier">simples</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#filterBag"><span class="hs-identifier hs-var">filterBag</span></a><span> </span><a href="TcRnTypes.html#isWantedCt"><span class="hs-identifier hs-var">isWantedCt</span></a><span> </span><a href="#local-1627933736"><span class="hs-identifier hs-var">simples</span></a><span>
</span><a name="line-1619"></a><span>                             </span><span class="hs-comment">-- simples are all Wanted or Derived</span><span>
</span><a name="line-1620"></a><span>
</span><a name="line-1621"></a><span class="hs-identifier">dropDerivedInsols</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1622"></a><span class="hs-comment">-- See Note [Dropping derived constraints]</span><span>
</span><a name="line-1623"></a><a name="dropDerivedInsols"><a href="TcRnTypes.html#dropDerivedInsols"><span class="hs-identifier">dropDerivedInsols</span></a></a><span> </span><a name="local-1627933737"><a href="#local-1627933737"><span class="hs-identifier">insols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#filterBag"><span class="hs-identifier hs-var">filterBag</span></a><span> </span><a href="#local-1627933738"><span class="hs-identifier hs-var">keep</span></a><span> </span><a href="#local-1627933737"><span class="hs-identifier hs-var">insols</span></a><span>
</span><a name="line-1624"></a><span>  </span><span class="hs-keyword">where</span><span>                    </span><span class="hs-comment">-- insols can include Given</span><span>
</span><a name="line-1625"></a><span>    </span><a name="local-1627933738"><a href="#local-1627933738"><span class="hs-identifier">keep</span></a></a><span> </span><a name="local-1627933739"><a href="#local-1627933739"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-1626"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#isDerivedCt"><span class="hs-identifier hs-var">isDerivedCt</span></a><span> </span><a href="#local-1627933739"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#isDroppableDerivedLoc"><span class="hs-identifier hs-var">isDroppableDerivedLoc</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1627933739"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1627"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1628"></a><span>
</span><a name="line-1629"></a><span class="hs-identifier">isDroppableDerivedLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1630"></a><span class="hs-comment">-- Note [Dropping derived constraints]</span><span>
</span><a name="line-1631"></a><a name="isDroppableDerivedLoc"><a href="TcRnTypes.html#isDroppableDerivedLoc"><span class="hs-identifier">isDroppableDerivedLoc</span></a></a><span> </span><a name="local-1627933740"><a href="#local-1627933740"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-1632"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="#local-1627933740"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1633"></a><span>      </span><a href="TcRnTypes.html#HoleOrigin"><span class="hs-identifier hs-var">HoleOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1634"></a><span>      </span><a href="TcRnTypes.html#KindEqOrigin"><span class="hs-identifier hs-var">KindEqOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1635"></a><span>      </span><a href="TcRnTypes.html#GivenOrigin"><span class="hs-identifier hs-var">GivenOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1636"></a><span>      </span><a href="TcRnTypes.html#FunDepOrigin1"><span class="hs-identifier hs-var">FunDepOrigin1</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1637"></a><span>      </span><a href="TcRnTypes.html#FunDepOrigin2"><span class="hs-identifier hs-var">FunDepOrigin2</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1638"></a><span>      </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1639"></a><span>
</span><a name="line-1640"></a><span class="hs-identifier">arisesFromGivens</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1641"></a><a name="arisesFromGivens"><a href="TcRnTypes.html#arisesFromGivens"><span class="hs-identifier">arisesFromGivens</span></a></a><span> </span><a name="local-1627933741"><a href="#local-1627933741"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-1642"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span> </span><a href="#local-1627933741"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1643"></a><span>      </span><a href="TcRnTypes.html#CtGiven"><span class="hs-identifier hs-var">CtGiven</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1644"></a><span>      </span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1645"></a><span>      </span><a href="TcRnTypes.html#CtDerived"><span class="hs-identifier hs-var">CtDerived</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933748"><a href="#local-1627933748"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627933742"><span class="hs-identifier hs-var">from_given</span></a><span> </span><a href="#local-1627933748"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-1646"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1647"></a><span>   </span><span class="hs-identifier">from_given</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1648"></a><span>   </span><a name="local-1627933742"><a href="#local-1627933742"><span class="hs-identifier">from_given</span></a></a><span> </span><a name="local-1627933744"><a href="#local-1627933744"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933743"><span class="hs-identifier hs-var">from_given_origin</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="#local-1627933744"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1649"></a><span>
</span><a name="line-1650"></a><span>   </span><span class="hs-identifier">from_given_origin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1651"></a><span>   </span><a name="local-1627933743"><a href="#local-1627933743"><span class="hs-identifier">from_given_origin</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#GivenOrigin"><span class="hs-identifier hs-var">GivenOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1652"></a><span>   </span><span class="hs-identifier">from_given_origin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#FunDepOrigin1"><span class="hs-identifier hs-var">FunDepOrigin1</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933745"><a href="#local-1627933745"><span class="hs-identifier">l1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933746"><a href="#local-1627933746"><span class="hs-identifier">l2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933742"><span class="hs-identifier hs-var">from_given</span></a><span> </span><a href="#local-1627933745"><span class="hs-identifier hs-var">l1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1627933742"><span class="hs-identifier hs-var">from_given</span></a><span> </span><a href="#local-1627933746"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-1653"></a><span>   </span><span class="hs-identifier">from_given_origin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#FunDepOrigin2"><span class="hs-identifier hs-var">FunDepOrigin2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933747"><a href="#local-1627933747"><span class="hs-identifier">o1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933743"><span class="hs-identifier hs-var">from_given_origin</span></a><span> </span><a href="#local-1627933747"><span class="hs-identifier hs-var">o1</span></a><span>
</span><a name="line-1654"></a><span>   </span><span class="hs-identifier">from_given_origin</span><span> </span><span class="hs-identifier">_</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1655"></a><span>
</span><a name="line-1656"></a><span class="hs-comment">{- Note [Dropping derived constraints]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In general we discard derived constraints at the end of constraint solving;
see dropDerivedWC.  For example

 * If we have an unsolved [W] (Ord a), we don't want to complain about
   an unsolved [D] (Eq a) as well.

 * If we have [W] a ~ Int, [W] a ~ Bool, improvement will generate
   [D] Int ~ Bool, and we don't want to report that because it's incomprehensible.
   That is why we don't rewrite wanteds with wanteds!

But (tiresomely) we do keep *some* Derived insolubles:

 * Insoluble kind equalities (e.g. [D] * ~ (* -&gt; *)) may arise from
   a type equality a ~ Int#, say.  In future they'll be Wanted, not Derived,
   but at the moment they are Derived.

 * Insoluble derived equalities (e.g. [D] Int ~ Bool) may arise from
   functional dependency interactions, either between Givens or
   Wanteds.  It seems sensible to retain these:
   - For Givens they reflect unreachable code
   - For Wanteds it is arguably better to get a fundep error than
     a no-instance error (Trac #9612)

 * Type holes are derived constraints because they have no evidence
   and we want to keep them so we get the error report

Moreover, we keep *all* derived insolubles under some circumstances:

  * They are looked at by simplifyInfer, to decide whether to
    generalise.  Example: [W] a ~ Int, [W] a ~ Bool
    We get [D] Int ~ Bool, and indeed the constraints are insoluble,
    and we want simplifyInfer to see that, even though we don't
    ultimately want to generate an (inexplicable) error message from

To distinguish these cases we use the CtOrigin.


************************************************************************
*                                                                      *
                    CtEvidence
         The &quot;flavor&quot; of a canonical constraint
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1702"></a><span>
</span><a name="line-1703"></a><span class="hs-identifier">isWantedCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1704"></a><a name="isWantedCt"><a href="TcRnTypes.html#isWantedCt"><span class="hs-identifier">isWantedCt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isWanted"><span class="hs-identifier hs-var">isWanted</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">cc_ev</span><span>
</span><a name="line-1705"></a><span>
</span><a name="line-1706"></a><span class="hs-identifier">isGivenCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1707"></a><a name="isGivenCt"><a href="TcRnTypes.html#isGivenCt"><span class="hs-identifier">isGivenCt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isGiven"><span class="hs-identifier hs-var">isGiven</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">cc_ev</span><span>
</span><a name="line-1708"></a><span>
</span><a name="line-1709"></a><span class="hs-identifier">isDerivedCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1710"></a><a name="isDerivedCt"><a href="TcRnTypes.html#isDerivedCt"><span class="hs-identifier">isDerivedCt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isDerived"><span class="hs-identifier hs-var">isDerived</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">cc_ev</span><span>
</span><a name="line-1711"></a><span>
</span><a name="line-1712"></a><span class="hs-identifier">isCTyEqCan</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1713"></a><a name="isCTyEqCan"><a href="TcRnTypes.html#isCTyEqCan"><span class="hs-identifier">isCTyEqCan</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CTyEqCan"><span class="hs-identifier hs-var">CTyEqCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1714"></a><span class="hs-identifier">isCTyEqCan</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CFunEqCan"><span class="hs-identifier hs-var">CFunEqCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1715"></a><span class="hs-identifier">isCTyEqCan</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1716"></a><span>
</span><a name="line-1717"></a><span class="hs-identifier">isCDictCan_Maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span>
</span><a name="line-1718"></a><a name="isCDictCan_Maybe"><a href="TcRnTypes.html#isCDictCan_Maybe"><span class="hs-identifier">isCDictCan_Maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CDictCan"><span class="hs-identifier hs-var">CDictCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cc_class</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933749"><a href="#local-1627933749"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627933749"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-1719"></a><span class="hs-identifier">isCDictCan_Maybe</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1720"></a><span>
</span><a name="line-1721"></a><span class="hs-identifier">isCIrredEvCan</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1722"></a><a name="isCIrredEvCan"><a href="TcRnTypes.html#isCIrredEvCan"><span class="hs-identifier">isCIrredEvCan</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CIrredEvCan"><span class="hs-identifier hs-var">CIrredEvCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1723"></a><span class="hs-identifier">isCIrredEvCan</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1724"></a><span>
</span><a name="line-1725"></a><span class="hs-identifier">isCFunEqCan_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1726"></a><a name="isCFunEqCan_maybe"><a href="TcRnTypes.html#isCFunEqCan_maybe"><span class="hs-identifier">isCFunEqCan_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CFunEqCan"><span class="hs-identifier hs-var">CFunEqCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_fun</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933750"><a href="#local-1627933750"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cc_tyargs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933751"><a href="#local-1627933751"><span class="hs-identifier">xis</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627933750"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627933751"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">)</span><span>
</span><a name="line-1727"></a><span class="hs-identifier">isCFunEqCan_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1728"></a><span>
</span><a name="line-1729"></a><span class="hs-identifier">isCFunEqCan</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1730"></a><a name="isCFunEqCan"><a href="TcRnTypes.html#isCFunEqCan"><span class="hs-identifier">isCFunEqCan</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CFunEqCan"><span class="hs-identifier hs-var">CFunEqCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1731"></a><span class="hs-identifier">isCFunEqCan</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1732"></a><span>
</span><a name="line-1733"></a><span class="hs-identifier">isCNonCanonical</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1734"></a><a name="isCNonCanonical"><a href="TcRnTypes.html#isCNonCanonical"><span class="hs-identifier">isCNonCanonical</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CNonCanonical"><span class="hs-identifier hs-var">CNonCanonical</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1735"></a><span class="hs-identifier">isCNonCanonical</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1736"></a><span>
</span><a name="line-1737"></a><span class="hs-identifier">isHoleCt</span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1738"></a><a name="isHoleCt"><a href="TcRnTypes.html#isHoleCt"><span class="hs-identifier">isHoleCt</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1739"></a><span class="hs-identifier">isHoleCt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1740"></a><span>
</span><a name="line-1741"></a><span class="hs-identifier">isOutOfScopeCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1742"></a><span class="hs-comment">-- A Hole that does not have a leading underscore is</span><span>
</span><a name="line-1743"></a><span class="hs-comment">-- simply an out-of-scope variable, and we treat that</span><span>
</span><a name="line-1744"></a><span class="hs-comment">-- a bit differently when it comes to error reporting</span><span>
</span><a name="line-1745"></a><a name="isOutOfScopeCt"><a href="TcRnTypes.html#isOutOfScopeCt"><span class="hs-identifier">isOutOfScopeCt</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933752"><a href="#local-1627933752"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="OccName.html#startsWithUnderscore"><span class="hs-identifier hs-var">startsWithUnderscore</span></a><span> </span><a href="#local-1627933752"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-1746"></a><span class="hs-identifier">isOutOfScopeCt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1747"></a><span>
</span><a name="line-1748"></a><span class="hs-identifier">isExprHoleCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1749"></a><a name="isExprHoleCt"><a href="TcRnTypes.html#isExprHoleCt"><span class="hs-identifier">isExprHoleCt</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_hole</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ExprHole"><span class="hs-identifier hs-var">ExprHole</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1750"></a><span class="hs-identifier">isExprHoleCt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1751"></a><span>
</span><a name="line-1752"></a><span class="hs-identifier">isTypeHoleCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1753"></a><a name="isTypeHoleCt"><a href="TcRnTypes.html#isTypeHoleCt"><span class="hs-identifier">isTypeHoleCt</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_hole</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TypeHole"><span class="hs-identifier hs-var">TypeHole</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1754"></a><span class="hs-identifier">isTypeHoleCt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1755"></a><span>
</span><a name="line-1756"></a><span class="hs-comment">-- | The following constraints are considered to be a custom type error:</span><span>
</span><a name="line-1757"></a><span class="hs-comment">--    1. TypeError msg a b c</span><span>
</span><a name="line-1758"></a><span class="hs-comment">--    2. TypeError msg a b c ~ Something (and the other way around)</span><span>
</span><a name="line-1759"></a><span class="hs-comment">--    4. C (TypeError msg a b c)         (for any parameter of class constraint)</span><span>
</span><a name="line-1760"></a><span class="hs-identifier">getUserTypeErrorMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1761"></a><a name="getUserTypeErrorMsg"><a href="TcRnTypes.html#getUserTypeErrorMsg"><span class="hs-identifier">getUserTypeErrorMsg</span></a></a><span> </span><a name="local-1627933753"><a href="#local-1627933753"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-1762"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1627933757"><a href="#local-1627933757"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-1627933758"><a href="#local-1627933758"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#getEqPredTys_maybe"><span class="hs-identifier hs-var">getEqPredTys_maybe</span></a><span> </span><a href="#local-1627933754"><span class="hs-identifier hs-var">ctT</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933755"><span class="hs-identifier hs-var">oneOf</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627933757"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><a href="#local-1627933758"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1763"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1627933759"><a href="#local-1627933759"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#getClassPredTys_maybe"><span class="hs-identifier hs-var">getClassPredTys_maybe</span></a><span> </span><a href="#local-1627933754"><span class="hs-identifier hs-var">ctT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933755"><span class="hs-identifier hs-var">oneOf</span></a><span> </span><a href="#local-1627933759"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-1764"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                                   </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#userTypeError_maybe"><span class="hs-identifier hs-var">userTypeError_maybe</span></a><span> </span><a href="#local-1627933754"><span class="hs-identifier hs-var">ctT</span></a><span>
</span><a name="line-1765"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1766"></a><span>  </span><a name="local-1627933754"><a href="#local-1627933754"><span class="hs-identifier">ctT</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1627933753"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1767"></a><span>  </span><a name="local-1627933755"><a href="#local-1627933755"><span class="hs-identifier">oneOf</span></a></a><span> </span><a name="local-1627933756"><a href="#local-1627933756"><span class="hs-identifier">xs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#msum"><span class="hs-identifier hs-var">msum</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Type.html#userTypeError_maybe"><span class="hs-identifier hs-var">userTypeError_maybe</span></a><span> </span><a href="#local-1627933756"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1768"></a><span>
</span><a name="line-1769"></a><span class="hs-identifier">isUserTypeErrorCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1770"></a><a name="isUserTypeErrorCt"><a href="TcRnTypes.html#isUserTypeErrorCt"><span class="hs-identifier">isUserTypeErrorCt</span></a></a><span> </span><a name="local-1627933760"><a href="#local-1627933760"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#getUserTypeErrorMsg"><span class="hs-identifier hs-var">getUserTypeErrorMsg</span></a><span> </span><a href="#local-1627933760"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1771"></a><span>                         </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1772"></a><span>                         </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1773"></a><span>
</span><a name="line-1774"></a><span class="hs-identifier">isPendingScDict</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1775"></a><span class="hs-comment">-- Says whether cc_pend_sc is True, AND if so flips the flag</span><span>
</span><a name="line-1776"></a><a name="isPendingScDict"><a href="TcRnTypes.html#isPendingScDict"><span class="hs-identifier">isPendingScDict</span></a></a><span> </span><a name="local-1627933761"><a href="#local-1627933761"><span class="hs-identifier">ct</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CDictCan"><span class="hs-identifier hs-var">CDictCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_pend_sc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1777"></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627933761"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_pend_sc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1778"></a><span class="hs-identifier">isPendingScDict</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1779"></a><span>
</span><a name="line-1780"></a><span class="hs-comment">-- | Are we looking at an Implicit CallStack</span><span>
</span><a name="line-1781"></a><span class="hs-comment">-- (i.e. @IP &quot;name&quot; CallStack@)?</span><span>
</span><a name="line-1782"></a><span class="hs-comment">--</span><span>
</span><a name="line-1783"></a><span class="hs-comment">-- If so, returns @Just &quot;name&quot;@.</span><span>
</span><a name="line-1784"></a><span class="hs-identifier">isCallStackDict</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span>
</span><a name="line-1785"></a><a name="isCallStackDict"><a href="TcRnTypes.html#isCallStackDict"><span class="hs-identifier">isCallStackDict</span></a></a><span> </span><a name="local-1627933762"><a href="#local-1627933762"><span class="hs-identifier">cls</span></a></a><span> </span><a name="local-1627933763"><a href="#local-1627933763"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1786"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627933762"><span class="hs-identifier hs-var">cls</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ipClassKey"><span class="hs-identifier hs-var">ipClassKey</span></a><span>
</span><a name="line-1787"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-1627933764"><a href="#local-1627933764"><span class="hs-identifier">ip_name_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627933765"><a href="#local-1627933765"><span class="hs-identifier">ty</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627933763"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1788"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627933766"><a href="#local-1627933766"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627933765"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1789"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1627933766"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#callStackTyConKey"><span class="hs-identifier hs-var">callStackTyConKey</span></a><span>
</span><a name="line-1790"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span> </span><a href="#local-1627933764"><span class="hs-identifier hs-var">ip_name_ty</span></a><span>
</span><a name="line-1791"></a><span class="hs-identifier">isCallStackDict</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1792"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1793"></a><span>
</span><a name="line-1794"></a><span class="hs-identifier">superClassesMightHelp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1795"></a><span class="hs-comment">-- ^ True if taking superclasses of givens, or of wanteds (to perhaps</span><span>
</span><a name="line-1796"></a><span class="hs-comment">-- expose more equalities or functional dependencies) might help to</span><span>
</span><a name="line-1797"></a><span class="hs-comment">-- solve this constraint.  See Note [When superclases help]</span><span>
</span><a name="line-1798"></a><a name="superClassesMightHelp"><a href="TcRnTypes.html#superClassesMightHelp"><span class="hs-identifier">superClassesMightHelp</span></a></a><span> </span><a name="local-1627933767"><a href="#local-1627933767"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-1799"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isWantedCt"><span class="hs-identifier hs-var">isWantedCt</span></a><span> </span><a href="#local-1627933767"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-1627933768"><span class="hs-identifier hs-var">is_ip</span></a><span> </span><a href="#local-1627933767"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-1800"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1801"></a><span>    </span><a name="local-1627933768"><a href="#local-1627933768"><span class="hs-identifier">is_ip</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CDictCan"><span class="hs-identifier hs-var">CDictCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_class</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933769"><a href="#local-1627933769"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isIPClass"><span class="hs-identifier hs-var">isIPClass</span></a><span> </span><a href="#local-1627933769"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-1802"></a><span>    </span><span class="hs-identifier">is_ip</span><span> </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1803"></a><span>
</span><a name="line-1804"></a><span class="hs-comment">{- Note [When superclasses help]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
First read Note [The superclass story] in TcCanonical.

We expand superclasses and iterate only if there is at unsolved wanted
for which expansion of superclasses (e.g. from given constraints)
might actually help. The function superClassesMightHelp tells if
doing this superclass expansion might help solve this constraint.
Note that

  * Superclasses help only for Wanted constraints.  Derived constraints
    are not really &quot;unsolved&quot; and we certainly don't want them to
    trigger superclass expansion. This was a good part of the loop
    in  Trac #11523

  * Even for Wanted constraints, we say &quot;no&quot; for implicit paramters.
    we have [W] ?x::ty, expanding superclasses won't help:
      - Superclasses can't be implicit parameters
      - If we have a [G] ?x:ty2, then we'll have another unsolved
        [D] ty ~ ty2 (from the functional dependency)
        which will trigger superclass expansion.

    It's a bit of a special case, but it's easy to do.  The runtime cost
    is low because the unsolved set is usually empty anyway (errors
    aside), and the first non-imlicit-parameter will terminate the search.

    The special case is worth it (Trac #11480, comment:2) because it
    applies to CallStack constraints, which aren't type errors. If we have
       f :: (C a) =&gt; blah
       f x = ...undefined...
    we'll get a CallStack constraint.  If that's the only unsolved
    constraint it'll eventually be solved by defaulting.  So we don't
    want to emit warnings about hitting the simplifier's iteration
    limit.  A CallStack constraint really isn't an unsolved
    constraint; it can always be solved by defaulting.
-}</span><span>
</span><a name="line-1840"></a><span>
</span><a name="line-1841"></a><span class="hs-identifier">singleCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1842"></a><a name="singleCt"><a href="TcRnTypes.html#singleCt"><span class="hs-identifier">singleCt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span>
</span><a name="line-1843"></a><span>
</span><a name="line-1844"></a><span class="hs-identifier">andCts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1845"></a><a name="andCts"><a href="TcRnTypes.html#andCts"><span class="hs-identifier">andCts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span>
</span><a name="line-1846"></a><span>
</span><a name="line-1847"></a><span class="hs-identifier">listToCts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1848"></a><a name="listToCts"><a href="TcRnTypes.html#listToCts"><span class="hs-identifier">listToCts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span>
</span><a name="line-1849"></a><span>
</span><a name="line-1850"></a><span class="hs-identifier">ctsElts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span>
</span><a name="line-1851"></a><a name="ctsElts"><a href="TcRnTypes.html#ctsElts"><span class="hs-identifier">ctsElts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a><span>
</span><a name="line-1852"></a><span>
</span><a name="line-1853"></a><span class="hs-identifier">consCts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1854"></a><a name="consCts"><a href="TcRnTypes.html#consCts"><span class="hs-identifier">consCts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#consBag"><span class="hs-identifier hs-var">consBag</span></a><span>
</span><a name="line-1855"></a><span>
</span><a name="line-1856"></a><span class="hs-identifier">snocCts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1857"></a><a name="snocCts"><a href="TcRnTypes.html#snocCts"><span class="hs-identifier">snocCts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#snocBag"><span class="hs-identifier hs-var">snocBag</span></a><span>
</span><a name="line-1858"></a><span>
</span><a name="line-1859"></a><span class="hs-identifier">extendCtsList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1860"></a><a name="extendCtsList"><a href="TcRnTypes.html#extendCtsList"><span class="hs-identifier">extendCtsList</span></a></a><span> </span><a name="local-1627933770"><a href="#local-1627933770"><span class="hs-identifier">cts</span></a></a><span> </span><a name="local-1627933771"><a href="#local-1627933771"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1627933771"><span class="hs-identifier hs-var">xs</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933770"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-1861"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933770"><span class="hs-identifier hs-var">cts</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><a href="#local-1627933771"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1862"></a><span>
</span><a name="line-1863"></a><span class="hs-identifier">andManyCts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1864"></a><a name="andManyCts"><a href="TcRnTypes.html#andManyCts"><span class="hs-identifier">andManyCts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unionManyBags"><span class="hs-identifier hs-var">unionManyBags</span></a><span>
</span><a name="line-1865"></a><span>
</span><a name="line-1866"></a><span class="hs-identifier">emptyCts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>
</span><a name="line-1867"></a><a name="emptyCts"><a href="TcRnTypes.html#emptyCts"><span class="hs-identifier">emptyCts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-1868"></a><span>
</span><a name="line-1869"></a><span class="hs-identifier">isEmptyCts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1870"></a><a name="isEmptyCts"><a href="TcRnTypes.html#isEmptyCts"><span class="hs-identifier">isEmptyCts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span>
</span><a name="line-1871"></a><span>
</span><a name="line-1872"></a><span class="hs-identifier">pprCts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1873"></a><a name="pprCts"><a href="TcRnTypes.html#pprCts"><span class="hs-identifier">pprCts</span></a></a><span> </span><a name="local-1627933772"><a href="#local-1627933772"><span class="hs-identifier">cts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a><span> </span><a href="#local-1627933772"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1874"></a><span>
</span><a name="line-1875"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Wanted constraints
     These are forced to be in TcRnTypes because
           TcLclEnv mentions WantedConstraints
           WantedConstraint mentions CtLoc
           CtLoc mentions ErrCtxt
           ErrCtxt mentions TcM
*                                                                      *
v%************************************************************************
-}</span><span>
</span><a name="line-1887"></a><span>
</span><a name="line-1888"></a><span class="hs-keyword">data</span><span> </span><a name="WantedConstraints"><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier">WantedConstraints</span></a></a><span>
</span><a name="line-1889"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="WC"><a href="TcRnTypes.html#WC"><span class="hs-identifier">WC</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#wc_simple"><span class="hs-identifier">wc_simple</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>              </span><span class="hs-comment">-- Unsolved constraints, all wanted</span><span>
</span><a name="line-1890"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#wc_impl"><span class="hs-identifier">wc_impl</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span>
</span><a name="line-1891"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#wc_insol"><span class="hs-identifier">wc_insol</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Cts"><span class="hs-identifier hs-type">Cts</span></a><span>              </span><span class="hs-comment">-- Insoluble constraints, can be</span><span>
</span><a name="line-1892"></a><span>                                       </span><span class="hs-comment">-- wanted, given, or derived</span><span>
</span><a name="line-1893"></a><span>                                       </span><span class="hs-comment">-- See Note [Insoluble constraints]</span><span>
</span><a name="line-1894"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1895"></a><span>
</span><a name="line-1896"></a><span class="hs-identifier">emptyWC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1897"></a><a name="emptyWC"><a href="TcRnTypes.html#emptyWC"><span class="hs-identifier">emptyWC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1898"></a><span>
</span><a name="line-1899"></a><span class="hs-identifier">mkSimpleWC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1900"></a><a name="mkSimpleWC"><a href="TcRnTypes.html#mkSimpleWC"><span class="hs-identifier">mkSimpleWC</span></a></a><span> </span><a name="local-1627933773"><a href="#local-1627933773"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-1901"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcRnTypes.html#mkNonCanonical"><span class="hs-identifier hs-var">mkNonCanonical</span></a><span> </span><a href="#local-1627933773"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span>
</span><a name="line-1902"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-1903"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1904"></a><span>
</span><a name="line-1905"></a><span class="hs-identifier">mkImplicWC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1906"></a><a name="mkImplicWC"><a href="TcRnTypes.html#mkImplicWC"><span class="hs-identifier">mkImplicWC</span></a></a><span> </span><a name="local-1627933774"><a href="#local-1627933774"><span class="hs-identifier">implic</span></a></a><span>
</span><a name="line-1907"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933774"><span class="hs-identifier hs-var">implic</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1908"></a><span>
</span><a name="line-1909"></a><span class="hs-identifier">isEmptyWC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1910"></a><a name="isEmptyWC"><a href="TcRnTypes.html#isEmptyWC"><span class="hs-identifier">isEmptyWC</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933775"><a href="#local-1627933775"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933776"><a href="#local-1627933776"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933777"><a href="#local-1627933777"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1911"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-1627933775"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-1627933776"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-1627933777"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1912"></a><span>
</span><a name="line-1913"></a><span class="hs-identifier">andWC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1914"></a><a name="andWC"><a href="TcRnTypes.html#andWC"><span class="hs-identifier">andWC</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933778"><a href="#local-1627933778"><span class="hs-identifier">f1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933779"><a href="#local-1627933779"><span class="hs-identifier">i1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933780"><a href="#local-1627933780"><span class="hs-identifier">n1</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1915"></a><span>      </span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933781"><a href="#local-1627933781"><span class="hs-identifier">f2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933782"><a href="#local-1627933782"><span class="hs-identifier">i2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933783"><a href="#local-1627933783"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1916"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933778"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933781"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-1917"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933779"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933782"><span class="hs-identifier hs-var">i2</span></a><span>
</span><a name="line-1918"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933780"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933783"><span class="hs-identifier hs-var">n2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1919"></a><span>
</span><a name="line-1920"></a><span class="hs-identifier">unionsWC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1921"></a><a name="unionsWC"><a href="TcRnTypes.html#unionsWC"><span class="hs-identifier">unionsWC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="TcRnTypes.html#andWC"><span class="hs-identifier hs-var">andWC</span></a><span> </span><a href="TcRnTypes.html#emptyWC"><span class="hs-identifier hs-var">emptyWC</span></a><span>
</span><a name="line-1922"></a><span>
</span><a name="line-1923"></a><span class="hs-comment">-- | Convert all Wanteds into Deriveds (ignoring insolubles)</span><span>
</span><a name="line-1924"></a><span class="hs-identifier">toDerivedWC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1925"></a><a name="toDerivedWC"><a href="TcRnTypes.html#toDerivedWC"><span class="hs-identifier">toDerivedWC</span></a></a><span> </span><a name="local-1627933784"><a href="#local-1627933784"><span class="hs-identifier">wc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933785"><a href="#local-1627933785"><span class="hs-identifier">simples</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933786"><a href="#local-1627933786"><span class="hs-identifier">implics</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1926"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933784"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#mapBag"><span class="hs-identifier hs-var">mapBag</span></a><span> </span><a href="TcRnTypes.html#toDerivedCt"><span class="hs-identifier hs-var">toDerivedCt</span></a><span> </span><a href="#local-1627933785"><span class="hs-identifier hs-var">simples</span></a><span>
</span><a name="line-1927"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#mapBag"><span class="hs-identifier hs-var">mapBag</span></a><span> </span><a href="#local-1627933787"><span class="hs-identifier hs-var">to_derived_implic</span></a><span> </span><a href="#local-1627933786"><span class="hs-identifier hs-var">implics</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1928"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1929"></a><span>    </span><a name="local-1627933787"><a href="#local-1627933787"><span class="hs-identifier">to_derived_implic</span></a></a><span> </span><a name="local-1627933788"><a href="#local-1627933788"><span class="hs-identifier">implic</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_wanted</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933789"><a href="#local-1627933789"><span class="hs-identifier">inner_wanted</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1930"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933788"><span class="hs-identifier hs-var">implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_wanted</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#toDerivedWC"><span class="hs-identifier hs-var">toDerivedWC</span></a><span> </span><a href="#local-1627933789"><span class="hs-identifier hs-var">inner_wanted</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1931"></a><span>
</span><a name="line-1932"></a><span>
</span><a name="line-1933"></a><span class="hs-identifier">addSimples</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1934"></a><a name="addSimples"><a href="TcRnTypes.html#addSimples"><span class="hs-identifier">addSimples</span></a></a><span> </span><a name="local-1627933790"><a href="#local-1627933790"><span class="hs-identifier">wc</span></a></a><span> </span><a name="local-1627933791"><a href="#local-1627933791"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-1935"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933790"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><a href="#local-1627933790"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933791"><span class="hs-identifier hs-var">cts</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1936"></a><span>    </span><span class="hs-comment">-- Consider: Put the new constraints at the front, so they get solved first</span><span>
</span><a name="line-1937"></a><span>
</span><a name="line-1938"></a><span class="hs-identifier">addImplics</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1939"></a><a name="addImplics"><a href="TcRnTypes.html#addImplics"><span class="hs-identifier">addImplics</span></a></a><span> </span><a name="local-1627933792"><a href="#local-1627933792"><span class="hs-identifier">wc</span></a></a><span> </span><a name="local-1627933793"><a href="#local-1627933793"><span class="hs-identifier">implic</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933792"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><a href="#local-1627933792"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933793"><span class="hs-identifier hs-var">implic</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1940"></a><span>
</span><a name="line-1941"></a><span class="hs-identifier">addInsols</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1942"></a><a name="addInsols"><a href="TcRnTypes.html#addInsols"><span class="hs-identifier">addInsols</span></a></a><span> </span><a name="local-1627933794"><a href="#local-1627933794"><span class="hs-identifier">wc</span></a></a><span> </span><a name="local-1627933795"><a href="#local-1627933795"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-1943"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933794"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><a href="#local-1627933794"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627933795"><span class="hs-identifier hs-var">cts</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1944"></a><span>
</span><a name="line-1945"></a><span class="hs-identifier">dropDerivedWC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span>
</span><a name="line-1946"></a><span class="hs-comment">-- See Note [Dropping derived constraints]</span><span>
</span><a name="line-1947"></a><a name="dropDerivedWC"><a href="TcRnTypes.html#dropDerivedWC"><span class="hs-identifier">dropDerivedWC</span></a></a><span> </span><a name="local-1627933796"><a href="#local-1627933796"><span class="hs-identifier">wc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933797"><a href="#local-1627933797"><span class="hs-identifier">simples</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933798"><a href="#local-1627933798"><span class="hs-identifier">insols</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1948"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933796"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#dropDerivedSimples"><span class="hs-identifier hs-var">dropDerivedSimples</span></a><span> </span><a href="#local-1627933797"><span class="hs-identifier hs-var">simples</span></a><span>
</span><a name="line-1949"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#dropDerivedInsols"><span class="hs-identifier hs-var">dropDerivedInsols</span></a><span> </span><a href="#local-1627933798"><span class="hs-identifier hs-var">insols</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1950"></a><span>    </span><span class="hs-comment">-- The wc_impl implications are already (recursively) filtered</span><span>
</span><a name="line-1951"></a><span>
</span><a name="line-1952"></a><span class="hs-identifier">isInsolubleStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ImplicStatus"><span class="hs-identifier hs-type">ImplicStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1953"></a><a name="isInsolubleStatus"><a href="TcRnTypes.html#isInsolubleStatus"><span class="hs-identifier">isInsolubleStatus</span></a></a><span> </span><a href="TcRnTypes.html#IC_Insoluble"><span class="hs-identifier hs-var">IC_Insoluble</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1954"></a><span class="hs-identifier">isInsolubleStatus</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1955"></a><span>
</span><a name="line-1956"></a><span class="hs-identifier">insolubleImplic</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1957"></a><a name="insolubleImplic"><a href="TcRnTypes.html#insolubleImplic"><span class="hs-identifier">insolubleImplic</span></a></a><span> </span><a name="local-1627933799"><a href="#local-1627933799"><span class="hs-identifier">ic</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isInsolubleStatus"><span class="hs-identifier hs-var">isInsolubleStatus</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ic_status</span><span> </span><a href="#local-1627933799"><span class="hs-identifier hs-var">ic</span></a><span class="hs-special">)</span><span>
</span><a name="line-1958"></a><span>
</span><a name="line-1959"></a><span class="hs-identifier">insolubleWC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1960"></a><a name="insolubleWC"><a href="TcRnTypes.html#insolubleWC"><span class="hs-identifier">insolubleWC</span></a></a><span> </span><a name="local-1627933800"><a href="#local-1627933800"><span class="hs-identifier">tc_lvl</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933801"><a href="#local-1627933801"><span class="hs-identifier">implics</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933802"><a href="#local-1627933802"><span class="hs-identifier">insols</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1961"></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="Bag.html#anyBag"><span class="hs-identifier hs-var">anyBag</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#trulyInsoluble"><span class="hs-identifier hs-var">trulyInsoluble</span></a><span> </span><a href="#local-1627933800"><span class="hs-identifier hs-var">tc_lvl</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627933802"><span class="hs-identifier hs-var">insols</span></a><span>
</span><a name="line-1962"></a><span>  </span><span class="hs-operator hs-var">||</span><span> </span><a href="Bag.html#anyBag"><span class="hs-identifier hs-var">anyBag</span></a><span> </span><a href="TcRnTypes.html#insolubleImplic"><span class="hs-identifier hs-var">insolubleImplic</span></a><span> </span><a href="#local-1627933801"><span class="hs-identifier hs-var">implics</span></a><span>
</span><a name="line-1963"></a><span>
</span><a name="line-1964"></a><span class="hs-identifier">trulyInsoluble</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1965"></a><span class="hs-comment">-- The constraint is in the wc_insol set,</span><span>
</span><a name="line-1966"></a><span class="hs-comment">-- but we do not treat as truly isoluble</span><span>
</span><a name="line-1967"></a><span class="hs-comment">--  a) type-holes, arising from PartialTypeSignatures,</span><span>
</span><a name="line-1968"></a><span class="hs-comment">--     (except out-of-scope variables masquerading as type-holes)</span><span>
</span><a name="line-1969"></a><span class="hs-comment">-- Yuk!</span><span>
</span><a name="line-1970"></a><a name="trulyInsoluble"><a href="TcRnTypes.html#trulyInsoluble"><span class="hs-identifier">trulyInsoluble</span></a></a><span> </span><a name="local-1627933803"><a href="#local-1627933803"><span class="hs-identifier">_tc_lvl</span></a></a><span> </span><a name="local-1627933804"><a href="#local-1627933804"><span class="hs-identifier">insol</span></a></a><span>
</span><a name="line-1971"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627933804"><span class="hs-identifier hs-var">insol</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isOutOfScopeCt"><span class="hs-identifier hs-var">isOutOfScopeCt</span></a><span> </span><a href="#local-1627933804"><span class="hs-identifier hs-var">insol</span></a><span>
</span><a name="line-1972"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1973"></a><span>
</span><a name="line-1974"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1975"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933971"><a href="#local-1627933971"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933972"><a href="#local-1627933972"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933973"><a href="#local-1627933973"><span class="hs-identifier">n</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1976"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;WC&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-1977"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="TcRnTypes.html#ppr_bag"><span class="hs-identifier hs-var">ppr_bag</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;wc_simple&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1627933971"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1978"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ppr_bag"><span class="hs-identifier hs-var">ppr_bag</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;wc_insol&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1627933973"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1979"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ppr_bag"><span class="hs-identifier hs-var">ppr_bag</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;wc_impl&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1627933972"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1980"></a><span>
</span><a name="line-1981"></a><span class="hs-identifier">ppr_bag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1627933667"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="#local-1627933667"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1982"></a><a name="ppr_bag"><a href="TcRnTypes.html#ppr_bag"><span class="hs-identifier">ppr_bag</span></a></a><span> </span><a name="local-1627933805"><a href="#local-1627933805"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-1627933806"><a href="#local-1627933806"><span class="hs-identifier">bag</span></a></a><span>
</span><a name="line-1983"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-1627933806"><span class="hs-identifier hs-var">bag</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1984"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627933805"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a><span class="hs-special">)</span><span>
</span><a name="line-1985"></a><span>                       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span> </span><a href="#local-1627933806"><span class="hs-identifier hs-var">bag</span></a><span class="hs-special">)</span><span>
</span><a name="line-1986"></a><span>
</span><a name="line-1987"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Implication constraints
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1994"></a><span>
</span><a name="line-1995"></a><span class="hs-keyword">data</span><span> </span><a name="Implication"><a href="TcRnTypes.html#Implication"><span class="hs-identifier">Implication</span></a></a><span>
</span><a name="line-1996"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Implic"><a href="TcRnTypes.html#Implic"><span class="hs-identifier">Implic</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1997"></a><span>      </span><a href="TcRnTypes.html#ic_tclvl"><span class="hs-identifier">ic_tclvl</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- TcLevel: unification variables</span><span>
</span><a name="line-1998"></a><span>                                </span><span class="hs-comment">-- free in the environment</span><span>
</span><a name="line-1999"></a><span>
</span><a name="line-2000"></a><span>      </span><a href="TcRnTypes.html#ic_skols"><span class="hs-identifier">ic_skols</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Introduced skolems</span><span>
</span><a name="line-2001"></a><span>      </span><a href="TcRnTypes.html#ic_info"><span class="hs-identifier">ic_info</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- See Note [Skolems in an implication]</span><span>
</span><a name="line-2002"></a><span>                                 </span><span class="hs-comment">-- See Note [Shadowing in a constraint]</span><span>
</span><a name="line-2003"></a><span>
</span><a name="line-2004"></a><span>      </span><a href="TcRnTypes.html#ic_given"><span class="hs-identifier">ic_given</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- Given evidence variables</span><span>
</span><a name="line-2005"></a><span>                                 </span><span class="hs-comment">--   (order does not matter)</span><span>
</span><a name="line-2006"></a><span>                                 </span><span class="hs-comment">-- See Invariant (GivenInv) in TcType</span><span>
</span><a name="line-2007"></a><span>
</span><a name="line-2008"></a><span>      </span><a href="TcRnTypes.html#ic_no_eqs"><span class="hs-identifier">ic_no_eqs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- True  &lt;=&gt; ic_givens have no equalities, for sure</span><span>
</span><a name="line-2009"></a><span>                                 </span><span class="hs-comment">-- False &lt;=&gt; ic_givens might have equalities</span><span>
</span><a name="line-2010"></a><span>
</span><a name="line-2011"></a><span>      </span><a href="TcRnTypes.html#ic_env"><span class="hs-identifier">ic_env</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- Gives the source location and error context</span><span>
</span><a name="line-2012"></a><span>                                 </span><span class="hs-comment">-- for the implication, and hence for all the</span><span>
</span><a name="line-2013"></a><span>                                 </span><span class="hs-comment">-- given evidence variables</span><span>
</span><a name="line-2014"></a><span>
</span><a name="line-2015"></a><span>      </span><a href="TcRnTypes.html#ic_wanted"><span class="hs-identifier">ic_wanted</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- The wanted</span><span>
</span><a name="line-2016"></a><span>
</span><a name="line-2017"></a><span>      </span><a href="TcRnTypes.html#ic_binds"><span class="hs-identifier">ic_binds</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-2018"></a><span>                                  </span><span class="hs-comment">-- Points to the place to fill in the</span><span>
</span><a name="line-2019"></a><span>                                  </span><span class="hs-comment">-- abstraction and bindings.</span><span>
</span><a name="line-2020"></a><span>                                  </span><span class="hs-comment">-- is Nothing if we can't deal with</span><span>
</span><a name="line-2021"></a><span>                                  </span><span class="hs-comment">-- non-equality constraints here</span><span>
</span><a name="line-2022"></a><span>                                  </span><span class="hs-comment">-- (this happens in TcS.deferTcSForAllEq)</span><span>
</span><a name="line-2023"></a><span>
</span><a name="line-2024"></a><span>      </span><a href="TcRnTypes.html#ic_status"><span class="hs-identifier">ic_status</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ImplicStatus"><span class="hs-identifier hs-type">ImplicStatus</span></a><span>
</span><a name="line-2025"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-2026"></a><span>
</span><a name="line-2027"></a><span class="hs-keyword">data</span><span> </span><a name="ImplicStatus"><a href="TcRnTypes.html#ImplicStatus"><span class="hs-identifier">ImplicStatus</span></a></a><span>
</span><a name="line-2028"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="IC_Solved"><a href="TcRnTypes.html#IC_Solved"><span class="hs-identifier">IC_Solved</span></a></a><span>     </span><span class="hs-comment">-- All wanteds in the tree are solved, all the way down</span><span>
</span><a name="line-2029"></a><span>       </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#ics_need"><span class="hs-identifier">ics_need</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span>     </span><span class="hs-comment">-- Evidence variables needed by this implication</span><span>
</span><a name="line-2030"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ics_dead"><span class="hs-identifier">ics_dead</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-comment">-- Subset of ic_given that are not needed</span><span>
</span><a name="line-2031"></a><span>         </span><span class="hs-comment">-- See Note [Tracking redundant constraints] in TcSimplify</span><span>
</span><a name="line-2032"></a><span>
</span><a name="line-2033"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IC_Insoluble"><a href="TcRnTypes.html#IC_Insoluble"><span class="hs-identifier">IC_Insoluble</span></a></a><span>  </span><span class="hs-comment">-- At least one insoluble constraint in the tree</span><span>
</span><a name="line-2034"></a><span>
</span><a name="line-2035"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IC_Unsolved"><a href="TcRnTypes.html#IC_Unsolved"><span class="hs-identifier">IC_Unsolved</span></a></a><span>   </span><span class="hs-comment">-- Neither of the above; might go either way</span><span>
</span><a name="line-2036"></a><span>
</span><a name="line-2037"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2038"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_tclvl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933963"><a href="#local-1627933963"><span class="hs-identifier">tclvl</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933964"><a href="#local-1627933964"><span class="hs-identifier">skols</span></a></a><span>
</span><a name="line-2039"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933965"><a href="#local-1627933965"><span class="hs-identifier">given</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_no_eqs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933966"><a href="#local-1627933966"><span class="hs-identifier">no_eqs</span></a></a><span>
</span><a name="line-2040"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_wanted</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933967"><a href="#local-1627933967"><span class="hs-identifier">wanted</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_status</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933968"><a href="#local-1627933968"><span class="hs-identifier">status</span></a></a><span>
</span><a name="line-2041"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933969"><a href="#local-1627933969"><span class="hs-identifier">binds</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933970"><a href="#local-1627933970"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2042"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Implic&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#lbrace"><span class="hs-identifier hs-var">lbrace</span></a><span class="hs-special">)</span><span>
</span><a name="line-2043"></a><span>        </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TcLevel =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933963"><span class="hs-identifier hs-var">tclvl</span></a><span>
</span><a name="line-2044"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Skolems =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprTvBndrs"><span class="hs-identifier hs-var">pprTvBndrs</span></a><span> </span><a href="#local-1627933964"><span class="hs-identifier hs-var">skols</span></a><span>
</span><a name="line-2045"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;No-eqs =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933966"><span class="hs-identifier hs-var">no_eqs</span></a><span>
</span><a name="line-2046"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Status =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933968"><span class="hs-identifier hs-var">status</span></a><span>
</span><a name="line-2047"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Given =&quot;</span><span class="hs-special">)</span><span>  </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#pprEvVars"><span class="hs-identifier hs-var">pprEvVars</span></a><span> </span><a href="#local-1627933965"><span class="hs-identifier hs-var">given</span></a><span class="hs-special">)</span><span>
</span><a name="line-2048"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Wanted =&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933967"><span class="hs-identifier hs-var">wanted</span></a><span class="hs-special">)</span><span>
</span><a name="line-2049"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Binds =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933969"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-2050"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pprSkolInfo"><span class="hs-identifier hs-var">pprSkolInfo</span></a><span> </span><a href="#local-1627933970"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">]</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#rbrace"><span class="hs-identifier hs-var">rbrace</span></a><span class="hs-special">)</span><span>
</span><a name="line-2051"></a><span>
</span><a name="line-2052"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#ImplicStatus"><span class="hs-identifier hs-type">ImplicStatus</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2053"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="TcRnTypes.html#IC_Insoluble"><span class="hs-identifier hs-var">IC_Insoluble</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Insoluble&quot;</span><span>
</span><a name="line-2054"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#IC_Unsolved"><span class="hs-identifier hs-var">IC_Unsolved</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unsolved&quot;</span><span>
</span><a name="line-2055"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#IC_Solved"><span class="hs-identifier hs-var">IC_Solved</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ics_need</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933961"><a href="#local-1627933961"><span class="hs-identifier">vs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ics_dead</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933962"><a href="#local-1627933962"><span class="hs-identifier">dead</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2056"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Solved&quot;</span><span>
</span><a name="line-2057"></a><span>      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Dead givens =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933962"><span class="hs-identifier hs-var">dead</span></a><span>
</span><a name="line-2058"></a><span>                         </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Needed =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933961"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2059"></a><span>
</span><a name="line-2060"></a><span class="hs-comment">{-
Note [Needed evidence variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Th ic_need_evs field holds the free vars of ic_binds, and all the
ic_binds in nested implications.

  * Main purpose: if one of the ic_givens is not mentioned in here, it
    is redundant.

  * solveImplication may drop an implication altogether if it has no
    remaining 'wanteds'. But we still track the free vars of its
    evidence binds, even though it has now disappeared.

Note [Shadowing in a constraint]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We assume NO SHADOWING in a constraint.  Specifically
 * The unification variables are all implicitly quantified at top
   level, and are all unique
 * The skolem variables bound in ic_skols are all freah when the
   implication is created.
So we can safely substitute. For example, if we have
   forall a.  a~Int =&gt; ...(forall b. ...a...)...
we can push the (a~Int) constraint inwards in the &quot;givens&quot; without
worrying that 'b' might clash.

Note [Skolems in an implication]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The skolems in an implication are not there to perform a skolem escape
check.  That happens because all the environment variables are in the
untouchables, and therefore cannot be unified with anything at all,
let alone the skolems.

Instead, ic_skols is used only when considering floating a constraint
outside the implication in TcSimplify.floatEqualities or
TcSimplify.approximateImplications

Note [Insoluble constraints]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Some of the errors that we get during canonicalization are best
reported when all constraints have been simplified as much as
possible. For instance, assume that during simplification the
following constraints arise:

 [Wanted]   F alpha ~  uf1
 [Wanted]   beta ~ uf1 beta

When canonicalizing the wanted (beta ~ uf1 beta), if we eagerly fail
we will simply see a message:
    'Can't construct the infinite type  beta ~ uf1 beta'
and the user has no idea what the uf1 variable is.

Instead our plan is that we will NOT fail immediately, but:
    (1) Record the &quot;frozen&quot; error in the ic_insols field
    (2) Isolate the offending constraint from the rest of the inerts
    (3) Keep on simplifying/canonicalizing

At the end, we will hopefully have substituted uf1 := F alpha, and we
will be able to report a more informative error:
    'Can't construct the infinite type beta ~ F alpha beta'

Insoluble constraints *do* include Derived constraints. For example,
a functional dependency might give rise to [D] Int ~ Bool, and we must
report that.  If insolubles did not contain Deriveds, reportErrors would
never see it.


************************************************************************
*                                                                      *
            Pretty printing
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2132"></a><span>
</span><a name="line-2133"></a><span class="hs-identifier">pprEvVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>    </span><span class="hs-comment">-- Print with their types</span><span>
</span><a name="line-2134"></a><a name="pprEvVars"><a href="TcRnTypes.html#pprEvVars"><span class="hs-identifier">pprEvVars</span></a></a><span> </span><a name="local-1627933807"><a href="#local-1627933807"><span class="hs-identifier">ev_vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcRnTypes.html#pprEvVarWithType"><span class="hs-identifier hs-var">pprEvVarWithType</span></a><span> </span><a href="#local-1627933807"><span class="hs-identifier hs-var">ev_vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-2135"></a><span>
</span><a name="line-2136"></a><span class="hs-identifier">pprEvVarTheta</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2137"></a><a name="pprEvVarTheta"><a href="TcRnTypes.html#pprEvVarTheta"><span class="hs-identifier">pprEvVarTheta</span></a></a><span> </span><a name="local-1627933808"><a href="#local-1627933808"><span class="hs-identifier">ev_vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#pprTheta"><span class="hs-identifier hs-var">pprTheta</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcType.html#evVarPred"><span class="hs-identifier hs-var">evVarPred</span></a><span> </span><a href="#local-1627933808"><span class="hs-identifier hs-var">ev_vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-2138"></a><span>
</span><a name="line-2139"></a><span class="hs-identifier">pprEvVarWithType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2140"></a><a name="pprEvVarWithType"><a href="TcRnTypes.html#pprEvVarWithType"><span class="hs-identifier">pprEvVarWithType</span></a></a><span> </span><a name="local-1627933809"><a href="#local-1627933809"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933809"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#evVarPred"><span class="hs-identifier hs-var">evVarPred</span></a><span> </span><a href="#local-1627933809"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2141"></a><span>
</span><a name="line-2142"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
            CtEvidence
*                                                                      *
************************************************************************

Note [Evidence field of CtEvidence]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
During constraint solving we never look at the type of ctev_evar/ctev_dest;
instead we look at the ctev_pred field.  The evtm/evar field
may be un-zonked.

Note [Bind new Givens immediately]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For Givens we make new EvVars and bind them immediately. Two main reasons:
  * Gain sharing.  E.g. suppose we start with g :: C a b, where
       class D a =&gt; C a b
       class (E a, F a) =&gt; D a
    If we generate all g's superclasses as separate EvTerms we might
    get    selD1 (selC1 g) :: E a
           selD2 (selC1 g) :: F a
           selC1 g :: D a
    which we could do more economically as:
           g1 :: D a = selC1 g
           g2 :: E a = selD1 g1
           g3 :: F a = selD2 g1

  * For *coercion* evidence we *must* bind each given:
      class (a~b) =&gt; C a b where ....
      f :: C a b =&gt; ....
    Then in f's Givens we have g:(C a b) and the superclass sc(g,0):a~b.
    But that superclass selector can't (yet) appear in a coercion
    (see evTermCoercion), so the easy thing is to bind it to an Id.

So a Given has EvVar inside it rather than (as previously) an EvTerm.
-}</span><span>
</span><a name="line-2179"></a><span>
</span><a name="line-2180"></a><span class="hs-comment">-- | A place for type-checking evidence to go after it is generated.</span><span>
</span><a name="line-2181"></a><span class="hs-comment">-- Wanted equalities are always HoleDest; other wanteds are always</span><span>
</span><a name="line-2182"></a><span class="hs-comment">-- EvVarDest.</span><span>
</span><a name="line-2183"></a><span class="hs-keyword">data</span><span> </span><a name="TcEvDest"><a href="TcRnTypes.html#TcEvDest"><span class="hs-identifier">TcEvDest</span></a></a><span>
</span><a name="line-2184"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="EvVarDest"><a href="TcRnTypes.html#EvVarDest"><span class="hs-identifier">EvVarDest</span></a></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>         </span><span class="hs-comment">-- ^ bind this var to the evidence</span><span>
</span><a name="line-2185"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HoleDest"><a href="TcRnTypes.html#HoleDest"><span class="hs-identifier">HoleDest</span></a></a><span>  </span><a href="TyCoRep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a><span>  </span><span class="hs-comment">-- ^ fill in this hole with the evidence</span><span>
</span><a name="line-2186"></a><span>              </span><span class="hs-comment">-- See Note [Coercion holes] in TyCoRep</span><span>
</span><a name="line-2187"></a><span>
</span><a name="line-2188"></a><span class="hs-keyword">data</span><span> </span><a name="CtEvidence"><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier">CtEvidence</span></a></a><span>
</span><a name="line-2189"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="CtGiven"><a href="TcRnTypes.html#CtGiven"><span class="hs-identifier">CtGiven</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#ctev_pred"><span class="hs-identifier">ctev_pred</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcPredType"><span class="hs-identifier hs-type">TcPredType</span></a><span>      </span><span class="hs-comment">-- See Note [Ct/evidence invariant]</span><span>
</span><a name="line-2190"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctev_evar"><span class="hs-identifier">ctev_evar</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>           </span><span class="hs-comment">-- See Note [Evidence field of CtEvidence]</span><span>
</span><a name="line-2191"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctev_loc"><span class="hs-identifier">ctev_loc</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2192"></a><span>    </span><span class="hs-comment">-- Truly given, not depending on subgoals</span><span>
</span><a name="line-2193"></a><span>    </span><span class="hs-comment">-- NB: Spontaneous unifications belong here</span><span>
</span><a name="line-2194"></a><span>
</span><a name="line-2195"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CtWanted"><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier">CtWanted</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#ctev_pred"><span class="hs-identifier">ctev_pred</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcPredType"><span class="hs-identifier hs-type">TcPredType</span></a><span>     </span><span class="hs-comment">-- See Note [Ct/evidence invariant]</span><span>
</span><a name="line-2196"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctev_dest"><span class="hs-identifier">ctev_dest</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcEvDest"><span class="hs-identifier hs-type">TcEvDest</span></a><span>
</span><a name="line-2197"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctev_loc"><span class="hs-identifier">ctev_loc</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2198"></a><span>    </span><span class="hs-comment">-- Wanted goal</span><span>
</span><a name="line-2199"></a><span>
</span><a name="line-2200"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CtDerived"><a href="TcRnTypes.html#CtDerived"><span class="hs-identifier">CtDerived</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#ctev_pred"><span class="hs-identifier">ctev_pred</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcPredType"><span class="hs-identifier hs-type">TcPredType</span></a><span>
</span><a name="line-2201"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctev_loc"><span class="hs-identifier">ctev_loc</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2202"></a><span>    </span><span class="hs-comment">-- A goal that we don't really have to solve and can't immediately</span><span>
</span><a name="line-2203"></a><span>    </span><span class="hs-comment">-- rewrite anything other than a derived (there's no evidence!)</span><span>
</span><a name="line-2204"></a><span>    </span><span class="hs-comment">-- but if we do manage to solve it may help in solving other goals.</span><span>
</span><a name="line-2205"></a><span>
</span><a name="line-2206"></a><span class="hs-identifier">ctEvPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcPredType"><span class="hs-identifier hs-type">TcPredType</span></a><span>
</span><a name="line-2207"></a><span class="hs-comment">-- The predicate of a flavor</span><span>
</span><a name="line-2208"></a><a name="ctEvPred"><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier">ctEvPred</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ctev_pred</span><span>
</span><a name="line-2209"></a><span>
</span><a name="line-2210"></a><span class="hs-identifier">ctEvLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2211"></a><a name="ctEvLoc"><a href="TcRnTypes.html#ctEvLoc"><span class="hs-identifier">ctEvLoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ctev_loc</span><span>
</span><a name="line-2212"></a><span>
</span><a name="line-2213"></a><span class="hs-identifier">ctEvOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>
</span><a name="line-2214"></a><a name="ctEvOrigin"><a href="TcRnTypes.html#ctEvOrigin"><span class="hs-identifier">ctEvOrigin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#ctEvLoc"><span class="hs-identifier hs-var">ctEvLoc</span></a><span>
</span><a name="line-2215"></a><span>
</span><a name="line-2216"></a><span class="hs-comment">-- | Get the equality relation relevant for a 'CtEvidence'</span><span>
</span><a name="line-2217"></a><span class="hs-identifier">ctEvEqRel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span>
</span><a name="line-2218"></a><a name="ctEvEqRel"><a href="TcRnTypes.html#ctEvEqRel"><span class="hs-identifier">ctEvEqRel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#predTypeEqRel"><span class="hs-identifier hs-var">predTypeEqRel</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span>
</span><a name="line-2219"></a><span>
</span><a name="line-2220"></a><span class="hs-comment">-- | Get the role relevant for a 'CtEvidence'</span><span>
</span><a name="line-2221"></a><span class="hs-identifier">ctEvRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-2222"></a><a name="ctEvRole"><a href="TcRnTypes.html#ctEvRole"><span class="hs-identifier">ctEvRole</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#eqRelRole"><span class="hs-identifier hs-var">eqRelRole</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#ctEvEqRel"><span class="hs-identifier hs-var">ctEvEqRel</span></a><span>
</span><a name="line-2223"></a><span>
</span><a name="line-2224"></a><span class="hs-identifier">ctEvTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-2225"></a><a name="ctEvTerm"><a href="TcRnTypes.html#ctEvTerm"><span class="hs-identifier">ctEvTerm</span></a></a><span> </span><a name="local-1627933810"><a href="#local-1627933810"><span class="hs-identifier">ev</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_dest</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#HoleDest"><span class="hs-identifier hs-var">HoleDest</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcRnTypes.html#ctEvCoercion"><span class="hs-identifier hs-var">ctEvCoercion</span></a><span> </span><a href="#local-1627933810"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-2226"></a><span class="hs-identifier">ctEvTerm</span><span> </span><a name="local-1627933811"><a href="#local-1627933811"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvId"><span class="hs-identifier hs-var">EvId</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvId"><span class="hs-identifier hs-var">ctEvId</span></a><span> </span><a href="#local-1627933811"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">)</span><span>
</span><a name="line-2227"></a><span>
</span><a name="line-2228"></a><span class="hs-identifier">ctEvCoercion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-2229"></a><a name="ctEvCoercion"><a href="TcRnTypes.html#ctEvCoercion"><span class="hs-identifier">ctEvCoercion</span></a></a><span> </span><a name="local-1627933812"><a href="#local-1627933812"><span class="hs-identifier">ev</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_dest</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#HoleDest"><span class="hs-identifier hs-var">HoleDest</span></a><span> </span><a name="local-1627933813"><a href="#local-1627933813"><span class="hs-identifier">hole</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctev_pred</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933814"><a href="#local-1627933814"><span class="hs-identifier">pred</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2230"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getEqPredTys_maybe"><span class="hs-identifier hs-var">getEqPredTys_maybe</span></a><span> </span><a href="#local-1627933814"><span class="hs-identifier hs-var">pred</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2231"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627933815"><a href="#local-1627933815"><span class="hs-identifier">role</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627933816"><a href="#local-1627933816"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627933817"><a href="#local-1627933817"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Coercion.html#mkHoleCo"><span class="hs-identifier hs-var">mkHoleCo</span></a><span> </span><a href="#local-1627933813"><span class="hs-identifier hs-var">hole</span></a><span> </span><a href="#local-1627933815"><span class="hs-identifier hs-var">role</span></a><span> </span><a href="#local-1627933816"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1627933817"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-2232"></a><span>      </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;ctEvTerm&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933812"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">)</span><span>
</span><a name="line-2233"></a><span class="hs-identifier">ctEvCoercion</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtGiven"><span class="hs-identifier hs-var">CtGiven</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_evar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933818"><a href="#local-1627933818"><span class="hs-identifier">ev_id</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkTcCoVarCo"><span class="hs-identifier hs-var">mkTcCoVarCo</span></a><span> </span><a href="#local-1627933818"><span class="hs-identifier hs-var">ev_id</span></a><span>
</span><a name="line-2234"></a><span class="hs-identifier">ctEvCoercion</span><span> </span><a name="local-1627933819"><a href="#local-1627933819"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;ctEvCoercion&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933819"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">)</span><span>
</span><a name="line-2235"></a><span>
</span><a name="line-2236"></a><span class="hs-identifier">ctEvId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-2237"></a><a name="ctEvId"><a href="TcRnTypes.html#ctEvId"><span class="hs-identifier">ctEvId</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_dest</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#EvVarDest"><span class="hs-identifier hs-var">EvVarDest</span></a><span> </span><a name="local-1627933820"><a href="#local-1627933820"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933820"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-2238"></a><span class="hs-identifier">ctEvId</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtGiven"><span class="hs-identifier hs-var">CtGiven</span></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_evar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933821"><a href="#local-1627933821"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933821"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-2239"></a><span class="hs-identifier">ctEvId</span><span> </span><a name="local-1627933822"><a href="#local-1627933822"><span class="hs-identifier">ctev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;ctEvId:&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933822"><span class="hs-identifier hs-var">ctev</span></a><span class="hs-special">)</span><span>
</span><a name="line-2240"></a><span>
</span><a name="line-2241"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#TcEvDest"><span class="hs-identifier hs-type">TcEvDest</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2242"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#HoleDest"><span class="hs-identifier hs-var">HoleDest</span></a><span> </span><a name="local-1627933959"><a href="#local-1627933959"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;hole&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933959"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-2243"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#EvVarDest"><span class="hs-identifier hs-var">EvVarDest</span></a><span> </span><a name="local-1627933960"><a href="#local-1627933960"><span class="hs-identifier">ev</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933960"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-2244"></a><span>
</span><a name="line-2245"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2246"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-1627933957"><a href="#local-1627933957"><span class="hs-identifier">fl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627933957"><span class="hs-identifier hs-var">fl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2247"></a><span>             </span><a href="TcRnTypes.html#CtGiven"><span class="hs-identifier hs-var">CtGiven</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[G]&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ctev_evar</span><span> </span><a href="#local-1627933957"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1627933958"><span class="hs-identifier hs-var">ppr_pty</span></a><span>
</span><a name="line-2248"></a><span>             </span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[W]&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ctev_dest</span><span> </span><a href="#local-1627933957"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1627933958"><span class="hs-identifier hs-var">ppr_pty</span></a><span>
</span><a name="line-2249"></a><span>             </span><a href="TcRnTypes.html#CtDerived"><span class="hs-identifier hs-var">CtDerived</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[D]&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1627933958"><span class="hs-identifier hs-var">ppr_pty</span></a><span>
</span><a name="line-2250"></a><span>         </span><span class="hs-keyword">where</span><span> </span><a name="local-1627933958"><a href="#local-1627933958"><span class="hs-identifier">ppr_pty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><a href="#local-1627933957"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span>
</span><a name="line-2251"></a><span>
</span><a name="line-2252"></a><span class="hs-identifier">isWanted</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2253"></a><a name="isWanted"><a href="TcRnTypes.html#isWanted"><span class="hs-identifier">isWanted</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2254"></a><span class="hs-identifier">isWanted</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2255"></a><span>
</span><a name="line-2256"></a><span class="hs-identifier">isGiven</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2257"></a><a name="isGiven"><a href="TcRnTypes.html#isGiven"><span class="hs-identifier">isGiven</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtGiven"><span class="hs-identifier hs-var">CtGiven</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2258"></a><span class="hs-identifier">isGiven</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2259"></a><span>
</span><a name="line-2260"></a><span class="hs-identifier">isDerived</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2261"></a><a name="isDerived"><a href="TcRnTypes.html#isDerived"><span class="hs-identifier">isDerived</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtDerived"><span class="hs-identifier hs-var">CtDerived</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2262"></a><span class="hs-identifier">isDerived</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2263"></a><span>
</span><a name="line-2264"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
            CtFlavour
%*                                                                      *
%************************************************************************

Just an enum type that tracks whether a constraint is wanted, derived,
or given, when we need to separate that info from the constraint itself.

-}</span><span>
</span><a name="line-2275"></a><span>
</span><a name="line-2276"></a><span class="hs-keyword">data</span><span> </span><a name="CtFlavour"><a href="TcRnTypes.html#CtFlavour"><span class="hs-identifier">CtFlavour</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Given"><a href="TcRnTypes.html#Given"><span class="hs-identifier">Given</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Wanted"><a href="TcRnTypes.html#Wanted"><span class="hs-identifier">Wanted</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Derived"><a href="TcRnTypes.html#Derived"><span class="hs-identifier">Derived</span></a></a><span>
</span><a name="line-2277"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-2278"></a><span>
</span><a name="line-2279"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#CtFlavour"><span class="hs-identifier hs-type">CtFlavour</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2280"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="TcRnTypes.html#Given"><span class="hs-identifier hs-var">Given</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[G]&quot;</span><span>
</span><a name="line-2281"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#Wanted"><span class="hs-identifier hs-var">Wanted</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[W]&quot;</span><span>
</span><a name="line-2282"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[D]&quot;</span><span>
</span><a name="line-2283"></a><span>
</span><a name="line-2284"></a><span class="hs-identifier">ctEvFlavour</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtFlavour"><span class="hs-identifier hs-type">CtFlavour</span></a><span>
</span><a name="line-2285"></a><a name="ctEvFlavour"><a href="TcRnTypes.html#ctEvFlavour"><span class="hs-identifier">ctEvFlavour</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Wanted"><span class="hs-identifier hs-var">Wanted</span></a><span>
</span><a name="line-2286"></a><span class="hs-identifier">ctEvFlavour</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtGiven"><span class="hs-identifier hs-var">CtGiven</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Given"><span class="hs-identifier hs-var">Given</span></a><span>
</span><a name="line-2287"></a><span class="hs-identifier">ctEvFlavour</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtDerived"><span class="hs-identifier hs-var">CtDerived</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span>
</span><a name="line-2288"></a><span>
</span><a name="line-2289"></a><span class="hs-comment">-- | Whether or not one 'Ct' can rewrite another is determined by its</span><span>
</span><a name="line-2290"></a><span class="hs-comment">-- flavour and its equality relation. See also</span><span>
</span><a name="line-2291"></a><span class="hs-comment">-- Note [Flavours with roles] in TcSMonad</span><span>
</span><a name="line-2292"></a><span class="hs-keyword">type</span><span> </span><a name="CtFlavourRole"><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier">CtFlavourRole</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtFlavour"><span class="hs-identifier hs-type">CtFlavour</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span class="hs-special">)</span><span>
</span><a name="line-2293"></a><span>
</span><a name="line-2294"></a><span class="hs-comment">-- | Extract the flavour, role, and boxity from a 'CtEvidence'</span><span>
</span><a name="line-2295"></a><span class="hs-identifier">ctEvFlavourRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span>
</span><a name="line-2296"></a><a name="ctEvFlavourRole"><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier">ctEvFlavourRole</span></a></a><span> </span><a name="local-1627933823"><a href="#local-1627933823"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvFlavour"><span class="hs-identifier hs-var">ctEvFlavour</span></a><span> </span><a href="#local-1627933823"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEvEqRel"><span class="hs-identifier hs-var">ctEvEqRel</span></a><span> </span><a href="#local-1627933823"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">)</span><span>
</span><a name="line-2297"></a><span>
</span><a name="line-2298"></a><span class="hs-comment">-- | Extract the flavour, role, and boxity from a 'Ct'</span><span>
</span><a name="line-2299"></a><span class="hs-identifier">ctFlavourRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span>
</span><a name="line-2300"></a><a name="ctFlavourRole"><a href="TcRnTypes.html#ctFlavourRole"><span class="hs-identifier">ctFlavourRole</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier hs-var">ctEvFlavourRole</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">cc_ev</span><span>
</span><a name="line-2301"></a><span>
</span><a name="line-2302"></a><span class="hs-comment">{- Note [eqCanRewrite]
~~~~~~~~~~~~~~~~~~~
(eqCanRewrite ct1 ct2) holds if the constraint ct1 (a CTyEqCan of form
tv ~ ty) can be used to rewrite ct2.  It must satisfy the properties of
a can-rewrite relation, see Definition [Can-rewrite relation] in
TcSMonad.

With the solver handling Coercible constraints like equality constraints,
the rewrite conditions must take role into account, never allowing
a representational equality to rewrite a nominal one.

Note [Wanteds do not rewrite Wanteds]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We don't allow Wanteds to rewrite Wanteds, because that can give rise
to very confusing type error messages.  A good example is Trac #8450.
Here's another
   f :: a -&gt; Bool
   f x = ( [x,'c'], [x,True] ) `seq` True
Here we get
  [W] a ~ Char
  [W] a ~ Bool
but we do not want to complain about Bool ~ Char!

Note [Deriveds do rewrite Deriveds]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
However we DO allow Deriveds to rewrite Deriveds, because that's how
improvement works; see Note [The improvement story] in TcInteract.

However, for now at least I'm only letting (Derived,NomEq) rewrite
(Derived,NomEq) and not doing anything for ReprEq.  If we have
    eqCanRewriteFR (Derived, NomEq) (Derived, _)  = True
then we lose property R2 of Definition [Can-rewrite relation]
in TcSMonad
  R2.  If f1 &gt;= f, and f2 &gt;= f,
       then either f1 &gt;= f2 or f2 &gt;= f1
Consider f1 = (Given, ReprEq)
         f2 = (Derived, NomEq)
          f = (Derived, ReprEq)

I thought maybe we could never get Derived ReprEq constraints, but
we can; straight from the Wanteds during improvment. And from a Derived
ReprEq we could conceivably get a Derived NomEq improvment (by decomposing
a type constructor with Nomninal role), and hence unify.

Note [funEqCanDischarge]
~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we have two CFunEqCans with the same LHS:
    (x1:F ts ~ f1) `funEqCanDischarge` (x2:F ts ~ f2)
Can we drop x2 in favour of x1, either unifying
f2 (if it's a flatten meta-var) or adding a new Given
(f1 ~ f2), if x2 is a Given?

Answer: yes if funEqCanDischarge is true.

Note [eqCanDischarge]
~~~~~~~~~~~~~~~~~~~~~
Suppose we have two identicla equality constraints
(i.e. both LHS and RHS are the same)
      (x1:s~t) `eqCanDischarge` (xs:s~t)
Can we just drop x2 in favour of x1?

Answer: yes if eqCanDischarge is true.

Note that we do /not/ allow Wanted to discharge Derived.
We must keep both.  Why?  Because the Derived may rewrite
other Deriveds in the model whereas the Wanted cannot.

However a Wanted can certainly discharge an identical Wanted.  So
eqCanDischarge does /not/ define a can-rewrite relation in the
sense of Definition [Can-rewrite relation] in TcSMonad.
-}</span><span>
</span><a name="line-2373"></a><span>
</span><a name="line-2374"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-2375"></a><span class="hs-identifier">eqCanRewrite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2376"></a><span class="hs-comment">-- Very important function!</span><span>
</span><a name="line-2377"></a><span class="hs-comment">-- See Note [eqCanRewrite]</span><span>
</span><a name="line-2378"></a><span class="hs-comment">-- See Note [Wanteds do not rewrite Wanteds]</span><span>
</span><a name="line-2379"></a><span class="hs-comment">-- See Note [Deriveds do rewrite Deriveds]</span><span>
</span><a name="line-2380"></a><a name="eqCanRewrite"><a href="TcRnTypes.html#eqCanRewrite"><span class="hs-identifier">eqCanRewrite</span></a></a><span> </span><a name="local-1627933824"><a href="#local-1627933824"><span class="hs-identifier">ev1</span></a></a><span> </span><a name="local-1627933825"><a href="#local-1627933825"><span class="hs-identifier">ev2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#eqCanRewriteFR"><span class="hs-identifier hs-var">eqCanRewriteFR</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier hs-var">ctEvFlavourRole</span></a><span> </span><a href="#local-1627933824"><span class="hs-identifier hs-var">ev1</span></a><span class="hs-special">)</span><span>
</span><a name="line-2381"></a><span>                                      </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier hs-var">ctEvFlavourRole</span></a><span> </span><a href="#local-1627933825"><span class="hs-identifier hs-var">ev2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2382"></a><span>
</span><a name="line-2383"></a><span class="hs-identifier">eqCanRewriteFR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2384"></a><a name="eqCanRewriteFR"><a href="TcRnTypes.html#eqCanRewriteFR"><span class="hs-identifier">eqCanRewriteFR</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Given"><span class="hs-identifier hs-var">Given</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2385"></a><span class="hs-identifier">eqCanRewriteFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Given"><span class="hs-identifier hs-var">Given</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2386"></a><span class="hs-identifier">eqCanRewriteFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2387"></a><span class="hs-identifier">eqCanRewriteFR</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2388"></a><span>
</span><a name="line-2389"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-2390"></a><span class="hs-identifier">funEqCanDischarge</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2391"></a><span class="hs-comment">-- See Note [funEqCanDischarge]</span><span>
</span><a name="line-2392"></a><a name="funEqCanDischarge"><a href="TcRnTypes.html#funEqCanDischarge"><span class="hs-identifier">funEqCanDischarge</span></a></a><span> </span><a name="local-1627933826"><a href="#local-1627933826"><span class="hs-identifier">ev1</span></a></a><span> </span><a name="local-1627933827"><a href="#local-1627933827"><span class="hs-identifier">ev2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#funEqCanDischargeFR"><span class="hs-identifier hs-var">funEqCanDischargeFR</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier hs-var">ctEvFlavourRole</span></a><span> </span><a href="#local-1627933826"><span class="hs-identifier hs-var">ev1</span></a><span class="hs-special">)</span><span>
</span><a name="line-2393"></a><span>                                      </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier hs-var">ctEvFlavourRole</span></a><span> </span><a href="#local-1627933827"><span class="hs-identifier hs-var">ev2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2394"></a><span>
</span><a name="line-2395"></a><span class="hs-identifier">funEqCanDischargeFR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2396"></a><a name="funEqCanDischargeFR"><a href="TcRnTypes.html#funEqCanDischargeFR"><span class="hs-identifier">funEqCanDischargeFR</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2397"></a><span class="hs-identifier">funEqCanDischargeFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Given"><span class="hs-identifier hs-var">Given</span></a><span class="hs-special">,</span><span>   </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2398"></a><span class="hs-identifier">funEqCanDischargeFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Wanted"><span class="hs-identifier hs-var">Wanted</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Wanted"><span class="hs-identifier hs-var">Wanted</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2399"></a><span class="hs-identifier">funEqCanDischargeFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Wanted"><span class="hs-identifier hs-var">Wanted</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2400"></a><span class="hs-identifier">funEqCanDischargeFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2401"></a><span class="hs-identifier">funEqCanDischargeFR</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2402"></a><span>
</span><a name="line-2403"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-2404"></a><span class="hs-identifier">eqCanDischarge</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2405"></a><span class="hs-comment">-- See Note [eqCanDischarge]</span><span>
</span><a name="line-2406"></a><a name="eqCanDischarge"><a href="TcRnTypes.html#eqCanDischarge"><span class="hs-identifier">eqCanDischarge</span></a></a><span> </span><a name="local-1627933828"><a href="#local-1627933828"><span class="hs-identifier">ev1</span></a></a><span> </span><a name="local-1627933829"><a href="#local-1627933829"><span class="hs-identifier">ev2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#eqCanDischargeFR"><span class="hs-identifier hs-var">eqCanDischargeFR</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier hs-var">ctEvFlavourRole</span></a><span> </span><a href="#local-1627933828"><span class="hs-identifier hs-var">ev1</span></a><span class="hs-special">)</span><span>
</span><a name="line-2407"></a><span>                                          </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvFlavourRole"><span class="hs-identifier hs-var">ctEvFlavourRole</span></a><span> </span><a href="#local-1627933829"><span class="hs-identifier hs-var">ev2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2408"></a><span class="hs-identifier">eqCanDischargeFR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtFlavourRole"><span class="hs-identifier hs-type">CtFlavourRole</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2409"></a><a name="eqCanDischargeFR"><a href="TcRnTypes.html#eqCanDischargeFR"><span class="hs-identifier">eqCanDischargeFR</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2410"></a><span class="hs-identifier">eqCanDischargeFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Given"><span class="hs-identifier hs-var">Given</span></a><span class="hs-special">,</span><span>   </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Given"><span class="hs-identifier hs-var">Given</span></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2411"></a><span class="hs-identifier">eqCanDischargeFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Wanted"><span class="hs-identifier hs-var">Wanted</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Wanted"><span class="hs-identifier hs-var">Wanted</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2412"></a><span class="hs-identifier">eqCanDischargeFR</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Derived"><span class="hs-identifier hs-var">Derived</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2413"></a><span class="hs-identifier">eqCanDischargeFR</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2414"></a><span>
</span><a name="line-2415"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
            SubGoalDepth
*                                                                      *
************************************************************************

Note [SubGoalDepth]
~~~~~~~~~~~~~~~~~~~
The 'SubGoalDepth' takes care of stopping the constraint solver from looping.

The counter starts at zero and increases. It includes dictionary constraints,
equality simplification, and type family reduction. (Why combine these? Because
it's actually quite easy to mistake one for another, in sufficiently involved
scenarios, like ConstraintKinds.)

The flag -fcontext-stack=n (not very well named!) fixes the maximium
level.

* The counter includes the depth of type class instance declarations.  Example:
     [W] d{7} : Eq [Int]
  That is d's dictionary-constraint depth is 7.  If we use the instance
     $dfEqList :: Eq a =&gt; Eq [a]
  to simplify it, we get
     d{7} = $dfEqList d'{8}
  where d'{8} : Eq Int, and d' has depth 8.

  For civilised (decidable) instance declarations, each increase of
  depth removes a type constructor from the type, so the depth never
  gets big; i.e. is bounded by the structural depth of the type.

* The counter also increments when resolving
equalities involving type functions. Example:
  Assume we have a wanted at depth 7:
    [W] d{7} : F () ~ a
  If there is an type function equation &quot;F () = Int&quot;, this would be rewritten to
    [W] d{8} : Int ~ a
  and remembered as having depth 8.

  Again, without UndecidableInstances, this counter is bounded, but without it
  can resolve things ad infinitum. Hence there is a maximum level.

* Lastly, every time an equality is rewritten, the counter increases. Again,
  rewriting an equality constraint normally makes progress, but it's possible
  the &quot;progress&quot; is just the reduction of an infinitely-reducing type family.
  Hence we need to track the rewrites.

When compiling a program requires a greater depth, then GHC recommends turning
off this check entirely by setting -freduction-depth=0. This is because the
exact number that works is highly variable, and is likely to change even between
minor releases. Because this check is solely to prevent infinite compilation
times, it seems safe to disable it when a user has ascertained that their program
doesn't loop at the type level.

-}</span><span>
</span><a name="line-2470"></a><span>
</span><a name="line-2471"></a><span class="hs-comment">-- | See Note [SubGoalDepth]</span><span>
</span><a name="line-2472"></a><span class="hs-keyword">newtype</span><span> </span><a name="SubGoalDepth"><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier">SubGoalDepth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SubGoalDepth"><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier">SubGoalDepth</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2473"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span class="hs-special">)</span><span>
</span><a name="line-2474"></a><span>
</span><a name="line-2475"></a><span class="hs-identifier">initialSubGoalDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-type">SubGoalDepth</span></a><span>
</span><a name="line-2476"></a><a name="initialSubGoalDepth"><a href="TcRnTypes.html#initialSubGoalDepth"><span class="hs-identifier">initialSubGoalDepth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-var">SubGoalDepth</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2477"></a><span>
</span><a name="line-2478"></a><span class="hs-identifier">bumpSubGoalDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-type">SubGoalDepth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-type">SubGoalDepth</span></a><span>
</span><a name="line-2479"></a><a name="bumpSubGoalDepth"><a href="TcRnTypes.html#bumpSubGoalDepth"><span class="hs-identifier">bumpSubGoalDepth</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-var">SubGoalDepth</span></a><span> </span><a name="local-1627933830"><a href="#local-1627933830"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-var">SubGoalDepth</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627933830"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-2480"></a><span>
</span><a name="line-2481"></a><span class="hs-identifier">subGoalDepthExceeded</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-type">SubGoalDepth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2482"></a><a name="subGoalDepthExceeded"><a href="TcRnTypes.html#subGoalDepthExceeded"><span class="hs-identifier">subGoalDepthExceeded</span></a></a><span> </span><a name="local-1627933831"><a href="#local-1627933831"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-var">SubGoalDepth</span></a><span> </span><a name="local-1627933832"><a href="#local-1627933832"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2483"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#mkIntWithInf"><span class="hs-identifier hs-var">mkIntWithInf</span></a><span> </span><a href="#local-1627933832"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-identifier">reductionDepth</span><span> </span><a href="#local-1627933831"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2484"></a><span>
</span><a name="line-2485"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
            CtLoc
*                                                                      *
************************************************************************

The 'CtLoc' gives information about where a constraint came from.
This is important for decent error message reporting because
dictionaries don't appear in the original source code.
type will evolve...
-}</span><span>
</span><a name="line-2497"></a><span>
</span><a name="line-2498"></a><span class="hs-keyword">data</span><span> </span><a name="CtLoc"><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier">CtLoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CtLoc"><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier">CtLoc</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#ctl_origin"><span class="hs-identifier">ctl_origin</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>
</span><a name="line-2499"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctl_env"><span class="hs-identifier">ctl_env</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span>
</span><a name="line-2500"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctl_t_or_k"><span class="hs-identifier">ctl_t_or_k</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>  </span><span class="hs-comment">-- OK if we're not sure</span><span>
</span><a name="line-2501"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctl_depth"><span class="hs-identifier">ctl_depth</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-type">SubGoalDepth</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2502"></a><span>  </span><span class="hs-comment">-- The TcLclEnv includes particularly</span><span>
</span><a name="line-2503"></a><span>  </span><span class="hs-comment">--    source location:  tcl_loc   :: RealSrcSpan</span><span>
</span><a name="line-2504"></a><span>  </span><span class="hs-comment">--    context:          tcl_ctxt  :: [ErrCtxt]</span><span>
</span><a name="line-2505"></a><span>  </span><span class="hs-comment">--    binder stack:     tcl_bndrs :: TcIdBinderStack</span><span>
</span><a name="line-2506"></a><span>  </span><span class="hs-comment">--    level:            tcl_tclvl :: TcLevel</span><span>
</span><a name="line-2507"></a><span>
</span><a name="line-2508"></a><span class="hs-identifier">mkGivenLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2509"></a><a name="mkGivenLoc"><a href="TcRnTypes.html#mkGivenLoc"><span class="hs-identifier">mkGivenLoc</span></a></a><span> </span><a name="local-1627933833"><a href="#local-1627933833"><span class="hs-identifier">tclvl</span></a></a><span> </span><a name="local-1627933834"><a href="#local-1627933834"><span class="hs-identifier">skol_info</span></a></a><span> </span><a name="local-1627933835"><a href="#local-1627933835"><span class="hs-identifier">env</span></a></a><span>
</span><a name="line-2510"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-var">CtLoc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#GivenOrigin"><span class="hs-identifier hs-var">GivenOrigin</span></a><span> </span><a href="#local-1627933834"><span class="hs-identifier hs-var">skol_info</span></a><span>
</span><a name="line-2511"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctl_env</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933835"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcl_tclvl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933833"><span class="hs-identifier hs-var">tclvl</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2512"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctl_t_or_k</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-comment">-- this only matters for error msgs</span><span>
</span><a name="line-2513"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctl_depth</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#initialSubGoalDepth"><span class="hs-identifier hs-var">initialSubGoalDepth</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2514"></a><span>
</span><a name="line-2515"></a><span class="hs-identifier">mkKindLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>   </span><span class="hs-comment">-- original *types* being compared</span><span>
</span><a name="line-2516"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2517"></a><a name="mkKindLoc"><a href="TcRnTypes.html#mkKindLoc"><span class="hs-identifier">mkKindLoc</span></a></a><span> </span><a name="local-1627933836"><a href="#local-1627933836"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-1627933837"><a href="#local-1627933837"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-1627933838"><a href="#local-1627933838"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#setCtLocOrigin"><span class="hs-identifier hs-var">setCtLocOrigin</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#toKindLoc"><span class="hs-identifier hs-var">toKindLoc</span></a><span> </span><a href="#local-1627933838"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2518"></a><span>                        </span><span class="hs-special">(</span><a href="TcRnTypes.html#KindEqOrigin"><span class="hs-identifier hs-var">KindEqOrigin</span></a><span> </span><a href="#local-1627933836"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627933837"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="#local-1627933838"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2519"></a><span>                                      </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLocTypeOrKind_maybe"><span class="hs-identifier hs-var">ctLocTypeOrKind_maybe</span></a><span> </span><a href="#local-1627933838"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2520"></a><span>
</span><a name="line-2521"></a><span class="hs-comment">-- | Take a CtLoc and moves it to the kind level</span><span>
</span><a name="line-2522"></a><span class="hs-identifier">toKindLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2523"></a><a name="toKindLoc"><a href="TcRnTypes.html#toKindLoc"><span class="hs-identifier">toKindLoc</span></a></a><span> </span><a name="local-1627933839"><a href="#local-1627933839"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933839"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_t_or_k</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2524"></a><span>
</span><a name="line-2525"></a><span class="hs-identifier">ctLocEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span>
</span><a name="line-2526"></a><a name="ctLocEnv"><a href="TcRnTypes.html#ctLocEnv"><span class="hs-identifier">ctLocEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ctl_env</span><span>
</span><a name="line-2527"></a><span>
</span><a name="line-2528"></a><span class="hs-identifier">ctLocLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a><span>
</span><a name="line-2529"></a><a name="ctLocLevel"><a href="TcRnTypes.html#ctLocLevel"><span class="hs-identifier">ctLocLevel</span></a></a><span> </span><a name="local-1627933840"><a href="#local-1627933840"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tcl_tclvl</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a><span> </span><a href="#local-1627933840"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2530"></a><span>
</span><a name="line-2531"></a><span class="hs-identifier">ctLocDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#SubGoalDepth"><span class="hs-identifier hs-type">SubGoalDepth</span></a><span>
</span><a name="line-2532"></a><a name="ctLocDepth"><a href="TcRnTypes.html#ctLocDepth"><span class="hs-identifier">ctLocDepth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ctl_depth</span><span>
</span><a name="line-2533"></a><span>
</span><a name="line-2534"></a><span class="hs-identifier">ctLocOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>
</span><a name="line-2535"></a><a name="ctLocOrigin"><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier">ctLocOrigin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ctl_origin</span><span>
</span><a name="line-2536"></a><span>
</span><a name="line-2537"></a><span class="hs-identifier">ctLocSpan</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a><span>
</span><a name="line-2538"></a><a name="ctLocSpan"><a href="TcRnTypes.html#ctLocSpan"><span class="hs-identifier">ctLocSpan</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-var">CtLoc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933841"><a href="#local-1627933841"><span class="hs-identifier">lcl</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tcl_loc</span><span> </span><a href="#local-1627933841"><span class="hs-identifier hs-var">lcl</span></a><span>
</span><a name="line-2539"></a><span>
</span><a name="line-2540"></a><span class="hs-identifier">ctLocTypeOrKind_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>
</span><a name="line-2541"></a><a name="ctLocTypeOrKind_maybe"><a href="TcRnTypes.html#ctLocTypeOrKind_maybe"><span class="hs-identifier">ctLocTypeOrKind_maybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ctl_t_or_k</span><span>
</span><a name="line-2542"></a><span>
</span><a name="line-2543"></a><span class="hs-identifier">setCtLocSpan</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2544"></a><a name="setCtLocSpan"><a href="TcRnTypes.html#setCtLocSpan"><span class="hs-identifier">setCtLocSpan</span></a></a><span> </span><a name="local-1627933842"><a href="#local-1627933842"><span class="hs-identifier">ctl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-var">CtLoc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933843"><a href="#local-1627933843"><span class="hs-identifier">lcl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627933844"><a href="#local-1627933844"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#setCtLocEnv"><span class="hs-identifier hs-var">setCtLocEnv</span></a><span> </span><a href="#local-1627933842"><span class="hs-identifier hs-var">ctl</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627933843"><span class="hs-identifier hs-var">lcl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcl_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933844"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2545"></a><span>
</span><a name="line-2546"></a><span class="hs-identifier">bumpCtLocDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2547"></a><a name="bumpCtLocDepth"><a href="TcRnTypes.html#bumpCtLocDepth"><span class="hs-identifier">bumpCtLocDepth</span></a></a><span> </span><a name="local-1627933845"><a href="#local-1627933845"><span class="hs-identifier">loc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-var">CtLoc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_depth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933846"><a href="#local-1627933846"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933845"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_depth</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#bumpSubGoalDepth"><span class="hs-identifier hs-var">bumpSubGoalDepth</span></a><span> </span><a href="#local-1627933846"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2548"></a><span>
</span><a name="line-2549"></a><span class="hs-identifier">setCtLocOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2550"></a><a name="setCtLocOrigin"><a href="TcRnTypes.html#setCtLocOrigin"><span class="hs-identifier">setCtLocOrigin</span></a></a><span> </span><a name="local-1627933847"><a href="#local-1627933847"><span class="hs-identifier">ctl</span></a></a><span> </span><a name="local-1627933848"><a href="#local-1627933848"><span class="hs-identifier">orig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933847"><span class="hs-identifier hs-var">ctl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933848"><span class="hs-identifier hs-var">orig</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2551"></a><span>
</span><a name="line-2552"></a><span class="hs-identifier">setCtLocEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2553"></a><a name="setCtLocEnv"><a href="TcRnTypes.html#setCtLocEnv"><span class="hs-identifier">setCtLocEnv</span></a></a><span> </span><a name="local-1627933849"><a href="#local-1627933849"><span class="hs-identifier">ctl</span></a></a><span> </span><a name="local-1627933850"><a href="#local-1627933850"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933849"><span class="hs-identifier hs-var">ctl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933850"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2554"></a><span>
</span><a name="line-2555"></a><span class="hs-identifier">pushErrCtxt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2556"></a><a name="pushErrCtxt"><a href="TcRnTypes.html#pushErrCtxt"><span class="hs-identifier">pushErrCtxt</span></a></a><span> </span><a name="local-1627933851"><a href="#local-1627933851"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-1627933852"><a href="#local-1627933852"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-1627933853"><a href="#local-1627933853"><span class="hs-identifier">loc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-var">CtLoc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933854"><a href="#local-1627933854"><span class="hs-identifier">lcl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2557"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933853"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933851"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933854"><span class="hs-identifier hs-var">lcl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcl_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933852"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">tcl_ctxt</span><span> </span><a href="#local-1627933854"><span class="hs-identifier hs-var">lcl</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2558"></a><span>
</span><a name="line-2559"></a><span class="hs-identifier">pushErrCtxtSameOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>
</span><a name="line-2560"></a><span class="hs-comment">-- Just add information w/o updating the origin!</span><span>
</span><a name="line-2561"></a><a name="pushErrCtxtSameOrigin"><a href="TcRnTypes.html#pushErrCtxtSameOrigin"><span class="hs-identifier">pushErrCtxtSameOrigin</span></a></a><span> </span><a name="local-1627933855"><a href="#local-1627933855"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-1627933856"><a href="#local-1627933856"><span class="hs-identifier">loc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-var">CtLoc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933857"><a href="#local-1627933857"><span class="hs-identifier">lcl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2562"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933856"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933857"><span class="hs-identifier hs-var">lcl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcl_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933855"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">tcl_ctxt</span><span> </span><a href="#local-1627933857"><span class="hs-identifier hs-var">lcl</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2563"></a><span>
</span><a name="line-2564"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                SkolemInfo
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2571"></a><span>
</span><a name="line-2572"></a><span class="hs-comment">-- SkolemInfo gives the origin of *given* constraints</span><span>
</span><a name="line-2573"></a><span class="hs-comment">--   a) type variables are skolemised</span><span>
</span><a name="line-2574"></a><span class="hs-comment">--   b) an implication constraint is generated</span><span>
</span><a name="line-2575"></a><span class="hs-keyword">data</span><span> </span><a name="SkolemInfo"><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier">SkolemInfo</span></a></a><span>
</span><a name="line-2576"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="SigSkol"><a href="TcRnTypes.html#SigSkol"><span class="hs-identifier">SigSkol</span></a></a><span> </span><a href="TcType.html#UserTypeCtxt"><span class="hs-identifier hs-type">UserTypeCtxt</span></a><span>        </span><span class="hs-comment">-- A skolem that is created by instantiating</span><span>
</span><a name="line-2577"></a><span>            </span><a href="TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a><span>             </span><span class="hs-comment">-- a programmer-supplied type signature</span><span>
</span><a name="line-2578"></a><span>                                </span><span class="hs-comment">-- Location of the binding site is on the TyVar</span><span>
</span><a name="line-2579"></a><span>
</span><a name="line-2580"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ClsSkol"><a href="TcRnTypes.html#ClsSkol"><span class="hs-identifier">ClsSkol</span></a></a><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span>       </span><span class="hs-comment">-- Bound at a class decl</span><span>
</span><a name="line-2581"></a><span>
</span><a name="line-2582"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivSkol"><a href="TcRnTypes.html#DerivSkol"><span class="hs-identifier">DerivSkol</span></a></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>      </span><span class="hs-comment">-- Bound by a 'deriving' clause;</span><span>
</span><a name="line-2583"></a><span>                        </span><span class="hs-comment">-- the type is the instance we are trying to derive</span><span>
</span><a name="line-2584"></a><span>
</span><a name="line-2585"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InstSkol"><a href="TcRnTypes.html#InstSkol"><span class="hs-identifier">InstSkol</span></a></a><span>            </span><span class="hs-comment">-- Bound at an instance decl</span><span>
</span><a name="line-2586"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InstSC"><a href="TcRnTypes.html#InstSC"><span class="hs-identifier">InstSC</span></a></a><span> </span><a href="TcType.html#TypeSize"><span class="hs-identifier hs-type">TypeSize</span></a><span>     </span><span class="hs-comment">-- A &quot;given&quot; constraint obtained by superclass selection.</span><span>
</span><a name="line-2587"></a><span>                        </span><span class="hs-comment">-- If (C ty1 .. tyn) is the largest class from</span><span>
</span><a name="line-2588"></a><span>                        </span><span class="hs-comment">--    which we made a superclass selection in the chain,</span><span>
</span><a name="line-2589"></a><span>                        </span><span class="hs-comment">--    then TypeSize = sizeTypes [ty1, .., tyn]</span><span>
</span><a name="line-2590"></a><span>                        </span><span class="hs-comment">-- See Note [Solving superclass constraints] in TcInstDcls</span><span>
</span><a name="line-2591"></a><span>
</span><a name="line-2592"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DataSkol"><a href="TcRnTypes.html#DataSkol"><span class="hs-identifier">DataSkol</span></a></a><span>            </span><span class="hs-comment">-- Bound at a data type declaration</span><span>
</span><a name="line-2593"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FamInstSkol"><a href="TcRnTypes.html#FamInstSkol"><span class="hs-identifier">FamInstSkol</span></a></a><span>         </span><span class="hs-comment">-- Bound at a family instance decl</span><span>
</span><a name="line-2594"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PatSkol"><a href="TcRnTypes.html#PatSkol"><span class="hs-identifier">PatSkol</span></a></a><span>             </span><span class="hs-comment">-- An existential type variable bound by a pattern for</span><span>
</span><a name="line-2595"></a><span>      </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span>           </span><span class="hs-comment">-- a data constructor with an existential type.</span><span>
</span><a name="line-2596"></a><span>      </span><span class="hs-special">(</span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2597"></a><span>             </span><span class="hs-comment">-- e.g.   data T = forall a. Eq a =&gt; MkT a</span><span>
</span><a name="line-2598"></a><span>             </span><span class="hs-comment">--        f (MkT x) = ...</span><span>
</span><a name="line-2599"></a><span>             </span><span class="hs-comment">-- The pattern MkT x will allocate an existential type</span><span>
</span><a name="line-2600"></a><span>             </span><span class="hs-comment">-- variable for 'a'.</span><span>
</span><a name="line-2601"></a><span>
</span><a name="line-2602"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ArrowSkol"><a href="TcRnTypes.html#ArrowSkol"><span class="hs-identifier">ArrowSkol</span></a></a><span>           </span><span class="hs-comment">-- An arrow form (see TcArrows)</span><span>
</span><a name="line-2603"></a><span>
</span><a name="line-2604"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IPSkol"><a href="TcRnTypes.html#IPSkol"><span class="hs-identifier">IPSkol</span></a></a><span> </span><span class="hs-special">[</span><a href="HsTypes.html#HsIPName"><span class="hs-identifier hs-type">HsIPName</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Binding site of an implicit parameter</span><span>
</span><a name="line-2605"></a><span>
</span><a name="line-2606"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RuleSkol"><a href="TcRnTypes.html#RuleSkol"><span class="hs-identifier">RuleSkol</span></a></a><span> </span><a href="BasicTypes.html#RuleName"><span class="hs-identifier hs-type">RuleName</span></a><span>   </span><span class="hs-comment">-- The LHS of a RULE</span><span>
</span><a name="line-2607"></a><span>
</span><a name="line-2608"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InferSkol"><a href="TcRnTypes.html#InferSkol"><span class="hs-identifier">InferSkol</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2609"></a><span>                        </span><span class="hs-comment">-- We have inferred a type for these (mutually-recursivive)</span><span>
</span><a name="line-2610"></a><span>                        </span><span class="hs-comment">-- polymorphic Ids, and are now checking that their RHS</span><span>
</span><a name="line-2611"></a><span>                        </span><span class="hs-comment">-- constraints are satisfied.</span><span>
</span><a name="line-2612"></a><span>
</span><a name="line-2613"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BracketSkol"><a href="TcRnTypes.html#BracketSkol"><span class="hs-identifier">BracketSkol</span></a></a><span>         </span><span class="hs-comment">-- Template Haskell bracket</span><span>
</span><a name="line-2614"></a><span>
</span><a name="line-2615"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnifyForAllSkol"><a href="TcRnTypes.html#UnifyForAllSkol"><span class="hs-identifier">UnifyForAllSkol</span></a></a><span>     </span><span class="hs-comment">-- We are unifying two for-all types</span><span>
</span><a name="line-2616"></a><span>       </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>           </span><span class="hs-comment">-- The instantiated type *inside* the forall</span><span>
</span><a name="line-2617"></a><span>
</span><a name="line-2618"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnkSkol"><a href="TcRnTypes.html#UnkSkol"><span class="hs-identifier">UnkSkol</span></a></a><span>             </span><span class="hs-comment">-- Unhelpful info (until I improve it)</span><span>
</span><a name="line-2619"></a><span>
</span><a name="line-2620"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2621"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#pprSkolInfo"><span class="hs-identifier hs-var">pprSkolInfo</span></a><span>
</span><a name="line-2622"></a><span>
</span><a name="line-2623"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2624"></a><span class="hs-comment">-- Complete the sentence &quot;is a rigid type variable bound by...&quot;</span><span>
</span><a name="line-2625"></a><a name="pprSkolInfo"><a href="TcRnTypes.html#pprSkolInfo"><span class="hs-identifier">pprSkolInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#SigSkol"><span class="hs-identifier hs-var">SigSkol</span></a><span> </span><a name="local-1627933858"><a href="#local-1627933858"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1627933859"><a href="#local-1627933859"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#pprSigSkolInfo"><span class="hs-identifier hs-var">pprSigSkolInfo</span></a><span> </span><a href="#local-1627933858"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1627933859"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2626"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#IPSkol"><span class="hs-identifier hs-var">IPSkol</span></a><span> </span><a name="local-1627933860"><a href="#local-1627933860"><span class="hs-identifier">ips</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the implicit-parameter binding&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1627933860"><span class="hs-identifier hs-var">ips</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;for&quot;</span><span>
</span><a name="line-2627"></a><span>                                </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprWithCommas"><span class="hs-identifier hs-var">pprWithCommas</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933860"><span class="hs-identifier hs-var">ips</span></a><span>
</span><a name="line-2628"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ClsSkol"><span class="hs-identifier hs-var">ClsSkol</span></a><span> </span><a name="local-1627933861"><a href="#local-1627933861"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the class declaration for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933861"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span>
</span><a name="line-2629"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#DerivSkol"><span class="hs-identifier hs-var">DerivSkol</span></a><span> </span><a name="local-1627933862"><a href="#local-1627933862"><span class="hs-identifier">pred</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the deriving clause for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933862"><span class="hs-identifier hs-var">pred</span></a><span class="hs-special">)</span><span>
</span><a name="line-2630"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><a href="TcRnTypes.html#InstSkol"><span class="hs-identifier hs-var">InstSkol</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the instance declaration&quot;</span><span>
</span><a name="line-2631"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#InstSC"><span class="hs-identifier hs-var">InstSC</span></a><span> </span><a name="local-1627933863"><a href="#local-1627933863"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the instance declaration&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ifPprDebug"><span class="hs-identifier hs-var">ifPprDebug</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933863"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2632"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><a href="TcRnTypes.html#DataSkol"><span class="hs-identifier hs-var">DataSkol</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a data type declaration&quot;</span><span>
</span><a name="line-2633"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><a href="TcRnTypes.html#FamInstSkol"><span class="hs-identifier hs-var">FamInstSkol</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a family instance declaration&quot;</span><span>
</span><a name="line-2634"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><a href="TcRnTypes.html#BracketSkol"><span class="hs-identifier hs-var">BracketSkol</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a Template Haskell bracket&quot;</span><span>
</span><a name="line-2635"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#RuleSkol"><span class="hs-identifier hs-var">RuleSkol</span></a><span> </span><a name="local-1627933864"><a href="#local-1627933864"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the RULE&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="BasicTypes.html#pprRuleName"><span class="hs-identifier hs-var">pprRuleName</span></a><span> </span><a href="#local-1627933864"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2636"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><a href="TcRnTypes.html#ArrowSkol"><span class="hs-identifier hs-var">ArrowSkol</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an arrow form&quot;</span><span>
</span><a name="line-2637"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#PatSkol"><span class="hs-identifier hs-var">PatSkol</span></a><span> </span><a name="local-1627933865"><a href="#local-1627933865"><span class="hs-identifier">cl</span></a></a><span> </span><a name="local-1627933866"><a href="#local-1627933866"><span class="hs-identifier">mc</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="TcRnTypes.html#pprPatSkolInfo"><span class="hs-identifier hs-var">pprPatSkolInfo</span></a><span> </span><a href="#local-1627933865"><span class="hs-identifier hs-var">cl</span></a><span>
</span><a name="line-2638"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="HsExpr.html#pprMatchContext"><span class="hs-identifier hs-var">pprMatchContext</span></a><span> </span><a href="#local-1627933866"><span class="hs-identifier hs-var">mc</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2639"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#InferSkol"><span class="hs-identifier hs-var">InferSkol</span></a><span> </span><a name="local-1627933867"><a href="#local-1627933867"><span class="hs-identifier">ids</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the inferred type of&quot;</span><span>
</span><a name="line-2640"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933868"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933869"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2641"></a><span>                                           </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1627933868"><a href="#local-1627933868"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><a name="local-1627933869"><a href="#local-1627933869"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627933867"><span class="hs-identifier hs-var">ids</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-2642"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#UnifyForAllSkol"><span class="hs-identifier hs-var">UnifyForAllSkol</span></a><span> </span><a name="local-1627933870"><a href="#local-1627933870"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933870"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2643"></a><span>
</span><a name="line-2644"></a><span class="hs-comment">-- UnkSkol</span><span>
</span><a name="line-2645"></a><span class="hs-comment">-- For type variables the others are dealt with by pprSkolTvBinding.</span><span>
</span><a name="line-2646"></a><span class="hs-comment">-- For Insts, these cases should not happen</span><span>
</span><a name="line-2647"></a><span class="hs-identifier">pprSkolInfo</span><span> </span><a href="TcRnTypes.html#UnkSkol"><span class="hs-identifier hs-var">UnkSkol</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><a href="Outputable.html#warnPprTrace"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;pprSkolInfo: UnkSkol&quot;</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;UnkSkol&quot;</span><span>
</span><a name="line-2648"></a><span>
</span><a name="line-2649"></a><span class="hs-identifier">pprSigSkolInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#UserTypeCtxt"><span class="hs-identifier hs-type">UserTypeCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2650"></a><a name="pprSigSkolInfo"><a href="TcRnTypes.html#pprSigSkolInfo"><span class="hs-identifier">pprSigSkolInfo</span></a></a><span> </span><a name="local-1627933871"><a href="#local-1627933871"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1627933872"><a href="#local-1627933872"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2651"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627933871"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2652"></a><span>       </span><a href="TcType.html#FunSigCtxt"><span class="hs-identifier hs-var">FunSigCtxt</span></a><span> </span><a name="local-1627933875"><a href="#local-1627933875"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627933873"><span class="hs-identifier hs-var">pp_sig</span></a><span> </span><a href="#local-1627933875"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-2653"></a><span>       </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="TcType.html#pprUserTypeCtxt"><span class="hs-identifier hs-var">pprUserTypeCtxt</span></a><span> </span><a href="#local-1627933871"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span>
</span><a name="line-2654"></a><span>                              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933872"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2655"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2656"></a><span>    </span><a name="local-1627933873"><a href="#local-1627933873"><span class="hs-identifier">pp_sig</span></a></a><span> </span><a name="local-1627933874"><a href="#local-1627933874"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the type signature for:&quot;</span><span>
</span><a name="line-2657"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#pprPrefixOcc"><span class="hs-identifier hs-var">pprPrefixOcc</span></a><span> </span><a href="#local-1627933874"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933872"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2658"></a><span>
</span><a name="line-2659"></a><span class="hs-identifier">pprPatSkolInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2660"></a><a name="pprPatSkolInfo"><a href="TcRnTypes.html#pprPatSkolInfo"><span class="hs-identifier">pprPatSkolInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a name="local-1627933876"><a href="#local-1627933876"><span class="hs-identifier">dc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2661"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a pattern with constructor:&quot;</span><span>
</span><a name="line-2662"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933876"><span class="hs-identifier hs-var">dc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span>
</span><a name="line-2663"></a><span>          </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConUserType"><span class="hs-identifier hs-var">dataConUserType</span></a><span> </span><a href="#local-1627933876"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2664"></a><span>          </span><span class="hs-comment">-- pprType prints forall's regardless of -fprint-explict-foralls</span><span>
</span><a name="line-2665"></a><span>          </span><span class="hs-comment">-- which is what we want here, since we might be saying</span><span>
</span><a name="line-2666"></a><span>          </span><span class="hs-comment">-- type variable 't' is bound by ...</span><span>
</span><a name="line-2667"></a><span>
</span><a name="line-2668"></a><span class="hs-identifier">pprPatSkolInfo</span><span> </span><span class="hs-special">(</span><a href="ConLike.html#PatSynCon"><span class="hs-identifier hs-var">PatSynCon</span></a><span> </span><a name="local-1627933877"><a href="#local-1627933877"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2669"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a pattern with pattern synonym:&quot;</span><span>
</span><a name="line-2670"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933877"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span>
</span><a name="line-2671"></a><span>                   </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><span class="hs-special">(</span><a href="PatSyn.html#patSynType"><span class="hs-identifier hs-var">patSynType</span></a><span> </span><a href="#local-1627933877"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2672"></a><span>
</span><a name="line-2673"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
            CtOrigin
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2680"></a><span>
</span><a name="line-2681"></a><span class="hs-keyword">data</span><span> </span><a name="CtOrigin"><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier">CtOrigin</span></a></a><span>
</span><a name="line-2682"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="GivenOrigin"><a href="TcRnTypes.html#GivenOrigin"><span class="hs-identifier">GivenOrigin</span></a></a><span> </span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span>
</span><a name="line-2683"></a><span>
</span><a name="line-2684"></a><span>  </span><span class="hs-comment">-- All the others are for *wanted* constraints</span><span>
</span><a name="line-2685"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="OccurrenceOf"><a href="TcRnTypes.html#OccurrenceOf"><span class="hs-identifier">OccurrenceOf</span></a></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>              </span><span class="hs-comment">-- Occurrence of an overloaded identifier</span><span>
</span><a name="line-2686"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="OccurrenceOfRecSel"><a href="TcRnTypes.html#OccurrenceOfRecSel"><span class="hs-identifier">OccurrenceOfRecSel</span></a></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>     </span><span class="hs-comment">-- Occurrence of a record selector</span><span>
</span><a name="line-2687"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AppOrigin"><a href="TcRnTypes.html#AppOrigin"><span class="hs-identifier">AppOrigin</span></a></a><span>                      </span><span class="hs-comment">-- An application of some kind</span><span>
</span><a name="line-2688"></a><span>
</span><a name="line-2689"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SpecPragOrigin"><a href="TcRnTypes.html#SpecPragOrigin"><span class="hs-identifier">SpecPragOrigin</span></a></a><span> </span><a href="TcType.html#UserTypeCtxt"><span class="hs-identifier hs-type">UserTypeCtxt</span></a><span>    </span><span class="hs-comment">-- Specialisation pragma for</span><span>
</span><a name="line-2690"></a><span>                                   </span><span class="hs-comment">-- function or instance</span><span>
</span><a name="line-2691"></a><span>
</span><a name="line-2692"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeEqOrigin"><a href="TcRnTypes.html#TypeEqOrigin"><span class="hs-identifier">TypeEqOrigin</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#uo_actual"><span class="hs-identifier">uo_actual</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>
</span><a name="line-2693"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#uo_expected"><span class="hs-identifier">uo_expected</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a><span>
</span><a name="line-2694"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#uo_thing"><span class="hs-identifier">uo_thing</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier hs-type">ErrorThing</span></a><span>
</span><a name="line-2695"></a><span>                                  </span><span class="hs-comment">-- ^ The thing that has type &quot;actual&quot;</span><span>
</span><a name="line-2696"></a><span>                 </span><span class="hs-special">}</span><span>
</span><a name="line-2697"></a><span>
</span><a name="line-2698"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="KindEqOrigin"><a href="TcRnTypes.html#KindEqOrigin"><span class="hs-identifier">KindEqOrigin</span></a></a><span>
</span><a name="line-2699"></a><span>      </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- A kind equality arising from unifying these two types</span><span>
</span><a name="line-2700"></a><span>      </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>                  </span><span class="hs-comment">-- originally arising from this</span><span>
</span><a name="line-2701"></a><span>      </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- the level of the eq this arises from</span><span>
</span><a name="line-2702"></a><span>
</span><a name="line-2703"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IPOccOrigin"><a href="TcRnTypes.html#IPOccOrigin"><span class="hs-identifier">IPOccOrigin</span></a></a><span>  </span><a href="HsTypes.html#HsIPName"><span class="hs-identifier hs-type">HsIPName</span></a><span>       </span><span class="hs-comment">-- Occurrence of an implicit parameter</span><span>
</span><a name="line-2704"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="OverLabelOrigin"><a href="TcRnTypes.html#OverLabelOrigin"><span class="hs-identifier">OverLabelOrigin</span></a></a><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span>  </span><span class="hs-comment">-- Occurrence of an overloaded label</span><span>
</span><a name="line-2705"></a><span>
</span><a name="line-2706"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LiteralOrigin"><a href="TcRnTypes.html#LiteralOrigin"><span class="hs-identifier">LiteralOrigin</span></a></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- Occurrence of a literal</span><span>
</span><a name="line-2707"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NegateOrigin"><a href="TcRnTypes.html#NegateOrigin"><span class="hs-identifier">NegateOrigin</span></a></a><span>                        </span><span class="hs-comment">-- Occurrence of syntactic negation</span><span>
</span><a name="line-2708"></a><span>
</span><a name="line-2709"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ArithSeqOrigin"><a href="TcRnTypes.html#ArithSeqOrigin"><span class="hs-identifier">ArithSeqOrigin</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- [x..], [x..y] etc</span><span>
</span><a name="line-2710"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PArrSeqOrigin"><a href="TcRnTypes.html#PArrSeqOrigin"><span class="hs-identifier">PArrSeqOrigin</span></a></a><span>  </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- [:x..y:] and [:x,y..z:]</span><span>
</span><a name="line-2711"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SectionOrigin"><a href="TcRnTypes.html#SectionOrigin"><span class="hs-identifier">SectionOrigin</span></a></a><span>
</span><a name="line-2712"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TupleOrigin"><a href="TcRnTypes.html#TupleOrigin"><span class="hs-identifier">TupleOrigin</span></a></a><span>                        </span><span class="hs-comment">-- (..,..)</span><span>
</span><a name="line-2713"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ExprSigOrigin"><a href="TcRnTypes.html#ExprSigOrigin"><span class="hs-identifier">ExprSigOrigin</span></a></a><span>       </span><span class="hs-comment">-- e :: ty</span><span>
</span><a name="line-2714"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PatSigOrigin"><a href="TcRnTypes.html#PatSigOrigin"><span class="hs-identifier">PatSigOrigin</span></a></a><span>        </span><span class="hs-comment">-- p :: ty</span><span>
</span><a name="line-2715"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PatOrigin"><a href="TcRnTypes.html#PatOrigin"><span class="hs-identifier">PatOrigin</span></a></a><span>           </span><span class="hs-comment">-- Instantiating a polytyped pattern at a constructor</span><span>
</span><a name="line-2716"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ProvCtxtOrigin"><a href="TcRnTypes.html#ProvCtxtOrigin"><span class="hs-identifier">ProvCtxtOrigin</span></a></a><span>      </span><span class="hs-comment">-- The &quot;provided&quot; context of a pattern synonym signature</span><span>
</span><a name="line-2717"></a><span>        </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Information about the pattern synonym, in particular</span><span>
</span><a name="line-2718"></a><span>                               </span><span class="hs-comment">-- the name and the right-hand side</span><span>
</span><a name="line-2719"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RecordUpdOrigin"><a href="TcRnTypes.html#RecordUpdOrigin"><span class="hs-identifier">RecordUpdOrigin</span></a></a><span>
</span><a name="line-2720"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ViewPatOrigin"><a href="TcRnTypes.html#ViewPatOrigin"><span class="hs-identifier">ViewPatOrigin</span></a></a><span>
</span><a name="line-2721"></a><span>
</span><a name="line-2722"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ScOrigin"><a href="TcRnTypes.html#ScOrigin"><span class="hs-identifier">ScOrigin</span></a></a><span> </span><a href="TcType.html#TypeSize"><span class="hs-identifier hs-type">TypeSize</span></a><span>   </span><span class="hs-comment">-- Typechecking superclasses of an instance declaration</span><span>
</span><a name="line-2723"></a><span>                        </span><span class="hs-comment">-- If the instance head is C ty1 .. tyn</span><span>
</span><a name="line-2724"></a><span>                        </span><span class="hs-comment">--    then TypeSize = sizeTypes [ty1, .., tyn]</span><span>
</span><a name="line-2725"></a><span>                        </span><span class="hs-comment">-- See Note [Solving superclass constraints] in TcInstDcls</span><span>
</span><a name="line-2726"></a><span>
</span><a name="line-2727"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivOrigin"><a href="TcRnTypes.html#DerivOrigin"><span class="hs-identifier">DerivOrigin</span></a></a><span>         </span><span class="hs-comment">-- Typechecking deriving</span><span>
</span><a name="line-2728"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivOriginDC"><a href="TcRnTypes.html#DerivOriginDC"><span class="hs-identifier">DerivOriginDC</span></a></a><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2729"></a><span>                        </span><span class="hs-comment">-- Checking constraints arising from this data con and field index</span><span>
</span><a name="line-2730"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivOriginCoerce"><a href="TcRnTypes.html#DerivOriginCoerce"><span class="hs-identifier">DerivOriginCoerce</span></a></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-2731"></a><span>                        </span><span class="hs-comment">-- DerivOriginCoerce id ty1 ty2: Trying to coerce class method `id` from</span><span>
</span><a name="line-2732"></a><span>                        </span><span class="hs-comment">-- `ty1` to `ty2`.</span><span>
</span><a name="line-2733"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StandAloneDerivOrigin"><a href="TcRnTypes.html#StandAloneDerivOrigin"><span class="hs-identifier">StandAloneDerivOrigin</span></a></a><span> </span><span class="hs-comment">-- Typechecking stand-alone deriving</span><span>
</span><a name="line-2734"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DefaultOrigin"><a href="TcRnTypes.html#DefaultOrigin"><span class="hs-identifier">DefaultOrigin</span></a></a><span>       </span><span class="hs-comment">-- Typechecking a default decl</span><span>
</span><a name="line-2735"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DoOrigin"><a href="TcRnTypes.html#DoOrigin"><span class="hs-identifier">DoOrigin</span></a></a><span>            </span><span class="hs-comment">-- Arising from a do expression</span><span>
</span><a name="line-2736"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DoPatOrigin"><a href="TcRnTypes.html#DoPatOrigin"><span class="hs-identifier">DoPatOrigin</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Arising from a failable pattern in</span><span>
</span><a name="line-2737"></a><span>                            </span><span class="hs-comment">-- a do expression</span><span>
</span><a name="line-2738"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MCompOrigin"><a href="TcRnTypes.html#MCompOrigin"><span class="hs-identifier">MCompOrigin</span></a></a><span>         </span><span class="hs-comment">-- Arising from a monad comprehension</span><span>
</span><a name="line-2739"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MCompPatOrigin"><a href="TcRnTypes.html#MCompPatOrigin"><span class="hs-identifier">MCompPatOrigin</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Arising from a failable pattern in a</span><span>
</span><a name="line-2740"></a><span>                               </span><span class="hs-comment">-- monad comprehension</span><span>
</span><a name="line-2741"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IfOrigin"><a href="TcRnTypes.html#IfOrigin"><span class="hs-identifier">IfOrigin</span></a></a><span>            </span><span class="hs-comment">-- Arising from an if statement</span><span>
</span><a name="line-2742"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ProcOrigin"><a href="TcRnTypes.html#ProcOrigin"><span class="hs-identifier">ProcOrigin</span></a></a><span>          </span><span class="hs-comment">-- Arising from a proc expression</span><span>
</span><a name="line-2743"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AnnOrigin"><a href="TcRnTypes.html#AnnOrigin"><span class="hs-identifier">AnnOrigin</span></a></a><span>           </span><span class="hs-comment">-- An annotation</span><span>
</span><a name="line-2744"></a><span>
</span><a name="line-2745"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FunDepOrigin1"><a href="TcRnTypes.html#FunDepOrigin1"><span class="hs-identifier">FunDepOrigin1</span></a></a><span>       </span><span class="hs-comment">-- A functional dependency from combining</span><span>
</span><a name="line-2746"></a><span>        </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>      </span><span class="hs-comment">-- This constraint arising from ...</span><span>
</span><a name="line-2747"></a><span>        </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span>      </span><span class="hs-comment">-- and this constraint arising from ...</span><span>
</span><a name="line-2748"></a><span>
</span><a name="line-2749"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FunDepOrigin2"><a href="TcRnTypes.html#FunDepOrigin2"><span class="hs-identifier">FunDepOrigin2</span></a></a><span>       </span><span class="hs-comment">-- A functional dependency from combining</span><span>
</span><a name="line-2750"></a><span>        </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>   </span><span class="hs-comment">-- This constraint arising from ...</span><span>
</span><a name="line-2751"></a><span>        </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>    </span><span class="hs-comment">-- and this instance</span><span>
</span><a name="line-2752"></a><span>        </span><span class="hs-comment">-- We only need a CtOrigin on the first, because the location</span><span>
</span><a name="line-2753"></a><span>        </span><span class="hs-comment">-- is pinned on the entire error message</span><span>
</span><a name="line-2754"></a><span>
</span><a name="line-2755"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HoleOrigin"><a href="TcRnTypes.html#HoleOrigin"><span class="hs-identifier">HoleOrigin</span></a></a><span>
</span><a name="line-2756"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnboundOccurrenceOf"><a href="TcRnTypes.html#UnboundOccurrenceOf"><span class="hs-identifier">UnboundOccurrenceOf</span></a></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-2757"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ListOrigin"><a href="TcRnTypes.html#ListOrigin"><span class="hs-identifier">ListOrigin</span></a></a><span>          </span><span class="hs-comment">-- An overloaded list</span><span>
</span><a name="line-2758"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StaticOrigin"><a href="TcRnTypes.html#StaticOrigin"><span class="hs-identifier">StaticOrigin</span></a></a><span>        </span><span class="hs-comment">-- A static form</span><span>
</span><a name="line-2759"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FailablePattern"><a href="TcRnTypes.html#FailablePattern"><span class="hs-identifier">FailablePattern</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- A failable pattern in do-notation for the</span><span>
</span><a name="line-2760"></a><span>                                </span><span class="hs-comment">-- MonadFail Proposal (MFP). Obsolete when</span><span>
</span><a name="line-2761"></a><span>                                </span><span class="hs-comment">-- actual desugaring to MonadFail.fail is live.</span><span>
</span><a name="line-2762"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Shouldn%27tHappenOrigin"><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier">Shouldn'tHappenOrigin</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-2763"></a><span>                            </span><span class="hs-comment">-- the user should never see this one,</span><span>
</span><a name="line-2764"></a><span>                            </span><span class="hs-comment">-- unlesss ImpredicativeTypes is on, where all</span><span>
</span><a name="line-2765"></a><span>                            </span><span class="hs-comment">-- bets are off</span><span>
</span><a name="line-2766"></a><span>
</span><a name="line-2767"></a><span class="hs-comment">-- | A thing that can be stored for error message generation only.</span><span>
</span><a name="line-2768"></a><span class="hs-comment">-- It is stored with a function to zonk and tidy the thing.</span><span>
</span><a name="line-2769"></a><span class="hs-keyword">data</span><span> </span><a name="ErrorThing"><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier">ErrorThing</span></a></a><span>
</span><a name="line-2770"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627933657"><a href="#local-1627933657"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1627933657"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="ErrorThing"><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier">ErrorThing</span></a></a><span> </span><a href="#local-1627933657"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2771"></a><span>                                         </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- # of args, if known</span><span>
</span><a name="line-2772"></a><span>                                         </span><span class="hs-special">(</span><a href="VarEnv.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627933657"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627933657"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2773"></a><span>
</span><a name="line-2774"></a><span class="hs-comment">-- | Flag to see whether we're type-checking terms or kind-checking types</span><span>
</span><a name="line-2775"></a><span class="hs-keyword">data</span><span> </span><a name="TypeOrKind"><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier">TypeOrKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TypeLevel"><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier">TypeLevel</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="KindLevel"><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier">KindLevel</span></a></a><span>
</span><a name="line-2776"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-2777"></a><span>
</span><a name="line-2778"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2779"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TypeLevel&quot;</span><span>
</span><a name="line-2780"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;KindLevel&quot;</span><span>
</span><a name="line-2781"></a><span>
</span><a name="line-2782"></a><span class="hs-identifier">isTypeLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2783"></a><a name="isTypeLevel"><a href="TcRnTypes.html#isTypeLevel"><span class="hs-identifier">isTypeLevel</span></a></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2784"></a><span class="hs-identifier">isTypeLevel</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2785"></a><span>
</span><a name="line-2786"></a><span class="hs-identifier">isKindLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2787"></a><a name="isKindLevel"><a href="TcRnTypes.html#isKindLevel"><span class="hs-identifier">isKindLevel</span></a></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2788"></a><span class="hs-identifier">isKindLevel</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2789"></a><span>
</span><a name="line-2790"></a><span class="hs-comment">-- | Make an 'ErrorThing' that doesn't need tidying or zonking</span><span>
</span><a name="line-2791"></a><span class="hs-identifier">mkErrorThing</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1627933666"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627933666"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier hs-type">ErrorThing</span></a><span>
</span><a name="line-2792"></a><a name="mkErrorThing"><a href="TcRnTypes.html#mkErrorThing"><span class="hs-identifier">mkErrorThing</span></a></a><span> </span><a name="local-1627933878"><a href="#local-1627933878"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier hs-var">ErrorThing</span></a><span> </span><a href="#local-1627933878"><span class="hs-identifier hs-var">thing</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627933879"><a href="#local-1627933879"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627933880"><a href="#local-1627933880"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627933879"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627933880"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2793"></a><span>
</span><a name="line-2794"></a><span class="hs-comment">-- | Retrieve the # of arguments in the error thing, if known</span><span>
</span><a name="line-2795"></a><span class="hs-identifier">errorThingNumArgs_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier hs-type">ErrorThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span>
</span><a name="line-2796"></a><a name="errorThingNumArgs_maybe"><a href="TcRnTypes.html#errorThingNumArgs_maybe"><span class="hs-identifier">errorThingNumArgs_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier hs-var">ErrorThing</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933881"><a href="#local-1627933881"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933881"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-2797"></a><span>
</span><a name="line-2798"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2799"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#pprCtOrigin"><span class="hs-identifier hs-var">pprCtOrigin</span></a><span>
</span><a name="line-2800"></a><span>
</span><a name="line-2801"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier hs-type">ErrorThing</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2802"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ErrorThing"><span class="hs-identifier hs-var">ErrorThing</span></a><span> </span><a name="local-1627933956"><a href="#local-1627933956"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933956"><span class="hs-identifier hs-var">thing</span></a><span>
</span><a name="line-2803"></a><span>
</span><a name="line-2804"></a><span class="hs-identifier">ctoHerald</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2805"></a><a name="ctoHerald"><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier">ctoHerald</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;arising from&quot;</span><span>
</span><a name="line-2806"></a><span>
</span><a name="line-2807"></a><span class="hs-comment">-- | Extract a suitable CtOrigin from a HsExpr</span><span>
</span><a name="line-2808"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>
</span><a name="line-2809"></a><a name="exprCtOrigin"><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier">exprCtOrigin</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933882"><a href="#local-1627933882"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a><span> </span><a href="#local-1627933882"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2810"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsUnboundVar"><span class="hs-identifier hs-var">HsUnboundVar</span></a><span> </span><a name="local-1627933883"><a href="#local-1627933883"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#UnboundOccurrenceOf"><span class="hs-identifier hs-var">UnboundOccurrenceOf</span></a><span> </span><a href="#local-1627933883"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-2811"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsRecFld"><span class="hs-identifier hs-var">HsRecFld</span></a><span> </span><a name="local-1627933884"><a href="#local-1627933884"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#OccurrenceOfRecSel"><span class="hs-identifier hs-var">OccurrenceOfRecSel</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#rdrNameAmbiguousFieldOcc"><span class="hs-identifier hs-var">rdrNameAmbiguousFieldOcc</span></a><span> </span><a href="#local-1627933884"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-2812"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLabel"><span class="hs-identifier hs-var">HsOverLabel</span></a><span> </span><a name="local-1627933885"><a href="#local-1627933885"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#OverLabelOrigin"><span class="hs-identifier hs-var">OverLabelOrigin</span></a><span> </span><a href="#local-1627933885"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-2813"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIPVar"><span class="hs-identifier hs-var">HsIPVar</span></a><span> </span><a name="local-1627933886"><a href="#local-1627933886"><span class="hs-identifier">ip</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#IPOccOrigin"><span class="hs-identifier hs-var">IPOccOrigin</span></a><span> </span><a href="#local-1627933886"><span class="hs-identifier hs-var">ip</span></a><span>
</span><a name="line-2814"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><a name="local-1627933887"><a href="#local-1627933887"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#LiteralOrigin"><span class="hs-identifier hs-var">LiteralOrigin</span></a><span> </span><a href="#local-1627933887"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-2815"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;concrete literal&quot;</span><span>
</span><a name="line-2816"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a name="local-1627933888"><a href="#local-1627933888"><span class="hs-identifier">matches</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#matchesCtOrigin"><span class="hs-identifier hs-var">matchesCtOrigin</span></a><span> </span><a href="#local-1627933888"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-2817"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLamCase"><span class="hs-identifier hs-var">HsLamCase</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933889"><a href="#local-1627933889"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#matchesCtOrigin"><span class="hs-identifier hs-var">matchesCtOrigin</span></a><span> </span><a href="#local-1627933889"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-2818"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933890"><a href="#local-1627933890"><span class="hs-identifier">e1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933890"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-2819"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933891"><a href="#local-1627933891"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933891"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-2820"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933892"><a href="#local-1627933892"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933892"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2821"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933893"><a href="#local-1627933893"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933893"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2822"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionL"><span class="hs-identifier hs-var">SectionL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#SectionOrigin"><span class="hs-identifier hs-var">SectionOrigin</span></a><span>
</span><a name="line-2823"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#SectionOrigin"><span class="hs-identifier hs-var">SectionOrigin</span></a><span>
</span><a name="line-2824"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;explicit tuple&quot;</span><span>
</span><a name="line-2825"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933894"><a href="#local-1627933894"><span class="hs-identifier">matches</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#matchesCtOrigin"><span class="hs-identifier hs-var">matchesCtOrigin</span></a><span> </span><a href="#local-1627933894"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-2826"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627933895"><a href="#local-1627933895"><span class="hs-identifier">syn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">syn_expr</span><span> </span><a href="#local-1627933895"><span class="hs-identifier hs-var">syn</span></a><span class="hs-special">)</span><span>
</span><a name="line-2827"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;if expression&quot;</span><span>
</span><a name="line-2828"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsMultiIf"><span class="hs-identifier hs-var">HsMultiIf</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933896"><a href="#local-1627933896"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#lGRHSCtOrigin"><span class="hs-identifier hs-var">lGRHSCtOrigin</span></a><span> </span><a href="#local-1627933896"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-2829"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLet"><span class="hs-identifier hs-var">HsLet</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933897"><a href="#local-1627933897"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933897"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2830"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#DoOrigin"><span class="hs-identifier hs-var">DoOrigin</span></a><span>
</span><a name="line-2831"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;list&quot;</span><span>
</span><a name="line-2832"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitPArr"><span class="hs-identifier hs-var">ExplicitPArr</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;parallel array&quot;</span><span>
</span><a name="line-2833"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecordCon"><span class="hs-identifier hs-var">RecordCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;record construction&quot;</span><span>
</span><a name="line-2834"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecordUpd"><span class="hs-identifier hs-var">RecordUpd</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;record update&quot;</span><span>
</span><a name="line-2835"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExprWithTySig"><span class="hs-identifier hs-var">ExprWithTySig</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ExprSigOrigin"><span class="hs-identifier hs-var">ExprSigOrigin</span></a><span>
</span><a name="line-2836"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExprWithTySigOut"><span class="hs-identifier hs-var">ExprWithTySigOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin ExprWithTySigOut&quot;</span><span>
</span><a name="line-2837"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeq"><span class="hs-identifier hs-var">ArithSeq</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;arithmetic sequence&quot;</span><span>
</span><a name="line-2838"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PArrSeq"><span class="hs-identifier hs-var">PArrSeq</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;parallel array sequence&quot;</span><span>
</span><a name="line-2839"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSCC"><span class="hs-identifier hs-var">HsSCC</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933898"><a href="#local-1627933898"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933898"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2840"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCoreAnn"><span class="hs-identifier hs-var">HsCoreAnn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933899"><a href="#local-1627933899"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933899"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2841"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsBracket"><span class="hs-identifier hs-var">HsBracket</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;TH bracket&quot;</span><span>
</span><a name="line-2842"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsRnBracketOut"><span class="hs-identifier hs-var">HsRnBracketOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;HsRnBracketOut&quot;</span><span>
</span><a name="line-2843"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTcBracketOut"><span class="hs-identifier hs-var">HsTcBracketOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin HsTcBracketOut&quot;</span><span>
</span><a name="line-2844"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;TH splice&quot;</span><span>
</span><a name="line-2845"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsProc"><span class="hs-identifier hs-var">HsProc</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;proc&quot;</span><span>
</span><a name="line-2846"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsStatic"><span class="hs-identifier hs-var">HsStatic</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;static expression&quot;</span><span>
</span><a name="line-2847"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsArrApp"><span class="hs-identifier hs-var">HsArrApp</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin HsArrApp&quot;</span><span>
</span><a name="line-2848"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsArrForm"><span class="hs-identifier hs-var">HsArrForm</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin HsArrForm&quot;</span><span>
</span><a name="line-2849"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTick"><span class="hs-identifier hs-var">HsTick</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933900"><a href="#local-1627933900"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933900"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2850"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsBinTick"><span class="hs-identifier hs-var">HsBinTick</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933901"><a href="#local-1627933901"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933901"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2851"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTickPragma"><span class="hs-identifier hs-var">HsTickPragma</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933902"><a href="#local-1627933902"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933902"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2852"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><a href="HsExpr.html#EWildPat"><span class="hs-identifier hs-var">EWildPat</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin EWildPat&quot;</span><span>
</span><a name="line-2853"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#EAsPat"><span class="hs-identifier hs-var">EAsPat</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin EAsPat&quot;</span><span>
</span><a name="line-2854"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#EViewPat"><span class="hs-identifier hs-var">EViewPat</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin EViewPat&quot;</span><span>
</span><a name="line-2855"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ELazyPat"><span class="hs-identifier hs-var">ELazyPat</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin ELazyPat&quot;</span><span>
</span><a name="line-2856"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsType"><span class="hs-identifier hs-var">HsType</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;type application&quot;</span><span>
</span><a name="line-2857"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTypeOut"><span class="hs-identifier hs-var">HsTypeOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin HsTypeOut&quot;</span><span>
</span><a name="line-2858"></a><span class="hs-identifier">exprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;exprCtOrigin HsWrap&quot;</span><span>
</span><a name="line-2859"></a><span>
</span><a name="line-2860"></a><span class="hs-comment">-- | Extract a suitable CtOrigin from a MatchGroup</span><span>
</span><a name="line-2861"></a><span class="hs-identifier">matchesCtOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>
</span><a name="line-2862"></a><a name="matchesCtOrigin"><a href="TcRnTypes.html#matchesCtOrigin"><span class="hs-identifier">matchesCtOrigin</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933903"><a href="#local-1627933903"><span class="hs-identifier">alts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2863"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933904"><a href="#local-1627933904"><span class="hs-identifier">match</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627933903"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-2864"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933905"><a href="#local-1627933905"><span class="hs-identifier">grhss</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627933904"><span class="hs-identifier hs-var">match</span></a><span>
</span><a name="line-2865"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#grhssCtOrigin"><span class="hs-identifier hs-var">grhssCtOrigin</span></a><span> </span><a href="#local-1627933905"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-2866"></a><span>
</span><a name="line-2867"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2868"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;multi-way match&quot;</span><span>
</span><a name="line-2869"></a><span>
</span><a name="line-2870"></a><span class="hs-comment">-- | Extract a suitable CtOrigin from guarded RHSs</span><span>
</span><a name="line-2871"></a><span class="hs-identifier">grhssCtOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>
</span><a name="line-2872"></a><a name="grhssCtOrigin"><a href="TcRnTypes.html#grhssCtOrigin"><span class="hs-identifier">grhssCtOrigin</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">grhssGRHSs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933906"><a href="#local-1627933906"><span class="hs-identifier">lgrhss</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#lGRHSCtOrigin"><span class="hs-identifier hs-var">lGRHSCtOrigin</span></a><span> </span><a href="#local-1627933906"><span class="hs-identifier hs-var">lgrhss</span></a><span>
</span><a name="line-2873"></a><span>
</span><a name="line-2874"></a><span class="hs-comment">-- | Extract a suitable CtOrigin from a list of guarded RHSs</span><span>
</span><a name="line-2875"></a><span class="hs-identifier">lGRHSCtOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LGRHS"><span class="hs-identifier hs-type">LGRHS</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span>
</span><a name="line-2876"></a><a name="lGRHSCtOrigin"><a href="TcRnTypes.html#lGRHSCtOrigin"><span class="hs-identifier">lGRHSCtOrigin</span></a></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933907"><a href="#local-1627933907"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#exprCtOrigin"><span class="hs-identifier hs-var">exprCtOrigin</span></a><span> </span><a href="#local-1627933907"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2877"></a><span class="hs-identifier">lGRHSCtOrigin</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><span class="hs-string">&quot;multi-way GRHS&quot;</span><span>
</span><a name="line-2878"></a><span>
</span><a name="line-2879"></a><span class="hs-identifier">pprCtLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2880"></a><span class="hs-comment">-- &quot;arising from ... at ...&quot;</span><span>
</span><a name="line-2881"></a><span class="hs-comment">-- Not an instance of Outputable because of the &quot;arising from&quot; prefix</span><span>
</span><a name="line-2882"></a><a name="pprCtLoc"><a href="TcRnTypes.html#pprCtLoc"><span class="hs-identifier">pprCtLoc</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-var">CtLoc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctl_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933908"><a href="#local-1627933908"><span class="hs-identifier">o</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627933909"><a href="#local-1627933909"><span class="hs-identifier">lcl</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2883"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="TcRnTypes.html#pprCtOrigin"><span class="hs-identifier hs-var">pprCtOrigin</span></a><span> </span><a href="#local-1627933908"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-2884"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_loc</span><span> </span><a href="#local-1627933909"><span class="hs-identifier hs-var">lcl</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2885"></a><span>
</span><a name="line-2886"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2887"></a><span class="hs-comment">-- &quot;arising from ...&quot;</span><span>
</span><a name="line-2888"></a><span class="hs-comment">-- Not an instance of Outputable because of the &quot;arising from&quot; prefix</span><span>
</span><a name="line-2889"></a><a name="pprCtOrigin"><a href="TcRnTypes.html#pprCtOrigin"><span class="hs-identifier">pprCtOrigin</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#GivenOrigin"><span class="hs-identifier hs-var">GivenOrigin</span></a><span> </span><a name="local-1627933910"><a href="#local-1627933910"><span class="hs-identifier">sk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933910"><span class="hs-identifier hs-var">sk</span></a><span>
</span><a name="line-2890"></a><span>
</span><a name="line-2891"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#SpecPragOrigin"><span class="hs-identifier hs-var">SpecPragOrigin</span></a><span> </span><a name="local-1627933911"><a href="#local-1627933911"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2892"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627933911"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2893"></a><span>       </span><a href="TcType.html#FunSigCtxt"><span class="hs-identifier hs-var">FunSigCtxt</span></a><span> </span><a name="local-1627933912"><a href="#local-1627933912"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a SPECIALISE pragma for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933912"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-2894"></a><span>       </span><a href="TcType.html#SpecInstCtxt"><span class="hs-identifier hs-var">SpecInstCtxt</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a SPECIALISE INSTANCE pragma&quot;</span><span>
</span><a name="line-2895"></a><span>       </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a SPECIALISE pragma&quot;</span><span>  </span><span class="hs-comment">-- Never happens I think</span><span>
</span><a name="line-2896"></a><span>
</span><a name="line-2897"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#FunDepOrigin1"><span class="hs-identifier hs-var">FunDepOrigin1</span></a><span> </span><a name="local-1627933913"><a href="#local-1627933913"><span class="hs-identifier">pred1</span></a></a><span> </span><a name="local-1627933914"><a href="#local-1627933914"><span class="hs-identifier">loc1</span></a></a><span> </span><a name="local-1627933915"><a href="#local-1627933915"><span class="hs-identifier">pred2</span></a></a><span> </span><a name="local-1627933916"><a href="#local-1627933916"><span class="hs-identifier">loc2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2898"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a functional dependency between constraints:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2899"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933913"><span class="hs-identifier hs-var">pred1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#pprCtLoc"><span class="hs-identifier hs-var">pprCtLoc</span></a><span> </span><a href="#local-1627933914"><span class="hs-identifier hs-var">loc1</span></a><span class="hs-special">)</span><span>
</span><a name="line-2900"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933915"><span class="hs-identifier hs-var">pred2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#pprCtLoc"><span class="hs-identifier hs-var">pprCtLoc</span></a><span> </span><a href="#local-1627933916"><span class="hs-identifier hs-var">loc2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2901"></a><span>
</span><a name="line-2902"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#FunDepOrigin2"><span class="hs-identifier hs-var">FunDepOrigin2</span></a><span> </span><a name="local-1627933917"><a href="#local-1627933917"><span class="hs-identifier">pred1</span></a></a><span> </span><a name="local-1627933918"><a href="#local-1627933918"><span class="hs-identifier">orig1</span></a></a><span> </span><a name="local-1627933919"><a href="#local-1627933919"><span class="hs-identifier">pred2</span></a></a><span> </span><a name="local-1627933920"><a href="#local-1627933920"><span class="hs-identifier">loc2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2903"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a functional dependency between:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2904"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;constraint&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933917"><span class="hs-identifier hs-var">pred1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2905"></a><span>                    </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#pprCtOrigin"><span class="hs-identifier hs-var">pprCtOrigin</span></a><span> </span><a href="#local-1627933918"><span class="hs-identifier hs-var">orig1</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2906"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;instance&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933919"><span class="hs-identifier hs-var">pred2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2907"></a><span>                    </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933920"><span class="hs-identifier hs-var">loc2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2908"></a><span>
</span><a name="line-2909"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#KindEqOrigin"><span class="hs-identifier hs-var">KindEqOrigin</span></a><span> </span><a name="local-1627933921"><a href="#local-1627933921"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627933922"><a href="#local-1627933922"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-2910"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a kind equality arising from&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2911"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933921"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'~'</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933922"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2912"></a><span>
</span><a name="line-2913"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#KindEqOrigin"><span class="hs-identifier hs-var">KindEqOrigin</span></a><span> </span><a name="local-1627933923"><a href="#local-1627933923"><span class="hs-identifier">t1</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-2914"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a kind equality when matching&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2915"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933923"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span>
</span><a name="line-2916"></a><span>
</span><a name="line-2917"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#UnboundOccurrenceOf"><span class="hs-identifier hs-var">UnboundOccurrenceOf</span></a><span> </span><a name="local-1627933924"><a href="#local-1627933924"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2918"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an undeclared identifier&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933924"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2919"></a><span>
</span><a name="line-2920"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#DerivOriginDC"><span class="hs-identifier hs-var">DerivOriginDC</span></a><span> </span><a name="local-1627933925"><a href="#local-1627933925"><span class="hs-identifier">dc</span></a></a><span> </span><a name="local-1627933926"><a href="#local-1627933926"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2921"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#speakNth"><span class="hs-identifier hs-var">speakNth</span></a><span> </span><a href="#local-1627933926"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2922"></a><span>          </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;field of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933925"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2923"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933927"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2924"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2925"></a><span>    </span><a name="local-1627933927"><a href="#local-1627933927"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span> </span><a href="#local-1627933925"><span class="hs-identifier hs-var">dc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627933926"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-2926"></a><span>
</span><a name="line-2927"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#DerivOriginCoerce"><span class="hs-identifier hs-var">DerivOriginCoerce</span></a><span> </span><a name="local-1627933928"><a href="#local-1627933928"><span class="hs-identifier">meth</span></a></a><span> </span><a name="local-1627933929"><a href="#local-1627933929"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627933930"><a href="#local-1627933930"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2928"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the coercion of the method&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933928"><span class="hs-identifier hs-var">meth</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2929"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;from type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933929"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span>
</span><a name="line-2930"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;to type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933930"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2931"></a><span>
</span><a name="line-2932"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#DoPatOrigin"><span class="hs-identifier hs-var">DoPatOrigin</span></a><span> </span><a name="local-1627933931"><a href="#local-1627933931"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2933"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a do statement&quot;</span><span>
</span><a name="line-2934"></a><span>      </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-2935"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;with the failable pattern&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933931"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-2936"></a><span>
</span><a name="line-2937"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#MCompPatOrigin"><span class="hs-identifier hs-var">MCompPatOrigin</span></a><span> </span><a name="local-1627933932"><a href="#local-1627933932"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2938"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the failable pattern&quot;</span><span>
</span><a name="line-2939"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933932"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-2940"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in a statement in a monad comprehension&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2941"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#FailablePattern"><span class="hs-identifier hs-var">FailablePattern</span></a><span> </span><a name="local-1627933933"><a href="#local-1627933933"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2942"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the failable pattern&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933933"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-2943"></a><span>      </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-2944"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(this will become an error in a future GHC release)&quot;</span><span>
</span><a name="line-2945"></a><span>
</span><a name="line-2946"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Shouldn%27tHappenOrigin"><span class="hs-identifier hs-var">Shouldn'tHappenOrigin</span></a><span> </span><a name="local-1627933934"><a href="#local-1627933934"><span class="hs-identifier">note</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2947"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627933935"><a href="#local-1627933935"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2948"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="DynFlags.html#xopt"><span class="hs-identifier hs-var">xopt</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#ImpredicativeTypes"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ImpredicativeTypes</span></a><span> </span><a href="#local-1627933935"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2949"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a situation created by impredicative types&quot;</span><span>
</span><a name="line-2950"></a><span>    </span><span class="hs-keyword">else</span><span>
</span><a name="line-2951"></a><span>    </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;&lt;&lt; This should not appear in error messages. If you see this&quot;</span><span>
</span><a name="line-2952"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in an error message, please report a bug mentioning&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1627933934"><span class="hs-identifier hs-var">note</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span>
</span><a name="line-2953"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;https://ghc.haskell.org/trac/ghc/wiki/ReportABug &gt;&gt;&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2954"></a><span>
</span><a name="line-2955"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ProvCtxtOrigin"><span class="hs-identifier hs-var">ProvCtxtOrigin</span></a><span> </span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627933936"><a href="#local-1627933936"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2956"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the \&quot;provided\&quot; constraints claimed by&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2957"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the signature of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933936"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2958"></a><span>
</span><a name="line-2959"></a><span class="hs-identifier">pprCtOrigin</span><span> </span><a name="local-1627933937"><a href="#local-1627933937"><span class="hs-identifier">simple_origin</span></a></a><span>
</span><a name="line-2960"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctoHerald"><span class="hs-identifier hs-var">ctoHerald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcRnTypes.html#pprCtO"><span class="hs-identifier hs-var">pprCtO</span></a><span> </span><a href="#local-1627933937"><span class="hs-identifier hs-var">simple_origin</span></a><span>
</span><a name="line-2961"></a><span>
</span><a name="line-2962"></a><span class="hs-comment">-- | Short one-liners</span><span>
</span><a name="line-2963"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2964"></a><a name="pprCtO"><a href="TcRnTypes.html#pprCtO"><span class="hs-identifier">pprCtO</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a><span> </span><a name="local-1627933938"><a href="#local-1627933938"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a use of&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933938"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2965"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#OccurrenceOfRecSel"><span class="hs-identifier hs-var">OccurrenceOfRecSel</span></a><span> </span><a name="local-1627933939"><a href="#local-1627933939"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a use of&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933939"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2966"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#AppOrigin"><span class="hs-identifier hs-var">AppOrigin</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an application&quot;</span><span>
</span><a name="line-2967"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#IPOccOrigin"><span class="hs-identifier hs-var">IPOccOrigin</span></a><span> </span><a name="local-1627933940"><a href="#local-1627933940"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a use of implicit parameter&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933940"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2968"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#OverLabelOrigin"><span class="hs-identifier hs-var">OverLabelOrigin</span></a><span> </span><a name="local-1627933941"><a href="#local-1627933941"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the overloaded label&quot;</span><span>
</span><a name="line-2969"></a><span>                                    </span><span class="hs-special">,</span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'#'</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933941"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2970"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#RecordUpdOrigin"><span class="hs-identifier hs-var">RecordUpdOrigin</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a record update&quot;</span><span>
</span><a name="line-2971"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#ExprSigOrigin"><span class="hs-identifier hs-var">ExprSigOrigin</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an expression type signature&quot;</span><span>
</span><a name="line-2972"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#PatSigOrigin"><span class="hs-identifier hs-var">PatSigOrigin</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a pattern type signature&quot;</span><span>
</span><a name="line-2973"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#PatOrigin"><span class="hs-identifier hs-var">PatOrigin</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a pattern&quot;</span><span>
</span><a name="line-2974"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#ViewPatOrigin"><span class="hs-identifier hs-var">ViewPatOrigin</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a view pattern&quot;</span><span>
</span><a name="line-2975"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#IfOrigin"><span class="hs-identifier hs-var">IfOrigin</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an if expression&quot;</span><span>
</span><a name="line-2976"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#LiteralOrigin"><span class="hs-identifier hs-var">LiteralOrigin</span></a><span> </span><a name="local-1627933942"><a href="#local-1627933942"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the literal&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933942"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2977"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ArithSeqOrigin"><span class="hs-identifier hs-var">ArithSeqOrigin</span></a><span> </span><a name="local-1627933943"><a href="#local-1627933943"><span class="hs-identifier">seq</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the arithmetic sequence&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933943"><span class="hs-identifier hs-var">seq</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2978"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#PArrSeqOrigin"><span class="hs-identifier hs-var">PArrSeqOrigin</span></a><span> </span><a name="local-1627933944"><a href="#local-1627933944"><span class="hs-identifier">seq</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the parallel array sequence&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933944"><span class="hs-identifier hs-var">seq</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2979"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#SectionOrigin"><span class="hs-identifier hs-var">SectionOrigin</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an operator section&quot;</span><span>
</span><a name="line-2980"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#TupleOrigin"><span class="hs-identifier hs-var">TupleOrigin</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a tuple&quot;</span><span>
</span><a name="line-2981"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#NegateOrigin"><span class="hs-identifier hs-var">NegateOrigin</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a use of syntactic negation&quot;</span><span>
</span><a name="line-2982"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ScOrigin"><span class="hs-identifier hs-var">ScOrigin</span></a><span> </span><a name="local-1627933945"><a href="#local-1627933945"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the superclasses of an instance declaration&quot;</span><span>
</span><a name="line-2983"></a><span>                               </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ifPprDebug"><span class="hs-identifier hs-var">ifPprDebug</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933945"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2984"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#DerivOrigin"><span class="hs-identifier hs-var">DerivOrigin</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the 'deriving' clause of a data type declaration&quot;</span><span>
</span><a name="line-2985"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#StandAloneDerivOrigin"><span class="hs-identifier hs-var">StandAloneDerivOrigin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a 'deriving' declaration&quot;</span><span>
</span><a name="line-2986"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#DefaultOrigin"><span class="hs-identifier hs-var">DefaultOrigin</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a 'default' declaration&quot;</span><span>
</span><a name="line-2987"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#DoOrigin"><span class="hs-identifier hs-var">DoOrigin</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a do statement&quot;</span><span>
</span><a name="line-2988"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#MCompOrigin"><span class="hs-identifier hs-var">MCompOrigin</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a statement in a monad comprehension&quot;</span><span>
</span><a name="line-2989"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#ProcOrigin"><span class="hs-identifier hs-var">ProcOrigin</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a proc expression&quot;</span><span>
</span><a name="line-2990"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TypeEqOrigin"><span class="hs-identifier hs-var">TypeEqOrigin</span></a><span> </span><a name="local-1627933946"><a href="#local-1627933946"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627933947"><a href="#local-1627933947"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a type equality&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933946"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'~'</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627933947"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-2991"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#AnnOrigin"><span class="hs-identifier hs-var">AnnOrigin</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an annotation&quot;</span><span>
</span><a name="line-2992"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#HoleOrigin"><span class="hs-identifier hs-var">HoleOrigin</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a use of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2993"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#ListOrigin"><span class="hs-identifier hs-var">ListOrigin</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an overloaded list&quot;</span><span>
</span><a name="line-2994"></a><span class="hs-identifier">pprCtO</span><span> </span><a href="TcRnTypes.html#StaticOrigin"><span class="hs-identifier hs-var">StaticOrigin</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a static form&quot;</span><span>
</span><a name="line-2995"></a><span class="hs-identifier">pprCtO</span><span> </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;pprCtOrigin&quot;</span><span>
</span><a name="line-2996"></a><span>
</span><a name="line-2997"></a><span class="hs-comment">{-
Constraint Solver Plugins
-------------------------
-}</span><span>
</span><a name="line-3001"></a><span>
</span><a name="line-3002"></a><span class="hs-keyword">type</span><span> </span><a name="TcPluginSolver"><a href="TcRnTypes.html#TcPluginSolver"><span class="hs-identifier">TcPluginSolver</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- given</span><span>
</span><a name="line-3003"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- derived</span><span>
</span><a name="line-3004"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- wanted</span><span>
</span><a name="line-3005"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><a href="TcRnTypes.html#TcPluginResult"><span class="hs-identifier hs-type">TcPluginResult</span></a><span>
</span><a name="line-3006"></a><span>
</span><a name="line-3007"></a><span class="hs-keyword">newtype</span><span> </span><a name="TcPluginM"><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier">TcPluginM</span></a></a><span> </span><a name="local-1627933656"><a href="#local-1627933656"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TcPluginM"><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier">TcPluginM</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1627933656"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-3008"></a><span>
</span><a name="line-3009"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span>     </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-3010"></a><span>  </span><a name="local-805306541"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span>
</span><a name="line-3011"></a><span>
</span><a name="line-3012"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-3013"></a><span>  </span><a name="local-805307120"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier">pure</span></a></a><span> </span><a name="local-1627933955"><a href="#local-1627933955"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-var">TcPluginM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="#local-1627933955"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-3014"></a><span>  </span><span class="hs-special">(</span><a name="local-805307119"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator">&lt;*&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#ap"><span class="hs-identifier hs-var">ap</span></a><span>
</span><a name="line-3015"></a><span>
</span><a name="line-3016"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-3017"></a><span>  </span><a name="local-805306538"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><a name="local-1627933950"><a href="#local-1627933950"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-var">TcPluginM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fail"><span class="hs-identifier hs-var">fail</span></a><span> </span><a href="#local-1627933950"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-3018"></a><span>  </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-var">TcPluginM</span></a><span> </span><a name="local-1627933951"><a href="#local-1627933951"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-805306539"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E%3D"><span class="hs-operator">&gt;&gt;=</span></a></a><span> </span><a name="local-1627933952"><a href="#local-1627933952"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3019"></a><span>    </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-var">TcPluginM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627933953"><a href="#local-1627933953"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1627933954"><a href="#local-1627933954"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627933951"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1627933953"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-3020"></a><span>                          </span><a href="TcRnTypes.html#runTcPluginM"><span class="hs-identifier hs-var">runTcPluginM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627933952"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627933954"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627933953"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">)</span><span>
</span><a name="line-3021"></a><span>
</span><a name="line-3022"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710</span><span>
</span><a name="line-3023"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html#MonadFail"><span class="hs-identifier hs-type">MonadFail</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MonadFail</span></a><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-3024"></a><span>  </span><a name="local-805306544"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><a name="local-1627933949"><a href="#local-1627933949"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-var">TcPluginM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fail"><span class="hs-identifier hs-var">fail</span></a><span> </span><a href="#local-1627933949"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-3025"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-3026"></a><span>
</span><a name="line-3027"></a><span class="hs-identifier">runTcPluginM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><a href="#local-1627933665"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1627933665"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-3028"></a><a name="runTcPluginM"><a href="TcRnTypes.html#runTcPluginM"><span class="hs-identifier">runTcPluginM</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-var">TcPluginM</span></a><span> </span><a name="local-1627933948"><a href="#local-1627933948"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627933948"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-3029"></a><span>
</span><a name="line-3030"></a><span class="hs-comment">-- | This function provides an escape for direct access to</span><span>
</span><a name="line-3031"></a><span class="hs-comment">-- the 'TcM` monad.  It should not be used lightly, and</span><span>
</span><a name="line-3032"></a><span class="hs-comment">-- the provided 'TcPluginM' API should be favoured instead.</span><span>
</span><a name="line-3033"></a><span class="hs-identifier">unsafeTcPluginTcM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1627933664"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><a href="#local-1627933664"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-3034"></a><a name="unsafeTcPluginTcM"><a href="TcRnTypes.html#unsafeTcPluginTcM"><span class="hs-identifier">unsafeTcPluginTcM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-var">TcPluginM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span>
</span><a name="line-3035"></a><span>
</span><a name="line-3036"></a><span class="hs-comment">-- | Access the 'EvBindsVar' carried by the 'TcPluginM' during</span><span>
</span><a name="line-3037"></a><span class="hs-comment">-- constraint solving.  Returns 'Nothing' if invoked during</span><span>
</span><a name="line-3038"></a><span class="hs-comment">-- 'tcPluginInit' or 'tcPluginStop'.</span><span>
</span><a name="line-3039"></a><span class="hs-identifier">getEvBindsTcPluginM_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-3040"></a><a name="getEvBindsTcPluginM_maybe"><a href="TcRnTypes.html#getEvBindsTcPluginM_maybe"><span class="hs-identifier">getEvBindsTcPluginM_maybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-var">TcPluginM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span>
</span><a name="line-3041"></a><span>
</span><a name="line-3042"></a><span>
</span><a name="line-3043"></a><span class="hs-keyword">data</span><span> </span><a name="TcPlugin"><a href="TcRnTypes.html#TcPlugin"><span class="hs-identifier">TcPlugin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627933655"><a href="#local-1627933655"><span class="hs-identifier">s</span></a></a><span class="hs-operator">.</span><span> </span><a name="TcPlugin"><a href="TcRnTypes.html#TcPlugin"><span class="hs-identifier">TcPlugin</span></a></a><span>
</span><a name="line-3044"></a><span>  </span><span class="hs-special">{</span><span> </span><a href="TcRnTypes.html#tcPluginInit"><span class="hs-identifier">tcPluginInit</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><a href="#local-1627933655"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-3045"></a><span>    </span><span class="hs-comment">-- ^ Initialize plugin, when entering type-checker.</span><span>
</span><a name="line-3046"></a><span>
</span><a name="line-3047"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#tcPluginSolve"><span class="hs-identifier">tcPluginSolve</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627933655"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcPluginSolver"><span class="hs-identifier hs-type">TcPluginSolver</span></a><span>
</span><a name="line-3048"></a><span>    </span><span class="hs-comment">-- ^ Solve some constraints.</span><span>
</span><a name="line-3049"></a><span>    </span><span class="hs-comment">-- TODO: WRITE MORE DETAILS ON HOW THIS WORKS.</span><span>
</span><a name="line-3050"></a><span>
</span><a name="line-3051"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#tcPluginStop"><span class="hs-identifier">tcPluginStop</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627933655"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcPluginM"><span class="hs-identifier hs-type">TcPluginM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3052"></a><span>   </span><span class="hs-comment">-- ^ Clean up after the plugin, when exiting the type-checker.</span><span>
</span><a name="line-3053"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-3054"></a><span>
</span><a name="line-3055"></a><span class="hs-keyword">data</span><span> </span><a name="TcPluginResult"><a href="TcRnTypes.html#TcPluginResult"><span class="hs-identifier">TcPluginResult</span></a></a><span>
</span><a name="line-3056"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TcPluginContradiction"><a href="TcRnTypes.html#TcPluginContradiction"><span class="hs-identifier">TcPluginContradiction</span></a></a><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span>
</span><a name="line-3057"></a><span>    </span><span class="hs-comment">-- ^ The plugin found a contradiction.</span><span>
</span><a name="line-3058"></a><span>    </span><span class="hs-comment">-- The returned constraints are removed from the inert set,</span><span>
</span><a name="line-3059"></a><span>    </span><span class="hs-comment">-- and recorded as insoluable.</span><span>
</span><a name="line-3060"></a><span>
</span><a name="line-3061"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TcPluginOk"><a href="TcRnTypes.html#TcPluginOk"><span class="hs-identifier">TcPluginOk</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span class="hs-special">,</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span>
</span><a name="line-3062"></a><span>    </span><span class="hs-comment">-- ^ The first field is for constraints that were solved.</span><span>
</span><a name="line-3063"></a><span>    </span><span class="hs-comment">-- These are removed from the inert set,</span><span>
</span><a name="line-3064"></a><span>    </span><span class="hs-comment">-- and the evidence for them is recorded.</span><span>
</span><a name="line-3065"></a><span>    </span><span class="hs-comment">-- The second field contains new work, that should be processed by</span><span>
</span><a name="line-3066"></a><span>    </span><span class="hs-comment">-- the constraint solver.</span><span>
</span><a name="line-3067"></a></pre></body></html>