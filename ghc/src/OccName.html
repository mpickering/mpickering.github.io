<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998
-}</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable, BangPatterns #-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- #name_types#</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- GHC uses several kinds of name internally:</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- * 'OccName.OccName' represents names as strings with just a little more information:</span><span>
</span><a name="line-13"></a><span class="hs-comment">--   the \&quot;namespace\&quot; that the name came from, e.g. the namespace of value, type constructors or</span><span>
</span><a name="line-14"></a><span class="hs-comment">--   data constructors</span><span>
</span><a name="line-15"></a><span class="hs-comment">--</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- * 'RdrName.RdrName': see &quot;RdrName#name_types&quot;</span><span>
</span><a name="line-17"></a><span class="hs-comment">--</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- * 'Name.Name': see &quot;Name#name_types&quot;</span><span>
</span><a name="line-19"></a><span class="hs-comment">--</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- * 'Id.Id': see &quot;Id#name_types&quot;</span><span>
</span><a name="line-21"></a><span class="hs-comment">--</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- * 'Var.Var': see &quot;Var#name_types&quot;</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OccName</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-25"></a><span>        </span><span class="hs-comment">-- * The 'NameSpace' type</span><span>
</span><a name="line-26"></a><span>        </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Abstract</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>        </span><a href="OccName.html#nameSpacesRelated"><span class="hs-identifier hs-var">nameSpacesRelated</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>        </span><span class="hs-comment">-- ** Construction</span><span>
</span><a name="line-31"></a><span>        </span><span class="hs-comment">-- $real_vs_source_data_constructors</span><span>
</span><a name="line-32"></a><span>        </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#clsName"><span class="hs-identifier hs-var">clsName</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#tcClsName"><span class="hs-identifier hs-var">tcClsName</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#dataName"><span class="hs-identifier hs-var">dataName</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="OccName.html#tvName"><span class="hs-identifier hs-var">tvName</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#srcDataName"><span class="hs-identifier hs-var">srcDataName</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>        </span><span class="hs-comment">-- ** Pretty Printing</span><span>
</span><a name="line-36"></a><span>        </span><a href="OccName.html#pprNameSpace"><span class="hs-identifier hs-var">pprNameSpace</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#pprNonVarNameSpace"><span class="hs-identifier hs-var">pprNonVarNameSpace</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#pprNameSpaceBrief"><span class="hs-identifier hs-var">pprNameSpaceBrief</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span>        </span><span class="hs-comment">-- * The 'OccName' type</span><span>
</span><a name="line-39"></a><span>        </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- Abstract, instance of Outputable</span><span>
</span><a name="line-40"></a><span>        </span><a href="OccName.html#pprOccName"><span class="hs-identifier hs-var">pprOccName</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>        </span><span class="hs-comment">-- ** Construction</span><span>
</span><a name="line-43"></a><span>        </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkOccNameFS"><span class="hs-identifier hs-var">mkOccNameFS</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>        </span><a href="OccName.html#mkVarOcc"><span class="hs-identifier hs-var">mkVarOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>        </span><a href="OccName.html#mkDataOcc"><span class="hs-identifier hs-var">mkDataOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkDataOccFS"><span class="hs-identifier hs-var">mkDataOccFS</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>        </span><a href="OccName.html#mkTyVarOcc"><span class="hs-identifier hs-var">mkTyVarOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkTyVarOccFS"><span class="hs-identifier hs-var">mkTyVarOccFS</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>        </span><a href="OccName.html#mkTcOcc"><span class="hs-identifier hs-var">mkTcOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkTcOccFS"><span class="hs-identifier hs-var">mkTcOccFS</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>        </span><a href="OccName.html#mkClsOcc"><span class="hs-identifier hs-var">mkClsOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkClsOccFS"><span class="hs-identifier hs-var">mkClsOccFS</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>        </span><a href="OccName.html#mkDFunOcc"><span class="hs-identifier hs-var">mkDFunOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>        </span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>        </span><a href="OccName.html#demoteOccName"><span class="hs-identifier hs-var">demoteOccName</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>        </span><a href="OccName.html#HasOccName"><span class="hs-identifier hs-type">HasOccName</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>        </span><span class="hs-comment">-- ** Derived 'OccName's</span><span>
</span><a name="line-55"></a><span>        </span><a href="OccName.html#isDerivedOccName"><span class="hs-identifier hs-var">isDerivedOccName</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>        </span><a href="OccName.html#mkDataConWrapperOcc"><span class="hs-identifier hs-var">mkDataConWrapperOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkWorkerOcc"><span class="hs-identifier hs-var">mkWorkerOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>        </span><a href="OccName.html#mkMatcherOcc"><span class="hs-identifier hs-var">mkMatcherOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkBuilderOcc"><span class="hs-identifier hs-var">mkBuilderOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>        </span><a href="OccName.html#mkDefaultMethodOcc"><span class="hs-identifier hs-var">mkDefaultMethodOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>        </span><a href="OccName.html#mkNewTyCoOcc"><span class="hs-identifier hs-var">mkNewTyCoOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkClassOpAuxOcc"><span class="hs-identifier hs-var">mkClassOpAuxOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>        </span><a href="OccName.html#mkCon2TagOcc"><span class="hs-identifier hs-var">mkCon2TagOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkTag2ConOcc"><span class="hs-identifier hs-var">mkTag2ConOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkMaxTagOcc"><span class="hs-identifier hs-var">mkMaxTagOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>        </span><a href="OccName.html#mkClassDataConOcc"><span class="hs-identifier hs-var">mkClassDataConOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkDictOcc"><span class="hs-identifier hs-var">mkDictOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkIPOcc"><span class="hs-identifier hs-var">mkIPOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>        </span><a href="OccName.html#mkSpecOcc"><span class="hs-identifier hs-var">mkSpecOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkForeignExportOcc"><span class="hs-identifier hs-var">mkForeignExportOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkRepEqOcc"><span class="hs-identifier hs-var">mkRepEqOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>        </span><a href="OccName.html#mkGenD"><span class="hs-identifier hs-var">mkGenD</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkGenR"><span class="hs-identifier hs-var">mkGenR</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkGen1R"><span class="hs-identifier hs-var">mkGen1R</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkGenRCo"><span class="hs-identifier hs-var">mkGenRCo</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkGenC"><span class="hs-identifier hs-var">mkGenC</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkGenS"><span class="hs-identifier hs-var">mkGenS</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>        </span><a href="OccName.html#mkDataTOcc"><span class="hs-identifier hs-var">mkDataTOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkDataCOcc"><span class="hs-identifier hs-var">mkDataCOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkDataConWorkerOcc"><span class="hs-identifier hs-var">mkDataConWorkerOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>        </span><a href="OccName.html#mkSuperDictSelOcc"><span class="hs-identifier hs-var">mkSuperDictSelOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkSuperDictAuxOcc"><span class="hs-identifier hs-var">mkSuperDictAuxOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>        </span><a href="OccName.html#mkLocalOcc"><span class="hs-identifier hs-var">mkLocalOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkMethodOcc"><span class="hs-identifier hs-var">mkMethodOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkInstTyTcOcc"><span class="hs-identifier hs-var">mkInstTyTcOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>        </span><a href="OccName.html#mkInstTyCoOcc"><span class="hs-identifier hs-var">mkInstTyCoOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkEqPredCoOcc"><span class="hs-identifier hs-var">mkEqPredCoOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>        </span><a href="OccName.html#mkVectOcc"><span class="hs-identifier hs-var">mkVectOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkVectTyConOcc"><span class="hs-identifier hs-var">mkVectTyConOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkVectDataConOcc"><span class="hs-identifier hs-var">mkVectDataConOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkVectIsoOcc"><span class="hs-identifier hs-var">mkVectIsoOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>        </span><a href="OccName.html#mkPDataTyConOcc"><span class="hs-identifier hs-var">mkPDataTyConOcc</span></a><span class="hs-special">,</span><span>  </span><a href="OccName.html#mkPDataDataConOcc"><span class="hs-identifier hs-var">mkPDataDataConOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>        </span><a href="OccName.html#mkPDatasTyConOcc"><span class="hs-identifier hs-var">mkPDatasTyConOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkPDatasDataConOcc"><span class="hs-identifier hs-var">mkPDatasDataConOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>        </span><a href="OccName.html#mkPReprTyConOcc"><span class="hs-identifier hs-var">mkPReprTyConOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>        </span><a href="OccName.html#mkPADFunOcc"><span class="hs-identifier hs-var">mkPADFunOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>        </span><a href="OccName.html#mkRecFldSelOcc"><span class="hs-identifier hs-var">mkRecFldSelOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>        </span><a href="OccName.html#mkTyConRepOcc"><span class="hs-identifier hs-var">mkTyConRepOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>        </span><span class="hs-comment">-- ** Deconstruction</span><span>
</span><a name="line-77"></a><span>        </span><a href="OccName.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#occNameSpace"><span class="hs-identifier hs-var">occNameSpace</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>        </span><a href="OccName.html#isVarOcc"><span class="hs-identifier hs-var">isVarOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isTvOcc"><span class="hs-identifier hs-var">isTvOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isTcOcc"><span class="hs-identifier hs-var">isTcOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isDataSymOcc"><span class="hs-identifier hs-var">isDataSymOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isValOcc"><span class="hs-identifier hs-var">isValOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>        </span><a href="OccName.html#parenSymOcc"><span class="hs-identifier hs-var">parenSymOcc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#startsWithUnderscore"><span class="hs-identifier hs-var">startsWithUnderscore</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>        </span><a href="OccName.html#isTcClsNameSpace"><span class="hs-identifier hs-var">isTcClsNameSpace</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isTvNameSpace"><span class="hs-identifier hs-var">isTvNameSpace</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isDataConNameSpace"><span class="hs-identifier hs-var">isDataConNameSpace</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isVarNameSpace"><span class="hs-identifier hs-var">isVarNameSpace</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isValNameSpace"><span class="hs-identifier hs-var">isValNameSpace</span></a><span class="hs-special">,</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span>        </span><span class="hs-comment">-- * The 'OccEnv' type</span><span>
</span><a name="line-85"></a><span>        </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#emptyOccEnv"><span class="hs-identifier hs-var">emptyOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#unitOccEnv"><span class="hs-identifier hs-var">unitOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#extendOccEnv"><span class="hs-identifier hs-var">extendOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mapOccEnv"><span class="hs-identifier hs-var">mapOccEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>        </span><a href="OccName.html#lookupOccEnv"><span class="hs-identifier hs-var">lookupOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkOccEnv"><span class="hs-identifier hs-var">mkOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkOccEnv_C"><span class="hs-identifier hs-var">mkOccEnv_C</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#extendOccEnvList"><span class="hs-identifier hs-var">extendOccEnvList</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#elemOccEnv"><span class="hs-identifier hs-var">elemOccEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>        </span><a href="OccName.html#occEnvElts"><span class="hs-identifier hs-var">occEnvElts</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#foldOccEnv"><span class="hs-identifier hs-var">foldOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#plusOccEnv"><span class="hs-identifier hs-var">plusOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#plusOccEnv_C"><span class="hs-identifier hs-var">plusOccEnv_C</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#extendOccEnv_C"><span class="hs-identifier hs-var">extendOccEnv_C</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>        </span><a href="OccName.html#extendOccEnv_Acc"><span class="hs-identifier hs-var">extendOccEnv_Acc</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#filterOccEnv"><span class="hs-identifier hs-var">filterOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#delListFromOccEnv"><span class="hs-identifier hs-var">delListFromOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#delFromOccEnv"><span class="hs-identifier hs-var">delFromOccEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-89"></a><span>        </span><a href="OccName.html#alterOccEnv"><span class="hs-identifier hs-var">alterOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#pprOccEnv"><span class="hs-identifier hs-var">pprOccEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span>        </span><span class="hs-comment">-- * The 'OccSet' type</span><span>
</span><a name="line-92"></a><span>        </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#emptyOccSet"><span class="hs-identifier hs-var">emptyOccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#unitOccSet"><span class="hs-identifier hs-var">unitOccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkOccSet"><span class="hs-identifier hs-var">mkOccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#extendOccSet"><span class="hs-identifier hs-var">extendOccSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-93"></a><span>        </span><a href="OccName.html#extendOccSetList"><span class="hs-identifier hs-var">extendOccSetList</span></a><span class="hs-special">,</span><span>
</span><a name="line-94"></a><span>        </span><a href="OccName.html#unionOccSets"><span class="hs-identifier hs-var">unionOccSets</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#unionManyOccSets"><span class="hs-identifier hs-var">unionManyOccSets</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#minusOccSet"><span class="hs-identifier hs-var">minusOccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#elemOccSet"><span class="hs-identifier hs-var">elemOccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#occSetElts"><span class="hs-identifier hs-var">occSetElts</span></a><span class="hs-special">,</span><span>
</span><a name="line-95"></a><span>        </span><a href="OccName.html#foldOccSet"><span class="hs-identifier hs-var">foldOccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#isEmptyOccSet"><span class="hs-identifier hs-var">isEmptyOccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#intersectOccSet"><span class="hs-identifier hs-var">intersectOccSet</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#intersectsOccSet"><span class="hs-identifier hs-var">intersectsOccSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-96"></a><span>        </span><a href="OccName.html#filterOccSet"><span class="hs-identifier hs-var">filterOccSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span>        </span><span class="hs-comment">-- * Tidying up</span><span>
</span><a name="line-99"></a><span>        </span><a href="OccName.html#TidyOccEnv"><span class="hs-identifier hs-type">TidyOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#emptyTidyOccEnv"><span class="hs-identifier hs-var">emptyTidyOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#tidyOccName"><span class="hs-identifier hs-var">tidyOccName</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#initTidyOccEnv"><span class="hs-identifier hs-var">initTidyOccEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>        </span><span class="hs-comment">-- FsEnv</span><span>
</span><a name="line-102"></a><span>        </span><a href="FastStringEnv.html#FastStringEnv"><span class="hs-identifier hs-type">FastStringEnv</span></a><span class="hs-special">,</span><span> </span><a href="FastStringEnv.html#emptyFsEnv"><span class="hs-identifier hs-var">emptyFsEnv</span></a><span class="hs-special">,</span><span> </span><a href="FastStringEnv.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a><span class="hs-special">,</span><span> </span><a href="FastStringEnv.html#extendFsEnv"><span class="hs-identifier hs-var">extendFsEnv</span></a><span class="hs-special">,</span><span> </span><a href="FastStringEnv.html#mkFsEnv"><span class="hs-identifier hs-var">mkFsEnv</span></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-106"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span>
</span><a name="line-107"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span> </span><a href="UniqFM.html"><span class="hs-identifier">UniqFM</span></a><span>
</span><a name="line-109"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSet.html"><span class="hs-identifier">UniqSet</span></a><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><a href="FastStringEnv.html"><span class="hs-identifier">FastStringEnv</span></a><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span> </span><a href="Lexeme.html"><span class="hs-identifier">Lexeme</span></a><span>
</span><a name="line-114"></a><span class="hs-keyword">import</span><span> </span><a href="Binary.html"><span class="hs-identifier">Binary</span></a><span>
</span><a name="line-115"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-116"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Char.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span></a><span>
</span><a name="line-117"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Name space}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-keyword">data</span><span> </span><a name="NameSpace"><a href="OccName.html#NameSpace"><span class="hs-identifier">NameSpace</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="VarName"><a href="OccName.html#VarName"><span class="hs-identifier">VarName</span></a></a><span>        </span><span class="hs-comment">-- Variables, including &quot;real&quot; data constructors</span><span>
</span><a name="line-128"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="DataName"><a href="OccName.html#DataName"><span class="hs-identifier">DataName</span></a></a><span>       </span><span class="hs-comment">-- &quot;Source&quot; data constructors</span><span>
</span><a name="line-129"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="TvName"><a href="OccName.html#TvName"><span class="hs-identifier">TvName</span></a></a><span>         </span><span class="hs-comment">-- Type variables</span><span>
</span><a name="line-130"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="TcClsName"><a href="OccName.html#TcClsName"><span class="hs-identifier">TcClsName</span></a></a><span>      </span><span class="hs-comment">-- Type constructors and classes; Haskell has them</span><span>
</span><a name="line-131"></a><span>                                </span><span class="hs-comment">-- in the same name space for now.</span><span>
</span><a name="line-132"></a><span>               </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>   </span><span class="hs-comment">{-! derive: Binary !-}</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- Note [Data Constructors]</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- see also: Note [Data Constructor Naming] in DataCon.hs</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- $real_vs_source_data_constructors</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- There are two forms of data constructor:</span><span>
</span><a name="line-140"></a><span class="hs-comment">--</span><span>
</span><a name="line-141"></a><span class="hs-comment">--      [Source data constructors] The data constructors mentioned in Haskell source code</span><span>
</span><a name="line-142"></a><span class="hs-comment">--</span><span>
</span><a name="line-143"></a><span class="hs-comment">--      [Real data constructors] The data constructors of the representation type, which may not be the same as the source type</span><span>
</span><a name="line-144"></a><span class="hs-comment">--</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- For example:</span><span>
</span><a name="line-146"></a><span class="hs-comment">--</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- &gt; data T = T !(Int, Int)</span><span>
</span><a name="line-148"></a><span class="hs-comment">--</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- The source datacon has type @(Int, Int) -&gt; T@</span><span>
</span><a name="line-150"></a><span class="hs-comment">-- The real   datacon has type @Int -&gt; Int -&gt; T@</span><span>
</span><a name="line-151"></a><span class="hs-comment">--</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- GHC chooses a representation based on the strictness etc.</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-identifier">tcName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">clsName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcClsName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span>
</span><a name="line-155"></a><span class="hs-identifier">dataName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">srcDataName</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span>
</span><a name="line-156"></a><span class="hs-identifier">tvName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">varName</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- Though type constructors and classes are in the same name space now,</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- the NameSpace type is abstract, so we can easily separate them later</span><span>
</span><a name="line-160"></a><a name="tcName"><a href="OccName.html#tcName"><span class="hs-identifier">tcName</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span>           </span><span class="hs-comment">-- Type constructors</span><span>
</span><a name="line-161"></a><a name="clsName"><a href="OccName.html#clsName"><span class="hs-identifier">clsName</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span>           </span><span class="hs-comment">-- Classes</span><span>
</span><a name="line-162"></a><a name="tcClsName"><a href="OccName.html#tcClsName"><span class="hs-identifier">tcClsName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span>           </span><span class="hs-comment">-- Not sure which!</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><a name="dataName"><a href="OccName.html#dataName"><span class="hs-identifier">dataName</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span>
</span><a name="line-165"></a><a name="srcDataName"><a href="OccName.html#srcDataName"><span class="hs-identifier">srcDataName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span>  </span><span class="hs-comment">-- Haskell-source data constructors should be</span><span>
</span><a name="line-166"></a><span>                        </span><span class="hs-comment">-- in the Data name space</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><a name="tvName"><a href="OccName.html#tvName"><span class="hs-identifier">tvName</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span>
</span><a name="line-169"></a><a name="varName"><a href="OccName.html#varName"><span class="hs-identifier">varName</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-identifier">isDataConNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-172"></a><a name="isDataConNameSpace"><a href="OccName.html#isDataConNameSpace"><span class="hs-identifier">isDataConNameSpace</span></a></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-173"></a><span class="hs-identifier">isDataConNameSpace</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-identifier">isTcClsNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-176"></a><a name="isTcClsNameSpace"><a href="OccName.html#isTcClsNameSpace"><span class="hs-identifier">isTcClsNameSpace</span></a></a><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-177"></a><span class="hs-identifier">isTcClsNameSpace</span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-identifier">isTvNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-180"></a><a name="isTvNameSpace"><a href="OccName.html#isTvNameSpace"><span class="hs-identifier">isTvNameSpace</span></a></a><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-181"></a><span class="hs-identifier">isTvNameSpace</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">isVarNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>     </span><span class="hs-comment">-- Variables or type variables, but not constructors</span><span>
</span><a name="line-184"></a><a name="isVarNameSpace"><a href="OccName.html#isVarNameSpace"><span class="hs-identifier">isVarNameSpace</span></a></a><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-185"></a><span class="hs-identifier">isVarNameSpace</span><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-186"></a><span class="hs-identifier">isVarNameSpace</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-identifier">isValNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-189"></a><a name="isValNameSpace"><a href="OccName.html#isValNameSpace"><span class="hs-identifier">isValNameSpace</span></a></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-190"></a><span class="hs-identifier">isValNameSpace</span><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-191"></a><span class="hs-identifier">isValNameSpace</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-identifier">pprNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-194"></a><a name="pprNameSpace"><a href="OccName.html#pprNameSpace"><span class="hs-identifier">pprNameSpace</span></a></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;data constructor&quot;</span><span>
</span><a name="line-195"></a><span class="hs-identifier">pprNameSpace</span><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;variable&quot;</span><span>
</span><a name="line-196"></a><span class="hs-identifier">pprNameSpace</span><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type variable&quot;</span><span>
</span><a name="line-197"></a><span class="hs-identifier">pprNameSpace</span><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type constructor or class&quot;</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-identifier">pprNonVarNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-200"></a><a name="pprNonVarNameSpace"><a href="OccName.html#pprNonVarNameSpace"><span class="hs-identifier">pprNonVarNameSpace</span></a></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-201"></a><span class="hs-identifier">pprNonVarNameSpace</span><span> </span><a name="local-1627544194"><a href="#local-1627544194"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#pprNameSpace"><span class="hs-identifier hs-var">pprNameSpace</span></a><span> </span><a href="#local-1627544194"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-identifier">pprNameSpaceBrief</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-204"></a><a name="pprNameSpaceBrief"><a href="OccName.html#pprNameSpaceBrief"><span class="hs-identifier">pprNameSpaceBrief</span></a></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'d'</span><span>
</span><a name="line-205"></a><span class="hs-identifier">pprNameSpaceBrief</span><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'v'</span><span>
</span><a name="line-206"></a><span class="hs-identifier">pprNameSpaceBrief</span><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;tv&quot;</span><span>
</span><a name="line-207"></a><span class="hs-identifier">pprNameSpaceBrief</span><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;tc&quot;</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- demoteNameSpace lowers the NameSpace if possible.  We can not know</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- in advance, since a TvName can appear in an HsTyVar.</span><span>
</span><a name="line-211"></a><span class="hs-comment">-- See Note [Demotion] in RnEnv</span><span>
</span><a name="line-212"></a><span class="hs-identifier">demoteNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span>
</span><a name="line-213"></a><a name="demoteNameSpace"><a href="OccName.html#demoteNameSpace"><span class="hs-identifier">demoteNameSpace</span></a></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-214"></a><span class="hs-identifier">demoteNameSpace</span><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-215"></a><span class="hs-identifier">demoteNameSpace</span><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-216"></a><span class="hs-identifier">demoteNameSpace</span><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[Name-pieces-datatypes]{The @OccName@ datatypes}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-keyword">data</span><span> </span><a name="OccName"><a href="OccName.html#OccName"><span class="hs-identifier">OccName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="OccName"><a href="OccName.html#OccName"><span class="hs-identifier">OccName</span></a></a><span>
</span><a name="line-227"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="OccName.html#occNameSpace"><span class="hs-identifier">occNameSpace</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span>
</span><a name="line-228"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="OccName.html#occNameFS"><span class="hs-identifier">occNameFS</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span>
</span><a name="line-229"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-230"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Typeable</span></a><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-233"></a><span>    </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a name="local-1627544367"><a href="#local-1627544367"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-1627544368"><a href="#local-1627544368"><span class="hs-identifier">s1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-805306535"><span class="hs-operator">==</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a name="local-1627544369"><a href="#local-1627544369"><span class="hs-identifier">sp2</span></a></a><span> </span><a name="local-1627544370"><a href="#local-1627544370"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544368"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627544370"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1627544367"><span class="hs-identifier hs-var">sp1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627544369"><span class="hs-identifier hs-var">sp2</span></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-236"></a><span>        </span><span class="hs-comment">-- Compares lexicographically, *not* by Unique of the string</span><span>
</span><a name="line-237"></a><span>    </span><a name="local-1912608689"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a name="local-1627544363"><a href="#local-1627544363"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-1627544364"><a href="#local-1627544364"><span class="hs-identifier">s1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a name="local-1627544365"><a href="#local-1627544365"><span class="hs-identifier">sp2</span></a></a><span> </span><a name="local-1627544366"><a href="#local-1627544366"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627544364"><span class="hs-identifier hs-var">s1</span></a><span>  </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-1627544366"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Util.html#thenCmp"><span class="hs-identifier hs-var">thenCmp</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-1627544363"><span class="hs-identifier hs-var">sp1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-1627544365"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-comment">-- don't traverse?</span><span>
</span><a name="line-242"></a><span>  </span><a name="local-1912605886"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#toConstr"><span class="hs-identifier">toConstr</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#abstractConstr"><span class="hs-identifier hs-var">abstractConstr</span></a><span> </span><span class="hs-string">&quot;OccName&quot;</span><span>
</span><a name="line-243"></a><span>  </span><a name="local-1912605887"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#gunfold"><span class="hs-identifier">gunfold</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-244"></a><span>  </span><a name="local-1912605885"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#dataTypeOf"><span class="hs-identifier">dataTypeOf</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#mkNoRepType"><span class="hs-identifier hs-var">mkNoRepType</span></a><span> </span><span class="hs-string">&quot;OccName&quot;</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-keyword">instance</span><span> </span><a href="OccName.html#HasOccName"><span class="hs-identifier hs-type">HasOccName</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-247"></a><span>  </span><a name="local-1912756698"><a href="OccName.html#occName"><span class="hs-identifier">occName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Printing}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-258"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#pprOccName"><span class="hs-identifier hs-var">pprOccName</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#OutputableBndr"><span class="hs-identifier hs-type">OutputableBndr</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-261"></a><span>    </span><a name="local-1912686307"><a href="Outputable.html#pprBndr"><span class="hs-identifier">pprBndr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span>
</span><a name="line-262"></a><span>    </span><a name="local-1912686309"><a href="Outputable.html#pprInfixOcc"><span class="hs-identifier">pprInfixOcc</span></a></a><span> </span><a name="local-1627544361"><a href="#local-1627544361"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprInfixVar"><span class="hs-identifier hs-var">pprInfixVar</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><a href="#local-1627544361"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627544361"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>    </span><a name="local-1912686308"><a href="Outputable.html#pprPrefixOcc"><span class="hs-identifier">pprPrefixOcc</span></a></a><span> </span><a name="local-1627544362"><a href="#local-1627544362"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPrefixVar"><span class="hs-identifier hs-var">pprPrefixVar</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><a href="#local-1627544362"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627544362"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-identifier">pprOccName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-266"></a><a name="pprOccName"><a href="OccName.html#pprOccName"><span class="hs-identifier">pprOccName</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a name="local-1627544195"><a href="#local-1627544195"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-1627544196"><a href="#local-1627544196"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-267"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#getPprStyle"><span class="hs-identifier hs-var">getPprStyle</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1627544205"><a href="#local-1627544205"><span class="hs-identifier">sty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="Outputable.html#codeStyle"><span class="hs-identifier hs-var">codeStyle</span></a><span> </span><a href="#local-1627544205"><span class="hs-identifier hs-var">sty</span></a><span>
</span><a name="line-269"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#ztext"><span class="hs-identifier hs-var">ztext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#zEncodeFS"><span class="hs-identifier hs-var">zEncodeFS</span></a><span> </span><a href="#local-1627544196"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span>    </span><span class="hs-keyword">else</span><span> </span><a href="#local-1627544198"><span class="hs-identifier hs-var">pp_occ</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-1627544197"><span class="hs-identifier hs-var">pp_debug</span></a><span> </span><a href="#local-1627544205"><span class="hs-identifier hs-var">sty</span></a><span>
</span><a name="line-271"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-272"></a><span>    </span><a name="local-1627544197"><a href="#local-1627544197"><span class="hs-identifier">pp_debug</span></a></a><span> </span><a name="local-1627544200"><a href="#local-1627544200"><span class="hs-identifier">sty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-1627544200"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#pprNameSpaceBrief"><span class="hs-identifier hs-var">pprNameSpaceBrief</span></a><span> </span><a href="#local-1627544195"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span>    </span><a name="local-1627544198"><a href="#local-1627544198"><span class="hs-identifier">pp_occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627544201"><a href="#local-1627544201"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-276"></a><span>             </span><span class="hs-keyword">if</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_SuppressUniques"><span class="hs-identifier hs-var">Opt_SuppressUniques</span></a><span> </span><a href="#local-1627544201"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-277"></a><span>             </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544199"><span class="hs-identifier hs-var">strip_th_unique</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-1627544196"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>             </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a><span> </span><a href="#local-1627544196"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span>        </span><span class="hs-comment">-- See Note [Suppressing uniques in OccNames]</span><span>
</span><a name="line-281"></a><span>    </span><a name="local-1627544199"><a href="#local-1627544199"><span class="hs-identifier">strip_th_unique</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-char">'['</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1627544202"><a href="#local-1627544202"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Unicode.html#isAlphaNum"><span class="hs-identifier hs-var">isAlphaNum</span></a><span> </span><a href="#local-1627544202"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-identifier">strip_th_unique</span><span> </span><span class="hs-special">(</span><a name="local-1627544203"><a href="#local-1627544203"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1627544204"><a href="#local-1627544204"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544203"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627544199"><span class="hs-identifier hs-var">strip_th_unique</span></a><span> </span><a href="#local-1627544204"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-283"></a><span>    </span><span class="hs-identifier">strip_th_unique</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-comment">{-
Note [Suppressing uniques in OccNames]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This is a hack to de-wobblify the OccNames that contain uniques from
Template Haskell that have been turned into a string in the OccName.
See Note [Unique OccNames from Template Haskell] in Convert.hs

************************************************************************
*                                                                      *
\subsection{Construction}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-identifier">mkOccName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-300"></a><a name="mkOccName"><a href="OccName.html#mkOccName"><span class="hs-identifier">mkOccName</span></a></a><span> </span><a name="local-1627544206"><a href="#local-1627544206"><span class="hs-identifier">occ_sp</span></a></a><span> </span><a name="local-1627544207"><a href="#local-1627544207"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="#local-1627544206"><span class="hs-identifier hs-var">occ_sp</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><a href="#local-1627544207"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-identifier">mkOccNameFS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-303"></a><a name="mkOccNameFS"><a href="OccName.html#mkOccNameFS"><span class="hs-identifier">mkOccNameFS</span></a></a><span> </span><a name="local-1627544208"><a href="#local-1627544208"><span class="hs-identifier">occ_sp</span></a></a><span> </span><a name="local-1627544209"><a href="#local-1627544209"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="#local-1627544208"><span class="hs-identifier hs-var">occ_sp</span></a><span> </span><a href="#local-1627544209"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-identifier">mkVarOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-306"></a><a name="mkVarOcc"><a href="OccName.html#mkVarOcc"><span class="hs-identifier">mkVarOcc</span></a></a><span> </span><a name="local-1627544210"><a href="#local-1627544210"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><a href="#local-1627544210"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><span class="hs-identifier">mkVarOccFS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-309"></a><a name="mkVarOccFS"><a href="OccName.html#mkVarOccFS"><span class="hs-identifier">mkVarOccFS</span></a></a><span> </span><a name="local-1627544211"><a href="#local-1627544211"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccNameFS"><span class="hs-identifier hs-var">mkOccNameFS</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><a href="#local-1627544211"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-identifier">mkDataOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-312"></a><a name="mkDataOcc"><a href="OccName.html#mkDataOcc"><span class="hs-identifier">mkDataOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="OccName.html#dataName"><span class="hs-identifier hs-var">dataName</span></a><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-identifier">mkDataOccFS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-315"></a><a name="mkDataOccFS"><a href="OccName.html#mkDataOccFS"><span class="hs-identifier">mkDataOccFS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccNameFS"><span class="hs-identifier hs-var">mkOccNameFS</span></a><span> </span><a href="OccName.html#dataName"><span class="hs-identifier hs-var">dataName</span></a><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-identifier">mkTyVarOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-318"></a><a name="mkTyVarOcc"><a href="OccName.html#mkTyVarOcc"><span class="hs-identifier">mkTyVarOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="OccName.html#tvName"><span class="hs-identifier hs-var">tvName</span></a><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-identifier">mkTyVarOccFS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-321"></a><a name="mkTyVarOccFS"><a href="OccName.html#mkTyVarOccFS"><span class="hs-identifier">mkTyVarOccFS</span></a></a><span> </span><a name="local-1627544212"><a href="#local-1627544212"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccNameFS"><span class="hs-identifier hs-var">mkOccNameFS</span></a><span> </span><a href="OccName.html#tvName"><span class="hs-identifier hs-var">tvName</span></a><span> </span><a href="#local-1627544212"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-identifier">mkTcOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-324"></a><a name="mkTcOcc"><a href="OccName.html#mkTcOcc"><span class="hs-identifier">mkTcOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-identifier">mkTcOccFS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-327"></a><a name="mkTcOccFS"><a href="OccName.html#mkTcOccFS"><span class="hs-identifier">mkTcOccFS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccNameFS"><span class="hs-identifier hs-var">mkOccNameFS</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-identifier">mkClsOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-330"></a><a name="mkClsOcc"><a href="OccName.html#mkClsOcc"><span class="hs-identifier">mkClsOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="OccName.html#clsName"><span class="hs-identifier hs-var">clsName</span></a><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-identifier">mkClsOccFS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-333"></a><a name="mkClsOccFS"><a href="OccName.html#mkClsOccFS"><span class="hs-identifier">mkClsOccFS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccNameFS"><span class="hs-identifier hs-var">mkOccNameFS</span></a><span> </span><a href="OccName.html#clsName"><span class="hs-identifier hs-var">clsName</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- demoteOccName lowers the Namespace of OccName.</span><span>
</span><a name="line-336"></a><span class="hs-comment">-- see Note [Demotion]</span><span>
</span><a name="line-337"></a><span class="hs-identifier">demoteOccName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-338"></a><a name="demoteOccName"><a href="OccName.html#demoteOccName"><span class="hs-identifier">demoteOccName</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a name="local-1627544213"><a href="#local-1627544213"><span class="hs-identifier">space</span></a></a><span> </span><a name="local-1627544214"><a href="#local-1627544214"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-339"></a><span>  </span><a name="local-1627544215"><a href="#local-1627544215"><span class="hs-identifier">space'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="OccName.html#demoteNameSpace"><span class="hs-identifier hs-var">demoteNameSpace</span></a><span> </span><a href="#local-1627544213"><span class="hs-identifier hs-var">space</span></a><span>
</span><a name="line-340"></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="#local-1627544215"><span class="hs-identifier hs-var">space'</span></a><span> </span><a href="#local-1627544214"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- Name spaces are related if there is a chance to mean the one when one writes</span><span>
</span><a name="line-343"></a><span class="hs-comment">-- the other, i.e. variables &lt;-&gt; data constructors and type variables &lt;-&gt; type constructors</span><span>
</span><a name="line-344"></a><span class="hs-identifier">nameSpacesRelated</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-345"></a><a name="nameSpacesRelated"><a href="OccName.html#nameSpacesRelated"><span class="hs-identifier">nameSpacesRelated</span></a></a><span> </span><a name="local-1627544216"><a href="#local-1627544216"><span class="hs-identifier">ns1</span></a></a><span> </span><a name="local-1627544217"><a href="#local-1627544217"><span class="hs-identifier">ns2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544216"><span class="hs-identifier hs-var">ns1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627544217"><span class="hs-identifier hs-var">ns2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="OccName.html#otherNameSpace"><span class="hs-identifier hs-var">otherNameSpace</span></a><span> </span><a href="#local-1627544216"><span class="hs-identifier hs-var">ns1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627544217"><span class="hs-identifier hs-var">ns2</span></a><span>
</span><a name="line-346"></a><span>
</span><a name="line-347"></a><span class="hs-identifier">otherNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span>
</span><a name="line-348"></a><a name="otherNameSpace"><a href="OccName.html#otherNameSpace"><span class="hs-identifier">otherNameSpace</span></a></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span>
</span><a name="line-349"></a><span class="hs-identifier">otherNameSpace</span><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span>
</span><a name="line-350"></a><span class="hs-identifier">otherNameSpace</span><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span>
</span><a name="line-351"></a><span class="hs-identifier">otherNameSpace</span><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">{- | Other names in the compiler add additional information to an OccName.
This class provides a consistent way to access the underlying OccName. -}</span><span>
</span><a name="line-357"></a><span class="hs-keyword">class</span><span> </span><a name="HasOccName"><a href="OccName.html#HasOccName"><span class="hs-identifier">HasOccName</span></a></a><span> </span><a name="local-1627544169"><a href="#local-1627544169"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-358"></a><span>  </span><span class="hs-identifier">occName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627544169"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Environments
*                                                                      *
************************************************************************

OccEnvs are used mainly for the envts in ModIfaces.

Note [The Unique of an OccName]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
They are efficient, because FastStrings have unique Int# keys.  We assume
this key is less than 2^24, and indeed FastStrings are allocated keys
sequentially starting at 0.

So we can make a Unique using
        mkUnique ns key  :: Unique
where 'ns' is a Char representing the name space.  This in turn makes it
easy to build an OccEnv.
-}</span><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-keyword">instance</span><span> </span><a href="Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-382"></a><span>      </span><span class="hs-comment">-- See Note [The Unique of an OccName]</span><span>
</span><a name="line-383"></a><span>  </span><a name="local-1912706050"><a href="Unique.html#getUnique"><span class="hs-identifier">getUnique</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span>   </span><a name="local-1627544357"><a href="#local-1627544357"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#mkVarOccUnique"><span class="hs-identifier hs-var">mkVarOccUnique</span></a><span>  </span><a href="#local-1627544357"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-384"></a><span>  </span><span class="hs-identifier">getUnique</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span>  </span><a name="local-1627544358"><a href="#local-1627544358"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#mkDataOccUnique"><span class="hs-identifier hs-var">mkDataOccUnique</span></a><span> </span><a href="#local-1627544358"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-385"></a><span>  </span><span class="hs-identifier">getUnique</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span>    </span><a name="local-1627544359"><a href="#local-1627544359"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#mkTvOccUnique"><span class="hs-identifier hs-var">mkTvOccUnique</span></a><span>   </span><a href="#local-1627544359"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-386"></a><span>  </span><span class="hs-identifier">getUnique</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><a name="local-1627544360"><a href="#local-1627544360"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#mkTcOccUnique"><span class="hs-identifier hs-var">mkTcOccUnique</span></a><span>   </span><a href="#local-1627544360"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-keyword">newtype</span><span> </span><a name="OccEnv"><a href="OccName.html#OccEnv"><span class="hs-identifier">OccEnv</span></a></a><span> </span><a name="local-1627544168"><a href="#local-1627544168"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="A"><a href="OccName.html#A"><span class="hs-identifier">A</span></a></a><span> </span><span class="hs-special">(</span><a href="UniqFM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a><span> </span><a href="#local-1627544168"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span class="hs-identifier">emptyOccEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544193"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-391"></a><span class="hs-identifier">unitOccEnv</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544192"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544192"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-392"></a><span class="hs-identifier">extendOccEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544191"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544191"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544191"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-393"></a><span class="hs-identifier">extendOccEnvList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544190"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627544190"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544190"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-394"></a><span class="hs-identifier">lookupOccEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544189"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627544189"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-395"></a><span class="hs-identifier">mkOccEnv</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">,</span><a href="#local-1627544188"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544188"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-396"></a><span class="hs-identifier">mkOccEnv_C</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627544187"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544187"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544187"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">,</span><a href="#local-1627544187"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544187"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-397"></a><span class="hs-identifier">elemOccEnv</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544186"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-398"></a><span class="hs-identifier">foldOccEnv</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627544184"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544185"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544185"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544185"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544184"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544185"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-399"></a><span class="hs-identifier">occEnvElts</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544183"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627544183"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-400"></a><span class="hs-identifier">extendOccEnv_C</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627544182"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-1627544182"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-1627544182"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544182"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544182"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544182"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-401"></a><span class="hs-identifier">extendOccEnv_Acc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627544180"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-1627544181"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-1627544181"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627544180"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-1627544181"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544181"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544180"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544181"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-402"></a><span class="hs-identifier">plusOccEnv</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544179"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544179"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544179"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-403"></a><span class="hs-identifier">plusOccEnv_C</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627544178"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-1627544178"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-1627544178"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544178"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544178"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544178"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-404"></a><span class="hs-identifier">mapOccEnv</span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627544176"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-1627544177"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544176"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544177"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-405"></a><span class="hs-identifier">delFromOccEnv</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544175"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544175"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-406"></a><span class="hs-identifier">delListFromOccEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544174"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544174"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-407"></a><span class="hs-identifier">filterOccEnv</span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627544173"><span class="hs-identifier hs-type">elt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544173"><span class="hs-identifier hs-type">elt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544173"><span class="hs-identifier hs-type">elt</span></a><span>
</span><a name="line-408"></a><span class="hs-identifier">alterOccEnv</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627544172"><span class="hs-identifier hs-type">elt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627544172"><span class="hs-identifier hs-type">elt</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544172"><span class="hs-identifier hs-type">elt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544172"><span class="hs-identifier hs-type">elt</span></a><span>
</span><a name="line-409"></a><span>
</span><a name="line-410"></a><a name="emptyOccEnv"><a href="OccName.html#emptyOccEnv"><span class="hs-identifier">emptyOccEnv</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="UniqFM.html#emptyUFM"><span class="hs-identifier hs-var">emptyUFM</span></a><span>
</span><a name="line-411"></a><a name="unitOccEnv"><a href="OccName.html#unitOccEnv"><span class="hs-identifier">unitOccEnv</span></a></a><span> </span><a name="local-1627544218"><a href="#local-1627544218"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627544219"><a href="#local-1627544219"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#unitUFM"><span class="hs-identifier hs-var">unitUFM</span></a><span> </span><a href="#local-1627544218"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544219"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-412"></a><a name="extendOccEnv"><a href="OccName.html#extendOccEnv"><span class="hs-identifier">extendOccEnv</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544220"><a href="#local-1627544220"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544221"><a href="#local-1627544221"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-1627544222"><a href="#local-1627544222"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#addToUFM"><span class="hs-identifier hs-var">addToUFM</span></a><span> </span><a href="#local-1627544220"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544221"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-1627544222"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-413"></a><a name="extendOccEnvList"><a href="OccName.html#extendOccEnvList"><span class="hs-identifier">extendOccEnvList</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544223"><a href="#local-1627544223"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544224"><a href="#local-1627544224"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#addListToUFM"><span class="hs-identifier hs-var">addListToUFM</span></a><span> </span><a href="#local-1627544223"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544224"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-414"></a><a name="lookupOccEnv"><a href="OccName.html#lookupOccEnv"><span class="hs-identifier">lookupOccEnv</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544225"><a href="#local-1627544225"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544226"><a href="#local-1627544226"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><a href="#local-1627544225"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544226"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-415"></a><a name="mkOccEnv"><a href="OccName.html#mkOccEnv"><span class="hs-identifier">mkOccEnv</span></a></a><span>     </span><a name="local-1627544227"><a href="#local-1627544227"><span class="hs-identifier">l</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#listToUFM"><span class="hs-identifier hs-var">listToUFM</span></a><span> </span><a href="#local-1627544227"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-416"></a><a name="elemOccEnv"><a href="OccName.html#elemOccEnv"><span class="hs-identifier">elemOccEnv</span></a></a><span> </span><a name="local-1627544228"><a href="#local-1627544228"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544229"><a href="#local-1627544229"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#elemUFM"><span class="hs-identifier hs-var">elemUFM</span></a><span> </span><a href="#local-1627544228"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544229"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-417"></a><a name="foldOccEnv"><a href="OccName.html#foldOccEnv"><span class="hs-identifier">foldOccEnv</span></a></a><span> </span><a name="local-1627544230"><a href="#local-1627544230"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627544231"><a href="#local-1627544231"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544232"><a href="#local-1627544232"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#foldUFM"><span class="hs-identifier hs-var">foldUFM</span></a><span> </span><a href="#local-1627544230"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1627544231"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1627544232"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-418"></a><a name="occEnvElts"><a href="OccName.html#occEnvElts"><span class="hs-identifier">occEnvElts</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544233"><a href="#local-1627544233"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#eltsUFM"><span class="hs-identifier hs-var">eltsUFM</span></a><span> </span><a href="#local-1627544233"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-419"></a><a name="plusOccEnv"><a href="OccName.html#plusOccEnv"><span class="hs-identifier">plusOccEnv</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544234"><a href="#local-1627544234"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544235"><a href="#local-1627544235"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#plusUFM"><span class="hs-identifier hs-var">plusUFM</span></a><span> </span><a href="#local-1627544234"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544235"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-420"></a><a name="plusOccEnv_C"><a href="OccName.html#plusOccEnv_C"><span class="hs-identifier">plusOccEnv_C</span></a></a><span> </span><a name="local-1627544236"><a href="#local-1627544236"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544237"><a href="#local-1627544237"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544238"><a href="#local-1627544238"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#plusUFM_C"><span class="hs-identifier hs-var">plusUFM_C</span></a><span> </span><a href="#local-1627544236"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627544237"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544238"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-421"></a><a name="extendOccEnv_C"><a href="OccName.html#extendOccEnv_C"><span class="hs-identifier">extendOccEnv_C</span></a></a><span> </span><a name="local-1627544239"><a href="#local-1627544239"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544240"><a href="#local-1627544240"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544241"><a href="#local-1627544241"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-1627544242"><a href="#local-1627544242"><span class="hs-identifier">z</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#addToUFM_C"><span class="hs-identifier hs-var">addToUFM_C</span></a><span> </span><a href="#local-1627544239"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627544240"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544241"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-1627544242"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-422"></a><a name="extendOccEnv_Acc"><a href="OccName.html#extendOccEnv_Acc"><span class="hs-identifier">extendOccEnv_Acc</span></a></a><span> </span><a name="local-1627544243"><a href="#local-1627544243"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627544244"><a href="#local-1627544244"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544245"><a href="#local-1627544245"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544246"><a href="#local-1627544246"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-1627544247"><a href="#local-1627544247"><span class="hs-identifier">z</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#addToUFM_Acc"><span class="hs-identifier hs-var">addToUFM_Acc</span></a><span> </span><a href="#local-1627544243"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627544244"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627544245"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544246"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-1627544247"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-423"></a><a name="mapOccEnv"><a href="OccName.html#mapOccEnv"><span class="hs-identifier">mapOccEnv</span></a></a><span> </span><a name="local-1627544248"><a href="#local-1627544248"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544249"><a href="#local-1627544249"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#mapUFM"><span class="hs-identifier hs-var">mapUFM</span></a><span> </span><a href="#local-1627544248"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627544249"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-424"></a><a name="mkOccEnv_C"><a href="OccName.html#mkOccEnv_C"><span class="hs-identifier">mkOccEnv_C</span></a></a><span> </span><a name="local-1627544250"><a href="#local-1627544250"><span class="hs-identifier">comb</span></a></a><span> </span><a name="local-1627544251"><a href="#local-1627544251"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#addListToUFM_C"><span class="hs-identifier hs-var">addListToUFM_C</span></a><span> </span><a href="#local-1627544250"><span class="hs-identifier hs-var">comb</span></a><span> </span><a href="UniqFM.html#emptyUFM"><span class="hs-identifier hs-var">emptyUFM</span></a><span> </span><a href="#local-1627544251"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-425"></a><a name="delFromOccEnv"><a href="OccName.html#delFromOccEnv"><span class="hs-identifier">delFromOccEnv</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544252"><a href="#local-1627544252"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544253"><a href="#local-1627544253"><span class="hs-identifier">y</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#delFromUFM"><span class="hs-identifier hs-var">delFromUFM</span></a><span> </span><a href="#local-1627544252"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544253"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-426"></a><a name="delListFromOccEnv"><a href="OccName.html#delListFromOccEnv"><span class="hs-identifier">delListFromOccEnv</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544254"><a href="#local-1627544254"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544255"><a href="#local-1627544255"><span class="hs-identifier">y</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#delListFromUFM"><span class="hs-identifier hs-var">delListFromUFM</span></a><span> </span><a href="#local-1627544254"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544255"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-427"></a><a name="filterOccEnv"><a href="OccName.html#filterOccEnv"><span class="hs-identifier">filterOccEnv</span></a></a><span> </span><a name="local-1627544256"><a href="#local-1627544256"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544257"><a href="#local-1627544257"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#filterUFM"><span class="hs-identifier hs-var">filterUFM</span></a><span> </span><a href="#local-1627544256"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627544257"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-428"></a><a name="alterOccEnv"><a href="OccName.html#alterOccEnv"><span class="hs-identifier">alterOccEnv</span></a></a><span> </span><a name="local-1627544258"><a href="#local-1627544258"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544259"><a href="#local-1627544259"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544260"><a href="#local-1627544260"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="UniqFM.html#alterUFM"><span class="hs-identifier hs-var">alterUFM</span></a><span> </span><a href="#local-1627544258"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-1627544259"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-1627544260"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1627544355"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544355"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-431"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-1627544356"><a href="#local-1627544356"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#pprOccEnv"><span class="hs-identifier hs-var">pprOccEnv</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627544356"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span class="hs-identifier">pprOccEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627544171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a><span> </span><a href="#local-1627544171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-434"></a><a name="pprOccEnv"><a href="OccName.html#pprOccEnv"><span class="hs-identifier">pprOccEnv</span></a></a><span> </span><a name="local-1627544261"><a href="#local-1627544261"><span class="hs-identifier">ppr_elt</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-1627544262"><a href="#local-1627544262"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#pprUniqFM"><span class="hs-identifier hs-var">pprUniqFM</span></a><span> </span><a href="#local-1627544261"><span class="hs-identifier hs-var">ppr_elt</span></a><span> </span><a href="#local-1627544262"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-keyword">type</span><span> </span><a name="OccSet"><a href="OccName.html#OccSet"><span class="hs-identifier">OccSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-identifier">emptyOccSet</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-439"></a><span class="hs-identifier">unitOccSet</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-440"></a><span class="hs-identifier">mkOccSet</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-441"></a><span class="hs-identifier">extendOccSet</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-442"></a><span class="hs-identifier">extendOccSetList</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-443"></a><span class="hs-identifier">unionOccSets</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-444"></a><span class="hs-identifier">unionManyOccSets</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-445"></a><span class="hs-identifier">minusOccSet</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-446"></a><span class="hs-identifier">elemOccSet</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-447"></a><span class="hs-identifier">occSetElts</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">]</span><span>
</span><a name="line-448"></a><span class="hs-identifier">foldOccSet</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544170"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544170"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544170"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544170"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-449"></a><span class="hs-identifier">isEmptyOccSet</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-450"></a><span class="hs-identifier">intersectOccSet</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-451"></a><span class="hs-identifier">intersectsOccSet</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-452"></a><span class="hs-identifier">filterOccSet</span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><a name="emptyOccSet"><a href="OccName.html#emptyOccSet"><span class="hs-identifier">emptyOccSet</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span>
</span><a name="line-455"></a><a name="unitOccSet"><a href="OccName.html#unitOccSet"><span class="hs-identifier">unitOccSet</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#unitUniqSet"><span class="hs-identifier hs-var">unitUniqSet</span></a><span>
</span><a name="line-456"></a><a name="mkOccSet"><a href="OccName.html#mkOccSet"><span class="hs-identifier">mkOccSet</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#mkUniqSet"><span class="hs-identifier hs-var">mkUniqSet</span></a><span>
</span><a name="line-457"></a><a name="extendOccSet"><a href="OccName.html#extendOccSet"><span class="hs-identifier">extendOccSet</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#addOneToUniqSet"><span class="hs-identifier hs-var">addOneToUniqSet</span></a><span>
</span><a name="line-458"></a><a name="extendOccSetList"><a href="OccName.html#extendOccSetList"><span class="hs-identifier">extendOccSetList</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#addListToUniqSet"><span class="hs-identifier hs-var">addListToUniqSet</span></a><span>
</span><a name="line-459"></a><a name="unionOccSets"><a href="OccName.html#unionOccSets"><span class="hs-identifier">unionOccSets</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span>
</span><a name="line-460"></a><a name="unionManyOccSets"><a href="OccName.html#unionManyOccSets"><span class="hs-identifier">unionManyOccSets</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#unionManyUniqSets"><span class="hs-identifier hs-var">unionManyUniqSets</span></a><span>
</span><a name="line-461"></a><a name="minusOccSet"><a href="OccName.html#minusOccSet"><span class="hs-identifier">minusOccSet</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#minusUniqSet"><span class="hs-identifier hs-var">minusUniqSet</span></a><span>
</span><a name="line-462"></a><a name="elemOccSet"><a href="OccName.html#elemOccSet"><span class="hs-identifier">elemOccSet</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#elementOfUniqSet"><span class="hs-identifier hs-var">elementOfUniqSet</span></a><span>
</span><a name="line-463"></a><a name="occSetElts"><a href="OccName.html#occSetElts"><span class="hs-identifier">occSetElts</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#uniqSetToList"><span class="hs-identifier hs-var">uniqSetToList</span></a><span>
</span><a name="line-464"></a><a name="foldOccSet"><a href="OccName.html#foldOccSet"><span class="hs-identifier">foldOccSet</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#foldUniqSet"><span class="hs-identifier hs-var">foldUniqSet</span></a><span>
</span><a name="line-465"></a><a name="isEmptyOccSet"><a href="OccName.html#isEmptyOccSet"><span class="hs-identifier">isEmptyOccSet</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#isEmptyUniqSet"><span class="hs-identifier hs-var">isEmptyUniqSet</span></a><span>
</span><a name="line-466"></a><a name="intersectOccSet"><a href="OccName.html#intersectOccSet"><span class="hs-identifier">intersectOccSet</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#intersectUniqSets"><span class="hs-identifier hs-var">intersectUniqSets</span></a><span>
</span><a name="line-467"></a><a name="intersectsOccSet"><a href="OccName.html#intersectsOccSet"><span class="hs-identifier">intersectsOccSet</span></a></a><span> </span><a name="local-1627544263"><a href="#local-1627544263"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-1627544264"><a href="#local-1627544264"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="OccName.html#isEmptyOccSet"><span class="hs-identifier hs-var">isEmptyOccSet</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544263"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#intersectOccSet"><span class="hs-identifier hs-var">intersectOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627544264"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-468"></a><a name="filterOccSet"><a href="OccName.html#filterOccSet"><span class="hs-identifier">filterOccSet</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#filterUniqSet"><span class="hs-identifier hs-var">filterUniqSet</span></a><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Predicates and taking them apart}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span class="hs-identifier">occNameString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-479"></a><a name="occNameString"><a href="OccName.html#occNameString"><span class="hs-identifier">occNameString</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627544265"><a href="#local-1627544265"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-1627544265"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-480"></a><span>
</span><a name="line-481"></a><span class="hs-identifier">setOccNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-482"></a><a name="setOccNameSpace"><a href="OccName.html#setOccNameSpace"><span class="hs-identifier">setOccNameSpace</span></a></a><span> </span><a name="local-1627544266"><a href="#local-1627544266"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627544267"><a href="#local-1627544267"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="#local-1627544266"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="#local-1627544267"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-483"></a><span>
</span><a name="line-484"></a><span class="hs-identifier">isVarOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isTvOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isTcOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isDataOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><a name="isVarOcc"><a href="OccName.html#isVarOcc"><span class="hs-identifier">isVarOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-487"></a><span class="hs-identifier">isVarOcc</span><span> </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><a name="isTvOcc"><a href="OccName.html#isTvOcc"><span class="hs-identifier">isTvOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-490"></a><span class="hs-identifier">isTvOcc</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><a name="isTcOcc"><a href="OccName.html#isTcOcc"><span class="hs-identifier">isTcOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-493"></a><span class="hs-identifier">isTcOcc</span><span> </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span class="hs-comment">-- | /Value/ 'OccNames's are those that are either in</span><span>
</span><a name="line-496"></a><span class="hs-comment">-- the variable or data constructor namespaces</span><span>
</span><a name="line-497"></a><span class="hs-identifier">isValOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-498"></a><a name="isValOcc"><a href="OccName.html#isValOcc"><span class="hs-identifier">isValOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-499"></a><span class="hs-identifier">isValOcc</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-500"></a><span class="hs-identifier">isValOcc</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-501"></a><span>
</span><a name="line-502"></a><a name="isDataOcc"><a href="OccName.html#isDataOcc"><span class="hs-identifier">isDataOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-503"></a><span class="hs-identifier">isDataOcc</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><span class="hs-comment">-- | Test if the 'OccName' is a data constructor that starts with</span><span>
</span><a name="line-506"></a><span class="hs-comment">-- a symbol (e.g. @:@, or @[]@)</span><span>
</span><a name="line-507"></a><span class="hs-identifier">isDataSymOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-508"></a><a name="isDataSymOcc"><a href="OccName.html#isDataSymOcc"><span class="hs-identifier">isDataSymOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><a name="local-1627544268"><a href="#local-1627544268"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lexeme.html#isLexConSym"><span class="hs-identifier hs-var">isLexConSym</span></a><span> </span><a href="#local-1627544268"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-509"></a><span class="hs-identifier">isDataSymOcc</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-510"></a><span class="hs-comment">-- Pretty inefficient!</span><span>
</span><a name="line-511"></a><span>
</span><a name="line-512"></a><span class="hs-comment">-- | Test if the 'OccName' is that for any operator (whether</span><span>
</span><a name="line-513"></a><span class="hs-comment">-- it is a data constructor or variable or whatever)</span><span>
</span><a name="line-514"></a><span class="hs-identifier">isSymOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-515"></a><a name="isSymOcc"><a href="OccName.html#isSymOcc"><span class="hs-identifier">isSymOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><a name="local-1627544269"><a href="#local-1627544269"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Lexeme.html#isLexConSym"><span class="hs-identifier hs-var">isLexConSym</span></a><span> </span><a href="#local-1627544269"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-516"></a><span class="hs-identifier">isSymOcc</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><a name="local-1627544270"><a href="#local-1627544270"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lexeme.html#isLexSym"><span class="hs-identifier hs-var">isLexSym</span></a><span> </span><a href="#local-1627544270"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-517"></a><span class="hs-identifier">isSymOcc</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><a name="local-1627544271"><a href="#local-1627544271"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Lexeme.html#isLexSym"><span class="hs-identifier hs-var">isLexSym</span></a><span> </span><a href="#local-1627544271"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-518"></a><span class="hs-identifier">isSymOcc</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span> </span><a name="local-1627544272"><a href="#local-1627544272"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lexeme.html#isLexSym"><span class="hs-identifier hs-var">isLexSym</span></a><span> </span><a href="#local-1627544272"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-519"></a><span class="hs-comment">-- Pretty inefficient!</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-identifier">parenSymOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-522"></a><span class="hs-comment">-- ^ Wrap parens around an operator</span><span>
</span><a name="line-523"></a><a name="parenSymOcc"><a href="OccName.html#parenSymOcc"><span class="hs-identifier">parenSymOcc</span></a></a><span> </span><a name="local-1627544273"><a href="#local-1627544273"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1627544274"><a href="#local-1627544274"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><a href="#local-1627544273"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><a href="#local-1627544274"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-524"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544274"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-identifier">startsWithUnderscore</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-527"></a><span class="hs-comment">-- ^ Haskell 98 encourages compilers to suppress warnings about unsed</span><span>
</span><a name="line-528"></a><span class="hs-comment">-- names in a pattern if they start with @_@: this implements that test</span><span>
</span><a name="line-529"></a><a name="startsWithUnderscore"><a href="OccName.html#startsWithUnderscore"><span class="hs-identifier">startsWithUnderscore</span></a></a><span> </span><a name="local-1627544275"><a href="#local-1627544275"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544275"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-530"></a><span>                             </span><span class="hs-special">(</span><span class="hs-char">'_'</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-531"></a><span>                             </span><a name="local-1627544276"><a href="#local-1627544276"><span class="hs-identifier">_other</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Making system names}
*                                                                      *
************************************************************************

Here's our convention for splitting up the interface file name space:

   d...         dictionary identifiers
                (local variables, so no name-clash worries)

All of these other OccNames contain a mixture of alphabetic
and symbolic characters, and hence cannot possibly clash with
a user-written type or function name

   $f...        Dict-fun identifiers (from inst decls)
   $dmop        Default method for 'op'
   $pnC         n'th superclass selector for class C
   $wf          Worker for function 'f'
   $sf..        Specialised version of f
   D:C          Data constructor for dictionary for class C
   NTCo:T       Coercion connecting newtype T with its representation type
   TFCo:R       Coercion connecting a data family to its representation type R

In encoded form these appear as Zdfxxx etc

        :...            keywords (export:, letrec: etc.)
--- I THINK THIS IS WRONG!

This knowledge is encoded in the following functions.

@mk_deriv@ generates an @OccName@ from the prefix and a string.
NB: The string must already be encoded!
-}</span><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-identifier">mk_deriv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span>
</span><a name="line-570"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>              </span><span class="hs-comment">-- Distinguishes one sort of derived name from another</span><span>
</span><a name="line-571"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-572"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><a name="mk_deriv"><a href="OccName.html#mk_deriv"><span class="hs-identifier">mk_deriv</span></a></a><span> </span><a name="local-1627544277"><a href="#local-1627544277"><span class="hs-identifier">occ_sp</span></a></a><span> </span><a name="local-1627544278"><a href="#local-1627544278"><span class="hs-identifier">sys_prefix</span></a></a><span> </span><a name="local-1627544279"><a href="#local-1627544279"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="#local-1627544277"><span class="hs-identifier hs-var">occ_sp</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544278"><span class="hs-identifier hs-var">sys_prefix</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627544279"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span class="hs-identifier">isDerivedOccName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-577"></a><span class="hs-comment">-- ^ Test for definitions internally generated by GHC.  This predicte</span><span>
</span><a name="line-578"></a><span class="hs-comment">-- is used to suppress printing of internal definitions in some debug prints</span><span>
</span><a name="line-579"></a><a name="isDerivedOccName"><a href="OccName.html#isDerivedOccName"><span class="hs-identifier">isDerivedOccName</span></a></a><span> </span><a name="local-1627544280"><a href="#local-1627544280"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-580"></a><span>   </span><span class="hs-keyword">case</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544280"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-581"></a><span>     </span><span class="hs-char">'$'</span><span class="hs-glyph">:</span><a name="local-1627544281"><a href="#local-1627544281"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Unicode.html#isAlphaNum"><span class="hs-identifier hs-var">isAlphaNum</span></a><span> </span><a href="#local-1627544281"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- E.g.  $wfoo</span><span>
</span><a name="line-582"></a><span>     </span><a name="local-1627544282"><a href="#local-1627544282"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><span class="hs-char">':'</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Unicode.html#isAlphaNum"><span class="hs-identifier hs-var">isAlphaNum</span></a><span> </span><a href="#local-1627544282"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- E.g.  N:blah   newtype coercions</span><span>
</span><a name="line-583"></a><span>     </span><a name="local-1627544283"><a href="#local-1627544283"><span class="hs-identifier">_other</span></a></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-584"></a><span>
</span><a name="line-585"></a><span class="hs-identifier">mkDataConWrapperOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkWorkerOcc</span><span class="hs-special">,</span><span>
</span><a name="line-586"></a><span>        </span><span class="hs-identifier">mkMatcherOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkBuilderOcc</span><span class="hs-special">,</span><span>
</span><a name="line-587"></a><span>        </span><span class="hs-identifier">mkDefaultMethodOcc</span><span class="hs-special">,</span><span>
</span><a name="line-588"></a><span>        </span><span class="hs-identifier">mkClassDataConOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkDictOcc</span><span class="hs-special">,</span><span>
</span><a name="line-589"></a><span>        </span><span class="hs-identifier">mkIPOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkSpecOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkForeignExportOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkRepEqOcc</span><span class="hs-special">,</span><span>
</span><a name="line-590"></a><span>        </span><span class="hs-identifier">mkGenR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkGen1R</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkGenRCo</span><span class="hs-special">,</span><span>
</span><a name="line-591"></a><span>        </span><span class="hs-identifier">mkDataTOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkDataCOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkDataConWorkerOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkNewTyCoOcc</span><span class="hs-special">,</span><span>
</span><a name="line-592"></a><span>        </span><span class="hs-identifier">mkInstTyCoOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkEqPredCoOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkClassOpAuxOcc</span><span class="hs-special">,</span><span>
</span><a name="line-593"></a><span>        </span><span class="hs-identifier">mkCon2TagOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkTag2ConOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkMaxTagOcc</span><span class="hs-special">,</span><span>
</span><a name="line-594"></a><span>        </span><span class="hs-identifier">mkTyConRepOcc</span><span>
</span><a name="line-595"></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span class="hs-comment">-- These derived variables have a prefix that no Haskell value could have</span><span>
</span><a name="line-598"></a><a name="mkDataConWrapperOcc"><a href="OccName.html#mkDataConWrapperOcc"><span class="hs-identifier">mkDataConWrapperOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$W&quot;</span><span>
</span><a name="line-599"></a><a name="mkWorkerOcc"><a href="OccName.html#mkWorkerOcc"><span class="hs-identifier">mkWorkerOcc</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$w&quot;</span><span>
</span><a name="line-600"></a><a name="mkMatcherOcc"><a href="OccName.html#mkMatcherOcc"><span class="hs-identifier">mkMatcherOcc</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$m&quot;</span><span>
</span><a name="line-601"></a><a name="mkBuilderOcc"><a href="OccName.html#mkBuilderOcc"><span class="hs-identifier">mkBuilderOcc</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$b&quot;</span><span>
</span><a name="line-602"></a><a name="mkDefaultMethodOcc"><a href="OccName.html#mkDefaultMethodOcc"><span class="hs-identifier">mkDefaultMethodOcc</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$dm&quot;</span><span>
</span><a name="line-603"></a><a name="mkClassOpAuxOcc"><a href="OccName.html#mkClassOpAuxOcc"><span class="hs-identifier">mkClassOpAuxOcc</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$c&quot;</span><span>
</span><a name="line-604"></a><a name="mkDictOcc"><a href="OccName.html#mkDictOcc"><span class="hs-identifier">mkDictOcc</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$d&quot;</span><span>
</span><a name="line-605"></a><a name="mkIPOcc"><a href="OccName.html#mkIPOcc"><span class="hs-identifier">mkIPOcc</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$i&quot;</span><span>
</span><a name="line-606"></a><a name="mkSpecOcc"><a href="OccName.html#mkSpecOcc"><span class="hs-identifier">mkSpecOcc</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$s&quot;</span><span>
</span><a name="line-607"></a><a name="mkForeignExportOcc"><a href="OccName.html#mkForeignExportOcc"><span class="hs-identifier">mkForeignExportOcc</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$f&quot;</span><span>
</span><a name="line-608"></a><a name="mkRepEqOcc"><a href="OccName.html#mkRepEqOcc"><span class="hs-identifier">mkRepEqOcc</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#tvName"><span class="hs-identifier hs-var">tvName</span></a><span>   </span><span class="hs-string">&quot;$r&quot;</span><span>   </span><span class="hs-comment">-- In RULES involving Coercible</span><span>
</span><a name="line-609"></a><a name="mkClassDataConOcc"><a href="OccName.html#mkClassDataConOcc"><span class="hs-identifier">mkClassDataConOcc</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#dataName"><span class="hs-identifier hs-var">dataName</span></a><span> </span><span class="hs-string">&quot;C:&quot;</span><span>     </span><span class="hs-comment">-- Data con for a class</span><span>
</span><a name="line-610"></a><a name="mkNewTyCoOcc"><a href="OccName.html#mkNewTyCoOcc"><span class="hs-identifier">mkNewTyCoOcc</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>   </span><span class="hs-string">&quot;N:&quot;</span><span>   </span><span class="hs-comment">-- Coercion for newtypes</span><span>
</span><a name="line-611"></a><a name="mkInstTyCoOcc"><a href="OccName.html#mkInstTyCoOcc"><span class="hs-identifier">mkInstTyCoOcc</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>   </span><span class="hs-string">&quot;D:&quot;</span><span>   </span><span class="hs-comment">-- Coercion for type functions</span><span>
</span><a name="line-612"></a><a name="mkEqPredCoOcc"><a href="OccName.html#mkEqPredCoOcc"><span class="hs-identifier">mkEqPredCoOcc</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>   </span><span class="hs-string">&quot;$co&quot;</span><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><span class="hs-comment">-- Used in derived instances</span><span>
</span><a name="line-615"></a><a name="mkCon2TagOcc"><a href="OccName.html#mkCon2TagOcc"><span class="hs-identifier">mkCon2TagOcc</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$con2tag_&quot;</span><span>
</span><a name="line-616"></a><a name="mkTag2ConOcc"><a href="OccName.html#mkTag2ConOcc"><span class="hs-identifier">mkTag2ConOcc</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$tag2con_&quot;</span><span>
</span><a name="line-617"></a><a name="mkMaxTagOcc"><a href="OccName.html#mkMaxTagOcc"><span class="hs-identifier">mkMaxTagOcc</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$maxtag_&quot;</span><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span class="hs-comment">-- TyConRepName stuff; see Note [Grand plan for Typeable] in TcTypeable</span><span>
</span><a name="line-620"></a><a name="mkTyConRepOcc"><a href="OccName.html#mkTyConRepOcc"><span class="hs-identifier">mkTyConRepOcc</span></a></a><span> </span><a name="local-1627544284"><a href="#local-1627544284"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><a href="#local-1627544285"><span class="hs-identifier hs-var">prefix</span></a><span> </span><a href="#local-1627544284"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-621"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-622"></a><span>    </span><a name="local-1627544285"><a href="#local-1627544285"><span class="hs-identifier">prefix</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a><span> </span><a href="#local-1627544284"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;$tc'&quot;</span><span>
</span><a name="line-623"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;$tc&quot;</span><span>
</span><a name="line-624"></a><span>
</span><a name="line-625"></a><span class="hs-comment">-- Generic deriving mechanism</span><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span class="hs-comment">-- | Generate a module-unique name, to be used e.g. while generating new names</span><span>
</span><a name="line-628"></a><span class="hs-comment">-- for Generics types. We use module unit id to avoid name clashes when</span><span>
</span><a name="line-629"></a><span class="hs-comment">-- package imports is used.</span><span>
</span><a name="line-630"></a><span class="hs-identifier">mkModPrefix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-631"></a><a name="mkModPrefix"><a href="OccName.html#mkModPrefix"><span class="hs-identifier">mkModPrefix</span></a></a><span> </span><a name="local-1627544286"><a href="#local-1627544286"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544287"><span class="hs-identifier hs-var">pk</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627544288"><span class="hs-identifier hs-var">mn</span></a><span>
</span><a name="line-632"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-633"></a><span>    </span><a name="local-1627544287"><a href="#local-1627544287"><span class="hs-identifier">pk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#unitIdString"><span class="hs-identifier hs-var">unitIdString</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-1627544286"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>    </span><a name="local-1627544288"><a href="#local-1627544288"><span class="hs-identifier">mn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#moduleNameString"><span class="hs-identifier hs-var">moduleNameString</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-1627544286"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-identifier">mkGenD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-637"></a><a name="mkGenD"><a href="OccName.html#mkGenD"><span class="hs-identifier">mkGenD</span></a></a><span> </span><a name="local-1627544289"><a href="#local-1627544289"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;D1_&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="OccName.html#mkModPrefix"><span class="hs-identifier hs-var">mkModPrefix</span></a><span> </span><a href="#local-1627544289"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-identifier">mkGenC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-640"></a><a name="mkGenC"><a href="OccName.html#mkGenC"><span class="hs-identifier">mkGenC</span></a></a><span> </span><a name="local-1627544290"><a href="#local-1627544290"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1627544291"><a href="#local-1627544291"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1627544292"><a href="#local-1627544292"><span class="hs-identifier">m</span></a></a><span>   </span><span class="hs-glyph">=</span><span>
</span><a name="line-641"></a><span>  </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;C1_&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627544292"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-642"></a><span>    </span><a href="OccName.html#mkModPrefix"><span class="hs-identifier hs-var">mkModPrefix</span></a><span> </span><a href="#local-1627544290"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544291"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-identifier">mkGenS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-645"></a><a name="mkGenS"><a href="OccName.html#mkGenS"><span class="hs-identifier">mkGenS</span></a></a><span> </span><a name="local-1627544293"><a href="#local-1627544293"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1627544294"><a href="#local-1627544294"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1627544295"><a href="#local-1627544295"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627544296"><a href="#local-1627544296"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-646"></a><span>  </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;S1_&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627544295"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627544296"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-647"></a><span>    </span><a href="OccName.html#mkModPrefix"><span class="hs-identifier hs-var">mkModPrefix</span></a><span> </span><a href="#local-1627544293"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544294"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-648"></a><span>
</span><a name="line-649"></a><a name="mkGenR"><a href="OccName.html#mkGenR"><span class="hs-identifier">mkGenR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span> </span><span class="hs-string">&quot;Rep_&quot;</span><span>
</span><a name="line-650"></a><a name="mkGen1R"><a href="OccName.html#mkGen1R"><span class="hs-identifier">mkGen1R</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span> </span><span class="hs-string">&quot;Rep1_&quot;</span><span>
</span><a name="line-651"></a><a name="mkGenRCo"><a href="OccName.html#mkGenRCo"><span class="hs-identifier">mkGenRCo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span> </span><span class="hs-string">&quot;CoRep_&quot;</span><span>
</span><a name="line-652"></a><span>
</span><a name="line-653"></a><span class="hs-comment">-- data T = MkT ... deriving( Data ) needs definitions for</span><span>
</span><a name="line-654"></a><span class="hs-comment">--      $tT   :: Data.Generics.Basics.DataType</span><span>
</span><a name="line-655"></a><span class="hs-comment">--      $cMkT :: Data.Generics.Basics.Constr</span><span>
</span><a name="line-656"></a><a name="mkDataTOcc"><a href="OccName.html#mkDataTOcc"><span class="hs-identifier">mkDataTOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$t&quot;</span><span>
</span><a name="line-657"></a><a name="mkDataCOcc"><a href="OccName.html#mkDataCOcc"><span class="hs-identifier">mkDataCOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$c&quot;</span><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span class="hs-comment">-- Vectorisation</span><span>
</span><a name="line-660"></a><span class="hs-identifier">mkVectOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkVectTyConOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkVectDataConOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkVectIsoOcc</span><span class="hs-special">,</span><span>
</span><a name="line-661"></a><span> </span><span class="hs-identifier">mkPADFunOcc</span><span class="hs-special">,</span><span>      </span><span class="hs-identifier">mkPReprTyConOcc</span><span class="hs-special">,</span><span>
</span><a name="line-662"></a><span> </span><span class="hs-identifier">mkPDataTyConOcc</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">mkPDataDataConOcc</span><span class="hs-special">,</span><span>
</span><a name="line-663"></a><span> </span><span class="hs-identifier">mkPDatasTyConOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkPDatasDataConOcc</span><span>
</span><a name="line-664"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-665"></a><a name="mkVectOcc"><a href="OccName.html#mkVectOcc"><span class="hs-identifier">mkVectOcc</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$v&quot;</span><span>
</span><a name="line-666"></a><a name="mkVectTyConOcc"><a href="OccName.html#mkVectTyConOcc"><span class="hs-identifier">mkVectTyConOcc</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>   </span><span class="hs-string">&quot;V:&quot;</span><span>
</span><a name="line-667"></a><a name="mkVectDataConOcc"><a href="OccName.html#mkVectDataConOcc"><span class="hs-identifier">mkVectDataConOcc</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#dataName"><span class="hs-identifier hs-var">dataName</span></a><span> </span><span class="hs-string">&quot;VD:&quot;</span><span>
</span><a name="line-668"></a><a name="mkVectIsoOcc"><a href="OccName.html#mkVectIsoOcc"><span class="hs-identifier">mkVectIsoOcc</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$vi&quot;</span><span>
</span><a name="line-669"></a><a name="mkPADFunOcc"><a href="OccName.html#mkPADFunOcc"><span class="hs-identifier">mkPADFunOcc</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span>  </span><span class="hs-string">&quot;$pa&quot;</span><span>
</span><a name="line-670"></a><a name="mkPReprTyConOcc"><a href="OccName.html#mkPReprTyConOcc"><span class="hs-identifier">mkPReprTyConOcc</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>   </span><span class="hs-string">&quot;VR:&quot;</span><span>
</span><a name="line-671"></a><a name="mkPDataTyConOcc"><a href="OccName.html#mkPDataTyConOcc"><span class="hs-identifier">mkPDataTyConOcc</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>   </span><span class="hs-string">&quot;VP:&quot;</span><span>
</span><a name="line-672"></a><a name="mkPDatasTyConOcc"><a href="OccName.html#mkPDatasTyConOcc"><span class="hs-identifier">mkPDatasTyConOcc</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>   </span><span class="hs-string">&quot;VPs:&quot;</span><span>
</span><a name="line-673"></a><a name="mkPDataDataConOcc"><a href="OccName.html#mkPDataDataConOcc"><span class="hs-identifier">mkPDataDataConOcc</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#dataName"><span class="hs-identifier hs-var">dataName</span></a><span> </span><span class="hs-string">&quot;VPD:&quot;</span><span>
</span><a name="line-674"></a><a name="mkPDatasDataConOcc"><a href="OccName.html#mkPDatasDataConOcc"><span class="hs-identifier">mkPDatasDataConOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier hs-var">mk_simple_deriv_with</span></a><span> </span><a href="OccName.html#dataName"><span class="hs-identifier hs-var">dataName</span></a><span> </span><span class="hs-string">&quot;VPDs:&quot;</span><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-comment">-- Overloaded record field selectors</span><span>
</span><a name="line-677"></a><span class="hs-identifier">mkRecFldSelOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-678"></a><a name="mkRecFldSelOcc"><a href="OccName.html#mkRecFldSelOcc"><span class="hs-identifier">mkRecFldSelOcc</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-string">&quot;$sel&quot;</span><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-identifier">mk_simple_deriv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-681"></a><a name="mk_simple_deriv"><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier">mk_simple_deriv</span></a></a><span> </span><a name="local-1627544297"><a href="#local-1627544297"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-1627544298"><a href="#local-1627544298"><span class="hs-identifier">px</span></a></a><span> </span><a name="local-1627544299"><a href="#local-1627544299"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="#local-1627544297"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="#local-1627544298"><span class="hs-identifier hs-var">px</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544299"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span class="hs-identifier">mk_simple_deriv_with</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-684"></a><a name="mk_simple_deriv_with"><a href="OccName.html#mk_simple_deriv_with"><span class="hs-identifier">mk_simple_deriv_with</span></a></a><span> </span><a name="local-1627544300"><a href="#local-1627544300"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-1627544301"><a href="#local-1627544301"><span class="hs-identifier">px</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><a name="local-1627544302"><a href="#local-1627544302"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="#local-1627544300"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="#local-1627544301"><span class="hs-identifier hs-var">px</span></a><span>                  </span><span class="hs-special">(</span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544302"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-685"></a><span class="hs-identifier">mk_simple_deriv_with</span><span> </span><a name="local-1627544303"><a href="#local-1627544303"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-1627544304"><a href="#local-1627544304"><span class="hs-identifier">px</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627544305"><a href="#local-1627544305"><span class="hs-identifier">with</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627544306"><a href="#local-1627544306"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="#local-1627544303"><span class="hs-identifier hs-var">sp</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544304"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627544305"><span class="hs-identifier hs-var">with</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544306"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span class="hs-comment">-- Data constructor workers are made by setting the name space</span><span>
</span><a name="line-688"></a><span class="hs-comment">-- of the data constructor OccName (which should be a DataName)</span><span>
</span><a name="line-689"></a><span class="hs-comment">-- to VarName</span><span>
</span><a name="line-690"></a><a name="mkDataConWorkerOcc"><a href="OccName.html#mkDataConWorkerOcc"><span class="hs-identifier">mkDataConWorkerOcc</span></a></a><span> </span><a name="local-1627544307"><a href="#local-1627544307"><span class="hs-identifier">datacon_occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><a href="#local-1627544307"><span class="hs-identifier hs-var">datacon_occ</span></a><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-identifier">mkSuperDictAuxOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-693"></a><a name="mkSuperDictAuxOcc"><a href="OccName.html#mkSuperDictAuxOcc"><span class="hs-identifier">mkSuperDictAuxOcc</span></a></a><span> </span><a name="local-1627544308"><a href="#local-1627544308"><span class="hs-identifier">index</span></a></a><span> </span><a name="local-1627544309"><a href="#local-1627544309"><span class="hs-identifier">cls_tc_occ</span></a></a><span>
</span><a name="line-694"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-string">&quot;$cp&quot;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627544308"><span class="hs-identifier hs-var">index</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544309"><span class="hs-identifier hs-var">cls_tc_occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-identifier">mkSuperDictSelOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>        </span><span class="hs-comment">-- ^ Index of superclass, e.g. 3</span><span>
</span><a name="line-697"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>    </span><span class="hs-comment">-- ^ Class, e.g. @Ord@</span><span>
</span><a name="line-698"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>    </span><span class="hs-comment">-- ^ Derived 'Occname', e.g. @$p3Ord@</span><span>
</span><a name="line-699"></a><a name="mkSuperDictSelOcc"><a href="OccName.html#mkSuperDictSelOcc"><span class="hs-identifier">mkSuperDictSelOcc</span></a></a><span> </span><a name="local-1627544310"><a href="#local-1627544310"><span class="hs-identifier">index</span></a></a><span> </span><a name="local-1627544311"><a href="#local-1627544311"><span class="hs-identifier">cls_tc_occ</span></a></a><span>
</span><a name="line-700"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-string">&quot;$p&quot;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627544310"><span class="hs-identifier hs-var">index</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544311"><span class="hs-identifier hs-var">cls_tc_occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-701"></a><span>
</span><a name="line-702"></a><span class="hs-identifier">mkLocalOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>            </span><span class="hs-comment">-- ^ Unique to combine with the 'OccName'</span><span>
</span><a name="line-703"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>           </span><span class="hs-comment">-- ^ Local name, e.g. @sat@</span><span>
</span><a name="line-704"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>           </span><span class="hs-comment">-- ^ Nice unique version, e.g. @$L23sat@</span><span>
</span><a name="line-705"></a><a name="mkLocalOcc"><a href="OccName.html#mkLocalOcc"><span class="hs-identifier">mkLocalOcc</span></a></a><span> </span><a name="local-1627544312"><a href="#local-1627544312"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-1627544313"><a href="#local-1627544313"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-706"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_deriv"><span class="hs-identifier hs-var">mk_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;$L&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627544312"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1627544313"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-707"></a><span>        </span><span class="hs-comment">-- The Unique might print with characters</span><span>
</span><a name="line-708"></a><span>        </span><span class="hs-comment">-- that need encoding (e.g. 'z'!)</span><span>
</span><a name="line-709"></a><span>
</span><a name="line-710"></a><span class="hs-comment">-- | Derive a name for the representation type constructor of a</span><span>
</span><a name="line-711"></a><span class="hs-comment">-- @data@\/@newtype@ instance.</span><span>
</span><a name="line-712"></a><span class="hs-identifier">mkInstTyTcOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>                 </span><span class="hs-comment">-- ^ Family name, e.g. @Map@</span><span>
</span><a name="line-713"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>                 </span><span class="hs-comment">-- ^ avoid these Occs</span><span>
</span><a name="line-714"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>                </span><span class="hs-comment">-- ^ @R:Map@</span><span>
</span><a name="line-715"></a><a name="mkInstTyTcOcc"><a href="OccName.html#mkInstTyTcOcc"><span class="hs-identifier">mkInstTyTcOcc</span></a></a><span> </span><a name="local-1627544314"><a href="#local-1627544314"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-1627544315"><a href="#local-1627544315"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-716"></a><span>  </span><a href="OccName.html#chooseUniqueOcc"><span class="hs-identifier hs-var">chooseUniqueOcc</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span> </span><span class="hs-special">(</span><span class="hs-char">'R'</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-char">':'</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627544314"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627544315"><span class="hs-identifier hs-var">set</span></a><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span class="hs-identifier">mkDFunOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>             </span><span class="hs-comment">-- ^ Typically the class and type glommed together e.g. @OrdMaybe@.</span><span>
</span><a name="line-719"></a><span>                                </span><span class="hs-comment">-- Only used in debug mode, for extra clarity</span><span>
</span><a name="line-720"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>               </span><span class="hs-comment">-- ^ Is this a hs-boot instance DFun?</span><span>
</span><a name="line-721"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>             </span><span class="hs-comment">-- ^ avoid these Occs</span><span>
</span><a name="line-722"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>            </span><span class="hs-comment">-- ^ E.g. @$f3OrdMaybe@</span><span>
</span><a name="line-723"></a><span>
</span><a name="line-724"></a><span class="hs-comment">-- In hs-boot files we make dict funs like $fx7ClsTy, which get bound to the real</span><span>
</span><a name="line-725"></a><span class="hs-comment">-- thing when we compile the mother module. Reason: we don't know exactly</span><span>
</span><a name="line-726"></a><span class="hs-comment">-- what the  mother module will call it.</span><span>
</span><a name="line-727"></a><span>
</span><a name="line-728"></a><a name="mkDFunOcc"><a href="OccName.html#mkDFunOcc"><span class="hs-identifier">mkDFunOcc</span></a></a><span> </span><a name="local-1627544316"><a href="#local-1627544316"><span class="hs-identifier">info_str</span></a></a><span> </span><a name="local-1627544317"><a href="#local-1627544317"><span class="hs-identifier">is_boot</span></a></a><span> </span><a name="local-1627544318"><a href="#local-1627544318"><span class="hs-identifier">set</span></a></a><span>
</span><a name="line-729"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#chooseUniqueOcc"><span class="hs-identifier hs-var">chooseUniqueOcc</span></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544319"><span class="hs-identifier hs-var">prefix</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627544316"><span class="hs-identifier hs-var">info_str</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627544318"><span class="hs-identifier hs-var">set</span></a><span>
</span><a name="line-730"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-731"></a><span>    </span><a name="local-1627544319"><a href="#local-1627544319"><span class="hs-identifier">prefix</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627544317"><span class="hs-identifier hs-var">is_boot</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;$fx&quot;</span><span>
</span><a name="line-732"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;$f&quot;</span><span>
</span><a name="line-733"></a><span>
</span><a name="line-734"></a><span class="hs-comment">{-
Sometimes we need to pick an OccName that has not already been used,
given a set of in-use OccNames.
-}</span><span>
</span><a name="line-738"></a><span>
</span><a name="line-739"></a><span class="hs-identifier">chooseUniqueOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-740"></a><a name="chooseUniqueOcc"><a href="OccName.html#chooseUniqueOcc"><span class="hs-identifier">chooseUniqueOcc</span></a></a><span> </span><a name="local-1627544320"><a href="#local-1627544320"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-1627544321"><a href="#local-1627544321"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-1627544322"><a href="#local-1627544322"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544323"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="#local-1627544320"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-1627544321"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-741"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-742"></a><span>  </span><a name="local-1627544323"><a href="#local-1627544323"><span class="hs-identifier">loop</span></a></a><span> </span><a name="local-1627544324"><a href="#local-1627544324"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1627544325"><a href="#local-1627544325"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-743"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627544324"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#elemOccSet"><span class="hs-identifier hs-var">elemOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627544322"><span class="hs-identifier hs-var">set</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544323"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="#local-1627544320"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544321"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627544325"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627544325"><span class="hs-identifier hs-var">n</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-744"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544324"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-745"></a><span>
</span><a name="line-746"></a><span class="hs-comment">{-
We used to add a '$m' to indicate a method, but that gives rise to bad
error messages from the type checker when we print the function name or pattern
of an instance-decl binding.  Why? Because the binding is zapped
to use the method name in place of the selector name.
(See TcClassDcl.tcMethodBind)

The way it is now, -ddump-xx output may look confusing, but
you can always say -dppr-debug to get the uniques.

However, we *do* have to zap the first character to be lower case,
because overloaded constructors (blarg) generate methods too.
And convert to VarName space

e.g. a call to constructor MkFoo where
        data (Ord a) =&gt; Foo a = MkFoo a

If this is necessary, we do it by prefixing '$m'.  These
guys never show up in error messages.  What a hack.
-}</span><span>
</span><a name="line-766"></a><span>
</span><a name="line-767"></a><span class="hs-identifier">mkMethodOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-768"></a><a name="mkMethodOcc"><a href="OccName.html#mkMethodOcc"><span class="hs-identifier">mkMethodOcc</span></a></a><span> </span><a name="local-1627544326"><a href="#local-1627544326"><span class="hs-identifier">occ</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627544326"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-769"></a><span class="hs-identifier">mkMethodOcc</span><span> </span><a name="local-1627544327"><a href="#local-1627544327"><span class="hs-identifier">occ</span></a></a><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mk_simple_deriv"><span class="hs-identifier hs-var">mk_simple_deriv</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-string">&quot;$m&quot;</span><span> </span><a href="#local-1627544327"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Tidying them up}
*                                                                      *
************************************************************************

Before we print chunks of code we like to rename it so that
we don't have to print lots of silly uniques in it.  But we mustn't
accidentally introduce name clashes!  So the idea is that we leave the
OccName alone unless it accidentally clashes with one that is already
in scope; if so, we tack on '1' at the end and try again, then '2', and
so on till we find a unique one.

There's a wrinkle for operators.  Consider '&gt;&gt;='.  We can't use '&gt;&gt;=1'
because that isn't a single lexeme.  So we encode it to 'lle' and *then*
tack on the '1', if necessary.

Note [TidyOccEnv]
~~~~~~~~~~~~~~~~~
type TidyOccEnv = UniqFM Int

* Domain = The OccName's FastString. These FastStrings are &quot;taken&quot;;
           make sure that we don't re-use

* Int, n = A plausible starting point for new guesses
           There is no guarantee that &quot;FSn&quot; is available;
           you must look that up in the TidyOccEnv.  But
           it's a good place to start looking.

* When looking for a renaming for &quot;foo2&quot; we strip off the &quot;2&quot; and start
  with &quot;foo&quot;.  Otherwise if we tidy twice we get silly names like foo23.

  However, if it started with digits at the end, we always make a name
  with digits at the end, rather than shortening &quot;foo2&quot; to just &quot;foo&quot;,
  even if &quot;foo&quot; is unused.  Reasons:
     - Plain &quot;foo&quot; might be used later
     - We use trailing digits to subtly indicate a unification variable
       in typechecker error message; see TypeRep.tidyTyVarBndr

We have to take care though! Consider a machine-generated module (Trac #10370)
  module Foo where
     a1 = e1
     a2 = e2
     ...
     a2000 = e2000
Then &quot;a1&quot;, &quot;a2&quot; etc are all marked taken.  But now if we come across &quot;a7&quot; again,
we have to do a linear search to find a free one, &quot;a2001&quot;.  That might just be
acceptable once.  But if we now come across &quot;a8&quot; again, we don't want to repeat
that search.

So we use the TidyOccEnv mapping for &quot;a&quot; (not &quot;a7&quot; or &quot;a8&quot;) as our base for
starting the search; and we make sure to update the starting point for &quot;a&quot;
after we allocate a new one.

-}</span><span>
</span><a name="line-827"></a><span>
</span><a name="line-828"></a><span class="hs-keyword">type</span><span> </span><a name="TidyOccEnv"><a href="OccName.html#TidyOccEnv"><span class="hs-identifier">TidyOccEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>    </span><span class="hs-comment">-- The in-scope OccNames</span><span>
</span><a name="line-829"></a><span>  </span><span class="hs-comment">-- See Note [TidyOccEnv]</span><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span class="hs-identifier">emptyTidyOccEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#TidyOccEnv"><span class="hs-identifier hs-type">TidyOccEnv</span></a><span>
</span><a name="line-832"></a><a name="emptyTidyOccEnv"><a href="OccName.html#emptyTidyOccEnv"><span class="hs-identifier">emptyTidyOccEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#emptyUFM"><span class="hs-identifier hs-var">emptyUFM</span></a><span>
</span><a name="line-833"></a><span>
</span><a name="line-834"></a><span class="hs-identifier">initTidyOccEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#TidyOccEnv"><span class="hs-identifier hs-type">TidyOccEnv</span></a><span>       </span><span class="hs-comment">-- Initialise with names to avoid!</span><span>
</span><a name="line-835"></a><a name="initTidyOccEnv"><a href="OccName.html#initTidyOccEnv"><span class="hs-identifier">initTidyOccEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-1627544328"><span class="hs-identifier hs-var">add</span></a><span> </span><a href="UniqFM.html#emptyUFM"><span class="hs-identifier hs-var">emptyUFM</span></a><span>
</span><a name="line-836"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-837"></a><span>    </span><a name="local-1627544328"><a href="#local-1627544328"><span class="hs-identifier">add</span></a></a><span> </span><a name="local-1627544329"><a href="#local-1627544329"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627544330"><a href="#local-1627544330"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#addToUFM"><span class="hs-identifier hs-var">addToUFM</span></a><span> </span><a href="#local-1627544329"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627544330"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-838"></a><span>
</span><a name="line-839"></a><span class="hs-identifier">tidyOccName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#TidyOccEnv"><span class="hs-identifier hs-type">TidyOccEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="OccName.html#TidyOccEnv"><span class="hs-identifier hs-type">TidyOccEnv</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">)</span><span>
</span><a name="line-840"></a><a name="tidyOccName"><a href="OccName.html#tidyOccName"><span class="hs-identifier">tidyOccName</span></a></a><span> </span><a name="local-1627544331"><a href="#local-1627544331"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627544332"><a href="#local-1627544332"><span class="hs-identifier">occ</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a name="local-1627544333"><a href="#local-1627544333"><span class="hs-identifier">occ_sp</span></a></a><span> </span><a name="local-1627544334"><a href="#local-1627544334"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><a href="#local-1627544331"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627544334"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-842"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="UniqFM.html#addToUFM"><span class="hs-identifier hs-var">addToUFM</span></a><span> </span><a href="#local-1627544331"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627544334"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-1627544332"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Desired OccName is free</span><span>
</span><a name="line-843"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><a href="#local-1627544331"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627544336"><span class="hs-identifier hs-var">base1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-844"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="UniqFM.html#addToUFM"><span class="hs-identifier hs-var">addToUFM</span></a><span> </span><a href="#local-1627544331"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627544336"><span class="hs-identifier hs-var">base1</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">,</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="#local-1627544333"><span class="hs-identifier hs-var">occ_sp</span></a><span> </span><a href="#local-1627544336"><span class="hs-identifier hs-var">base1</span></a><span class="hs-special">)</span><span>
</span><a name="line-845"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627544342"><a href="#local-1627544342"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544337"><span class="hs-identifier hs-var">find</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-1627544342"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-846"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-847"></a><span>    </span><span class="hs-identifier">base</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>  </span><span class="hs-comment">-- Drop trailing digits (see Note [TidyOccEnv])</span><span>
</span><a name="line-848"></a><span>    </span><a name="local-1627544335"><a href="#local-1627544335"><span class="hs-identifier">base</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#dropWhileEndLE"><span class="hs-identifier hs-var">dropWhileEndLE</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Unicode.html#isDigit"><span class="hs-identifier hs-var">isDigit</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-1627544334"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-849"></a><span>    </span><a name="local-1627544336"><a href="#local-1627544336"><span class="hs-identifier">base1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544335"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;1&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-850"></a><span>
</span><a name="line-851"></a><span>    </span><a name="local-1627544337"><a href="#local-1627544337"><span class="hs-identifier">find</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627544338"><a href="#local-1627544338"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627544339"><a href="#local-1627544339"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-852"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><a href="#local-1627544331"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627544340"><span class="hs-identifier hs-var">new_fs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-853"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627544337"><span class="hs-identifier hs-var">find</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544338"><span class="hs-identifier hs-var">k</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627544339"><span class="hs-identifier hs-var">n</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><a href="#local-1627544338"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-854"></a><span>                       </span><span class="hs-comment">-- By using n+k, the n argument to find goes</span><span>
</span><a name="line-855"></a><span>                       </span><span class="hs-comment">--    1, add 1, add 2, add 3, etc which</span><span>
</span><a name="line-856"></a><span>                       </span><span class="hs-comment">-- moves at quadratic speed through a dense patch</span><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627544341"><span class="hs-identifier hs-var">new_env</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="#local-1627544333"><span class="hs-identifier hs-var">occ_sp</span></a><span> </span><a href="#local-1627544340"><span class="hs-identifier hs-var">new_fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-859"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-860"></a><span>         </span><a name="local-1627544340"><a href="#local-1627544340"><span class="hs-identifier">new_fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544335"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627544339"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-861"></a><span>         </span><a name="local-1627544341"><a href="#local-1627544341"><span class="hs-identifier">new_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#addToUFM"><span class="hs-identifier hs-var">addToUFM</span></a><span> </span><span class="hs-special">(</span><a href="UniqFM.html#addToUFM"><span class="hs-identifier hs-var">addToUFM</span></a><span> </span><a href="#local-1627544331"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627544340"><span class="hs-identifier hs-var">new_fs</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1627544336"><span class="hs-identifier hs-var">base1</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627544339"><span class="hs-identifier hs-var">n</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-862"></a><span>                     </span><span class="hs-comment">-- Update:  base1,  so that next time we'll start where we left off</span><span>
</span><a name="line-863"></a><span>                     </span><span class="hs-comment">--          new_fs, so that we know it is taken</span><span>
</span><a name="line-864"></a><span>                     </span><span class="hs-comment">-- If they are the same (n==1), the former wins</span><span>
</span><a name="line-865"></a><span>                     </span><span class="hs-comment">-- See Note [TidyOccEnv]</span><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Binary instance
    Here rather than BinIface because OccName is abstract
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-875"></a><span>
</span><a name="line-876"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-877"></a><span>    </span><a name="local-1912728500"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-1627544349"><a href="#local-1627544349"><span class="hs-identifier">bh</span></a></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-878"></a><span>            </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627544349"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-879"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-1627544350"><a href="#local-1627544350"><span class="hs-identifier">bh</span></a></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-880"></a><span>            </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627544350"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-881"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-1627544351"><a href="#local-1627544351"><span class="hs-identifier">bh</span></a></a><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-882"></a><span>            </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627544351"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-883"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-1627544352"><a href="#local-1627544352"><span class="hs-identifier">bh</span></a></a><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-884"></a><span>            </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627544352"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">3</span><span>
</span><a name="line-885"></a><span>    </span><a name="local-1912728502"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-1627544353"><a href="#local-1627544353"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-886"></a><span>            </span><a name="local-1627544354"><a href="#local-1627544354"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a><span> </span><a href="#local-1627544353"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-887"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627544354"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-888"></a><span>              </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="OccName.html#VarName"><span class="hs-identifier hs-var">VarName</span></a><span>
</span><a name="line-889"></a><span>              </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="OccName.html#DataName"><span class="hs-identifier hs-var">DataName</span></a><span>
</span><a name="line-890"></a><span>              </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="OccName.html#TvName"><span class="hs-identifier hs-var">TvName</span></a><span>
</span><a name="line-891"></a><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="OccName.html#TcClsName"><span class="hs-identifier hs-var">TcClsName</span></a><span>
</span><a name="line-892"></a><span>
</span><a name="line-893"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-894"></a><span>    </span><a name="local-1912728500"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-1627544343"><a href="#local-1627544343"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a name="local-1627544344"><a href="#local-1627544344"><span class="hs-identifier">aa</span></a></a><span> </span><a name="local-1627544345"><a href="#local-1627544345"><span class="hs-identifier">ab</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-895"></a><span>            </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-1627544343"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-1627544344"><span class="hs-identifier hs-var">aa</span></a><span>
</span><a name="line-896"></a><span>            </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-1627544343"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-1627544345"><span class="hs-identifier hs-var">ab</span></a><span>
</span><a name="line-897"></a><span>    </span><a name="local-1912728502"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-1627544346"><a href="#local-1627544346"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-898"></a><span>          </span><a name="local-1627544347"><a href="#local-1627544347"><span class="hs-identifier">aa</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-1627544346"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-899"></a><span>          </span><a name="local-1627544348"><a href="#local-1627544348"><span class="hs-identifier">ab</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-1627544346"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-900"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-var">OccName</span></a><span> </span><a href="#local-1627544347"><span class="hs-identifier hs-var">aa</span></a><span> </span><a href="#local-1627544348"><span class="hs-identifier hs-var">ab</span></a><span class="hs-special">)</span><span>
</span><a name="line-901"></a></pre></body></html>