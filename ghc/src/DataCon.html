<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1998

\section[DataCon]{@DataCon@: Data Constructors}
-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE CPP, DeriveDataTypeable #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">DataCon</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-comment">-- * Main data types</span><span>
</span><a name="line-12"></a><span>        </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#DataConRep"><span class="hs-identifier hs-type">DataConRep</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>        </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="DataCon.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>        </span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>        </span><a href="DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="BasicTypes.html#ConTag"><span class="hs-identifier hs-type">ConTag</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span>        </span><span class="hs-comment">-- ** Equality specs</span><span>
</span><a name="line-19"></a><span>        </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#mkEqSpec"><span class="hs-identifier hs-var">mkEqSpec</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#eqSpecTyVar"><span class="hs-identifier hs-var">eqSpecTyVar</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#eqSpecType"><span class="hs-identifier hs-var">eqSpecType</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>        </span><a href="DataCon.html#eqSpecPair"><span class="hs-identifier hs-var">eqSpecPair</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#eqSpecPreds"><span class="hs-identifier hs-var">eqSpecPreds</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>        </span><a href="DataCon.html#substEqSpec"><span class="hs-identifier hs-var">substEqSpec</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>        </span><span class="hs-comment">-- ** Field labels</span><span>
</span><a name="line-24"></a><span>        </span><a href="FieldLabel.html#FieldLbl"><span class="hs-identifier hs-type">FieldLbl</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">,</span><span> </span><a href="FieldLabel.html#FieldLabelString"><span class="hs-identifier hs-type">FieldLabelString</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span>        </span><span class="hs-comment">-- ** Type construction</span><span>
</span><a name="line-27"></a><span>        </span><a href="DataCon.html#mkDataCon"><span class="hs-identifier hs-var">mkDataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#buildAlgTyCon"><span class="hs-identifier hs-var">buildAlgTyCon</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#fIRST_TAG"><span class="hs-identifier hs-var">fIRST_TAG</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>        </span><span class="hs-comment">-- ** Type deconstruction</span><span>
</span><a name="line-30"></a><span>        </span><a href="DataCon.html#dataConRepType"><span class="hs-identifier hs-var">dataConRepType</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConSig"><span class="hs-identifier hs-var">dataConSig</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConInstSig"><span class="hs-identifier hs-var">dataConInstSig</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConFullSig"><span class="hs-identifier hs-var">dataConFullSig</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>        </span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConIdentity"><span class="hs-identifier hs-var">dataConIdentity</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConTag"><span class="hs-identifier hs-var">dataConTag</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="DataCon.html#dataConOrigTyCon"><span class="hs-identifier hs-var">dataConOrigTyCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConUserType"><span class="hs-identifier hs-var">dataConUserType</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="DataCon.html#dataConUnivTyVars"><span class="hs-identifier hs-var">dataConUnivTyVars</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConExTyVars"><span class="hs-identifier hs-var">dataConExTyVars</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConAllTyVars"><span class="hs-identifier hs-var">dataConAllTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>        </span><a href="DataCon.html#dataConEqSpec"><span class="hs-identifier hs-var">dataConEqSpec</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConTheta"><span class="hs-identifier hs-var">dataConTheta</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>        </span><a href="DataCon.html#dataConStupidTheta"><span class="hs-identifier hs-var">dataConStupidTheta</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>        </span><a href="DataCon.html#dataConInstArgTys"><span class="hs-identifier hs-var">dataConInstArgTys</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConOrigResTy"><span class="hs-identifier hs-var">dataConOrigResTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>        </span><a href="DataCon.html#dataConInstOrigArgTys"><span class="hs-identifier hs-var">dataConInstOrigArgTys</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>        </span><a href="DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConFieldType"><span class="hs-identifier hs-var">dataConFieldType</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>        </span><a href="DataCon.html#dataConSrcBangs"><span class="hs-identifier hs-var">dataConSrcBangs</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>        </span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConRepArity"><span class="hs-identifier hs-var">dataConRepArity</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConRepRepArity"><span class="hs-identifier hs-var">dataConRepRepArity</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>        </span><a href="DataCon.html#dataConIsInfix"><span class="hs-identifier hs-var">dataConIsInfix</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><a href="DataCon.html#dataConWorkId"><span class="hs-identifier hs-var">dataConWorkId</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConWrapId"><span class="hs-identifier hs-var">dataConWrapId</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConWrapId_maybe"><span class="hs-identifier hs-var">dataConWrapId_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><a href="DataCon.html#dataConImplicitTyThings"><span class="hs-identifier hs-var">dataConImplicitTyThings</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>        </span><a href="DataCon.html#dataConRepStrictness"><span class="hs-identifier hs-var">dataConRepStrictness</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConImplBangs"><span class="hs-identifier hs-var">dataConImplBangs</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConBoxer"><span class="hs-identifier hs-var">dataConBoxer</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>        </span><a href="DataCon.html#splitDataProductType_maybe"><span class="hs-identifier hs-var">splitDataProductType_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>        </span><span class="hs-comment">-- ** Predicates on DataCons</span><span>
</span><a name="line-49"></a><span>        </span><a href="DataCon.html#isNullarySrcDataCon"><span class="hs-identifier hs-var">isNullarySrcDataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#isNullaryRepDataCon"><span class="hs-identifier hs-var">isNullaryRepDataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#isTupleDataCon"><span class="hs-identifier hs-var">isTupleDataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#isUnboxedTupleCon"><span class="hs-identifier hs-var">isUnboxedTupleCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>        </span><a href="DataCon.html#isVanillaDataCon"><span class="hs-identifier hs-var">isVanillaDataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#classDataCon"><span class="hs-identifier hs-var">classDataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConCannotMatch"><span class="hs-identifier hs-var">dataConCannotMatch</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>        </span><a href="DataCon.html#isBanged"><span class="hs-identifier hs-var">isBanged</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#isMarkedStrict"><span class="hs-identifier hs-var">isMarkedStrict</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#eqHsBang"><span class="hs-identifier hs-var">eqHsBang</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#isSrcStrict"><span class="hs-identifier hs-var">isSrcStrict</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#isSrcUnpacked"><span class="hs-identifier hs-var">isSrcUnpacked</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>        </span><a href="DataCon.html#specialPromotedDc"><span class="hs-identifier hs-var">specialPromotedDc</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#isLegacyPromotableDataCon"><span class="hs-identifier hs-var">isLegacyPromotableDataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#isLegacyPromotableTyCon"><span class="hs-identifier hs-var">isLegacyPromotableTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>        </span><span class="hs-comment">-- ** Promotion related functions</span><span>
</span><a name="line-55"></a><span>        </span><a href="DataCon.html#promoteDataCon"><span class="hs-identifier hs-var">promoteDataCon</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="MkId.html"><span class="hs-identifier">MkId</span></a><span class="hs-special">(</span><span> </span><a href="MkId.html#DataConBoxer"><span class="hs-identifier hs-type">DataConBoxer</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="ForeignCall.html"><span class="hs-identifier">ForeignCall</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="ForeignCall.html#CType"><span class="hs-identifier hs-type">CType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="Unify.html"><span class="hs-identifier">Unify</span></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="FieldLabel.html"><span class="hs-identifier">FieldLabel</span></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><a href="Binary.html"><span class="hs-identifier">Binary</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Data</span><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Char.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span></a><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Word.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Word</span></a><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">{-
Data constructor representation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider the following Haskell data type declaration

        data T = T !Int ![Int]

Using the strictness annotations, GHC will represent this as

        data T = T Int# [Int]

That is, the Int has been unboxed.  Furthermore, the Haskell source construction

        T e1 e2

is translated to

        case e1 of { I# x -&gt;
        case e2 of { r -&gt;
        T x r }}

That is, the first argument is unboxed, and the second is evaluated.  Finally,
pattern matching is translated too:

        case e of { T a b -&gt; ... }

becomes

        case e of { T a' b -&gt; let a = I# a' in ... }

To keep ourselves sane, we name the different versions of the data constructor
differently, as follows.


Note [Data Constructor Naming]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Each data constructor C has two, and possibly up to four, Names associated with it:

                   OccName   Name space   Name of   Notes
 ---------------------------------------------------------------------------
 The &quot;data con itself&quot;   C     DataName   DataCon   In dom( GlobalRdrEnv )
 The &quot;worker data con&quot;   C     VarName    Id        The worker
 The &quot;wrapper data con&quot;  $WC   VarName    Id        The wrapper
 The &quot;newtype coercion&quot;  :CoT  TcClsName  TyCon

EVERY data constructor (incl for newtypes) has the former two (the
data con itself, and its worker.  But only some data constructors have a
wrapper (see Note [The need for a wrapper]).

Each of these three has a distinct Unique.  The &quot;data con itself&quot; name
appears in the output of the renamer, and names the Haskell-source
data constructor.  The type checker translates it into either the wrapper Id
(if it exists) or worker Id (otherwise).

The data con has one or two Ids associated with it:

The &quot;worker Id&quot;, is the actual data constructor.
* Every data constructor (newtype or data type) has a worker

* The worker is very like a primop, in that it has no binding.

* For a *data* type, the worker *is* the data constructor;
  it has no unfolding

* For a *newtype*, the worker has a compulsory unfolding which
  does a cast, e.g.
        newtype T = MkT Int
        The worker for MkT has unfolding
                \\(x:Int). x `cast` sym CoT
  Here CoT is the type constructor, witnessing the FC axiom
        axiom CoT : T = Int

The &quot;wrapper Id&quot;, \$WC, goes as follows

* Its type is exactly what it looks like in the source program.

* It is an ordinary function, and it gets a top-level binding
  like any other function.

* The wrapper Id isn't generated for a data type if there is
  nothing for the wrapper to do.  That is, if its defn would be
        \$wC = C

Note [The need for a wrapper]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Why might the wrapper have anything to do?  Two reasons:

* Unboxing strict fields (with -funbox-strict-fields)
        data T = MkT !(Int,Int)
        \$wMkT :: (Int,Int) -&gt; T
        \$wMkT (x,y) = MkT x y
  Notice that the worker has two fields where the wapper has
  just one.  That is, the worker has type
                MkT :: Int -&gt; Int -&gt; T

* Equality constraints for GADTs
        data T a where { MkT :: a -&gt; T [a] }

  The worker gets a type with explicit equality
  constraints, thus:
        MkT :: forall a b. (a=[b]) =&gt; b -&gt; T a

  The wrapper has the programmer-specified type:
        \$wMkT :: a -&gt; T [a]
        \$wMkT a x = MkT [a] a [a] x
  The third argument is a coercion
        [a] :: [a]~[a]

INVARIANT: the dictionary constructor for a class
           never has a wrapper.


A note about the stupid context
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Data types can have a context:

        data (Eq a, Ord b) =&gt; T a b = T1 a b | T2 a

and that makes the constructors have a context too
(notice that T2's context is &quot;thinned&quot;):

        T1 :: (Eq a, Ord b) =&gt; a -&gt; b -&gt; T a b
        T2 :: (Eq a) =&gt; a -&gt; T a b

Furthermore, this context pops up when pattern matching
(though GHC hasn't implemented this, but it is in H98, and
I've fixed GHC so that it now does):

        f (T2 x) = x
gets inferred type
        f :: Eq a =&gt; T a b -&gt; a

I say the context is &quot;stupid&quot; because the dictionaries passed
are immediately discarded -- they do nothing and have no benefit.
It's a flaw in the language.

        Up to now [March 2002] I have put this stupid context into the
        type of the &quot;wrapper&quot; constructors functions, T1 and T2, but
        that turned out to be jolly inconvenient for generics, and
        record update, and other functions that build values of type T
        (because they don't have suitable dictionaries available).

        So now I've taken the stupid context out.  I simply deal with
        it separately in the type checker on occurrences of a
        constructor, either in an expression or in a pattern.

        [May 2003: actually I think this decision could evasily be
        reversed now, and probably should be.  Generics could be
        disabled for types with a stupid context; record updates now
        (H98) needs the context too; etc.  It's an unforced change, so
        I'm leaving it for now --- but it does seem odd that the
        wrapper doesn't include the stupid context.]

[July 04] With the advent of generalised data types, it's less obvious
what the &quot;stupid context&quot; is.  Consider
        C :: forall a. Ord a =&gt; a -&gt; a -&gt; T (Foo a)
Does the C constructor in Core contain the Ord dictionary?  Yes, it must:

        f :: T b -&gt; Ordering
        f = /\b. \x:T b.
            case x of
                C a (d:Ord a) (p:a) (q:a) -&gt; compare d p q

Note that (Foo a) might not be an instance of Ord.

************************************************************************
*                                                                      *
\subsection{Data constructors}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">-- | A data constructor</span><span>
</span><a name="line-259"></a><span class="hs-comment">--</span><span>
</span><a name="line-260"></a><span class="hs-comment">-- - 'ApiAnnotation.AnnKeywordId' : 'ApiAnnotation.AnnOpen',</span><span>
</span><a name="line-261"></a><span class="hs-comment">--             'ApiAnnotation.AnnClose','ApiAnnotation.AnnComma'</span><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">-- For details on above see note [Api annotations] in ApiAnnotation</span><span>
</span><a name="line-264"></a><span class="hs-keyword">data</span><span> </span><a name="DataCon"><a href="DataCon.html#DataCon"><span class="hs-identifier">DataCon</span></a></a><span>
</span><a name="line-265"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="MkData"><a href="DataCon.html#MkData"><span class="hs-identifier">MkData</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-266"></a><span>        </span><a href="DataCon.html#dcName"><span class="hs-identifier">dcName</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- This is the name of the *source data con*</span><span>
</span><a name="line-267"></a><span>                                </span><span class="hs-comment">-- (see &quot;Note [Data Constructor Naming]&quot; above)</span><span>
</span><a name="line-268"></a><span>        </span><a href="DataCon.html#dcUnique"><span class="hs-identifier">dcUnique</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Cached from Name</span><span>
</span><a name="line-269"></a><span>        </span><a href="DataCon.html#dcTag"><span class="hs-identifier">dcTag</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#ConTag"><span class="hs-identifier hs-type">ConTag</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ^ Tag, used for ordering 'DataCon's</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span>        </span><span class="hs-comment">-- Running example:</span><span>
</span><a name="line-272"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-273"></a><span>        </span><span class="hs-comment">--      *** As declared by the user</span><span>
</span><a name="line-274"></a><span>        </span><span class="hs-comment">--  data T a where</span><span>
</span><a name="line-275"></a><span>        </span><span class="hs-comment">--    MkT :: forall x y. (x~y,Ord x) =&gt; x -&gt; y -&gt; T (x,y)</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span>        </span><span class="hs-comment">--      *** As represented internally</span><span>
</span><a name="line-278"></a><span>        </span><span class="hs-comment">--  data T a where</span><span>
</span><a name="line-279"></a><span>        </span><span class="hs-comment">--    MkT :: forall a. forall x y. (a~(x,y),x~y,Ord x) =&gt; x -&gt; y -&gt; T a</span><span>
</span><a name="line-280"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-281"></a><span>        </span><span class="hs-comment">-- The next six fields express the type of the constructor, in pieces</span><span>
</span><a name="line-282"></a><span>        </span><span class="hs-comment">-- e.g.</span><span>
</span><a name="line-283"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-284"></a><span>        </span><span class="hs-comment">--      dcUnivTyVars  = [a]</span><span>
</span><a name="line-285"></a><span>        </span><span class="hs-comment">--      dcExTyVars    = [x,y]</span><span>
</span><a name="line-286"></a><span>        </span><span class="hs-comment">--      dcEqSpec      = [a~(x,y)]</span><span>
</span><a name="line-287"></a><span>        </span><span class="hs-comment">--      dcOtherTheta  = [x~y, Ord x]</span><span>
</span><a name="line-288"></a><span>        </span><span class="hs-comment">--      dcOrigArgTys  = [x,y]</span><span>
</span><a name="line-289"></a><span>        </span><span class="hs-comment">--      dcRepTyCon       = T</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span>        </span><a href="DataCon.html#dcVanilla"><span class="hs-identifier">dcVanilla</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- True &lt;=&gt; This is a vanilla Haskell 98 data constructor</span><span>
</span><a name="line-292"></a><span>                                </span><span class="hs-comment">--          Its type is of form</span><span>
</span><a name="line-293"></a><span>                                </span><span class="hs-comment">--              forall a1..an . t1 -&gt; ... tm -&gt; T a1..an</span><span>
</span><a name="line-294"></a><span>                                </span><span class="hs-comment">--          No existentials, no coercions, nothing.</span><span>
</span><a name="line-295"></a><span>                                </span><span class="hs-comment">-- That is: dcExTyVars = dcEqSpec = dcOtherTheta = []</span><span>
</span><a name="line-296"></a><span>                </span><span class="hs-comment">-- NB 1: newtypes always have a vanilla data con</span><span>
</span><a name="line-297"></a><span>                </span><span class="hs-comment">-- NB 2: a vanilla constructor can still be declared in GADT-style</span><span>
</span><a name="line-298"></a><span>                </span><span class="hs-comment">--       syntax, provided its type looks like the above.</span><span>
</span><a name="line-299"></a><span>                </span><span class="hs-comment">--       The declaration format is held in the TyCon (algTcGadtSyntax)</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span>        </span><a href="DataCon.html#dcUnivTyVars"><span class="hs-identifier">dcUnivTyVars</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- Universally-quantified type vars [a,b,c]</span><span>
</span><a name="line-302"></a><span>                                        </span><span class="hs-comment">-- INVARIANT: length matches arity of the dcRepTyCon</span><span>
</span><a name="line-303"></a><span>                                        </span><span class="hs-comment">---           result type of (rep) data con is exactly (T a b c)</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span>        </span><a href="DataCon.html#dcExTyVars"><span class="hs-identifier">dcExTyVars</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Existentially-quantified type vars</span><span>
</span><a name="line-306"></a><span>                </span><span class="hs-comment">-- In general, the dcUnivTyVars are NOT NECESSARILY THE SAME AS THE TYVARS</span><span>
</span><a name="line-307"></a><span>                </span><span class="hs-comment">-- FOR THE PARENT TyCon. With GADTs the data con might not even have</span><span>
</span><a name="line-308"></a><span>                </span><span class="hs-comment">-- the same number of type variables.</span><span>
</span><a name="line-309"></a><span>                </span><span class="hs-comment">-- [This is a change (Oct05): previously, vanilla datacons guaranteed to</span><span>
</span><a name="line-310"></a><span>                </span><span class="hs-comment">--  have the same type variables as their parent TyCon, but that seems ugly.]</span><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span>        </span><span class="hs-comment">-- INVARIANT: the UnivTyVars and ExTyVars all have distinct OccNames</span><span>
</span><a name="line-313"></a><span>        </span><span class="hs-comment">-- Reason: less confusing, and easier to generate IfaceSyn</span><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span>        </span><a href="DataCon.html#dcEqSpec"><span class="hs-identifier">dcEqSpec</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- Equalities derived from the result type,</span><span>
</span><a name="line-316"></a><span>                                </span><span class="hs-comment">-- _as written by the programmer_</span><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span>                </span><span class="hs-comment">-- This field allows us to move conveniently between the two ways</span><span>
</span><a name="line-319"></a><span>                </span><span class="hs-comment">-- of representing a GADT constructor's type:</span><span>
</span><a name="line-320"></a><span>                </span><span class="hs-comment">--      MkT :: forall a b. (a ~ [b]) =&gt; b -&gt; T a</span><span>
</span><a name="line-321"></a><span>                </span><span class="hs-comment">--      MkT :: forall b. b -&gt; T [b]</span><span>
</span><a name="line-322"></a><span>                </span><span class="hs-comment">-- Each equality is of the form (a ~ ty), where 'a' is one of</span><span>
</span><a name="line-323"></a><span>                </span><span class="hs-comment">-- the universally quantified type variables</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span>                </span><span class="hs-comment">-- The next two fields give the type context of the data constructor</span><span>
</span><a name="line-326"></a><span>                </span><span class="hs-comment">--      (aside from the GADT constraints,</span><span>
</span><a name="line-327"></a><span>                </span><span class="hs-comment">--       which are given by the dcExpSpec)</span><span>
</span><a name="line-328"></a><span>                </span><span class="hs-comment">-- In GADT form, this is *exactly* what the programmer writes, even if</span><span>
</span><a name="line-329"></a><span>                </span><span class="hs-comment">-- the context constrains only universally quantified variables</span><span>
</span><a name="line-330"></a><span>                </span><span class="hs-comment">--      MkT :: forall a b. (a ~ b, Ord b) =&gt; a -&gt; T a b</span><span>
</span><a name="line-331"></a><span>        </span><a href="DataCon.html#dcOtherTheta"><span class="hs-identifier">dcOtherTheta</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- The other constraints in the data con's type</span><span>
</span><a name="line-332"></a><span>                                    </span><span class="hs-comment">-- other than those in the dcEqSpec</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span>        </span><a href="DataCon.html#dcStupidTheta"><span class="hs-identifier">dcStupidTheta</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- The context of the data type declaration</span><span>
</span><a name="line-335"></a><span>                                        </span><span class="hs-comment">--      data Eq a =&gt; T a = ...</span><span>
</span><a name="line-336"></a><span>                                        </span><span class="hs-comment">-- or, rather, a &quot;thinned&quot; version thereof</span><span>
</span><a name="line-337"></a><span>                </span><span class="hs-comment">-- &quot;Thinned&quot;, because the Report says</span><span>
</span><a name="line-338"></a><span>                </span><span class="hs-comment">-- to eliminate any constraints that don't mention</span><span>
</span><a name="line-339"></a><span>                </span><span class="hs-comment">-- tyvars free in the arg types for this constructor</span><span>
</span><a name="line-340"></a><span>                </span><span class="hs-comment">--</span><span>
</span><a name="line-341"></a><span>                </span><span class="hs-comment">-- INVARIANT: the free tyvars of dcStupidTheta are a subset of dcUnivTyVars</span><span>
</span><a name="line-342"></a><span>                </span><span class="hs-comment">-- Reason: dcStupidTeta is gotten by thinning the stupid theta from the tycon</span><span>
</span><a name="line-343"></a><span>                </span><span class="hs-comment">--</span><span>
</span><a name="line-344"></a><span>                </span><span class="hs-comment">-- &quot;Stupid&quot;, because the dictionaries aren't used for anything.</span><span>
</span><a name="line-345"></a><span>                </span><span class="hs-comment">-- Indeed, [as of March 02] they are no longer in the type of</span><span>
</span><a name="line-346"></a><span>                </span><span class="hs-comment">-- the wrapper Id, because that makes it harder to use the wrap-id</span><span>
</span><a name="line-347"></a><span>                </span><span class="hs-comment">-- to rebuild values after record selection or in generics.</span><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span>        </span><a href="DataCon.html#dcOrigArgTys"><span class="hs-identifier">dcOrigArgTys</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- Original argument types</span><span>
</span><a name="line-350"></a><span>                                        </span><span class="hs-comment">-- (before unboxing and flattening of strict fields)</span><span>
</span><a name="line-351"></a><span>        </span><a href="DataCon.html#dcOrigResTy"><span class="hs-identifier">dcOrigResTy</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- Original result type, as seen by the user</span><span>
</span><a name="line-352"></a><span>                </span><span class="hs-comment">-- NB: for a data instance, the original user result type may</span><span>
</span><a name="line-353"></a><span>                </span><span class="hs-comment">-- differ from the DataCon's representation TyCon.  Example</span><span>
</span><a name="line-354"></a><span>                </span><span class="hs-comment">--      data instance T [a] where MkT :: a -&gt; T [a]</span><span>
</span><a name="line-355"></a><span>                </span><span class="hs-comment">-- The OrigResTy is T [a], but the dcRepTyCon might be :T123</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span>        </span><span class="hs-comment">-- Now the strictness annotations and field labels of the constructor</span><span>
</span><a name="line-358"></a><span>        </span><a href="DataCon.html#dcSrcBangs"><span class="hs-identifier">dcSrcBangs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-359"></a><span>                </span><span class="hs-comment">-- See Note [Bangs on data constructor arguments]</span><span>
</span><a name="line-360"></a><span>                </span><span class="hs-comment">--</span><span>
</span><a name="line-361"></a><span>                </span><span class="hs-comment">-- The [HsSrcBang] as written by the programmer.</span><span>
</span><a name="line-362"></a><span>                </span><span class="hs-comment">--</span><span>
</span><a name="line-363"></a><span>                </span><span class="hs-comment">-- Matches 1-1 with dcOrigArgTys</span><span>
</span><a name="line-364"></a><span>                </span><span class="hs-comment">-- Hence length = dataConSourceArity dataCon</span><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span>        </span><a href="DataCon.html#dcFields"><span class="hs-identifier">dcFields</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-367"></a><span>                </span><span class="hs-comment">-- Field labels for this constructor, in the</span><span>
</span><a name="line-368"></a><span>                </span><span class="hs-comment">-- same order as the dcOrigArgTys;</span><span>
</span><a name="line-369"></a><span>                </span><span class="hs-comment">-- length = 0 (if not a record) or dataConSourceArity.</span><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span>        </span><span class="hs-comment">-- The curried worker function that corresponds to the constructor:</span><span>
</span><a name="line-372"></a><span>        </span><span class="hs-comment">-- It doesn't have an unfolding; the code generator saturates these Ids</span><span>
</span><a name="line-373"></a><span>        </span><span class="hs-comment">-- and allocates a real constructor when it finds one.</span><span>
</span><a name="line-374"></a><span>        </span><a href="DataCon.html#dcWorkId"><span class="hs-identifier">dcWorkId</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span>
</span><a name="line-375"></a><span>
</span><a name="line-376"></a><span>        </span><span class="hs-comment">-- Constructor representation</span><span>
</span><a name="line-377"></a><span>        </span><a href="DataCon.html#dcRep"><span class="hs-identifier">dcRep</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataConRep"><span class="hs-identifier hs-type">DataConRep</span></a><span class="hs-special">,</span><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span>        </span><span class="hs-comment">-- Cached</span><span>
</span><a name="line-380"></a><span>          </span><span class="hs-comment">-- dcRepArity == length dataConRepArgTys</span><span>
</span><a name="line-381"></a><span>        </span><a href="DataCon.html#dcRepArity"><span class="hs-identifier">dcRepArity</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>
</span><a name="line-382"></a><span>          </span><span class="hs-comment">-- dcSourceArity == length dcOrigArgTys</span><span>
</span><a name="line-383"></a><span>        </span><a href="DataCon.html#dcSourceArity"><span class="hs-identifier">dcSourceArity</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>
</span><a name="line-384"></a><span>
</span><a name="line-385"></a><span>        </span><span class="hs-comment">-- Result type of constructor is T t1..tn</span><span>
</span><a name="line-386"></a><span>        </span><a href="DataCon.html#dcRepTyCon"><span class="hs-identifier">dcRepTyCon</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- Result tycon, T</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span>        </span><a href="DataCon.html#dcRepType"><span class="hs-identifier">dcRepType</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Type of the constructor</span><span>
</span><a name="line-389"></a><span>                                </span><span class="hs-comment">--      forall a x y. (a~(x,y), x~y, Ord x) =&gt;</span><span>
</span><a name="line-390"></a><span>                                </span><span class="hs-comment">--        x -&gt; y -&gt; T a</span><span>
</span><a name="line-391"></a><span>                                </span><span class="hs-comment">-- (this is *not* of the constructor wrapper Id:</span><span>
</span><a name="line-392"></a><span>                                </span><span class="hs-comment">--  see Note [Data con representation] below)</span><span>
</span><a name="line-393"></a><span>        </span><span class="hs-comment">-- Notice that the existential type parameters come *second*.</span><span>
</span><a name="line-394"></a><span>        </span><span class="hs-comment">-- Reason: in a case expression we may find:</span><span>
</span><a name="line-395"></a><span>        </span><span class="hs-comment">--      case (e :: T t) of</span><span>
</span><a name="line-396"></a><span>        </span><span class="hs-comment">--        MkT x y co1 co2 (d:Ord x) (v:r) (w:F s) -&gt; ...</span><span>
</span><a name="line-397"></a><span>        </span><span class="hs-comment">-- It's convenient to apply the rep-type of MkT to 't', to get</span><span>
</span><a name="line-398"></a><span>        </span><span class="hs-comment">--      forall x y. (t~(x,y), x~y, Ord x) =&gt; x -&gt; y -&gt; T t</span><span>
</span><a name="line-399"></a><span>        </span><span class="hs-comment">-- and use that to check the pattern.  Mind you, this is really only</span><span>
</span><a name="line-400"></a><span>        </span><span class="hs-comment">-- used in CoreLint.</span><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span>        </span><a href="DataCon.html#dcInfix"><span class="hs-identifier">dcInfix</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- True &lt;=&gt; declared infix</span><span>
</span><a name="line-404"></a><span>                                </span><span class="hs-comment">-- Used for Template Haskell and 'deriving' only</span><span>
</span><a name="line-405"></a><span>                                </span><span class="hs-comment">-- The actual fixity is stored elsewhere</span><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span>        </span><a href="DataCon.html#dcPromoted"><span class="hs-identifier">dcPromoted</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>    </span><span class="hs-comment">-- The promoted TyCon</span><span>
</span><a name="line-408"></a><span>                               </span><span class="hs-comment">-- See Note [Promoted data constructors] in TyCon</span><span>
</span><a name="line-409"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-410"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Typeable</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Typeable</span></a><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span class="hs-keyword">data</span><span> </span><a name="DataConRep"><a href="DataCon.html#DataConRep"><span class="hs-identifier">DataConRep</span></a></a><span>
</span><a name="line-413"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="NoDataConRep"><a href="DataCon.html#NoDataConRep"><span class="hs-identifier">NoDataConRep</span></a></a><span>              </span><span class="hs-comment">-- No wrapper</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DCR"><a href="DataCon.html#DCR"><span class="hs-identifier">DCR</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="DataCon.html#dcr_wrap_id"><span class="hs-identifier">dcr_wrap_id</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>   </span><span class="hs-comment">-- Takes src args, unboxes/flattens,</span><span>
</span><a name="line-416"></a><span>                              </span><span class="hs-comment">-- and constructs the representation</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="DataCon.html#dcr_boxer"><span class="hs-identifier">dcr_boxer</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="MkId.html#DataConBoxer"><span class="hs-identifier hs-type">DataConBoxer</span></a><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="DataCon.html#dcr_arg_tys"><span class="hs-identifier">dcr_arg_tys</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Final, representation argument types,</span><span>
</span><a name="line-421"></a><span>                                 </span><span class="hs-comment">-- after unboxing and flattening,</span><span>
</span><a name="line-422"></a><span>                                 </span><span class="hs-comment">-- and *including* all evidence args</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="DataCon.html#dcr_stricts"><span class="hs-identifier">dcr_stricts</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- 1-1 with dcr_arg_tys</span><span>
</span><a name="line-425"></a><span>                </span><span class="hs-comment">-- See also Note [Data-con worker strictness] in MkId.hs</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="DataCon.html#dcr_bangs"><span class="hs-identifier">dcr_bangs</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- The actual decisions made (including failures)</span><span>
</span><a name="line-428"></a><span>                                     </span><span class="hs-comment">-- about the original arguments; 1-1 with orig_arg_tys</span><span>
</span><a name="line-429"></a><span>                                     </span><span class="hs-comment">-- See Note [Bangs on data constructor arguments]</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-432"></a><span class="hs-comment">-- Algebraic data types always have a worker, and</span><span>
</span><a name="line-433"></a><span class="hs-comment">-- may or may not have a wrapper, depending on whether</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- the wrapper does anything.</span><span>
</span><a name="line-435"></a><span class="hs-comment">--</span><span>
</span><a name="line-436"></a><span class="hs-comment">-- Data types have a worker with no unfolding</span><span>
</span><a name="line-437"></a><span class="hs-comment">-- Newtypes just have a worker, which has a compulsory unfolding (just a cast)</span><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-comment">-- _Neither_ the worker _nor_ the wrapper take the dcStupidTheta dicts as arguments</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-comment">-- The wrapper (if it exists) takes dcOrigArgTys as its arguments</span><span>
</span><a name="line-442"></a><span class="hs-comment">-- The worker takes dataConRepArgTys as its arguments</span><span>
</span><a name="line-443"></a><span class="hs-comment">-- If the worker is absent, dataConRepArgTys is the same as dcOrigArgTys</span><span>
</span><a name="line-444"></a><span>
</span><a name="line-445"></a><span class="hs-comment">-- The 'NoDataConRep' case is important</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- Not only is this efficient,</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- but it also ensures that the wrapper is replaced</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- by the worker (because it *is* the worker)</span><span>
</span><a name="line-449"></a><span class="hs-comment">-- even when there are no args. E.g. in</span><span>
</span><a name="line-450"></a><span class="hs-comment">--              f (:) x</span><span>
</span><a name="line-451"></a><span class="hs-comment">-- the (:) *is* the worker.</span><span>
</span><a name="line-452"></a><span class="hs-comment">-- This is really important in rule matching,</span><span>
</span><a name="line-453"></a><span class="hs-comment">-- (We could match on the wrappers,</span><span>
</span><a name="line-454"></a><span class="hs-comment">-- but that makes it less likely that rules will match</span><span>
</span><a name="line-455"></a><span class="hs-comment">-- when we bring bits of unfoldings together.)</span><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span class="hs-comment">-------------------------</span><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span class="hs-comment">-- | Bangs on data constructor arguments as the user wrote them in the</span><span>
</span><a name="line-460"></a><span class="hs-comment">-- source code.</span><span>
</span><a name="line-461"></a><span class="hs-comment">--</span><span>
</span><a name="line-462"></a><span class="hs-comment">-- (HsSrcBang _ SrcUnpack SrcLazy) and</span><span>
</span><a name="line-463"></a><span class="hs-comment">-- (HsSrcBang _ SrcUnpack NoSrcStrict) (without StrictData) makes no sense, we</span><span>
</span><a name="line-464"></a><span class="hs-comment">-- emit a warning (in checkValidDataCon) and treat it like</span><span>
</span><a name="line-465"></a><span class="hs-comment">-- (HsSrcBang _ NoSrcUnpack SrcLazy)</span><span>
</span><a name="line-466"></a><span class="hs-keyword">data</span><span> </span><a name="HsSrcBang"><a href="DataCon.html#HsSrcBang"><span class="hs-identifier">HsSrcBang</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-467"></a><span>  </span><a name="HsSrcBang"><a href="DataCon.html#HsSrcBang"><span class="hs-identifier">HsSrcBang</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-type">SourceText</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Note [Pragma source text] in BasicTypes</span><span>
</span><a name="line-468"></a><span>            </span><a href="DataCon.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a><span>
</span><a name="line-469"></a><span>            </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span>
</span><a name="line-470"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Data</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Typeable</span></a><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span>
</span><a name="line-472"></a><span class="hs-comment">-- | Bangs of data constructor arguments as generated by the compiler</span><span>
</span><a name="line-473"></a><span class="hs-comment">-- after consulting HsSrcBang, flags, etc.</span><span>
</span><a name="line-474"></a><span class="hs-keyword">data</span><span> </span><a name="HsImplBang"><a href="DataCon.html#HsImplBang"><span class="hs-identifier">HsImplBang</span></a></a><span>
</span><a name="line-475"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="HsLazy"><a href="DataCon.html#HsLazy"><span class="hs-identifier">HsLazy</span></a></a><span>  </span><span class="hs-comment">-- ^ Lazy field</span><span>
</span><a name="line-476"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HsStrict"><a href="DataCon.html#HsStrict"><span class="hs-identifier">HsStrict</span></a></a><span>  </span><span class="hs-comment">-- ^ Strict but not unpacked field</span><span>
</span><a name="line-477"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HsUnpack"><a href="DataCon.html#HsUnpack"><span class="hs-identifier">HsUnpack</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span class="hs-special">)</span><span>
</span><a name="line-478"></a><span>    </span><span class="hs-comment">-- ^ Strict and unpacked field</span><span>
</span><a name="line-479"></a><span>    </span><span class="hs-comment">-- co :: arg-ty ~ product-ty HsBang</span><span>
</span><a name="line-480"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Data</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Typeable</span></a><span class="hs-special">)</span><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-comment">-- | What strictness annotation the user wrote</span><span>
</span><a name="line-483"></a><span class="hs-keyword">data</span><span> </span><a name="SrcStrictness"><a href="DataCon.html#SrcStrictness"><span class="hs-identifier">SrcStrictness</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SrcLazy"><a href="DataCon.html#SrcLazy"><span class="hs-identifier">SrcLazy</span></a></a><span> </span><span class="hs-comment">-- ^ Lazy, ie '~'</span><span>
</span><a name="line-484"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="SrcStrict"><a href="DataCon.html#SrcStrict"><span class="hs-identifier">SrcStrict</span></a></a><span> </span><span class="hs-comment">-- ^ Strict, ie '!'</span><span>
</span><a name="line-485"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="NoSrcStrict"><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier">NoSrcStrict</span></a></a><span> </span><span class="hs-comment">-- ^ no strictness annotation</span><span>
</span><a name="line-486"></a><span>     </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Data</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Typeable</span></a><span class="hs-special">)</span><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-comment">-- | What unpackedness the user requested</span><span>
</span><a name="line-489"></a><span class="hs-keyword">data</span><span> </span><a name="SrcUnpackedness"><a href="DataCon.html#SrcUnpackedness"><span class="hs-identifier">SrcUnpackedness</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SrcUnpack"><a href="DataCon.html#SrcUnpack"><span class="hs-identifier">SrcUnpack</span></a></a><span> </span><span class="hs-comment">-- ^ {-# UNPACK #-} specified</span><span>
</span><a name="line-490"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><a name="SrcNoUnpack"><a href="DataCon.html#SrcNoUnpack"><span class="hs-identifier">SrcNoUnpack</span></a></a><span> </span><span class="hs-comment">-- ^ {-# NOUNPACK #-} specified</span><span>
</span><a name="line-491"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><a name="NoSrcUnpack"><a href="DataCon.html#NoSrcUnpack"><span class="hs-identifier">NoSrcUnpack</span></a></a><span> </span><span class="hs-comment">-- ^ no unpack pragma</span><span>
</span><a name="line-492"></a><span>     </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Data</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Typeable</span></a><span class="hs-special">)</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-comment">-------------------------</span><span>
</span><a name="line-497"></a><span class="hs-comment">-- StrictnessMark is internal only, used to indicate strictness</span><span>
</span><a name="line-498"></a><span class="hs-comment">-- of the DataCon *worker* fields</span><span>
</span><a name="line-499"></a><span class="hs-keyword">data</span><span> </span><a name="StrictnessMark"><a href="DataCon.html#StrictnessMark"><span class="hs-identifier">StrictnessMark</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MarkedStrict"><a href="DataCon.html#MarkedStrict"><span class="hs-identifier">MarkedStrict</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NotMarkedStrict"><a href="DataCon.html#NotMarkedStrict"><span class="hs-identifier">NotMarkedStrict</span></a></a><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-comment">-- | An 'EqSpec' is a tyvar/type pair representing an equality made in</span><span>
</span><a name="line-502"></a><span class="hs-comment">-- rejigging a GADT constructor</span><span>
</span><a name="line-503"></a><span class="hs-keyword">data</span><span> </span><a name="EqSpec"><a href="DataCon.html#EqSpec"><span class="hs-identifier">EqSpec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EqSpec"><a href="DataCon.html#EqSpec"><span class="hs-identifier">EqSpec</span></a></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-504"></a><span>                     </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-comment">-- | Make an 'EqSpec'</span><span>
</span><a name="line-507"></a><span class="hs-identifier">mkEqSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span>
</span><a name="line-508"></a><a name="mkEqSpec"><a href="DataCon.html#mkEqSpec"><span class="hs-identifier">mkEqSpec</span></a></a><span> </span><a name="local-1627626097"><a href="#local-1627626097"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627626098"><a href="#local-1627626098"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-var">EqSpec</span></a><span> </span><a href="#local-1627626097"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1627626098"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-identifier">eqSpecTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-511"></a><a name="eqSpecTyVar"><a href="DataCon.html#eqSpecTyVar"><span class="hs-identifier">eqSpecTyVar</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-var">EqSpec</span></a><span> </span><a name="local-1627626099"><a href="#local-1627626099"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626099"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-identifier">eqSpecType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-514"></a><a name="eqSpecType"><a href="DataCon.html#eqSpecType"><span class="hs-identifier">eqSpecType</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-var">EqSpec</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627626100"><a href="#local-1627626100"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626100"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span class="hs-identifier">eqSpecPair</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-517"></a><a name="eqSpecPair"><a href="DataCon.html#eqSpecPair"><span class="hs-identifier">eqSpecPair</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-var">EqSpec</span></a><span> </span><a name="local-1627626101"><a href="#local-1627626101"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627626102"><a href="#local-1627626102"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627626101"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626102"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-518"></a><span>
</span><a name="line-519"></a><span class="hs-identifier">eqSpecPreds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span>
</span><a name="line-520"></a><a name="eqSpecPreds"><a href="DataCon.html#eqSpecPreds"><span class="hs-identifier">eqSpecPreds</span></a></a><span> </span><a name="local-1627626103"><a href="#local-1627626103"><span class="hs-identifier">spec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Type.html#mkPrimEqPred"><span class="hs-identifier hs-var">mkPrimEqPred</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1627626104"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627626105"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-521"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-var">EqSpec</span></a><span> </span><a name="local-1627626104"><a href="#local-1627626104"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627626105"><a href="#local-1627626105"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627626103"><span class="hs-identifier hs-var">spec</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-522"></a><span>
</span><a name="line-523"></a><span class="hs-comment">-- | Substitute in an 'EqSpec'. Precondition: if the LHS of the EqSpec</span><span>
</span><a name="line-524"></a><span class="hs-comment">-- is mapped in the substitution, it is mapped to a type variable, not</span><span>
</span><a name="line-525"></a><span class="hs-comment">-- a full type.</span><span>
</span><a name="line-526"></a><span class="hs-identifier">substEqSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span>
</span><a name="line-527"></a><a name="substEqSpec"><a href="DataCon.html#substEqSpec"><span class="hs-identifier">substEqSpec</span></a></a><span> </span><a name="local-1627626106"><a href="#local-1627626106"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-var">EqSpec</span></a><span> </span><a name="local-1627626107"><a href="#local-1627626107"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627626108"><a href="#local-1627626108"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-var">EqSpec</span></a><span> </span><a href="#local-1627626109"><span class="hs-identifier hs-var">tv'</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><a href="#local-1627626106"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627626108"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-529"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-530"></a><span>    </span><a name="local-1627626109"><a href="#local-1627626109"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getTyVar"><span class="hs-identifier hs-var">getTyVar</span></a><span> </span><span class="hs-string">&quot;substEqSpec&quot;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a><span> </span><a href="#local-1627626106"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627626107"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-531"></a><span>
</span><a name="line-532"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-533"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-var">EqSpec</span></a><span> </span><a name="local-1627626292"><a href="#local-1627626292"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627626293"><a href="#local-1627626293"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627626292"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626293"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-comment">{- Note [Bangs on data constructor arguments]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
  data T = MkT !Int {-# UNPACK #-} !Int Bool

When compiling the module, GHC will decide how to represent
MkT, depending on the optimisation level, and settings of
flags like -funbox-small-strict-fields.

Terminology:
  * HsSrcBang:  What the user wrote
                Constructors: HsSrcBang

  * HsImplBang: What GHC decided
                Constructors: HsLazy, HsStrict, HsUnpack

* If T was defined in this module, MkT's dcSrcBangs field
  records the [HsSrcBang] of what the user wrote; in the example
    [ HsSrcBang _ NoSrcUnpack SrcStrict
    , HsSrcBang _ SrcUnpack SrcStrict
    , HsSrcBang _ NoSrcUnpack NoSrcStrictness]

* However, if T was defined in an imported module, the importing module
  must follow the decisions made in the original module, regardless of
  the flag settings in the importing module.
  Also see Note [Bangs on imported data constructors] in MkId

* The dcr_bangs field of the dcRep field records the [HsImplBang]
  If T was defined in this module, Without -O the dcr_bangs might be
    [HsStrict, HsStrict, HsLazy]
  With -O it might be
    [HsStrict, HsUnpack _, HsLazy]
  With -funbox-small-strict-fields it might be
    [HsUnpack, HsUnpack _, HsLazy]
  With -XStrictData it might be
    [HsStrict, HsUnpack _, HsStrict]

Note [Data con representation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The dcRepType field contains the type of the representation of a contructor
This may differ from the type of the constructor *Id* (built
by MkId.mkDataConId) for two reasons:
        a) the constructor Id may be overloaded, but the dictionary isn't stored
           e.g.    data Eq a =&gt; T a = MkT a a

        b) the constructor may store an unboxed version of a strict field.

Here's an example illustrating both:
        data Ord a =&gt; T a = MkT Int! a
Here
        T :: Ord a =&gt; Int -&gt; a -&gt; T a
but the rep type is
        Trep :: Int# -&gt; a -&gt; T a
Actually, the unboxed part isn't implemented yet!



************************************************************************
*                                                                      *
\subsection{Instances}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-598"></a><span>
</span><a name="line-599"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-600"></a><span>    </span><a name="local-1627626288"><a href="#local-1627626288"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-805306535"><span class="hs-operator">==</span></a><span> </span><a name="local-1627626289"><a href="#local-1627626289"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626288"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626289"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-601"></a><span>    </span><a name="local-1627626290"><a href="#local-1627626290"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1912608688"><span class="hs-operator">/=</span></a><span> </span><a name="local-1627626291"><a href="#local-1627626291"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626290"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626291"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-604"></a><span>    </span><a name="local-1627626278"><a href="#local-1627626278"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1912608690"><span class="hs-operator">&lt;=</span></a><span> </span><a name="local-1627626279"><a href="#local-1627626279"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626278"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626279"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-605"></a><span>    </span><a name="local-1627626280"><a href="#local-1627626280"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1912608694"><span class="hs-operator">&lt;</span></a><span>  </span><a name="local-1627626281"><a href="#local-1627626281"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626280"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span>  </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626281"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-606"></a><span>    </span><a name="local-1627626282"><a href="#local-1627626282"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-805306536"><span class="hs-operator">&gt;=</span></a><span> </span><a name="local-1627626283"><a href="#local-1627626283"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626282"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626283"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-607"></a><span>    </span><a name="local-1627626284"><a href="#local-1627626284"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1912608695"><span class="hs-operator">&gt;</span></a><span>  </span><a name="local-1627626285"><a href="#local-1627626285"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626284"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626285"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-608"></a><span>    </span><a name="local-1912608689"><span class="hs-identifier">compare</span></a><span> </span><a name="local-1627626286"><a href="#local-1627626286"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627626287"><a href="#local-1627626287"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626286"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627626287"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-keyword">instance</span><span> </span><a href="Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-611"></a><span>    </span><a name="local-1912706050"><a href="Unique.html#getUnique"><span class="hs-identifier">getUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcUnique</span><span>
</span><a name="line-612"></a><span>
</span><a name="line-613"></a><span class="hs-keyword">instance</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-614"></a><span>    </span><a name="local-1912759012"><a href="Name.html#getName"><span class="hs-identifier">getName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcName</span><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-617"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-1627626277"><a href="#local-1627626277"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span> </span><a href="#local-1627626277"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#OutputableBndr"><span class="hs-identifier hs-type">OutputableBndr</span></a><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-620"></a><span>    </span><a name="local-1912686309"><a href="Outputable.html#pprInfixOcc"><span class="hs-identifier">pprInfixOcc</span></a></a><span> </span><a name="local-1627626275"><a href="#local-1627626275"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#pprInfixName"><span class="hs-identifier hs-var">pprInfixName</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span> </span><a href="#local-1627626275"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>    </span><a name="local-1912686308"><a href="Outputable.html#pprPrefixOcc"><span class="hs-identifier">pprPrefixOcc</span></a></a><span> </span><a name="local-1627626276"><a href="#local-1627626276"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#pprPrefixName"><span class="hs-identifier hs-var">pprPrefixName</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span> </span><a href="#local-1627626276"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-622"></a><span>
</span><a name="line-623"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Data</span></a><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-624"></a><span>    </span><span class="hs-comment">-- don't traverse?</span><span>
</span><a name="line-625"></a><span>    </span><a name="local-1912605886"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#toConstr"><span class="hs-identifier">toConstr</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#abstractConstr"><span class="hs-identifier hs-var">abstractConstr</span></a><span> </span><span class="hs-string">&quot;DataCon&quot;</span><span>
</span><a name="line-626"></a><span>    </span><a name="local-1912605887"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#gunfold"><span class="hs-identifier">gunfold</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-627"></a><span>    </span><a name="local-1912605885"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#dataTypeOf"><span class="hs-identifier">dataTypeOf</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#mkNoRepType"><span class="hs-identifier hs-var">mkNoRepType</span></a><span> </span><span class="hs-string">&quot;DataCon&quot;</span><span>
</span><a name="line-628"></a><span>
</span><a name="line-629"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-630"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-var">HsSrcBang</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627626273"><a href="#local-1627626273"><span class="hs-identifier">prag</span></a></a><span> </span><a name="local-1627626274"><a href="#local-1627626274"><span class="hs-identifier">mark</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627626273"><span class="hs-identifier hs-var">prag</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627626274"><span class="hs-identifier hs-var">mark</span></a><span>
</span><a name="line-631"></a><span>
</span><a name="line-632"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-633"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Lazy&quot;</span><span>
</span><a name="line-634"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unpacked&quot;</span><span>
</span><a name="line-635"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627626272"><a href="#local-1627626272"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unpacked&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627626272"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-636"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><a href="DataCon.html#HsStrict"><span class="hs-identifier hs-var">HsStrict</span></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;StrictNotUnpacked&quot;</span><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-639"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="DataCon.html#SrcLazy"><span class="hs-identifier hs-var">SrcLazy</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'~'</span><span>
</span><a name="line-640"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><a href="DataCon.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'!'</span><span>
</span><a name="line-641"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-642"></a><span>
</span><a name="line-643"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="DataCon.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-644"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="DataCon.html#SrcUnpack"><span class="hs-identifier hs-var">SrcUnpack</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;{-# UNPACK #-}&quot;</span><span>
</span><a name="line-645"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><a href="DataCon.html#SrcNoUnpack"><span class="hs-identifier hs-var">SrcNoUnpack</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;{-# NOUNPACK #-}&quot;</span><span>
</span><a name="line-646"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><a href="DataCon.html#NoSrcUnpack"><span class="hs-identifier hs-var">NoSrcUnpack</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-649"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="DataCon.html#MarkedStrict"><span class="hs-identifier hs-var">MarkedStrict</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;!&quot;</span><span>
</span><a name="line-650"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><a href="DataCon.html#NotMarkedStrict"><span class="hs-identifier hs-var">NotMarkedStrict</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-651"></a><span>
</span><a name="line-652"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-653"></a><span>    </span><a name="local-1912728500"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-1627626267"><a href="#local-1627626267"><span class="hs-identifier">bh</span></a></a><span> </span><a href="DataCon.html#SrcLazy"><span class="hs-identifier hs-var">SrcLazy</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627626267"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-654"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-1627626268"><a href="#local-1627626268"><span class="hs-identifier">bh</span></a></a><span> </span><a href="DataCon.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627626268"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-655"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-1627626269"><a href="#local-1627626269"><span class="hs-identifier">bh</span></a></a><span> </span><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627626269"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-656"></a><span>
</span><a name="line-657"></a><span>    </span><a name="local-1912728502"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-1627626270"><a href="#local-1627626270"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-658"></a><span>      </span><span class="hs-keyword">do</span><span> </span><a name="local-1627626271"><a href="#local-1627626271"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a><span> </span><a href="#local-1627626270"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-659"></a><span>         </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627626271"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-660"></a><span>           </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="DataCon.html#SrcLazy"><span class="hs-identifier hs-var">SrcLazy</span></a><span>
</span><a name="line-661"></a><span>           </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="DataCon.html#SrcLazy"><span class="hs-identifier hs-var">SrcLazy</span></a><span>
</span><a name="line-662"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a><span>
</span><a name="line-663"></a><span>
</span><a name="line-664"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="DataCon.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-665"></a><span>    </span><a name="local-1912728500"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-1627626262"><a href="#local-1627626262"><span class="hs-identifier">bh</span></a></a><span> </span><a href="DataCon.html#SrcNoUnpack"><span class="hs-identifier hs-var">SrcNoUnpack</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627626262"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-666"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-1627626263"><a href="#local-1627626263"><span class="hs-identifier">bh</span></a></a><span> </span><a href="DataCon.html#SrcUnpack"><span class="hs-identifier hs-var">SrcUnpack</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627626263"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-667"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-1627626264"><a href="#local-1627626264"><span class="hs-identifier">bh</span></a></a><span> </span><a href="DataCon.html#NoSrcUnpack"><span class="hs-identifier hs-var">NoSrcUnpack</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-1627626264"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span>    </span><a name="local-1912728502"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-1627626265"><a href="#local-1627626265"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-670"></a><span>      </span><span class="hs-keyword">do</span><span> </span><a name="local-1627626266"><a href="#local-1627626266"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a><span> </span><a href="#local-1627626265"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-671"></a><span>         </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627626266"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-672"></a><span>           </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="DataCon.html#SrcNoUnpack"><span class="hs-identifier hs-var">SrcNoUnpack</span></a><span>
</span><a name="line-673"></a><span>           </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="DataCon.html#SrcUnpack"><span class="hs-identifier hs-var">SrcUnpack</span></a><span>
</span><a name="line-674"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="DataCon.html#NoSrcUnpack"><span class="hs-identifier hs-var">NoSrcUnpack</span></a><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-comment">-- | Compare strictness annotations</span><span>
</span><a name="line-677"></a><span class="hs-identifier">eqHsBang</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-678"></a><a name="eqHsBang"><a href="DataCon.html#eqHsBang"><span class="hs-identifier">eqHsBang</span></a></a><span> </span><a href="DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a><span>               </span><a href="DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-679"></a><span class="hs-identifier">eqHsBang</span><span> </span><a href="DataCon.html#HsStrict"><span class="hs-identifier hs-var">HsStrict</span></a><span>             </span><a href="DataCon.html#HsStrict"><span class="hs-identifier hs-var">HsStrict</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-680"></a><span class="hs-identifier">eqHsBang</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-681"></a><span class="hs-identifier">eqHsBang</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627626110"><a href="#local-1627626110"><span class="hs-identifier">c1</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627626111"><a href="#local-1627626111"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-682"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span> </span><span class="hs-special">(</span><a href="Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a><span> </span><a href="#local-1627626110"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a><span> </span><a href="#local-1627626111"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span>
</span><a name="line-683"></a><span class="hs-identifier">eqHsBang</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span class="hs-identifier">isBanged</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-686"></a><a name="isBanged"><a href="DataCon.html#isBanged"><span class="hs-identifier">isBanged</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-687"></a><span class="hs-identifier">isBanged</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsStrict"><span class="hs-identifier hs-var">HsStrict</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-688"></a><span class="hs-identifier">isBanged</span><span> </span><a href="DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-identifier">isSrcStrict</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-691"></a><a name="isSrcStrict"><a href="DataCon.html#isSrcStrict"><span class="hs-identifier">isSrcStrict</span></a></a><span> </span><a href="DataCon.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-692"></a><span class="hs-identifier">isSrcStrict</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-693"></a><span>
</span><a name="line-694"></a><span class="hs-identifier">isSrcUnpacked</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-695"></a><a name="isSrcUnpacked"><a href="DataCon.html#isSrcUnpacked"><span class="hs-identifier">isSrcUnpacked</span></a></a><span> </span><a href="DataCon.html#SrcUnpack"><span class="hs-identifier hs-var">SrcUnpack</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-696"></a><span class="hs-identifier">isSrcUnpacked</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-697"></a><span>
</span><a name="line-698"></a><span class="hs-identifier">isMarkedStrict</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-699"></a><a name="isMarkedStrict"><a href="DataCon.html#isMarkedStrict"><span class="hs-identifier">isMarkedStrict</span></a></a><span> </span><a href="DataCon.html#NotMarkedStrict"><span class="hs-identifier hs-var">NotMarkedStrict</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-700"></a><span class="hs-identifier">isMarkedStrict</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- All others are strict</span><span>
</span><a name="line-701"></a><span>
</span><a name="line-702"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Construction}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-709"></a><span>
</span><a name="line-710"></a><span class="hs-comment">-- | Build a new data constructor</span><span>
</span><a name="line-711"></a><span class="hs-identifier">mkDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-712"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>           </span><span class="hs-comment">-- ^ Is the constructor declared infix?</span><span>
</span><a name="line-713"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>   </span><span class="hs-comment">-- ^  TyConRepName for the promoted TyCon</span><span>
</span><a name="line-714"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- ^ Strictness/unpack annotations, from user</span><span>
</span><a name="line-715"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ Field labels for the constructor,</span><span>
</span><a name="line-716"></a><span>                            </span><span class="hs-comment">-- if it is a record, otherwise empty</span><span>
</span><a name="line-717"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ Universally quantified type variables</span><span>
</span><a name="line-718"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ Existentially quantified type variables</span><span>
</span><a name="line-719"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- ^ GADT equalities</span><span>
</span><a name="line-720"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span>      </span><span class="hs-comment">-- ^ Theta-type occuring before the arguments proper</span><span>
</span><a name="line-721"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- ^ Original argument types</span><span>
</span><a name="line-722"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>           </span><span class="hs-comment">-- ^ Original result type</span><span>
</span><a name="line-723"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#RuntimeRepInfo"><span class="hs-identifier hs-type">RuntimeRepInfo</span></a><span> </span><span class="hs-comment">-- ^ See comments on 'TyCon.RuntimeRepInfo'</span><span>
</span><a name="line-724"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>          </span><span class="hs-comment">-- ^ Representation type constructor</span><span>
</span><a name="line-725"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span>      </span><span class="hs-comment">-- ^ The &quot;stupid theta&quot;, context of the data</span><span>
</span><a name="line-726"></a><span>                            </span><span class="hs-comment">-- declaration e.g. @data Eq a =&gt; T a ...@</span><span>
</span><a name="line-727"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>             </span><span class="hs-comment">-- ^ Worker Id</span><span>
</span><a name="line-728"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataConRep"><span class="hs-identifier hs-type">DataConRep</span></a><span>     </span><span class="hs-comment">-- ^ Representation</span><span>
</span><a name="line-729"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-730"></a><span>  </span><span class="hs-comment">-- Can get the tag from the TyCon</span><span>
</span><a name="line-731"></a><span>
</span><a name="line-732"></a><a name="mkDataCon"><a href="DataCon.html#mkDataCon"><span class="hs-identifier">mkDataCon</span></a></a><span> </span><a name="local-1627626112"><a href="#local-1627626112"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1627626113"><a href="#local-1627626113"><span class="hs-identifier">declared_infix</span></a></a><span> </span><a name="local-1627626114"><a href="#local-1627626114"><span class="hs-identifier">prom_info</span></a></a><span>
</span><a name="line-733"></a><span>          </span><a name="local-1627626115"><a href="#local-1627626115"><span class="hs-identifier">arg_stricts</span></a></a><span>   </span><span class="hs-comment">-- Must match orig_arg_tys 1-1</span><span>
</span><a name="line-734"></a><span>          </span><a name="local-1627626116"><a href="#local-1627626116"><span class="hs-identifier">fields</span></a></a><span>
</span><a name="line-735"></a><span>          </span><a name="local-1627626117"><a href="#local-1627626117"><span class="hs-identifier">univ_tvs</span></a></a><span> </span><a name="local-1627626118"><a href="#local-1627626118"><span class="hs-identifier">ex_tvs</span></a></a><span>
</span><a name="line-736"></a><span>          </span><a name="local-1627626119"><a href="#local-1627626119"><span class="hs-identifier">eq_spec</span></a></a><span> </span><a name="local-1627626120"><a href="#local-1627626120"><span class="hs-identifier">theta</span></a></a><span>
</span><a name="line-737"></a><span>          </span><a name="local-1627626121"><a href="#local-1627626121"><span class="hs-identifier">orig_arg_tys</span></a></a><span> </span><a name="local-1627626122"><a href="#local-1627626122"><span class="hs-identifier">orig_res_ty</span></a></a><span> </span><a name="local-1627626123"><a href="#local-1627626123"><span class="hs-identifier">rep_info</span></a></a><span> </span><a name="local-1627626124"><a href="#local-1627626124"><span class="hs-identifier">rep_tycon</span></a></a><span>
</span><a name="line-738"></a><span>          </span><a name="local-1627626125"><a href="#local-1627626125"><span class="hs-identifier">stupid_theta</span></a></a><span> </span><a name="local-1627626126"><a href="#local-1627626126"><span class="hs-identifier">work_id</span></a></a><span> </span><a name="local-1627626127"><a href="#local-1627626127"><span class="hs-identifier">rep</span></a></a><span>
</span><a name="line-739"></a><span class="hs-comment">-- Warning: mkDataCon is not a good place to check invariants.</span><span>
</span><a name="line-740"></a><span class="hs-comment">-- If the programmer writes the wrong result type in the decl, thus:</span><span>
</span><a name="line-741"></a><span class="hs-comment">--      data T a where { MkT :: S }</span><span>
</span><a name="line-742"></a><span class="hs-comment">-- then it's possible that the univ_tvs may hit an assertion failure</span><span>
</span><a name="line-743"></a><span class="hs-comment">-- if you pull on univ_tvs.  This case is checked by checkValidDataCon,</span><span>
</span><a name="line-744"></a><span class="hs-comment">-- so the error is detected properly... it's just that asaertions here</span><span>
</span><a name="line-745"></a><span class="hs-comment">-- are a little dodgy.</span><span>
</span><a name="line-746"></a><span>
</span><a name="line-747"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626129"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-748"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-749"></a><span>    </span><a name="local-1627626128"><a href="#local-1627626128"><span class="hs-identifier">is_vanilla</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1627626118"><span class="hs-identifier hs-var">ex_tvs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1627626119"><span class="hs-identifier hs-var">eq_spec</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1627626120"><span class="hs-identifier hs-var">theta</span></a><span>
</span><a name="line-750"></a><span>    </span><a name="local-1627626129"><a href="#local-1627626129"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">dcName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626112"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcUnique</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-1627626112"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-751"></a><span>                  </span><span class="hs-identifier">dcVanilla</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626128"><span class="hs-identifier hs-var">is_vanilla</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcInfix</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626113"><span class="hs-identifier hs-var">declared_infix</span></a><span class="hs-special">,</span><span>
</span><a name="line-752"></a><span>                  </span><span class="hs-identifier">dcUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626117"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626118"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span>
</span><a name="line-753"></a><span>                  </span><span class="hs-identifier">dcEqSpec</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626119"><span class="hs-identifier hs-var">eq_spec</span></a><span class="hs-special">,</span><span>
</span><a name="line-754"></a><span>                  </span><span class="hs-identifier">dcOtherTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626120"><span class="hs-identifier hs-var">theta</span></a><span class="hs-special">,</span><span>
</span><a name="line-755"></a><span>                  </span><span class="hs-identifier">dcStupidTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626125"><span class="hs-identifier hs-var">stupid_theta</span></a><span class="hs-special">,</span><span>
</span><a name="line-756"></a><span>                  </span><span class="hs-identifier">dcOrigArgTys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626121"><span class="hs-identifier hs-var">orig_arg_tys</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOrigResTy</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626122"><span class="hs-identifier hs-var">orig_res_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-757"></a><span>                  </span><span class="hs-identifier">dcRepTyCon</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626124"><span class="hs-identifier hs-var">rep_tycon</span></a><span class="hs-special">,</span><span>
</span><a name="line-758"></a><span>                  </span><span class="hs-identifier">dcSrcBangs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626115"><span class="hs-identifier hs-var">arg_stricts</span></a><span class="hs-special">,</span><span>
</span><a name="line-759"></a><span>                  </span><span class="hs-identifier">dcFields</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626116"><span class="hs-identifier hs-var">fields</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcTag</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626130"><span class="hs-identifier hs-var">tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcRepType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626132"><span class="hs-identifier hs-var">rep_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-760"></a><span>                  </span><span class="hs-identifier">dcWorkId</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626126"><span class="hs-identifier hs-var">work_id</span></a><span class="hs-special">,</span><span>
</span><a name="line-761"></a><span>                  </span><span class="hs-identifier">dcRep</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626127"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">,</span><span>
</span><a name="line-762"></a><span>                  </span><span class="hs-identifier">dcSourceArity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627626121"><span class="hs-identifier hs-var">orig_arg_tys</span></a><span class="hs-special">,</span><span>
</span><a name="line-763"></a><span>                  </span><span class="hs-identifier">dcRepArity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627626131"><span class="hs-identifier hs-var">rep_arg_tys</span></a><span class="hs-special">,</span><span>
</span><a name="line-764"></a><span>                  </span><span class="hs-identifier">dcPromoted</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626135"><span class="hs-identifier hs-var">promoted</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-765"></a><span>
</span><a name="line-766"></a><span>        </span><span class="hs-comment">-- The 'arg_stricts' passed to mkDataCon are simply those for the</span><span>
</span><a name="line-767"></a><span>        </span><span class="hs-comment">-- source-language arguments.  We add extra ones for the</span><span>
</span><a name="line-768"></a><span>        </span><span class="hs-comment">-- dictionary arguments right here.</span><span>
</span><a name="line-769"></a><span>
</span><a name="line-770"></a><span>    </span><a name="local-1627626130"><a href="#local-1627626130"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#assoc"><span class="hs-identifier hs-var">assoc</span></a><span> </span><span class="hs-string">&quot;mkDataCon&quot;</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1627626124"><span class="hs-identifier hs-var">rep_tycon</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="BasicTypes.html#fIRST_TAG"><span class="hs-identifier hs-var">fIRST_TAG</span></a><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-1627626129"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-771"></a><span>    </span><a name="local-1627626131"><a href="#local-1627626131"><span class="hs-identifier">rep_arg_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a><span> </span><a href="#local-1627626129"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-772"></a><span>      </span><span class="hs-comment">-- NB: This type is user-facing for datatypes that don't need wrappers;</span><span>
</span><a name="line-773"></a><span>      </span><span class="hs-comment">--     so it's important to use mkSpecForAllTys</span><span>
</span><a name="line-774"></a><span>    </span><a name="local-1627626132"><a href="#local-1627626132"><span class="hs-identifier">rep_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a><span> </span><a href="#local-1627626117"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a><span> </span><a href="#local-1627626118"><span class="hs-identifier hs-var">ex_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-775"></a><span>             </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><a href="#local-1627626131"><span class="hs-identifier hs-var">rep_arg_tys</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-776"></a><span>             </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1627626124"><span class="hs-identifier hs-var">rep_tycon</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span> </span><a href="#local-1627626117"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-777"></a><span>
</span><a name="line-778"></a><span>      </span><span class="hs-comment">-- See Note [Promoted data constructors] in TyCon</span><span>
</span><a name="line-779"></a><span>    </span><a name="local-1627626133"><a href="#local-1627626133"><span class="hs-identifier">prom_binders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#mkNamedBinder"><span class="hs-identifier hs-var">mkNamedBinder</span></a><span> </span><a href="TyCoRep.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span class="hs-special">)</span><span>
</span><a name="line-780"></a><span>                       </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627626117"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#minusList"><span class="hs-identifier hs-var">minusList</span></a><span class="hs-special">`</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="DataCon.html#eqSpecTyVar"><span class="hs-identifier hs-var">eqSpecTyVar</span></a><span> </span><a href="#local-1627626119"><span class="hs-identifier hs-var">eq_spec</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-781"></a><span>                        </span><a href="#local-1627626118"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-782"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Type.html#mkAnonBinder"><span class="hs-identifier hs-var">mkAnonBinder</span></a><span> </span><a href="#local-1627626120"><span class="hs-identifier hs-var">theta</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-783"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Type.html#mkAnonBinder"><span class="hs-identifier hs-var">mkAnonBinder</span></a><span> </span><a href="#local-1627626121"><span class="hs-identifier hs-var">orig_arg_tys</span></a><span>
</span><a name="line-784"></a><span>    </span><a name="local-1627626134"><a href="#local-1627626134"><span class="hs-identifier">prom_res_kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626122"><span class="hs-identifier hs-var">orig_res_ty</span></a><span>
</span><a name="line-785"></a><span>    </span><a name="local-1627626135"><a href="#local-1627626135"><span class="hs-identifier">promoted</span></a></a><span>
</span><a name="line-786"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkPromotedDataCon"><span class="hs-identifier hs-var">mkPromotedDataCon</span></a><span> </span><a href="#local-1627626129"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1627626112"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-1627626114"><span class="hs-identifier hs-var">prom_info</span></a><span> </span><a href="#local-1627626133"><span class="hs-identifier hs-var">prom_binders</span></a><span> </span><a href="#local-1627626134"><span class="hs-identifier hs-var">prom_res_kind</span></a><span> </span><a href="#local-1627626136"><span class="hs-identifier hs-var">roles</span></a><span> </span><a href="#local-1627626123"><span class="hs-identifier hs-var">rep_info</span></a><span>
</span><a name="line-787"></a><span>
</span><a name="line-788"></a><span>    </span><a name="local-1627626136"><a href="#local-1627626136"><span class="hs-identifier">roles</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627626117"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627626118"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-789"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627626121"><span class="hs-identifier hs-var">orig_arg_tys</span></a><span>
</span><a name="line-790"></a><span>
</span><a name="line-791"></a><span class="hs-comment">-- | The 'Name' of the 'DataCon', giving it a unique, rooted identification</span><span>
</span><a name="line-792"></a><span class="hs-identifier">dataConName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-793"></a><a name="dataConName"><a href="DataCon.html#dataConName"><span class="hs-identifier">dataConName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcName</span><span>
</span><a name="line-794"></a><span>
</span><a name="line-795"></a><span class="hs-comment">-- | The tag used for ordering 'DataCon's</span><span>
</span><a name="line-796"></a><span class="hs-identifier">dataConTag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#ConTag"><span class="hs-identifier hs-type">ConTag</span></a><span>
</span><a name="line-797"></a><a name="dataConTag"><a href="DataCon.html#dataConTag"><span class="hs-identifier">dataConTag</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcTag</span><span>
</span><a name="line-798"></a><span>
</span><a name="line-799"></a><span class="hs-comment">-- | The type constructor that we are building via this data constructor</span><span>
</span><a name="line-800"></a><span class="hs-identifier">dataConTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-801"></a><a name="dataConTyCon"><a href="DataCon.html#dataConTyCon"><span class="hs-identifier">dataConTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcRepTyCon</span><span>
</span><a name="line-802"></a><span>
</span><a name="line-803"></a><span class="hs-comment">-- | The original type constructor used in the definition of this data</span><span>
</span><a name="line-804"></a><span class="hs-comment">-- constructor.  In case of a data family instance, that will be the family</span><span>
</span><a name="line-805"></a><span class="hs-comment">-- type constructor.</span><span>
</span><a name="line-806"></a><span class="hs-identifier">dataConOrigTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-807"></a><a name="dataConOrigTyCon"><a href="DataCon.html#dataConOrigTyCon"><span class="hs-identifier">dataConOrigTyCon</span></a></a><span> </span><a name="local-1627626137"><a href="#local-1627626137"><span class="hs-identifier">dc</span></a></a><span>
</span><a name="line-808"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627626138"><a href="#local-1627626138"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">dcRepTyCon</span><span> </span><a href="#local-1627626137"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626138"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-809"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcRepTyCon</span><span> </span><a href="#local-1627626137"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-810"></a><span>
</span><a name="line-811"></a><span class="hs-comment">-- | The representation type of the data constructor, i.e. the sort</span><span>
</span><a name="line-812"></a><span class="hs-comment">-- type that will represent values of this type at runtime</span><span>
</span><a name="line-813"></a><span class="hs-identifier">dataConRepType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-814"></a><a name="dataConRepType"><a href="DataCon.html#dataConRepType"><span class="hs-identifier">dataConRepType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcRepType</span><span>
</span><a name="line-815"></a><span>
</span><a name="line-816"></a><span class="hs-comment">-- | Should the 'DataCon' be presented infix?</span><span>
</span><a name="line-817"></a><span class="hs-identifier">dataConIsInfix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-818"></a><a name="dataConIsInfix"><a href="DataCon.html#dataConIsInfix"><span class="hs-identifier">dataConIsInfix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcInfix</span><span>
</span><a name="line-819"></a><span>
</span><a name="line-820"></a><span class="hs-comment">-- | The universally-quantified type variables of the constructor</span><span>
</span><a name="line-821"></a><span class="hs-identifier">dataConUnivTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-822"></a><a name="dataConUnivTyVars"><a href="DataCon.html#dataConUnivTyVars"><span class="hs-identifier">dataConUnivTyVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcUnivTyVars</span><span>
</span><a name="line-823"></a><span>
</span><a name="line-824"></a><span class="hs-comment">-- | The existentially-quantified type variables of the constructor</span><span>
</span><a name="line-825"></a><span class="hs-identifier">dataConExTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-826"></a><a name="dataConExTyVars"><a href="DataCon.html#dataConExTyVars"><span class="hs-identifier">dataConExTyVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcExTyVars</span><span>
</span><a name="line-827"></a><span>
</span><a name="line-828"></a><span class="hs-comment">-- | Both the universal and existentiatial type variables of the constructor</span><span>
</span><a name="line-829"></a><span class="hs-identifier">dataConAllTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-830"></a><a name="dataConAllTyVars"><a href="DataCon.html#dataConAllTyVars"><span class="hs-identifier">dataConAllTyVars</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626139"><a href="#local-1627626139"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626140"><a href="#local-1627626140"><span class="hs-identifier">ex_tvs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-831"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626139"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627626140"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-832"></a><span>
</span><a name="line-833"></a><span class="hs-comment">-- | Equalities derived from the result type of the data constructor, as written</span><span>
</span><a name="line-834"></a><span class="hs-comment">-- by the programmer in any GADT declaration. This includes *all* GADT-like</span><span>
</span><a name="line-835"></a><span class="hs-comment">-- equalities, including those written in by hand by the programmer.</span><span>
</span><a name="line-836"></a><span class="hs-identifier">dataConEqSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span class="hs-special">]</span><span>
</span><a name="line-837"></a><a name="dataConEqSpec"><a href="DataCon.html#dataConEqSpec"><span class="hs-identifier">dataConEqSpec</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcEqSpec</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626141"><a href="#local-1627626141"><span class="hs-identifier">eq_spec</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOtherTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626142"><a href="#local-1627626142"><span class="hs-identifier">theta</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-838"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626141"><span class="hs-identifier hs-var">eq_spec</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-839"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="#local-1627626150"><span class="hs-identifier hs-var">spec</span></a><span>   </span><span class="hs-comment">-- heterogeneous equality</span><span>
</span><a name="line-840"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627626143"><a href="#local-1627626143"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-1627626144"><a href="#local-1627626144"><span class="hs-identifier">_k1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627626145"><a href="#local-1627626145"><span class="hs-identifier">_k2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627626146"><a href="#local-1627626146"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627626147"><a href="#local-1627626147"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627626142"><span class="hs-identifier hs-var">theta</span></a><span>
</span><a name="line-841"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-1627626143"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#heqTyConKey"><span class="hs-identifier hs-var">heqTyConKey</span></a><span>
</span><a name="line-842"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="local-1627626150"><a href="#local-1627626150"><span class="hs-identifier">spec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1627626146"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1627626147"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-843"></a><span>                    </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627626148"><a href="#local-1627626148"><span class="hs-identifier">tv1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#mkEqSpec"><span class="hs-identifier hs-var">mkEqSpec</span></a><span> </span><a href="#local-1627626148"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1627626147"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-844"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627626149"><a href="#local-1627626149"><span class="hs-identifier">tv2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#mkEqSpec"><span class="hs-identifier hs-var">mkEqSpec</span></a><span> </span><a href="#local-1627626149"><span class="hs-identifier hs-var">tv2</span></a><span> </span><a href="#local-1627626146"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">]</span><span>
</span><a name="line-845"></a><span>                    </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-846"></a><span>    </span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-847"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="#local-1627626157"><span class="hs-identifier hs-var">spec</span></a><span>   </span><span class="hs-comment">-- homogeneous equality</span><span>
</span><a name="line-848"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627626151"><a href="#local-1627626151"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-1627626152"><a href="#local-1627626152"><span class="hs-identifier">_k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627626153"><a href="#local-1627626153"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627626154"><a href="#local-1627626154"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627626142"><span class="hs-identifier hs-var">theta</span></a><span>
</span><a name="line-849"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-1627626151"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqTyConKey"><span class="hs-identifier hs-var">eqTyConKey</span></a><span>
</span><a name="line-850"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="local-1627626157"><a href="#local-1627626157"><span class="hs-identifier">spec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1627626153"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1627626154"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-851"></a><span>                    </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627626155"><a href="#local-1627626155"><span class="hs-identifier">tv1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#mkEqSpec"><span class="hs-identifier hs-var">mkEqSpec</span></a><span> </span><a href="#local-1627626155"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1627626154"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-852"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627626156"><a href="#local-1627626156"><span class="hs-identifier">tv2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#mkEqSpec"><span class="hs-identifier hs-var">mkEqSpec</span></a><span> </span><a href="#local-1627626156"><span class="hs-identifier hs-var">tv2</span></a><span> </span><a href="#local-1627626153"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">]</span><span>
</span><a name="line-853"></a><span>                    </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-854"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span>
</span><a name="line-857"></a><span class="hs-comment">-- | The *full* constraints on the constructor type.</span><span>
</span><a name="line-858"></a><span class="hs-identifier">dataConTheta</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span>
</span><a name="line-859"></a><a name="dataConTheta"><a href="DataCon.html#dataConTheta"><span class="hs-identifier">dataConTheta</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcEqSpec</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626158"><a href="#local-1627626158"><span class="hs-identifier">eq_spec</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOtherTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626159"><a href="#local-1627626159"><span class="hs-identifier">theta</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-860"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#eqSpecPreds"><span class="hs-identifier hs-var">eqSpecPreds</span></a><span> </span><a href="#local-1627626158"><span class="hs-identifier hs-var">eq_spec</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627626159"><span class="hs-identifier hs-var">theta</span></a><span>
</span><a name="line-861"></a><span>
</span><a name="line-862"></a><span class="hs-comment">-- | Get the Id of the 'DataCon' worker: a function that is the &quot;actual&quot;</span><span>
</span><a name="line-863"></a><span class="hs-comment">-- constructor and has no top level binding in the program. The type may</span><span>
</span><a name="line-864"></a><span class="hs-comment">-- be different from the obvious one written in the source program. Panics</span><span>
</span><a name="line-865"></a><span class="hs-comment">-- if there is no such 'Id' for this 'DataCon'</span><span>
</span><a name="line-866"></a><span class="hs-identifier">dataConWorkId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-867"></a><a name="dataConWorkId"><a href="DataCon.html#dataConWorkId"><span class="hs-identifier">dataConWorkId</span></a></a><span> </span><a name="local-1627626160"><a href="#local-1627626160"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcWorkId</span><span> </span><a href="#local-1627626160"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span class="hs-comment">-- | Get the Id of the 'DataCon' wrapper: a function that wraps the &quot;actual&quot;</span><span>
</span><a name="line-870"></a><span class="hs-comment">-- constructor so it has the type visible in the source program: c.f. 'dataConWorkId'.</span><span>
</span><a name="line-871"></a><span class="hs-comment">-- Returns Nothing if there is no wrapper, which occurs for an algebraic data constructor</span><span>
</span><a name="line-872"></a><span class="hs-comment">-- and also for a newtype (whose constructor is inlined compulsorily)</span><span>
</span><a name="line-873"></a><span class="hs-identifier">dataConWrapId_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-874"></a><a name="dataConWrapId_maybe"><a href="DataCon.html#dataConWrapId_maybe"><span class="hs-identifier">dataConWrapId_maybe</span></a></a><span> </span><a name="local-1627626161"><a href="#local-1627626161"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">dcRep</span><span> </span><a href="#local-1627626161"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-875"></a><span>                           </span><a href="DataCon.html#NoDataConRep"><span class="hs-identifier hs-var">NoDataConRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-876"></a><span>                           </span><a href="DataCon.html#DCR"><span class="hs-identifier hs-var">DCR</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcr_wrap_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626162"><a href="#local-1627626162"><span class="hs-identifier">wrap_id</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627626162"><span class="hs-identifier hs-var">wrap_id</span></a><span>
</span><a name="line-877"></a><span>
</span><a name="line-878"></a><span class="hs-comment">-- | Returns an Id which looks like the Haskell-source constructor by using</span><span>
</span><a name="line-879"></a><span class="hs-comment">-- the wrapper if it exists (see 'dataConWrapId_maybe') and failing over to</span><span>
</span><a name="line-880"></a><span class="hs-comment">-- the worker (see 'dataConWorkId')</span><span>
</span><a name="line-881"></a><span class="hs-identifier">dataConWrapId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-882"></a><a name="dataConWrapId"><a href="DataCon.html#dataConWrapId"><span class="hs-identifier">dataConWrapId</span></a></a><span> </span><a name="local-1627626163"><a href="#local-1627626163"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">dcRep</span><span> </span><a href="#local-1627626163"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-883"></a><span>                     </span><a href="DataCon.html#NoDataConRep"><span class="hs-identifier hs-var">NoDataConRep</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">dcWorkId</span><span> </span><a href="#local-1627626163"><span class="hs-identifier hs-var">dc</span></a><span>    </span><span class="hs-comment">-- worker=wrapper</span><span>
</span><a name="line-884"></a><span>                     </span><a href="DataCon.html#DCR"><span class="hs-identifier hs-var">DCR</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcr_wrap_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626164"><a href="#local-1627626164"><span class="hs-identifier">wrap_id</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627626164"><span class="hs-identifier hs-var">wrap_id</span></a><span>
</span><a name="line-885"></a><span>
</span><a name="line-886"></a><span class="hs-comment">-- | Find all the 'Id's implicitly brought into scope by the data constructor. Currently,</span><span>
</span><a name="line-887"></a><span class="hs-comment">-- the union of the 'dataConWorkId' and the 'dataConWrapId'</span><span>
</span><a name="line-888"></a><span class="hs-identifier">dataConImplicitTyThings</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span class="hs-special">]</span><span>
</span><a name="line-889"></a><a name="dataConImplicitTyThings"><a href="DataCon.html#dataConImplicitTyThings"><span class="hs-identifier">dataConImplicitTyThings</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcWorkId</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626165"><a href="#local-1627626165"><span class="hs-identifier">work</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcRep</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626166"><a href="#local-1627626166"><span class="hs-identifier">rep</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-890"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#AnId"><span class="hs-identifier hs-var">AnId</span></a><span> </span><a href="#local-1627626165"><span class="hs-identifier hs-var">work</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627626167"><span class="hs-identifier hs-var">wrap_ids</span></a><span>
</span><a name="line-891"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-892"></a><span>    </span><a name="local-1627626167"><a href="#local-1627626167"><span class="hs-identifier">wrap_ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627626166"><span class="hs-identifier hs-var">rep</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-893"></a><span>                 </span><a href="DataCon.html#NoDataConRep"><span class="hs-identifier hs-var">NoDataConRep</span></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-894"></a><span>                 </span><a href="DataCon.html#DCR"><span class="hs-identifier hs-var">DCR</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcr_wrap_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626168"><a href="#local-1627626168"><span class="hs-identifier">wrap</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#AnId"><span class="hs-identifier hs-var">AnId</span></a><span> </span><a href="#local-1627626168"><span class="hs-identifier hs-var">wrap</span></a><span class="hs-special">]</span><span>
</span><a name="line-895"></a><span>
</span><a name="line-896"></a><span class="hs-comment">-- | The labels for the fields of this particular 'DataCon'</span><span>
</span><a name="line-897"></a><span class="hs-identifier">dataConFieldLabels</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span>
</span><a name="line-898"></a><a name="dataConFieldLabels"><a href="DataCon.html#dataConFieldLabels"><span class="hs-identifier">dataConFieldLabels</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcFields</span><span>
</span><a name="line-899"></a><span>
</span><a name="line-900"></a><span class="hs-comment">-- | Extract the type for any given labelled field of the 'DataCon'</span><span>
</span><a name="line-901"></a><span class="hs-identifier">dataConFieldType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FieldLabel.html#FieldLabelString"><span class="hs-identifier hs-type">FieldLabelString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-902"></a><a name="dataConFieldType"><a href="DataCon.html#dataConFieldType"><span class="hs-identifier">dataConFieldType</span></a></a><span> </span><a name="local-1627626169"><a href="#local-1627626169"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1627626170"><a href="#local-1627626170"><span class="hs-identifier">label</span></a></a><span>
</span><a name="line-903"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627626170"><span class="hs-identifier hs-var">label</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">flLabel</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dcFields</span><span> </span><a href="#local-1627626169"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">dcOrigArgTys</span><span> </span><a href="#local-1627626169"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-904"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627626171"><a href="#local-1627626171"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627626171"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-905"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;dataConFieldType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627626169"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627626170"><span class="hs-identifier hs-var">label</span></a><span class="hs-special">)</span><span>
</span><a name="line-906"></a><span>
</span><a name="line-907"></a><span class="hs-comment">-- | Strictness/unpack annotations, from user; or, for imported</span><span>
</span><a name="line-908"></a><span class="hs-comment">-- DataCons, from the interface file</span><span>
</span><a name="line-909"></a><span class="hs-comment">-- The list is in one-to-one correspondence with the arity of the 'DataCon'</span><span>
</span><a name="line-910"></a><span>
</span><a name="line-911"></a><span class="hs-identifier">dataConSrcBangs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a><span class="hs-special">]</span><span>
</span><a name="line-912"></a><a name="dataConSrcBangs"><a href="DataCon.html#dataConSrcBangs"><span class="hs-identifier">dataConSrcBangs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcSrcBangs</span><span>
</span><a name="line-913"></a><span>
</span><a name="line-914"></a><span class="hs-comment">-- | Source-level arity of the data constructor</span><span>
</span><a name="line-915"></a><span class="hs-identifier">dataConSourceArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span>
</span><a name="line-916"></a><a name="dataConSourceArity"><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier">dataConSourceArity</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcSourceArity</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626172"><a href="#local-1627626172"><span class="hs-identifier">arity</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626172"><span class="hs-identifier hs-var">arity</span></a><span>
</span><a name="line-917"></a><span>
</span><a name="line-918"></a><span class="hs-comment">-- | Gives the number of actual fields in the /representation/ of the</span><span>
</span><a name="line-919"></a><span class="hs-comment">-- data constructor. This may be more than appear in the source code;</span><span>
</span><a name="line-920"></a><span class="hs-comment">-- the extra ones are the existentially quantified dictionaries</span><span>
</span><a name="line-921"></a><span class="hs-identifier">dataConRepArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span>
</span><a name="line-922"></a><a name="dataConRepArity"><a href="DataCon.html#dataConRepArity"><span class="hs-identifier">dataConRepArity</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcRepArity</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626173"><a href="#local-1627626173"><span class="hs-identifier">arity</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626173"><span class="hs-identifier hs-var">arity</span></a><span>
</span><a name="line-923"></a><span>
</span><a name="line-924"></a><span>
</span><a name="line-925"></a><span class="hs-comment">-- | The number of fields in the /representation/ of the constructor</span><span>
</span><a name="line-926"></a><span class="hs-comment">-- AFTER taking into account the unpacking of any unboxed tuple fields</span><span>
</span><a name="line-927"></a><span class="hs-identifier">dataConRepRepArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#RepArity"><span class="hs-identifier hs-type">RepArity</span></a><span>
</span><a name="line-928"></a><a name="dataConRepRepArity"><a href="DataCon.html#dataConRepRepArity"><span class="hs-identifier">dataConRepRepArity</span></a></a><span> </span><a name="local-1627626174"><a href="#local-1627626174"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeRepArity"><span class="hs-identifier hs-var">typeRepArity</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConRepArity"><span class="hs-identifier hs-var">dataConRepArity</span></a><span> </span><a href="#local-1627626174"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConRepType"><span class="hs-identifier hs-var">dataConRepType</span></a><span> </span><a href="#local-1627626174"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-929"></a><span>
</span><a name="line-930"></a><span class="hs-comment">-- | Return whether there are any argument types for this 'DataCon's original source type</span><span>
</span><a name="line-931"></a><span class="hs-identifier">isNullarySrcDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-932"></a><a name="isNullarySrcDataCon"><a href="DataCon.html#isNullarySrcDataCon"><span class="hs-identifier">isNullarySrcDataCon</span></a></a><span> </span><a name="local-1627626175"><a href="#local-1627626175"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">dcOrigArgTys</span><span> </span><a href="#local-1627626175"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-933"></a><span>
</span><a name="line-934"></a><span class="hs-comment">-- | Return whether there are any argument types for this 'DataCon's runtime representation type</span><span>
</span><a name="line-935"></a><span class="hs-identifier">isNullaryRepDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-936"></a><a name="isNullaryRepDataCon"><a href="DataCon.html#isNullaryRepDataCon"><span class="hs-identifier">isNullaryRepDataCon</span></a></a><span> </span><a name="local-1627626176"><a href="#local-1627626176"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConRepArity"><span class="hs-identifier hs-var">dataConRepArity</span></a><span> </span><a href="#local-1627626176"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-937"></a><span>
</span><a name="line-938"></a><span class="hs-identifier">dataConRepStrictness</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a><span class="hs-special">]</span><span>
</span><a name="line-939"></a><span class="hs-comment">-- ^ Give the demands on the arguments of a</span><span>
</span><a name="line-940"></a><span class="hs-comment">-- Core constructor application (Con dc args)</span><span>
</span><a name="line-941"></a><a name="dataConRepStrictness"><a href="DataCon.html#dataConRepStrictness"><span class="hs-identifier">dataConRepStrictness</span></a></a><span> </span><a name="local-1627626177"><a href="#local-1627626177"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">dcRep</span><span> </span><a href="#local-1627626177"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-942"></a><span>                            </span><a href="DataCon.html#NoDataConRep"><span class="hs-identifier hs-var">NoDataConRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#NotMarkedStrict"><span class="hs-identifier hs-var">NotMarkedStrict</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a><span> </span><a href="#local-1627626177"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">]</span><span>
</span><a name="line-943"></a><span>                            </span><a href="DataCon.html#DCR"><span class="hs-identifier hs-var">DCR</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcr_stricts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626178"><a href="#local-1627626178"><span class="hs-identifier">strs</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627626178"><span class="hs-identifier hs-var">strs</span></a><span>
</span><a name="line-944"></a><span>
</span><a name="line-945"></a><span class="hs-identifier">dataConImplBangs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a><span class="hs-special">]</span><span>
</span><a name="line-946"></a><span class="hs-comment">-- The implementation decisions about the strictness/unpack of each</span><span>
</span><a name="line-947"></a><span class="hs-comment">-- source program argument to the data constructor</span><span>
</span><a name="line-948"></a><a name="dataConImplBangs"><a href="DataCon.html#dataConImplBangs"><span class="hs-identifier">dataConImplBangs</span></a></a><span> </span><a name="local-1627626179"><a href="#local-1627626179"><span class="hs-identifier">dc</span></a></a><span>
</span><a name="line-949"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">dcRep</span><span> </span><a href="#local-1627626179"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-950"></a><span>      </span><a href="DataCon.html#NoDataConRep"><span class="hs-identifier hs-var">NoDataConRep</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">dcSourceArity</span><span> </span><a href="#local-1627626179"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><a href="DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a><span>
</span><a name="line-951"></a><span>      </span><a href="DataCon.html#DCR"><span class="hs-identifier hs-var">DCR</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcr_bangs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626180"><a href="#local-1627626180"><span class="hs-identifier">bangs</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627626180"><span class="hs-identifier hs-var">bangs</span></a><span>
</span><a name="line-952"></a><span>
</span><a name="line-953"></a><span class="hs-identifier">dataConBoxer</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="MkId.html#DataConBoxer"><span class="hs-identifier hs-type">DataConBoxer</span></a><span>
</span><a name="line-954"></a><a name="dataConBoxer"><a href="DataCon.html#dataConBoxer"><span class="hs-identifier">dataConBoxer</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcRep</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#DCR"><span class="hs-identifier hs-var">DCR</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcr_boxer</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626181"><a href="#local-1627626181"><span class="hs-identifier">boxer</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627626181"><span class="hs-identifier hs-var">boxer</span></a><span>
</span><a name="line-955"></a><span class="hs-identifier">dataConBoxer</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span class="hs-comment">-- | The \&quot;signature\&quot; of the 'DataCon' returns, in order:</span><span>
</span><a name="line-958"></a><span class="hs-comment">--</span><span>
</span><a name="line-959"></a><span class="hs-comment">-- 1) The result of 'dataConAllTyVars',</span><span>
</span><a name="line-960"></a><span class="hs-comment">--</span><span>
</span><a name="line-961"></a><span class="hs-comment">-- 2) All the 'ThetaType's relating to the 'DataCon' (coercion, dictionary, implicit</span><span>
</span><a name="line-962"></a><span class="hs-comment">--    parameter - whatever)</span><span>
</span><a name="line-963"></a><span class="hs-comment">--</span><span>
</span><a name="line-964"></a><span class="hs-comment">-- 3) The type arguments to the constructor</span><span>
</span><a name="line-965"></a><span class="hs-comment">--</span><span>
</span><a name="line-966"></a><span class="hs-comment">-- 4) The /original/ result type of the 'DataCon'</span><span>
</span><a name="line-967"></a><span class="hs-identifier">dataConSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-968"></a><a name="dataConSig"><a href="DataCon.html#dataConSig"><span class="hs-identifier">dataConSig</span></a></a><span> </span><a name="local-1627626182"><a href="#local-1627626182"><span class="hs-identifier">con</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">dcUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626183"><a href="#local-1627626183"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626184"><a href="#local-1627626184"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-969"></a><span>                        </span><span class="hs-identifier">dcOrigArgTys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626185"><a href="#local-1627626185"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOrigResTy</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626186"><a href="#local-1627626186"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-970"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627626183"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627626184"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConTheta"><span class="hs-identifier hs-var">dataConTheta</span></a><span> </span><a href="#local-1627626182"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626185"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626186"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-identifier">dataConInstSig</span><span>
</span><a name="line-973"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-974"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- Instantiate the *universal* tyvars with these types</span><span>
</span><a name="line-975"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Return instantiated existentials</span><span>
</span><a name="line-976"></a><span>                                   </span><span class="hs-comment">-- theta and arg tys</span><span>
</span><a name="line-977"></a><span class="hs-comment">-- ^ Instantantiate the universal tyvars of a data con,</span><span>
</span><a name="line-978"></a><span class="hs-comment">--   returning the instantiated existentials, constraints, and args</span><span>
</span><a name="line-979"></a><a name="dataConInstSig"><a href="DataCon.html#dataConInstSig"><span class="hs-identifier">dataConInstSig</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626187"><a href="#local-1627626187"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626188"><a href="#local-1627626188"><span class="hs-identifier">ex_tvs</span></a></a><span>
</span><a name="line-980"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcEqSpec</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626189"><a href="#local-1627626189"><span class="hs-identifier">eq_spec</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOtherTheta</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626190"><a href="#local-1627626190"><span class="hs-identifier">theta</span></a></a><span>
</span><a name="line-981"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOrigArgTys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626191"><a href="#local-1627626191"><span class="hs-identifier">arg_tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-982"></a><span>               </span><a name="local-1627626192"><a href="#local-1627626192"><span class="hs-identifier">univ_tys</span></a></a><span>
</span><a name="line-983"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627626195"><span class="hs-identifier hs-var">ex_tvs'</span></a><span>
</span><a name="line-984"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTheta"><span class="hs-identifier hs-var">substTheta</span></a><span> </span><a href="#local-1627626194"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#eqSpecPreds"><span class="hs-identifier hs-var">eqSpecPreds</span></a><span> </span><a href="#local-1627626189"><span class="hs-identifier hs-var">eq_spec</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627626190"><span class="hs-identifier hs-var">theta</span></a><span class="hs-special">)</span><span>
</span><a name="line-985"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTys"><span class="hs-identifier hs-var">substTys</span></a><span>   </span><a href="#local-1627626194"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627626191"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-986"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-987"></a><span>    </span><a name="local-1627626193"><a href="#local-1627626193"><span class="hs-identifier">univ_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a><span> </span><a href="#local-1627626187"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="#local-1627626192"><span class="hs-identifier hs-var">univ_tys</span></a><span>
</span><a name="line-988"></a><span>    </span><span class="hs-special">(</span><a name="local-1627626194"><a href="#local-1627626194"><span class="hs-identifier">subst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627626195"><a href="#local-1627626195"><span class="hs-identifier">ex_tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a><span> </span><a href="TyCoRep.html#substTyVarBndr"><span class="hs-identifier hs-var">Type</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">substTyVarBndr</span></a><span> </span><a href="#local-1627626193"><span class="hs-identifier hs-var">univ_subst</span></a><span> </span><a href="#local-1627626188"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-989"></a><span>
</span><a name="line-990"></a><span>
</span><a name="line-991"></a><span class="hs-comment">-- | The \&quot;full signature\&quot; of the 'DataCon' returns, in order:</span><span>
</span><a name="line-992"></a><span class="hs-comment">--</span><span>
</span><a name="line-993"></a><span class="hs-comment">-- 1) The result of 'dataConUnivTyVars'</span><span>
</span><a name="line-994"></a><span class="hs-comment">--</span><span>
</span><a name="line-995"></a><span class="hs-comment">-- 2) The result of 'dataConExTyVars'</span><span>
</span><a name="line-996"></a><span class="hs-comment">--</span><span>
</span><a name="line-997"></a><span class="hs-comment">-- 3) The GADT equalities</span><span>
</span><a name="line-998"></a><span class="hs-comment">--</span><span>
</span><a name="line-999"></a><span class="hs-comment">-- 4) The result of 'dataConDictTheta'</span><span>
</span><a name="line-1000"></a><span class="hs-comment">--</span><span>
</span><a name="line-1001"></a><span class="hs-comment">-- 5) The original argument types to the 'DataCon' (i.e. before</span><span>
</span><a name="line-1002"></a><span class="hs-comment">--    any change of the representation of the type)</span><span>
</span><a name="line-1003"></a><span class="hs-comment">--</span><span>
</span><a name="line-1004"></a><span class="hs-comment">-- 6) The original result type of the 'DataCon'</span><span>
</span><a name="line-1005"></a><span class="hs-identifier">dataConFullSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-1006"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#EqSpec"><span class="hs-identifier hs-type">EqSpec</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1007"></a><a name="dataConFullSig"><a href="DataCon.html#dataConFullSig"><span class="hs-identifier">dataConFullSig</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">dcUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626196"><a href="#local-1627626196"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626197"><a href="#local-1627626197"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1008"></a><span>                        </span><span class="hs-identifier">dcEqSpec</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626198"><a href="#local-1627626198"><span class="hs-identifier">eq_spec</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOtherTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626199"><a href="#local-1627626199"><span class="hs-identifier">theta</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1009"></a><span>                        </span><span class="hs-identifier">dcOrigArgTys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626200"><a href="#local-1627626200"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOrigResTy</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626201"><a href="#local-1627626201"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1010"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627626196"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626197"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626198"><span class="hs-identifier hs-var">eq_spec</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626199"><span class="hs-identifier hs-var">theta</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626200"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626201"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1011"></a><span>
</span><a name="line-1012"></a><span class="hs-identifier">dataConOrigResTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1013"></a><a name="dataConOrigResTy"><a href="DataCon.html#dataConOrigResTy"><span class="hs-identifier">dataConOrigResTy</span></a></a><span> </span><a name="local-1627626202"><a href="#local-1627626202"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcOrigResTy</span><span> </span><a href="#local-1627626202"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1014"></a><span>
</span><a name="line-1015"></a><span class="hs-comment">-- | The \&quot;stupid theta\&quot; of the 'DataCon', such as @data Eq a@ in:</span><span>
</span><a name="line-1016"></a><span class="hs-comment">--</span><span>
</span><a name="line-1017"></a><span class="hs-comment">-- &gt; data Eq a =&gt; T a = ...</span><span>
</span><a name="line-1018"></a><span class="hs-identifier">dataConStupidTheta</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span>
</span><a name="line-1019"></a><a name="dataConStupidTheta"><a href="DataCon.html#dataConStupidTheta"><span class="hs-identifier">dataConStupidTheta</span></a></a><span> </span><a name="local-1627626203"><a href="#local-1627626203"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcStupidTheta</span><span> </span><a href="#local-1627626203"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1020"></a><span>
</span><a name="line-1021"></a><span class="hs-identifier">dataConUserType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1022"></a><span class="hs-comment">-- ^ The user-declared type of the data constructor</span><span>
</span><a name="line-1023"></a><span class="hs-comment">-- in the nice-to-read form:</span><span>
</span><a name="line-1024"></a><span class="hs-comment">--</span><span>
</span><a name="line-1025"></a><span class="hs-comment">-- &gt; T :: forall a b. a -&gt; b -&gt; T [a]</span><span>
</span><a name="line-1026"></a><span class="hs-comment">--</span><span>
</span><a name="line-1027"></a><span class="hs-comment">-- rather than:</span><span>
</span><a name="line-1028"></a><span class="hs-comment">--</span><span>
</span><a name="line-1029"></a><span class="hs-comment">-- &gt; T :: forall a c. forall b. (c~[a]) =&gt; a -&gt; b -&gt; T c</span><span>
</span><a name="line-1030"></a><span class="hs-comment">--</span><span>
</span><a name="line-1031"></a><span class="hs-comment">-- NB: If the constructor is part of a data instance, the result type</span><span>
</span><a name="line-1032"></a><span class="hs-comment">-- mentions the family tycon, not the internal one.</span><span>
</span><a name="line-1033"></a><a name="dataConUserType"><a href="DataCon.html#dataConUserType"><span class="hs-identifier">dataConUserType</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626204"><a href="#local-1627626204"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1034"></a><span>                          </span><span class="hs-identifier">dcExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626205"><a href="#local-1627626205"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcEqSpec</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626206"><a href="#local-1627626206"><span class="hs-identifier">eq_spec</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1035"></a><span>                          </span><span class="hs-identifier">dcOtherTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626207"><a href="#local-1627626207"><span class="hs-identifier">theta</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOrigArgTys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626208"><a href="#local-1627626208"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1036"></a><span>                          </span><span class="hs-identifier">dcOrigResTy</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626209"><a href="#local-1627626209"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1037"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627626204"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#minusList"><span class="hs-identifier hs-var">minusList</span></a><span class="hs-special">`</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="DataCon.html#eqSpecTyVar"><span class="hs-identifier hs-var">eqSpecTyVar</span></a><span> </span><a href="#local-1627626206"><span class="hs-identifier hs-var">eq_spec</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-1038"></a><span>                      </span><a href="#local-1627626205"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1039"></a><span>    </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><a href="#local-1627626207"><span class="hs-identifier hs-var">theta</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1040"></a><span>    </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><a href="#local-1627626208"><span class="hs-identifier hs-var">arg_tys</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1041"></a><span>    </span><a href="#local-1627626209"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-1042"></a><span>
</span><a name="line-1043"></a><span class="hs-comment">-- | Finds the instantiated types of the arguments required to construct a 'DataCon' representation</span><span>
</span><a name="line-1044"></a><span class="hs-comment">-- NB: these INCLUDE any dictionary args</span><span>
</span><a name="line-1045"></a><span class="hs-comment">--     but EXCLUDE the data-declaration context, which is discarded</span><span>
</span><a name="line-1046"></a><span class="hs-comment">-- It's all post-flattening etc; this is a representation type</span><span>
</span><a name="line-1047"></a><span class="hs-identifier">dataConInstArgTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>    </span><span class="hs-comment">-- ^ A datacon with no existentials or equality constraints</span><span>
</span><a name="line-1048"></a><span>                                </span><span class="hs-comment">-- However, it can have a dcTheta (notably it can be a</span><span>
</span><a name="line-1049"></a><span>                                </span><span class="hs-comment">-- class dictionary, with superclasses)</span><span>
</span><a name="line-1050"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ Instantiated at these types</span><span>
</span><a name="line-1051"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1052"></a><a name="dataConInstArgTys"><a href="DataCon.html#dataConInstArgTys"><span class="hs-identifier">dataConInstArgTys</span></a></a><span> </span><a name="local-1627626210"><a href="#local-1627626210"><span class="hs-identifier">dc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">dcUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626211"><a href="#local-1627626211"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1053"></a><span>                              </span><span class="hs-identifier">dcExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626212"><a href="#local-1627626212"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627626213"><a href="#local-1627626213"><span class="hs-identifier">inst_tys</span></a></a><span>
</span><a name="line-1054"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">univ_tvs</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">inst_tys</span><span>
</span><a name="line-1055"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;dataConInstArgTys&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">dc</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">univ_tvs</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">inst_tys</span><span class="hs-special">)</span><span>
</span><a name="line-1056"></a><span>   </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">ex_tvs</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">dc</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1057"></a><span>   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span> </span><a href="#local-1627626211"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="#local-1627626213"><span class="hs-identifier hs-var">inst_tys</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a><span> </span><a href="#local-1627626210"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1058"></a><span>
</span><a name="line-1059"></a><span class="hs-comment">-- | Returns just the instantiated /value/ argument types of a 'DataCon',</span><span>
</span><a name="line-1060"></a><span class="hs-comment">-- (excluding dictionary args)</span><span>
</span><a name="line-1061"></a><span class="hs-identifier">dataConInstOrigArgTys</span><span>
</span><a name="line-1062"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>      </span><span class="hs-comment">-- Works for any DataCon</span><span>
</span><a name="line-1063"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- Includes existential tyvar args, but NOT</span><span>
</span><a name="line-1064"></a><span>                        </span><span class="hs-comment">-- equality constraints or dicts</span><span>
</span><a name="line-1065"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1066"></a><span class="hs-comment">-- For vanilla datacons, it's all quite straightforward</span><span>
</span><a name="line-1067"></a><span class="hs-comment">-- But for the call in MatchCon, we really do want just the value args</span><span>
</span><a name="line-1068"></a><a name="dataConInstOrigArgTys"><a href="DataCon.html#dataConInstOrigArgTys"><span class="hs-identifier">dataConInstOrigArgTys</span></a></a><span> </span><a name="local-1627626214"><a href="#local-1627626214"><span class="hs-identifier">dc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">dcOrigArgTys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626215"><a href="#local-1627626215"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1069"></a><span>                                  </span><span class="hs-identifier">dcUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626216"><a href="#local-1627626216"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1070"></a><span>                                  </span><span class="hs-identifier">dcExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626217"><a href="#local-1627626217"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627626218"><a href="#local-1627626218"><span class="hs-identifier">inst_tys</span></a></a><span>
</span><a name="line-1071"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">tyvars</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">inst_tys</span><span>
</span><a name="line-1072"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;dataConInstOrigArgTys&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">dc</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tyvars</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">inst_tys</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1073"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span> </span><a href="#local-1627626219"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><a href="#local-1627626218"><span class="hs-identifier hs-var">inst_tys</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627626215"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-1074"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1075"></a><span>    </span><a name="local-1627626219"><a href="#local-1627626219"><span class="hs-identifier">tyvars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626216"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627626217"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-1076"></a><span>
</span><a name="line-1077"></a><span class="hs-comment">-- | Returns the argument types of the wrapper, excluding all dictionary arguments</span><span>
</span><a name="line-1078"></a><span class="hs-comment">-- and without substituting for any type variables</span><span>
</span><a name="line-1079"></a><span class="hs-identifier">dataConOrigArgTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1080"></a><a name="dataConOrigArgTys"><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier">dataConOrigArgTys</span></a></a><span> </span><a name="local-1627626220"><a href="#local-1627626220"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcOrigArgTys</span><span> </span><a href="#local-1627626220"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1081"></a><span>
</span><a name="line-1082"></a><span class="hs-comment">-- | Returns the arg types of the worker, including *all*</span><span>
</span><a name="line-1083"></a><span class="hs-comment">-- evidence, after any flattening has been done and without substituting for</span><span>
</span><a name="line-1084"></a><span class="hs-comment">-- any type variables</span><span>
</span><a name="line-1085"></a><span class="hs-identifier">dataConRepArgTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1086"></a><a name="dataConRepArgTys"><a href="DataCon.html#dataConRepArgTys"><span class="hs-identifier">dataConRepArgTys</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcRep</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626221"><a href="#local-1627626221"><span class="hs-identifier">rep</span></a></a><span>
</span><a name="line-1087"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcEqSpec</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626222"><a href="#local-1627626222"><span class="hs-identifier">eq_spec</span></a></a><span>
</span><a name="line-1088"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOtherTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626223"><a href="#local-1627626223"><span class="hs-identifier">theta</span></a></a><span>
</span><a name="line-1089"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dcOrigArgTys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626224"><a href="#local-1627626224"><span class="hs-identifier">orig_arg_tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1090"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627626221"><span class="hs-identifier hs-var">rep</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1091"></a><span>      </span><a href="DataCon.html#NoDataConRep"><span class="hs-identifier hs-var">NoDataConRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">eq_spec</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">theta</span><span> </span><a href="#local-1627626222"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-identifier">orig_arg_tys</span><span>
</span><a name="line-1092"></a><span>      </span><a href="DataCon.html#DCR"><span class="hs-identifier hs-var">DCR</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcr_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626225"><a href="#local-1627626225"><span class="hs-identifier">arg_tys</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627626225"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-1093"></a><span>
</span><a name="line-1094"></a><span class="hs-comment">-- | The string @package:module.name@ identifying a constructor, which is attached</span><span>
</span><a name="line-1095"></a><span class="hs-comment">-- to its info table and used by the GHCi debugger and the heap profiler</span><span>
</span><a name="line-1096"></a><span class="hs-identifier">dataConIdentity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a><span class="hs-special">]</span><span>
</span><a name="line-1097"></a><span class="hs-comment">-- We want this string to be UTF-8, so we get the bytes directly from the FastStrings.</span><span>
</span><a name="line-1098"></a><a name="dataConIdentity"><a href="DataCon.html#dataConIdentity"><span class="hs-identifier">dataConIdentity</span></a></a><span> </span><a name="local-1627626226"><a href="#local-1627626226"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#bytesFS"><span class="hs-identifier hs-var">bytesFS</span></a><span> </span><span class="hs-special">(</span><a href="Module.html#unitIdFS"><span class="hs-identifier hs-var">unitIdFS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-1627626228"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-1099"></a><span>                  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a><span> </span><span class="hs-char">':'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="FastString.html#bytesFS"><span class="hs-identifier hs-var">bytesFS</span></a><span> </span><span class="hs-special">(</span><a href="Module.html#moduleNameFS"><span class="hs-identifier hs-var">moduleNameFS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-1627626228"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-1100"></a><span>                  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a><span> </span><span class="hs-char">'.'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="FastString.html#bytesFS"><span class="hs-identifier hs-var">bytesFS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1627626227"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1101"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-1627626227"><a href="#local-1627626227"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span> </span><a href="#local-1627626226"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1102"></a><span>        </span><a name="local-1627626228"><a href="#local-1627626228"><span class="hs-identifier">mod</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isExternalName</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">nameModule</span><span> </span><span class="hs-identifier">name</span><span>
</span><a name="line-1103"></a><span>
</span><a name="line-1104"></a><span class="hs-identifier">isTupleDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1105"></a><a name="isTupleDataCon"><a href="DataCon.html#isTupleDataCon"><span class="hs-identifier">isTupleDataCon</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">dcRepTyCon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626229"><a href="#local-1627626229"><span class="hs-identifier">tc</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><a href="#local-1627626229"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1106"></a><span>
</span><a name="line-1107"></a><span class="hs-identifier">isUnboxedTupleCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1108"></a><a name="isUnboxedTupleCon"><a href="DataCon.html#isUnboxedTupleCon"><span class="hs-identifier">isUnboxedTupleCon</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">dcRepTyCon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626230"><a href="#local-1627626230"><span class="hs-identifier">tc</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span></a><span> </span><a href="#local-1627626230"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1109"></a><span>
</span><a name="line-1110"></a><span class="hs-comment">-- | Vanilla 'DataCon's are those that are nice boring Haskell 98 constructors</span><span>
</span><a name="line-1111"></a><span class="hs-identifier">isVanillaDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1112"></a><a name="isVanillaDataCon"><a href="DataCon.html#isVanillaDataCon"><span class="hs-identifier">isVanillaDataCon</span></a></a><span> </span><a name="local-1627626231"><a href="#local-1627626231"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dcVanilla</span><span> </span><a href="#local-1627626231"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1113"></a><span>
</span><a name="line-1114"></a><span class="hs-comment">-- | Should this DataCon be allowed in a type even without -XDataKinds?</span><span>
</span><a name="line-1115"></a><span class="hs-comment">-- Currently, only Lifted &amp; Unlifted</span><span>
</span><a name="line-1116"></a><span class="hs-identifier">specialPromotedDc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1117"></a><a name="specialPromotedDc"><a href="DataCon.html#specialPromotedDc"><span class="hs-identifier">specialPromotedDc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isKindTyCon"><span class="hs-identifier hs-var">isKindTyCon</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span>
</span><a name="line-1118"></a><span>
</span><a name="line-1119"></a><span class="hs-comment">-- | Was this datacon promotable before GHC 8.0? That is, is it promotable</span><span>
</span><a name="line-1120"></a><span class="hs-comment">-- without -XTypeInType</span><span>
</span><a name="line-1121"></a><span class="hs-identifier">isLegacyPromotableDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1122"></a><a name="isLegacyPromotableDataCon"><a href="DataCon.html#isLegacyPromotableDataCon"><span class="hs-identifier">isLegacyPromotableDataCon</span></a></a><span> </span><a name="local-1627626232"><a href="#local-1627626232"><span class="hs-identifier">dc</span></a></a><span>
</span><a name="line-1123"></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConEqSpec"><span class="hs-identifier hs-var">dataConEqSpec</span></a><span> </span><a href="#local-1627626232"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- no GADTs</span><span>
</span><a name="line-1124"></a><span>  </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTheta"><span class="hs-identifier hs-var">dataConTheta</span></a><span> </span><a href="#local-1627626232"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- no context</span><span>
</span><a name="line-1125"></a><span>  </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isFamInstTyCon"><span class="hs-identifier hs-var">isFamInstTyCon</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-1627626232"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- no data instance constructors</span><span>
</span><a name="line-1126"></a><span>  </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="DataCon.html#isLegacyPromotableTyCon"><span class="hs-identifier hs-var">isLegacyPromotableTyCon</span></a><span> </span><span class="hs-special">(</span><a href="NameEnv.html#nameEnvElts"><span class="hs-identifier hs-var">nameEnvElts</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1127"></a><span>                                  </span><a href="Type.html#tyConsOfType"><span class="hs-identifier hs-var">tyConsOfType</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConUserType"><span class="hs-identifier hs-var">dataConUserType</span></a><span> </span><a href="#local-1627626232"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1128"></a><span>
</span><a name="line-1129"></a><span class="hs-comment">-- | Was this tycon promotable before GHC 8.0? That is, is it promotable</span><span>
</span><a name="line-1130"></a><span class="hs-comment">-- without -XTypeInType</span><span>
</span><a name="line-1131"></a><span class="hs-identifier">isLegacyPromotableTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1132"></a><a name="isLegacyPromotableTyCon"><a href="DataCon.html#isLegacyPromotableTyCon"><span class="hs-identifier">isLegacyPromotableTyCon</span></a></a><span> </span><a name="local-1627626233"><a href="#local-1627626233"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-1133"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isVanillaAlgTyCon"><span class="hs-identifier hs-var">isVanillaAlgTyCon</span></a><span> </span><a href="#local-1627626233"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-1134"></a><span>      </span><span class="hs-comment">-- This returns True more often than it should, but it's quite painful</span><span>
</span><a name="line-1135"></a><span>      </span><span class="hs-comment">-- to make this fully accurate. And no harm is caused; we just don't</span><span>
</span><a name="line-1136"></a><span>      </span><span class="hs-comment">-- require -XTypeInType every time we need to. (We'll always require</span><span>
</span><a name="line-1137"></a><span>      </span><span class="hs-comment">-- -XDataKinds, though, so there's no standards-compliance issue.)</span><span>
</span><a name="line-1138"></a><span>    </span><a href="TyCon.html#isFunTyCon"><span class="hs-identifier hs-var">isFunTyCon</span></a><span> </span><a href="#local-1627626233"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="TyCon.html#isKindTyCon"><span class="hs-identifier hs-var">isKindTyCon</span></a><span> </span><a href="#local-1627626233"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1139"></a><span>
</span><a name="line-1140"></a><span class="hs-identifier">classDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-1141"></a><a name="classDataCon"><a href="DataCon.html#classDataCon"><span class="hs-identifier">classDataCon</span></a></a><span> </span><a name="local-1627626234"><a href="#local-1627626234"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">classTyCon</span><span> </span><a href="#local-1627626234"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1142"></a><span>                      </span><span class="hs-special">(</span><a name="local-1627626235"><a href="#local-1627626235"><span class="hs-identifier">dict_constr</span></a></a><span class="hs-glyph">:</span><a name="local-1627626236"><a href="#local-1627626236"><span class="hs-identifier">no_more</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">no_more</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">dict_constr</span><span>
</span><a name="line-1143"></a><span>                      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;classDataCon&quot;</span><span>
</span><a name="line-1144"></a><span>
</span><a name="line-1145"></a><span class="hs-identifier">dataConCannotMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1146"></a><span class="hs-comment">-- Returns True iff the data con *definitely cannot* match a</span><span>
</span><a name="line-1147"></a><span class="hs-comment">--                  scrutinee of type (T tys)</span><span>
</span><a name="line-1148"></a><span class="hs-comment">--                  where T is the dcRepTyCon for the data con</span><span>
</span><a name="line-1149"></a><a name="dataConCannotMatch"><a href="DataCon.html#dataConCannotMatch"><span class="hs-identifier">dataConCannotMatch</span></a></a><span> </span><a name="local-1627626237"><a href="#local-1627626237"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-1627626238"><a href="#local-1627626238"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-1150"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1627626239"><span class="hs-identifier hs-var">inst_theta</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-comment">-- Common</span><span>
</span><a name="line-1151"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a><span> </span><a href="#local-1627626237"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-comment">-- Also common</span><span>
</span><a name="line-1152"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Unify.html#typesCantMatch"><span class="hs-identifier hs-var">typesCantMatch</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><a href="#local-1627626240"><span class="hs-identifier hs-var">predEqs</span></a><span> </span><a href="#local-1627626239"><span class="hs-identifier hs-var">inst_theta</span></a><span class="hs-special">)</span><span>
</span><a name="line-1153"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1154"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627626239"><a href="#local-1627626239"><span class="hs-identifier">inst_theta</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConInstSig"><span class="hs-identifier hs-var">dataConInstSig</span></a><span> </span><a href="#local-1627626238"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1627626237"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span>    </span><span class="hs-comment">-- TODO: could gather equalities from superclasses too</span><span>
</span><a name="line-1157"></a><span>    </span><a name="local-1627626240"><a href="#local-1627626240"><span class="hs-identifier">predEqs</span></a></a><span> </span><a name="local-1627626241"><a href="#local-1627626241"><span class="hs-identifier">pred</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a><span> </span><a href="#local-1627626241"><span class="hs-identifier hs-var">pred</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1158"></a><span>                     </span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><a name="local-1627626242"><a href="#local-1627626242"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627626243"><a href="#local-1627626243"><span class="hs-identifier">ty2</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627626242"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626243"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1159"></a><span>                     </span><a href="Type.html#ClassPred"><span class="hs-identifier hs-var">ClassPred</span></a><span> </span><a name="local-1627626244"><a href="#local-1627626244"><span class="hs-identifier">eq</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627626245"><a href="#local-1627626245"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627626246"><a href="#local-1627626246"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1160"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627626244"><span class="hs-identifier hs-var">eq</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqTyConKey"><span class="hs-identifier hs-var">eqTyConKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627626245"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626246"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1161"></a><span>                     </span><span class="hs-identifier">_</span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1162"></a><span>
</span><a name="line-1163"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
        Promoting of data types to the kind level
*                                                                      *
************************************************************************

-}</span><span>
</span><a name="line-1171"></a><span>
</span><a name="line-1172"></a><span class="hs-identifier">promoteDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1173"></a><a name="promoteDataCon"><a href="DataCon.html#promoteDataCon"><span class="hs-identifier">promoteDataCon</span></a></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#MkData"><span class="hs-identifier hs-var">MkData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dcPromoted</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627626247"><a href="#local-1627626247"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627626247"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1174"></a><span>
</span><a name="line-1175"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Splitting products}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1182"></a><span>
</span><a name="line-1183"></a><span class="hs-comment">-- | Extract the type constructor, type argument, data constructor and it's</span><span>
</span><a name="line-1184"></a><span class="hs-comment">-- /representation/ argument types from a type if it is a product type.</span><span>
</span><a name="line-1185"></a><span class="hs-comment">--</span><span>
</span><a name="line-1186"></a><span class="hs-comment">-- Precisely, we return @Just@ for any type that is all of:</span><span>
</span><a name="line-1187"></a><span class="hs-comment">--</span><span>
</span><a name="line-1188"></a><span class="hs-comment">--  * Concrete (i.e. constructors visible)</span><span>
</span><a name="line-1189"></a><span class="hs-comment">--</span><span>
</span><a name="line-1190"></a><span class="hs-comment">--  * Single-constructor</span><span>
</span><a name="line-1191"></a><span class="hs-comment">--</span><span>
</span><a name="line-1192"></a><span class="hs-comment">--  * Not existentially quantified</span><span>
</span><a name="line-1193"></a><span class="hs-comment">--</span><span>
</span><a name="line-1194"></a><span class="hs-comment">-- Whether the type is a @data@ type or a @newtype@</span><span>
</span><a name="line-1195"></a><span class="hs-identifier">splitDataProductType_maybe</span><span>
</span><a name="line-1196"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                         </span><span class="hs-comment">-- ^ A product type, perhaps</span><span>
</span><a name="line-1197"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span>                </span><span class="hs-comment">-- The type constructor</span><span>
</span><a name="line-1198"></a><span>                  </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>               </span><span class="hs-comment">-- Type args of the tycon</span><span>
</span><a name="line-1199"></a><span>                  </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span>              </span><span class="hs-comment">-- The data constructor</span><span>
</span><a name="line-1200"></a><span>                  </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>               </span><span class="hs-comment">-- Its /representation/ arg types</span><span>
</span><a name="line-1201"></a><span>
</span><a name="line-1202"></a><span>        </span><span class="hs-comment">-- Rejecting existentials is conservative.  Maybe some things</span><span>
</span><a name="line-1203"></a><span>        </span><span class="hs-comment">-- could be made to work with them, but I'm not going to sweat</span><span>
</span><a name="line-1204"></a><span>        </span><span class="hs-comment">-- it through till someone finds it's important.</span><span>
</span><a name="line-1205"></a><span>
</span><a name="line-1206"></a><a name="splitDataProductType_maybe"><a href="DataCon.html#splitDataProductType_maybe"><span class="hs-identifier">splitDataProductType_maybe</span></a></a><span> </span><a name="local-1627626248"><a href="#local-1627626248"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1207"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627626249"><a href="#local-1627626249"><span class="hs-identifier">tycon</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627626250"><a href="#local-1627626250"><span class="hs-identifier">ty_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627626248"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1208"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627626251"><a href="#local-1627626251"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#isDataProductTyCon_maybe"><span class="hs-identifier hs-var">isDataProductTyCon_maybe</span></a><span> </span><a href="#local-1627626249"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1209"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627626249"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626250"><span class="hs-identifier hs-var">ty_args</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627626251"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConInstArgTys"><span class="hs-identifier hs-var">dataConInstArgTys</span></a><span> </span><a href="#local-1627626251"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1627626250"><span class="hs-identifier hs-var">ty_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1210"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1211"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1212"></a><span>
</span><a name="line-1213"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
              Building an algebraic data type
*                                                                      *
************************************************************************

buildAlgTyCon is here because it is called from TysWiredIn, which can
depend on this module, but not on BuildTyCl.
-}</span><span>
</span><a name="line-1223"></a><span>
</span><a name="line-1224"></a><span class="hs-identifier">buildAlgTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1225"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>               </span><span class="hs-comment">-- ^ Kind variables and type variables</span><span>
</span><a name="line-1226"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span>
</span><a name="line-1227"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="ForeignCall.html#CType"><span class="hs-identifier hs-type">CType</span></a><span>
</span><a name="line-1228"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span>             </span><span class="hs-comment">-- ^ Stupid theta</span><span>
</span><a name="line-1229"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span>
</span><a name="line-1230"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a><span>
</span><a name="line-1231"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                  </span><span class="hs-comment">-- ^ True &lt;=&gt; was declared in GADT syntax</span><span>
</span><a name="line-1232"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span>
</span><a name="line-1233"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1234"></a><span>
</span><a name="line-1235"></a><a name="buildAlgTyCon"><a href="DataCon.html#buildAlgTyCon"><span class="hs-identifier">buildAlgTyCon</span></a></a><span> </span><a name="local-1627626252"><a href="#local-1627626252"><span class="hs-identifier">tc_name</span></a></a><span> </span><a name="local-1627626253"><a href="#local-1627626253"><span class="hs-identifier">ktvs</span></a></a><span> </span><a name="local-1627626254"><a href="#local-1627626254"><span class="hs-identifier">roles</span></a></a><span> </span><a name="local-1627626255"><a href="#local-1627626255"><span class="hs-identifier">cType</span></a></a><span> </span><a name="local-1627626256"><a href="#local-1627626256"><span class="hs-identifier">stupid_theta</span></a></a><span> </span><a name="local-1627626257"><a href="#local-1627626257"><span class="hs-identifier">rhs</span></a></a><span>
</span><a name="line-1236"></a><span>              </span><a name="local-1627626258"><a href="#local-1627626258"><span class="hs-identifier">is_rec</span></a></a><span> </span><a name="local-1627626259"><a href="#local-1627626259"><span class="hs-identifier">gadt_syn</span></a></a><span> </span><a name="local-1627626260"><a href="#local-1627626260"><span class="hs-identifier">parent</span></a></a><span>
</span><a name="line-1237"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkAlgTyCon"><span class="hs-identifier hs-var">mkAlgTyCon</span></a><span> </span><a href="#local-1627626252"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><a href="#local-1627626261"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span> </span><a href="#local-1627626253"><span class="hs-identifier hs-var">ktvs</span></a><span> </span><a href="#local-1627626254"><span class="hs-identifier hs-var">roles</span></a><span> </span><a href="#local-1627626255"><span class="hs-identifier hs-var">cType</span></a><span> </span><a href="#local-1627626256"><span class="hs-identifier hs-var">stupid_theta</span></a><span>
</span><a name="line-1238"></a><span>               </span><a href="#local-1627626257"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-1627626260"><span class="hs-identifier hs-var">parent</span></a><span> </span><a href="#local-1627626258"><span class="hs-identifier hs-var">is_rec</span></a><span> </span><a href="#local-1627626259"><span class="hs-identifier hs-var">gadt_syn</span></a><span>
</span><a name="line-1239"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1240"></a><span>    </span><a name="local-1627626261"><a href="#local-1627626261"><span class="hs-identifier">binders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyBindersPreferAnon"><span class="hs-identifier hs-var">mkTyBindersPreferAnon</span></a><span> </span><a href="#local-1627626253"><span class="hs-identifier hs-var">ktvs</span></a><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span>
</span><a name="line-1241"></a></pre></body></html>