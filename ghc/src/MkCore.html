<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-- | Handy functions for creating much Core syntax</span><span>
</span><a name="line-4"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MkCore</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-5"></a><span>        </span><span class="hs-comment">-- * Constructing normal syntax</span><span>
</span><a name="line-6"></a><span>        </span><a href="MkCore.html#mkCoreLet"><span class="hs-identifier hs-var">mkCoreLet</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkCoreLets"><span class="hs-identifier hs-var">mkCoreLets</span></a><span class="hs-special">,</span><span>
</span><a name="line-7"></a><span>        </span><a href="MkCore.html#mkCoreApp"><span class="hs-identifier hs-var">mkCoreApp</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkCoreApps"><span class="hs-identifier hs-var">mkCoreApps</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span class="hs-special">,</span><span>
</span><a name="line-8"></a><span>        </span><a href="MkCore.html#mkCoreLams"><span class="hs-identifier hs-var">mkCoreLams</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkWildCase"><span class="hs-identifier hs-var">mkWildCase</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkIfThenElse"><span class="hs-identifier hs-var">mkIfThenElse</span></a><span class="hs-special">,</span><span>
</span><a name="line-9"></a><span>        </span><a href="MkCore.html#mkWildValBinder"><span class="hs-identifier hs-var">mkWildValBinder</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkWildEvBinder"><span class="hs-identifier hs-var">mkWildEvBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-10"></a><span>        </span><a href="MkCore.html#sortQuantVars"><span class="hs-identifier hs-var">sortQuantVars</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#castBottomExpr"><span class="hs-identifier hs-var">castBottomExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span>        </span><span class="hs-comment">-- * Constructing boxed literals</span><span>
</span><a name="line-13"></a><span>        </span><a href="MkCore.html#mkWordExpr"><span class="hs-identifier hs-var">mkWordExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkWordExprWord"><span class="hs-identifier hs-var">mkWordExprWord</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>        </span><a href="MkCore.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkIntExprInt"><span class="hs-identifier hs-var">mkIntExprInt</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>        </span><a href="MkCore.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="MkCore.html#mkFloatExpr"><span class="hs-identifier hs-var">mkFloatExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkDoubleExpr"><span class="hs-identifier hs-var">mkDoubleExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="MkCore.html#mkCharExpr"><span class="hs-identifier hs-var">mkCharExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkStringExpr"><span class="hs-identifier hs-var">mkStringExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkStringExprFS"><span class="hs-identifier hs-var">mkStringExprFS</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span>        </span><span class="hs-comment">-- * Floats</span><span>
</span><a name="line-20"></a><span>        </span><a href="MkCore.html#FloatBind"><span class="hs-identifier hs-type">FloatBind</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="MkCore.html#wrapFloat"><span class="hs-identifier hs-var">wrapFloat</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span>        </span><span class="hs-comment">-- * Constructing small tuples</span><span>
</span><a name="line-23"></a><span>        </span><a href="MkCore.html#mkCoreVarTup"><span class="hs-identifier hs-var">mkCoreVarTup</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkCoreVarTupTy"><span class="hs-identifier hs-var">mkCoreVarTupTy</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkCoreTup"><span class="hs-identifier hs-var">mkCoreTup</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkCoreUbxTup"><span class="hs-identifier hs-var">mkCoreUbxTup</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>        </span><a href="MkCore.html#mkCoreTupBoxity"><span class="hs-identifier hs-var">mkCoreTupBoxity</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span>        </span><span class="hs-comment">-- * Constructing big tuples</span><span>
</span><a name="line-27"></a><span>        </span><a href="MkCore.html#mkBigCoreVarTup"><span class="hs-identifier hs-var">mkBigCoreVarTup</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkBigCoreVarTup1"><span class="hs-identifier hs-var">mkBigCoreVarTup1</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="MkCore.html#mkBigCoreVarTupTy"><span class="hs-identifier hs-var">mkBigCoreVarTupTy</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkBigCoreTupTy"><span class="hs-identifier hs-var">mkBigCoreTupTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>        </span><a href="MkCore.html#mkBigCoreTup"><span class="hs-identifier hs-var">mkBigCoreTup</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>        </span><span class="hs-comment">-- * Deconstructing small tuples</span><span>
</span><a name="line-32"></a><span>        </span><a href="MkCore.html#mkSmallTupleSelector"><span class="hs-identifier hs-var">mkSmallTupleSelector</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkSmallTupleCase"><span class="hs-identifier hs-var">mkSmallTupleCase</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span>        </span><span class="hs-comment">-- * Deconstructing big tuples</span><span>
</span><a name="line-35"></a><span>        </span><a href="MkCore.html#mkTupleSelector"><span class="hs-identifier hs-var">mkTupleSelector</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkTupleSelector1"><span class="hs-identifier hs-var">mkTupleSelector1</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkTupleCase"><span class="hs-identifier hs-var">mkTupleCase</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span>        </span><span class="hs-comment">-- * Constructing list expressions</span><span>
</span><a name="line-38"></a><span>        </span><a href="MkCore.html#mkNilExpr"><span class="hs-identifier hs-var">mkNilExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkConsExpr"><span class="hs-identifier hs-var">mkConsExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkListExpr"><span class="hs-identifier hs-var">mkListExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>        </span><a href="MkCore.html#mkFoldrExpr"><span class="hs-identifier hs-var">mkFoldrExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkBuildExpr"><span class="hs-identifier hs-var">mkBuildExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span>        </span><span class="hs-comment">-- * Constructing Maybe expressions</span><span>
</span><a name="line-42"></a><span>        </span><a href="MkCore.html#mkNothingExpr"><span class="hs-identifier hs-var">mkNothingExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkJustExpr"><span class="hs-identifier hs-var">mkJustExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span>        </span><span class="hs-comment">-- * Error Ids</span><span>
</span><a name="line-45"></a><span>        </span><a href="MkCore.html#mkRuntimeErrorApp"><span class="hs-identifier hs-var">mkRuntimeErrorApp</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#mkImpossibleExpr"><span class="hs-identifier hs-var">mkImpossibleExpr</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#errorIds"><span class="hs-identifier hs-var">errorIds</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>        </span><a href="MkCore.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-var">rEC_CON_ERROR_ID</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#iRREFUT_PAT_ERROR_ID"><span class="hs-identifier hs-var">iRREFUT_PAT_ERROR_ID</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#rUNTIME_ERROR_ID"><span class="hs-identifier hs-var">rUNTIME_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>        </span><a href="MkCore.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier hs-var">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier hs-var">nO_METHOD_BINDING_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>        </span><a href="MkCore.html#pAT_ERROR_ID"><span class="hs-identifier hs-var">pAT_ERROR_ID</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#rEC_SEL_ERROR_ID"><span class="hs-identifier hs-var">rEC_SEL_ERROR_ID</span></a><span class="hs-special">,</span><span> </span><a href="MkCore.html#aBSENT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>        </span><a href="MkCore.html#tYPE_ERROR_ID"><span class="hs-identifier hs-var">tYPE_ERROR_ID</span></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>      </span><span class="hs-special">(</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#setTyVarUnique"><span class="hs-identifier hs-var">setTyVarUnique</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="CoreSyn.html"><span class="hs-identifier">CoreSyn</span></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="CoreUtils.html"><span class="hs-identifier">CoreUtils</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span class="hs-special">,</span><span> </span><a href="CoreUtils.html#needsCaseBinding"><span class="hs-identifier hs-var">needsCaseBinding</span></a><span class="hs-special">,</span><span> </span><a href="CoreUtils.html#bindNonRec"><span class="hs-identifier hs-var">bindNonRec</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="Literal.html"><span class="hs-identifier">Literal</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="HscTypes.html"><span class="hs-identifier">HscTypes</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="HsUtils.html"><span class="hs-identifier">HsUtils</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>           </span><span class="hs-special">(</span><span> </span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>         </span><span class="hs-special">(</span><span> </span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConWorkId"><span class="hs-identifier hs-var">dataConWorkId</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="IdInfo.html"><span class="hs-identifier">IdInfo</span></a><span>           </span><span class="hs-special">(</span><span> </span><a href="IdInfo.html#vanillaIdInfo"><span class="hs-identifier hs-var">vanillaIdInfo</span></a><span class="hs-special">,</span><span> </span><a href="IdInfo.html#setStrictnessInfo"><span class="hs-identifier hs-var">setStrictnessInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>                          </span><a href="IdInfo.html#setArityInfo"><span class="hs-identifier hs-var">setArityInfo</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="Demand.html"><span class="hs-identifier">Demand</span></a><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>      </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSupply.html"><span class="hs-identifier">UniqSupply</span></a><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Char.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mkCoreApp</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mkCoreApps</span><span class="hs-special">`</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Basic CoreSyn construction}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-94"></a><span class="hs-identifier">sortQuantVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- Sort the variables, putting type and covars first, in scoped order,</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- and then other Ids</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- It is a deterministic sort, meaining it doesn't look at the values of</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- Uniques. For explanation why it's important See Note [Unique Determinism]</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- in Unique.</span><span>
</span><a name="line-100"></a><a name="sortQuantVars"><a href="MkCore.html#sortQuantVars"><span class="hs-identifier">sortQuantVars</span></a></a><span> </span><a name="local-1627942105"><a href="#local-1627942105"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627942108"><span class="hs-identifier hs-var">sorted_tcvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627942107"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-101"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">(</span><a name="local-1627942106"><a href="#local-1627942106"><span class="hs-identifier">tcvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942107"><a href="#local-1627942107"><span class="hs-identifier">ids</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="Util.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">&lt;||&gt;</span></a><span> </span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942105"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-103"></a><span>    </span><a name="local-1627942108"><a href="#local-1627942108"><span class="hs-identifier">sorted_tcvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#toposortTyVars"><span class="hs-identifier hs-var">toposortTyVars</span></a><span> </span><a href="#local-1627942106"><span class="hs-identifier hs-var">tcvs</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- | Bind a binding group over an expression, using a @let@ or @case@ as</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- appropriate (see &quot;CoreSyn#let_app_invariant&quot;)</span><span>
</span><a name="line-107"></a><span class="hs-identifier">mkCoreLet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-108"></a><a name="mkCoreLet"><a href="MkCore.html#mkCoreLet"><span class="hs-identifier">mkCoreLet</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-1627942109"><a href="#local-1627942109"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627942110"><a href="#local-1627942110"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627942111"><a href="#local-1627942111"><span class="hs-identifier">body</span></a></a><span>        </span><span class="hs-comment">-- See Note [CoreSyn let/app invariant]</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="CoreUtils.html#needsCaseBinding"><span class="hs-identifier hs-var">needsCaseBinding</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1627942109"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942110"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-110"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-1627942110"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-1627942109"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-special">(</span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span> </span><a href="#local-1627942111"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-1627942111"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-111"></a><span class="hs-identifier">mkCoreLet</span><span> </span><a name="local-1627942112"><a href="#local-1627942112"><span class="hs-identifier">bind</span></a></a><span> </span><a name="local-1627942113"><a href="#local-1627942113"><span class="hs-identifier">body</span></a></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><a href="#local-1627942112"><span class="hs-identifier hs-var">bind</span></a><span> </span><a href="#local-1627942113"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | Bind a list of binding groups over an expression. The leftmost binding</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- group becomes the outermost group in the resulting expression</span><span>
</span><a name="line-116"></a><span class="hs-identifier">mkCoreLets</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-117"></a><a name="mkCoreLets"><a href="MkCore.html#mkCoreLets"><span class="hs-identifier">mkCoreLets</span></a></a><span> </span><a name="local-1627942114"><a href="#local-1627942114"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-1627942115"><a href="#local-1627942115"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="MkCore.html#mkCoreLet"><span class="hs-identifier hs-var">mkCoreLet</span></a><span> </span><a href="#local-1627942115"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1627942114"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- | Construct an expression which represents the application of one expression</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- to the other</span><span>
</span><a name="line-121"></a><span class="hs-identifier">mkCoreApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- Respects the let/app invariant by building a case expression where necessary</span><span>
</span><a name="line-123"></a><span class="hs-comment">--   See CoreSyn Note [CoreSyn let/app invariant]</span><span>
</span><a name="line-124"></a><a name="mkCoreApp"><a href="MkCore.html#mkCoreApp"><span class="hs-identifier">mkCoreApp</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627942116"><a href="#local-1627942116"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-1627942117"><a href="#local-1627942117"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-1627942116"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942117"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span class="hs-identifier">mkCoreApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627942118"><a href="#local-1627942118"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a name="local-1627942119"><a href="#local-1627942119"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-1627942118"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a href="#local-1627942119"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span class="hs-identifier">mkCoreApp</span><span> </span><a name="local-1627942120"><a href="#local-1627942120"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-1627942121"><a href="#local-1627942121"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-1627942122"><a href="#local-1627942122"><span class="hs-identifier">arg</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isFunTy</span><span> </span><span class="hs-identifier">fun_ty</span><span class="hs-special">,</span><span> </span><a href="Type.html#isFunTy"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">fun</span><span> </span><a href="#local-1627942123"><span class="hs-operator hs-var">$$</span></a><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">arg</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>                                </span><a href="MkCore.html#mk_val_app"><span class="hs-identifier hs-var">mk_val_app</span></a><span> </span><a href="#local-1627942121"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-1627942122"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-1627942124"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="#local-1627942125"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-128"></a><span>                              </span><span class="hs-keyword">where</span><span>
</span><a name="line-129"></a><span>                                </span><a name="local-1627942123"><a href="#local-1627942123"><span class="hs-identifier">fun_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span> </span><a href="#local-1627942121"><span class="hs-identifier hs-var">fun</span></a><span>
</span><a name="line-130"></a><span>                                </span><span class="hs-special">(</span><a name="local-1627942124"><a href="#local-1627942124"><span class="hs-identifier">arg_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942125"><a href="#local-1627942125"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitFunTy"><span class="hs-identifier hs-var">splitFunTy</span></a><span> </span><a href="#local-1627942123"><span class="hs-identifier hs-var">fun_ty</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | Construct an expression which represents the application of a number of</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- expressions to another. The leftmost expression in the list is applied first</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- Respects the let/app invariant by building a case expression where necessary</span><span>
</span><a name="line-135"></a><span class="hs-comment">--   See CoreSyn Note [CoreSyn let/app invariant]</span><span>
</span><a name="line-136"></a><span class="hs-identifier">mkCoreApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-137"></a><span class="hs-comment">-- Slightly more efficient version of (foldl mkCoreApp)</span><span>
</span><a name="line-138"></a><a name="mkCoreApps"><a href="MkCore.html#mkCoreApps"><span class="hs-identifier">mkCoreApps</span></a></a><span> </span><a name="local-1627942126"><a href="#local-1627942126"><span class="hs-identifier">orig_fun</span></a></a><span> </span><a name="local-1627942127"><a href="#local-1627942127"><span class="hs-identifier">orig_args</span></a></a><span>
</span><a name="line-139"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627942128"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627942126"><span class="hs-identifier hs-var">orig_fun</span></a><span> </span><span class="hs-special">(</span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span> </span><a href="#local-1627942126"><span class="hs-identifier hs-var">orig_fun</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942127"><span class="hs-identifier hs-var">orig_args</span></a><span>
</span><a name="line-140"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>    </span><a name="local-1627942128"><a href="#local-1627942128"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627942129"><a href="#local-1627942129"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627942129"><span class="hs-identifier hs-var">fun</span></a><span>
</span><a name="line-142"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627942130"><a href="#local-1627942130"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-1627942131"><a href="#local-1627942131"><span class="hs-identifier">fun_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-1627942132"><a href="#local-1627942132"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1627942133"><a href="#local-1627942133"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627942128"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-1627942130"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942132"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Type.html#piResultTy"><span class="hs-identifier hs-var">piResultTy</span></a><span> </span><a href="#local-1627942131"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><a href="#local-1627942132"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942133"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627942134"><a href="#local-1627942134"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-1627942135"><a href="#local-1627942135"><span class="hs-identifier">fun_ty</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627942136"><a href="#local-1627942136"><span class="hs-identifier">arg</span></a></a><span>     </span><span class="hs-glyph">:</span><span> </span><a name="local-1627942137"><a href="#local-1627942137"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><a href="#local-1627942127"><span class="hs-identifier hs-var">isFunTy</span></a><span> </span><span class="hs-identifier">fun_ty</span><span class="hs-special">,</span><span> </span><a href="Type.html#isFunTy"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">fun_ty</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">orig_fun</span><span>
</span><a name="line-144"></a><span>                                                              </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">orig_args</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>                                     </span><a href="#local-1627942128"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="MkCore.html#mk_val_app"><span class="hs-identifier hs-var">mk_val_app</span></a><span> </span><a href="#local-1627942134"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-1627942136"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-1627942138"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="#local-1627942139"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942139"><span class="hs-identifier hs-var">res_ty</span></a><span> </span><a href="#local-1627942137"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-146"></a><span>                                   </span><span class="hs-keyword">where</span><span>
</span><a name="line-147"></a><span>                                     </span><span class="hs-special">(</span><a name="local-1627942138"><a href="#local-1627942138"><span class="hs-identifier">arg_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942139"><a href="#local-1627942139"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitFunTy"><span class="hs-identifier hs-var">splitFunTy</span></a><span> </span><a href="#local-1627942135"><span class="hs-identifier hs-var">fun_ty</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- | Construct an expression which represents the application of a number of</span><span>
</span><a name="line-150"></a><span class="hs-comment">-- expressions to that of a data constructor expression. The leftmost expression</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- in the list is applied first</span><span>
</span><a name="line-152"></a><span class="hs-identifier">mkCoreConApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-153"></a><a name="mkCoreConApps"><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier">mkCoreConApps</span></a></a><span> </span><a name="local-1627942140"><a href="#local-1627942140"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1627942141"><a href="#local-1627942141"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreApps"><span class="hs-identifier hs-var">mkCoreApps</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConWorkId"><span class="hs-identifier hs-var">dataConWorkId</span></a><span> </span><a href="#local-1627942140"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627942141"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-identifier">mk_val_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- Build an application (e1 e2),</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- or a strict binding  (case e2 of x -&gt; e1 x)</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- using the latter when necessary to respect the let/app invariant</span><span>
</span><a name="line-159"></a><span class="hs-comment">--   See Note [CoreSyn let/app invariant]</span><span>
</span><a name="line-160"></a><a name="mk_val_app"><a href="MkCore.html#mk_val_app"><span class="hs-identifier">mk_val_app</span></a></a><span> </span><a name="local-1627942142"><a href="#local-1627942142"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-1627942143"><a href="#local-1627942143"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-1627942144"><a href="#local-1627942144"><span class="hs-identifier">arg_ty</span></a></a><span> </span><a name="local-1627942145"><a href="#local-1627942145"><span class="hs-identifier">res_ty</span></a></a><span>
</span><a name="line-161"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="CoreUtils.html#needsCaseBinding"><span class="hs-identifier hs-var">needsCaseBinding</span></a><span> </span><a href="#local-1627942144"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="#local-1627942143"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-1627942142"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-1627942143"><span class="hs-identifier hs-var">arg</span></a><span>                </span><span class="hs-comment">-- The vastly common case</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-165"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-1627942143"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-1627942146"><span class="hs-identifier hs-var">arg_id</span></a><span> </span><a href="#local-1627942145"><span class="hs-identifier hs-var">res_ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-1627942142"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942146"><span class="hs-identifier hs-var">arg_id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-167"></a><span>    </span><a name="local-1627942146"><a href="#local-1627942146"><span class="hs-identifier">arg_id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkWildValBinder"><span class="hs-identifier hs-var">mkWildValBinder</span></a><span> </span><a href="#local-1627942144"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-168"></a><span>        </span><span class="hs-comment">-- Lots of shadowing, but it doesn't matter,</span><span>
</span><a name="line-169"></a><span>        </span><span class="hs-comment">-- because 'fun ' should not have a free wild-id</span><span>
</span><a name="line-170"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-171"></a><span>        </span><span class="hs-comment">-- This is Dangerous.  But this is the only place we play this</span><span>
</span><a name="line-172"></a><span>        </span><span class="hs-comment">-- game, mk_val_app returns an expression that does not have</span><span>
</span><a name="line-173"></a><span>        </span><span class="hs-comment">-- have a free wild-id.  So the only thing that can go wrong</span><span>
</span><a name="line-174"></a><span>        </span><span class="hs-comment">-- is if you take apart this case expression, and pass a</span><span>
</span><a name="line-175"></a><span>        </span><span class="hs-comment">-- fragmet of it as the fun part of a 'mk_val_app'.</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-----------</span><span>
</span><a name="line-178"></a><span class="hs-identifier">mkWildEvBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>
</span><a name="line-179"></a><a name="mkWildEvBinder"><a href="MkCore.html#mkWildEvBinder"><span class="hs-identifier">mkWildEvBinder</span></a></a><span> </span><a name="local-1627942147"><a href="#local-1627942147"><span class="hs-identifier">pred</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkWildValBinder"><span class="hs-identifier hs-var">mkWildValBinder</span></a><span> </span><a href="#local-1627942147"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- | Make a /wildcard binder/. This is typically used when you need a binder</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- that you expect to use only at a *binding* site.  Do not use it at</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- occurrence sites because it has a single, fixed unique, and it's very</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- easy to get into difficulties with shadowing.  That's why it is used so little.</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- See Note [WildCard binders] in SimplEnv</span><span>
</span><a name="line-186"></a><span class="hs-identifier">mkWildValBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-187"></a><a name="mkWildValBinder"><a href="MkCore.html#mkWildValBinder"><span class="hs-identifier">mkWildValBinder</span></a></a><span> </span><a name="local-1627942148"><a href="#local-1627942148"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkLocalIdOrCoVar"><span class="hs-identifier hs-var">mkLocalIdOrCoVar</span></a><span> </span><a href="PrelNames.html#wildCardName"><span class="hs-identifier hs-var">wildCardName</span></a><span> </span><a href="#local-1627942148"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-identifier">mkWildCase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-190"></a><span class="hs-comment">-- Make a case expression whose case binder is unused</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- The alts should not have any occurrences of WildId</span><span>
</span><a name="line-192"></a><a name="mkWildCase"><a href="MkCore.html#mkWildCase"><span class="hs-identifier">mkWildCase</span></a></a><span> </span><a name="local-1627942149"><a href="#local-1627942149"><span class="hs-identifier">scrut</span></a></a><span> </span><a name="local-1627942150"><a href="#local-1627942150"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><a name="local-1627942151"><a href="#local-1627942151"><span class="hs-identifier">res_ty</span></a></a><span> </span><a name="local-1627942152"><a href="#local-1627942152"><span class="hs-identifier">alts</span></a></a><span>
</span><a name="line-193"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-1627942149"><span class="hs-identifier hs-var">scrut</span></a><span> </span><span class="hs-special">(</span><a href="MkCore.html#mkWildValBinder"><span class="hs-identifier hs-var">mkWildValBinder</span></a><span> </span><a href="#local-1627942150"><span class="hs-identifier hs-var">scrut_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942151"><span class="hs-identifier hs-var">res_ty</span></a><span> </span><a href="#local-1627942152"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-identifier">mkIfThenElse</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-196"></a><a name="mkIfThenElse"><a href="MkCore.html#mkIfThenElse"><span class="hs-identifier">mkIfThenElse</span></a></a><span> </span><a name="local-1627942153"><a href="#local-1627942153"><span class="hs-identifier">guard</span></a></a><span> </span><a name="local-1627942154"><a href="#local-1627942154"><span class="hs-identifier">then_expr</span></a></a><span> </span><a name="local-1627942155"><a href="#local-1627942155"><span class="hs-identifier">else_expr</span></a></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- Not going to be refining, so okay to take the type of the &quot;then&quot; clause</span><span>
</span><a name="line-198"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkWildCase"><span class="hs-identifier hs-var">mkWildCase</span></a><span> </span><a href="#local-1627942153"><span class="hs-identifier hs-var">guard</span></a><span> </span><a href="TysWiredIn.html#boolTy"><span class="hs-identifier hs-var">boolTy</span></a><span> </span><span class="hs-special">(</span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span> </span><a href="#local-1627942154"><span class="hs-identifier hs-var">then_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>         </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><a href="TysWiredIn.html#falseDataCon"><span class="hs-identifier hs-var">falseDataCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1627942155"><span class="hs-identifier hs-var">else_expr</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Increasing order of tag!</span><span>
</span><a name="line-200"></a><span>           </span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><a href="TysWiredIn.html#trueDataCon"><span class="hs-identifier hs-var">trueDataCon</span></a><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1627942154"><span class="hs-identifier hs-var">then_expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-identifier">castBottomExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- (castBottomExpr e ty), assuming that 'e' diverges,</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- return an expression of type 'ty'</span><span>
</span><a name="line-205"></a><span class="hs-comment">-- See Note [Empty case alternatives] in CoreSyn</span><span>
</span><a name="line-206"></a><a name="castBottomExpr"><a href="MkCore.html#castBottomExpr"><span class="hs-identifier">castBottomExpr</span></a></a><span> </span><a name="local-1627942156"><a href="#local-1627942156"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627942157"><a href="#local-1627942157"><span class="hs-identifier">res_ty</span></a></a><span>
</span><a name="line-207"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627942158"><span class="hs-identifier hs-var">e_ty</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627942157"><span class="hs-identifier hs-var">res_ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627942156"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-208"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-1627942156"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><a href="MkCore.html#mkWildValBinder"><span class="hs-identifier hs-var">mkWildValBinder</span></a><span> </span><a href="#local-1627942158"><span class="hs-identifier hs-var">e_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942157"><span class="hs-identifier hs-var">res_ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-209"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-210"></a><span>    </span><a name="local-1627942158"><a href="#local-1627942158"><span class="hs-identifier">e_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span> </span><a href="#local-1627942156"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">{-
The functions from this point don't really do anything cleverer than
their counterparts in CoreSyn, but they are here for consistency
-}</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- | Create a lambda where the given expression has a number of variables</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- bound over it. The leftmost binder is that bound by the outermost</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- lambda in the result</span><span>
</span><a name="line-220"></a><span class="hs-identifier">mkCoreLams</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-221"></a><a name="mkCoreLams"><a href="MkCore.html#mkCoreLams"><span class="hs-identifier">mkCoreLams</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Making literals}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Int@</span><span>
</span><a name="line-232"></a><span class="hs-identifier">mkIntExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>        </span><span class="hs-comment">-- Result = I# i :: Int</span><span>
</span><a name="line-233"></a><a name="mkIntExpr"><a href="MkCore.html#mkIntExpr"><span class="hs-identifier">mkIntExpr</span></a></a><span> </span><a name="local-1627942159"><a href="#local-1627942159"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1627942160"><a href="#local-1627942160"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon"><span class="hs-identifier hs-var">intDataCon</span></a><span>  </span><span class="hs-special">[</span><a href="CoreSyn.html#mkIntLit"><span class="hs-identifier hs-var">mkIntLit</span></a><span> </span><a href="#local-1627942159"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1627942160"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Int@</span><span>
</span><a name="line-236"></a><span class="hs-identifier">mkIntExprInt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>         </span><span class="hs-comment">-- Result = I# i :: Int</span><span>
</span><a name="line-237"></a><a name="mkIntExprInt"><a href="MkCore.html#mkIntExprInt"><span class="hs-identifier">mkIntExprInt</span></a></a><span> </span><a name="local-1627942161"><a href="#local-1627942161"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1627942162"><a href="#local-1627942162"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon"><span class="hs-identifier hs-var">intDataCon</span></a><span>  </span><span class="hs-special">[</span><a href="CoreSyn.html#mkIntLitInt"><span class="hs-identifier hs-var">mkIntLitInt</span></a><span> </span><a href="#local-1627942161"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1627942162"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the a @Word@ with the given value</span><span>
</span><a name="line-240"></a><span class="hs-identifier">mkWordExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-241"></a><a name="mkWordExpr"><a href="MkCore.html#mkWordExpr"><span class="hs-identifier">mkWordExpr</span></a></a><span> </span><a name="local-1627942163"><a href="#local-1627942163"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1627942164"><a href="#local-1627942164"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#wordDataCon"><span class="hs-identifier hs-var">wordDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#mkWordLit"><span class="hs-identifier hs-var">mkWordLit</span></a><span> </span><a href="#local-1627942163"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1627942164"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Word@</span><span>
</span><a name="line-244"></a><span class="hs-identifier">mkWordExprWord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-245"></a><a name="mkWordExprWord"><a href="MkCore.html#mkWordExprWord"><span class="hs-identifier">mkWordExprWord</span></a></a><span> </span><a name="local-1627942165"><a href="#local-1627942165"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1627942166"><a href="#local-1627942166"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#wordDataCon"><span class="hs-identifier hs-var">wordDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#mkWordLitWord"><span class="hs-identifier hs-var">mkWordLitWord</span></a><span> </span><a href="#local-1627942165"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1627942166"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Integer@</span><span>
</span><a name="line-248"></a><span class="hs-identifier">mkIntegerExpr</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a><span> </span><a href="#local-1627942104"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627942104"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>  </span><span class="hs-comment">-- Result :: Integer</span><span>
</span><a name="line-249"></a><a name="mkIntegerExpr"><a href="MkCore.html#mkIntegerExpr"><span class="hs-identifier">mkIntegerExpr</span></a></a><span> </span><a name="local-1627942167"><a href="#local-1627942167"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1627942168"><a href="#local-1627942168"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HscTypes.html#lookupTyCon"><span class="hs-identifier hs-var">lookupTyCon</span></a><span> </span><a href="PrelNames.html#integerTyConName"><span class="hs-identifier hs-var">integerTyConName</span></a><span>
</span><a name="line-250"></a><span>                     </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Lit"><span class="hs-identifier hs-var">Lit</span></a><span> </span><span class="hs-special">(</span><a href="Literal.html#mkLitInteger"><span class="hs-identifier hs-var">mkLitInteger</span></a><span> </span><a href="#local-1627942167"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a><span> </span><a href="#local-1627942168"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Float@</span><span>
</span><a name="line-253"></a><span class="hs-identifier">mkFloatExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-254"></a><a name="mkFloatExpr"><a href="MkCore.html#mkFloatExpr"><span class="hs-identifier">mkFloatExpr</span></a></a><span> </span><a name="local-1627942169"><a href="#local-1627942169"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#floatDataCon"><span class="hs-identifier hs-var">floatDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#mkFloatLitFloat"><span class="hs-identifier hs-var">mkFloatLitFloat</span></a><span> </span><a href="#local-1627942169"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">]</span><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Double@</span><span>
</span><a name="line-257"></a><span class="hs-identifier">mkDoubleExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-258"></a><a name="mkDoubleExpr"><a href="MkCore.html#mkDoubleExpr"><span class="hs-identifier">mkDoubleExpr</span></a></a><span> </span><a name="local-1627942170"><a href="#local-1627942170"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#doubleDataCon"><span class="hs-identifier hs-var">doubleDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#mkDoubleLitDouble"><span class="hs-identifier hs-var">mkDoubleLitDouble</span></a><span> </span><a href="#local-1627942170"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Char@</span><span>
</span><a name="line-262"></a><span class="hs-identifier">mkCharExpr</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>      </span><span class="hs-comment">-- Result = C# c :: Int</span><span>
</span><a name="line-263"></a><a name="mkCharExpr"><a href="MkCore.html#mkCharExpr"><span class="hs-identifier">mkCharExpr</span></a></a><span> </span><a name="local-1627942171"><a href="#local-1627942171"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#charDataCon"><span class="hs-identifier hs-var">charDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#mkCharLit"><span class="hs-identifier hs-var">mkCharLit</span></a><span> </span><a href="#local-1627942171"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @String@</span><span>
</span><a name="line-266"></a><span class="hs-identifier">mkStringExpr</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a><span> </span><a href="#local-1627942103"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627942103"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>  </span><span class="hs-comment">-- Result :: String</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to a string morally equivalent to the given @FastString@</span><span>
</span><a name="line-269"></a><span class="hs-identifier">mkStringExprFS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a><span> </span><a href="#local-1627942102"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627942102"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>  </span><span class="hs-comment">-- Result :: String</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><a name="mkStringExpr"><a href="MkCore.html#mkStringExpr"><span class="hs-identifier">mkStringExpr</span></a></a><span> </span><a name="local-1627942172"><a href="#local-1627942172"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkStringExprFS"><span class="hs-identifier hs-var">mkStringExprFS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><a href="#local-1627942172"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><a name="mkStringExprFS"><a href="MkCore.html#mkStringExprFS"><span class="hs-identifier">mkStringExprFS</span></a></a><span> </span><a name="local-1627942173"><a href="#local-1627942173"><span class="hs-identifier">str</span></a></a><span>
</span><a name="line-274"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="FastString.html#nullFS"><span class="hs-identifier hs-var">nullFS</span></a><span> </span><a href="#local-1627942173"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-275"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="MkCore.html#mkNilExpr"><span class="hs-identifier hs-var">mkNilExpr</span></a><span> </span><a href="TysWiredIn.html#charTy"><span class="hs-identifier hs-var">charTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="#local-1627942175"><span class="hs-identifier hs-var">safeChar</span></a><span> </span><a href="#local-1627942174"><span class="hs-identifier hs-var">chars</span></a><span>
</span><a name="line-278"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1627942178"><a href="#local-1627942178"><span class="hs-identifier">unpack_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HscTypes.html#lookupId"><span class="hs-identifier hs-var">lookupId</span></a><span> </span><a href="PrelNames.html#unpackCStringName"><span class="hs-identifier hs-var">unpackCStringName</span></a><span>
</span><a name="line-279"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942178"><span class="hs-identifier hs-var">unpack_id</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942176"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-282"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1627942179"><a href="#local-1627942179"><span class="hs-identifier">unpack_utf8_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HscTypes.html#lookupId"><span class="hs-identifier hs-var">lookupId</span></a><span> </span><a href="PrelNames.html#unpackCStringUtf8Name"><span class="hs-identifier hs-var">unpackCStringUtf8Name</span></a><span>
</span><a name="line-283"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942179"><span class="hs-identifier hs-var">unpack_utf8_id</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942176"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-286"></a><span>    </span><a name="local-1627942174"><a href="#local-1627942174"><span class="hs-identifier">chars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-1627942173"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-287"></a><span>    </span><a name="local-1627942175"><a href="#local-1627942175"><span class="hs-identifier">safeChar</span></a></a><span> </span><a name="local-1627942177"><a href="#local-1627942177"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a><span> </span><a href="#local-1627942177"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a><span> </span><a href="#local-1627942177"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0x7F</span><span>
</span><a name="line-288"></a><span>    </span><a name="local-1627942176"><a href="#local-1627942176"><span class="hs-identifier">lit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Lit"><span class="hs-identifier hs-var">Lit</span></a><span> </span><span class="hs-special">(</span><a href="Literal.html#MachStr"><span class="hs-identifier hs-var">MachStr</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fastStringToByteString"><span class="hs-identifier hs-var">fastStringToByteString</span></a><span> </span><a href="#local-1627942173"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Tuple constructors}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">{-
Creating tuples and their types for Core expressions

@mkBigCoreVarTup@ builds a tuple; the inverse to @mkTupleSelector@.

* If it has only one element, it is the identity function.

* If there are more elements than a big tuple can have, it nests
  the tuples.

Note [Flattening one-tuples]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This family of functions creates a tuple of variables/expressions/types.
  mkCoreTup [e1,e2,e3] = (e1,e2,e3)
What if there is just one variable/expression/type in the agument?
We could do one of two things:

* Flatten it out, so that
    mkCoreTup [e1] = e1

* Built a one-tuple (see Note [One-tuples] in TysWiredIn)
    mkCoreTup1 [e1] = Unit e1
  We use a suffix &quot;1&quot; to indicate this.

Usually we want the former, but occasionally the latter.
-}</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-comment">-- | Build a small tuple holding the specified variables</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening of one-tuples]</span><span>
</span><a name="line-327"></a><span class="hs-identifier">mkCoreVarTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-328"></a><a name="mkCoreVarTup"><a href="MkCore.html#mkCoreVarTup"><span class="hs-identifier">mkCoreVarTup</span></a></a><span> </span><a name="local-1627942180"><a href="#local-1627942180"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreTup"><span class="hs-identifier hs-var">mkCoreTup</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942180"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-comment">-- | Bulid the type of a small tuple that holds the specified variables</span><span>
</span><a name="line-331"></a><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening of one-tuples]</span><span>
</span><a name="line-332"></a><span class="hs-identifier">mkCoreVarTupTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-333"></a><a name="mkCoreVarTupTy"><a href="MkCore.html#mkCoreVarTupTy"><span class="hs-identifier">mkCoreVarTupTy</span></a></a><span> </span><a name="local-1627942181"><a href="#local-1627942181"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkBoxedTupleTy"><span class="hs-identifier hs-var">mkBoxedTupleTy</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1627942181"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- | Build a small tuple holding the specified expressions</span><span>
</span><a name="line-336"></a><span class="hs-comment">-- One-tuples are flattened; see NOte [Flattening of one-tuples]</span><span>
</span><a name="line-337"></a><span class="hs-identifier">mkCoreTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-338"></a><a name="mkCoreTup"><a href="MkCore.html#mkCoreTup"><span class="hs-identifier">mkCoreTup</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="TysWiredIn.html#unitDataConId"><span class="hs-identifier hs-var">unitDataConId</span></a><span>
</span><a name="line-339"></a><span class="hs-identifier">mkCoreTup</span><span> </span><span class="hs-special">[</span><a name="local-1627942182"><a href="#local-1627942182"><span class="hs-identifier">c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627942182"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-340"></a><span class="hs-identifier">mkCoreTup</span><span> </span><a name="local-1627942183"><a href="#local-1627942183"><span class="hs-identifier">cs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627942183"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>                              </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942183"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627942183"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span class="hs-comment">-- | Build a small unboxed tuple holding the specified expressions,</span><span>
</span><a name="line-344"></a><span class="hs-comment">-- with the given types. The types must be the types of the expressions.</span><span>
</span><a name="line-345"></a><span class="hs-comment">-- Do not include the RuntimeRep specifiers; this function calculates them</span><span>
</span><a name="line-346"></a><span class="hs-comment">-- for you.</span><span>
</span><a name="line-347"></a><span class="hs-comment">-- Does /not/ flatten one-tuples; see Note [Flattening one-tuples]</span><span>
</span><a name="line-348"></a><span class="hs-identifier">mkCoreUbxTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-349"></a><a name="mkCoreUbxTup"><a href="MkCore.html#mkCoreUbxTup"><span class="hs-identifier">mkCoreUbxTup</span></a></a><span> </span><a name="local-1627942184"><a href="#local-1627942184"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-1627942185"><a href="#local-1627942185"><span class="hs-identifier">exps</span></a></a><span>
</span><a name="line-350"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><a href="Util.html#equalLength"><span class="hs-identifier hs-var">exps</span></a><span class="hs-special">)</span><span>
</span><a name="line-351"></a><span>    </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a><span> </span><a href="BasicTypes.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627942184"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>             </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><span class="hs-string">&quot;mkCoreUbxTup&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1627942184"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942184"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627942185"><span class="hs-identifier hs-var">exps</span></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-comment">-- | Make a core tuple of the given boxity</span><span>
</span><a name="line-355"></a><span class="hs-identifier">mkCoreTupBoxity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Boxity"><span class="hs-identifier hs-type">Boxity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-356"></a><a name="mkCoreTupBoxity"><a href="MkCore.html#mkCoreTupBoxity"><span class="hs-identifier">mkCoreTupBoxity</span></a></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span>   </span><a name="local-1627942186"><a href="#local-1627942186"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreTup"><span class="hs-identifier hs-var">mkCoreTup</span></a><span> </span><a href="#local-1627942186"><span class="hs-identifier hs-var">exps</span></a><span>
</span><a name="line-357"></a><span class="hs-identifier">mkCoreTupBoxity</span><span> </span><a href="BasicTypes.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a><span> </span><a name="local-1627942187"><a href="#local-1627942187"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreUbxTup"><span class="hs-identifier hs-var">mkCoreUbxTup</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span> </span><a href="#local-1627942187"><span class="hs-identifier hs-var">exps</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942187"><span class="hs-identifier hs-var">exps</span></a><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-comment">-- | Build a big tuple holding the specified variables</span><span>
</span><a name="line-360"></a><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening of one-tuples]</span><span>
</span><a name="line-361"></a><span class="hs-identifier">mkBigCoreVarTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-362"></a><a name="mkBigCoreVarTup"><a href="MkCore.html#mkBigCoreVarTup"><span class="hs-identifier">mkBigCoreVarTup</span></a></a><span> </span><a name="local-1627942188"><a href="#local-1627942188"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkBigCoreTup"><span class="hs-identifier hs-var">mkBigCoreTup</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942188"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-identifier">mkBigCoreVarTup1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-365"></a><span class="hs-comment">-- Same as mkBigCoreVarTup, but one-tuples are NOT flattened</span><span>
</span><a name="line-366"></a><span class="hs-comment">--                          see Note [Flattening one-tuples]</span><span>
</span><a name="line-367"></a><a name="mkBigCoreVarTup1"><a href="MkCore.html#mkBigCoreVarTup1"><span class="hs-identifier">mkBigCoreVarTup1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-1627942189"><a href="#local-1627942189"><span class="hs-identifier">id</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-368"></a><span>                                      </span><span class="hs-special">[</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1627942189"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942189"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-369"></a><span class="hs-identifier">mkBigCoreVarTup1</span><span> </span><a name="local-1627942190"><a href="#local-1627942190"><span class="hs-identifier">ids</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkBigCoreTup"><span class="hs-identifier hs-var">mkBigCoreTup</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942190"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-comment">-- | Build the type of a big tuple that holds the specified variables</span><span>
</span><a name="line-372"></a><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening of one-tuples]</span><span>
</span><a name="line-373"></a><span class="hs-identifier">mkBigCoreVarTupTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-374"></a><a name="mkBigCoreVarTupTy"><a href="MkCore.html#mkBigCoreVarTupTy"><span class="hs-identifier">mkBigCoreVarTupTy</span></a></a><span> </span><a name="local-1627942191"><a href="#local-1627942191"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkBigCoreTupTy"><span class="hs-identifier hs-var">mkBigCoreTupTy</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1627942191"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>
</span><a name="line-376"></a><span class="hs-comment">-- | Build a big tuple holding the specified expressions</span><span>
</span><a name="line-377"></a><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening of one-tuples]</span><span>
</span><a name="line-378"></a><span class="hs-identifier">mkBigCoreTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-379"></a><a name="mkBigCoreTup"><a href="MkCore.html#mkBigCoreTup"><span class="hs-identifier">mkBigCoreTup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span> </span><a href="MkCore.html#mkCoreTup"><span class="hs-identifier hs-var">mkCoreTup</span></a><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-comment">-- | Build the type of a big tuple that holds the specified type of thing</span><span>
</span><a name="line-382"></a><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening of one-tuples]</span><span>
</span><a name="line-383"></a><span class="hs-identifier">mkBigCoreTupTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-384"></a><a name="mkBigCoreTupTy"><a href="MkCore.html#mkBigCoreTupTy"><span class="hs-identifier">mkBigCoreTupTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span> </span><a href="TysWiredIn.html#mkBoxedTupleTy"><span class="hs-identifier hs-var">mkBoxedTupleTy</span></a><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Tuple destructors}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-comment">-- | Builds a selector which scrutises the given</span><span>
</span><a name="line-396"></a><span class="hs-comment">-- expression and extracts the one name from the list given.</span><span>
</span><a name="line-397"></a><span class="hs-comment">-- If you want the no-shadowing rule to apply, the caller</span><span>
</span><a name="line-398"></a><span class="hs-comment">-- is responsible for making sure that none of these names</span><span>
</span><a name="line-399"></a><span class="hs-comment">-- are in scope.</span><span>
</span><a name="line-400"></a><span class="hs-comment">--</span><span>
</span><a name="line-401"></a><span class="hs-comment">-- If there is just one 'Id' in the tuple, then the selector is</span><span>
</span><a name="line-402"></a><span class="hs-comment">-- just the identity.</span><span>
</span><a name="line-403"></a><span class="hs-comment">--</span><span>
</span><a name="line-404"></a><span class="hs-comment">-- If necessary, we pattern match on a \&quot;big\&quot; tuple.</span><span>
</span><a name="line-405"></a><span class="hs-identifier">mkTupleSelector</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkTupleSelector1</span><span>
</span><a name="line-406"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- ^ The 'Id's to pattern match the tuple against</span><span>
</span><a name="line-407"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>           </span><span class="hs-comment">-- ^ The 'Id' to select</span><span>
</span><a name="line-408"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>           </span><span class="hs-comment">-- ^ A variable of the same type as the scrutinee</span><span>
</span><a name="line-409"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>     </span><span class="hs-comment">-- ^ Scrutinee</span><span>
</span><a name="line-410"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>     </span><span class="hs-comment">-- ^ Selector expression</span><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span class="hs-comment">-- mkTupleSelector [a,b,c,d] b v e</span><span>
</span><a name="line-413"></a><span class="hs-comment">--          = case e of v {</span><span>
</span><a name="line-414"></a><span class="hs-comment">--                (p,q) -&gt; case p of p {</span><span>
</span><a name="line-415"></a><span class="hs-comment">--                           (a,b) -&gt; b }}</span><span>
</span><a name="line-416"></a><span class="hs-comment">-- We use 'tpl' vars for the p,q, since shadowing does not matter.</span><span>
</span><a name="line-417"></a><span class="hs-comment">--</span><span>
</span><a name="line-418"></a><span class="hs-comment">-- In fact, it's more convenient to generate it innermost first, getting</span><span>
</span><a name="line-419"></a><span class="hs-comment">--</span><span>
</span><a name="line-420"></a><span class="hs-comment">--        case (case e of v</span><span>
</span><a name="line-421"></a><span class="hs-comment">--                (p,q) -&gt; p) of p</span><span>
</span><a name="line-422"></a><span class="hs-comment">--          (a,b) -&gt; b</span><span>
</span><a name="line-423"></a><a name="mkTupleSelector"><a href="MkCore.html#mkTupleSelector"><span class="hs-identifier">mkTupleSelector</span></a></a><span> </span><a name="local-1627942192"><a href="#local-1627942192"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1627942193"><a href="#local-1627942193"><span class="hs-identifier">the_var</span></a></a><span> </span><a name="local-1627942194"><a href="#local-1627942194"><span class="hs-identifier">scrut_var</span></a></a><span> </span><a name="local-1627942195"><a href="#local-1627942195"><span class="hs-identifier">scrut</span></a></a><span>
</span><a name="line-424"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627942196"><span class="hs-identifier hs-var">mk_tup_sel</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><a href="#local-1627942192"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942193"><span class="hs-identifier hs-var">the_var</span></a><span>
</span><a name="line-425"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-426"></a><span>    </span><a name="local-1627942196"><a href="#local-1627942196"><span class="hs-identifier">mk_tup_sel</span></a></a><span> </span><span class="hs-special">[</span><a name="local-1627942197"><a href="#local-1627942197"><span class="hs-identifier">vars</span></a></a><span class="hs-special">]</span><span> </span><a name="local-1627942198"><a href="#local-1627942198"><span class="hs-identifier">the_var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkSmallTupleSelector"><span class="hs-identifier hs-var">mkSmallTupleSelector</span></a><span> </span><a href="#local-1627942197"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-1627942198"><span class="hs-identifier hs-var">the_var</span></a><span> </span><a href="#local-1627942194"><span class="hs-identifier hs-var">scrut_var</span></a><span> </span><a href="#local-1627942195"><span class="hs-identifier hs-var">scrut</span></a><span>
</span><a name="line-427"></a><span>    </span><span class="hs-identifier">mk_tup_sel</span><span> </span><a name="local-1627942199"><a href="#local-1627942199"><span class="hs-identifier">vars_s</span></a></a><span> </span><a name="local-1627942200"><a href="#local-1627942200"><span class="hs-identifier">the_var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkSmallTupleSelector"><span class="hs-identifier hs-var">mkSmallTupleSelector</span></a><span> </span><a href="#local-1627942204"><span class="hs-identifier hs-var">group</span></a><span> </span><a href="#local-1627942200"><span class="hs-identifier hs-var">the_var</span></a><span> </span><a href="#local-1627942203"><span class="hs-identifier hs-var">tpl_v</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-428"></a><span>                                </span><a href="#local-1627942196"><span class="hs-identifier hs-var">mk_tup_sel</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><a href="#local-1627942202"><span class="hs-identifier hs-var">tpl_vs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942203"><span class="hs-identifier hs-var">tpl_v</span></a><span>
</span><a name="line-429"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-430"></a><span>          </span><a name="local-1627942201"><a href="#local-1627942201"><span class="hs-identifier">tpl_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="TysWiredIn.html#mkBoxedTupleTy"><span class="hs-identifier hs-var">mkBoxedTupleTy</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1627942205"><span class="hs-identifier hs-var">gp</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1627942205"><a href="#local-1627942205"><span class="hs-identifier">gp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627942199"><span class="hs-identifier hs-var">vars_s</span></a><span class="hs-special">]</span><span>
</span><a name="line-431"></a><span>          </span><a name="local-1627942202"><a href="#local-1627942202"><span class="hs-identifier">tpl_vs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkTemplateLocals"><span class="hs-identifier hs-var">mkTemplateLocals</span></a><span> </span><a href="#local-1627942201"><span class="hs-identifier hs-var">tpl_tys</span></a><span>
</span><a name="line-432"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-1627942203"><a href="#local-1627942203"><span class="hs-identifier">tpl_v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942204"><a href="#local-1627942204"><span class="hs-identifier">group</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627942206"><span class="hs-identifier hs-var">tpl</span></a><span class="hs-special">,</span><a href="#local-1627942207"><span class="hs-identifier hs-var">gp</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1627942206"><a href="#local-1627942206"><span class="hs-identifier">tpl</span></a></a><span class="hs-special">,</span><a name="local-1627942207"><a href="#local-1627942207"><span class="hs-identifier">gp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#zipEqual"><span class="hs-identifier hs-var">zipEqual</span></a><span> </span><span class="hs-string">&quot;mkTupleSelector&quot;</span><span> </span><a href="#local-1627942202"><span class="hs-identifier hs-var">tpl_vs</span></a><span> </span><a href="#local-1627942199"><span class="hs-identifier hs-var">vars_s</span></a><span class="hs-special">,</span><span>
</span><a name="line-433"></a><span>                                         </span><a href="#local-1627942200"><span class="hs-identifier hs-var">the_var</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627942207"><span class="hs-identifier hs-var">gp</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- ^ 'mkTupleSelector1' is like 'mkTupleSelector'</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- but one-tuples are NOT flattened (see Note [Flattening one-tuples])</span><span>
</span><a name="line-436"></a><a name="mkTupleSelector1"><a href="MkCore.html#mkTupleSelector1"><span class="hs-identifier">mkTupleSelector1</span></a></a><span> </span><a name="local-1627942208"><a href="#local-1627942208"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1627942209"><a href="#local-1627942209"><span class="hs-identifier">the_var</span></a></a><span> </span><a name="local-1627942210"><a href="#local-1627942210"><span class="hs-identifier">scrut_var</span></a></a><span> </span><a name="local-1627942211"><a href="#local-1627942211"><span class="hs-identifier">scrut</span></a></a><span>
</span><a name="line-437"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627942208"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-438"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkSmallTupleSelector1"><span class="hs-identifier hs-var">mkSmallTupleSelector1</span></a><span> </span><a href="#local-1627942208"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-1627942209"><span class="hs-identifier hs-var">the_var</span></a><span> </span><a href="#local-1627942210"><span class="hs-identifier hs-var">scrut_var</span></a><span> </span><a href="#local-1627942211"><span class="hs-identifier hs-var">scrut</span></a><span>
</span><a name="line-439"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-440"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkTupleSelector"><span class="hs-identifier hs-var">mkTupleSelector</span></a><span> </span><a href="#local-1627942208"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-1627942209"><span class="hs-identifier hs-var">the_var</span></a><span> </span><a href="#local-1627942210"><span class="hs-identifier hs-var">scrut_var</span></a><span> </span><a href="#local-1627942211"><span class="hs-identifier hs-var">scrut</span></a><span>
</span><a name="line-441"></a><span>
</span><a name="line-442"></a><span class="hs-comment">-- | Like 'mkTupleSelector' but for tuples that are guaranteed</span><span>
</span><a name="line-443"></a><span class="hs-comment">-- never to be \&quot;big\&quot;.</span><span>
</span><a name="line-444"></a><span class="hs-comment">--</span><span>
</span><a name="line-445"></a><span class="hs-comment">-- &gt; mkSmallTupleSelector [x] x v e = [| e |]</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- &gt; mkSmallTupleSelector [x,y,z] x v e = [| case e of v { (x,y,z) -&gt; x } |]</span><span>
</span><a name="line-447"></a><span class="hs-identifier">mkSmallTupleSelector</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkSmallTupleSelector1</span><span>
</span><a name="line-448"></a><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- The tuple args</span><span>
</span><a name="line-449"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>          </span><span class="hs-comment">-- The selected one</span><span>
</span><a name="line-450"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>          </span><span class="hs-comment">-- A variable of the same type as the scrutinee</span><span>
</span><a name="line-451"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>    </span><span class="hs-comment">-- Scrutinee</span><span>
</span><a name="line-452"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-453"></a><a name="mkSmallTupleSelector"><a href="MkCore.html#mkSmallTupleSelector"><span class="hs-identifier">mkSmallTupleSelector</span></a></a><span> </span><span class="hs-special">[</span><a name="local-1627942212"><a href="#local-1627942212"><span class="hs-identifier">var</span></a></a><span class="hs-special">]</span><span> </span><a name="local-1627942213"><a href="#local-1627942213"><span class="hs-identifier">should_be_the_same_var</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627942214"><a href="#local-1627942214"><span class="hs-identifier">scrut</span></a></a><span>
</span><a name="line-454"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">should_be_the_same_var</span><span class="hs-special">)</span><span>
</span><a name="line-455"></a><span>    </span><a href="#local-1627942214"><span class="hs-identifier hs-var">scrut</span></a><span>  </span><span class="hs-comment">-- Special case for 1-tuples</span><span>
</span><a name="line-456"></a><span class="hs-identifier">mkSmallTupleSelector</span><span> </span><a name="local-1627942215"><a href="#local-1627942215"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1627942216"><a href="#local-1627942216"><span class="hs-identifier">the_var</span></a></a><span> </span><a name="local-1627942217"><a href="#local-1627942217"><span class="hs-identifier">scrut_var</span></a></a><span> </span><a name="local-1627942218"><a href="#local-1627942218"><span class="hs-identifier">scrut</span></a></a><span>
</span><a name="line-457"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkSmallTupleSelector1"><span class="hs-identifier hs-var">mkSmallTupleSelector1</span></a><span> </span><a href="#local-1627942215"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-1627942216"><span class="hs-identifier hs-var">the_var</span></a><span> </span><a href="#local-1627942217"><span class="hs-identifier hs-var">scrut_var</span></a><span> </span><a href="#local-1627942218"><span class="hs-identifier hs-var">scrut</span></a><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span class="hs-comment">-- ^ 'mkSmallTupleSelector1' is like 'mkSmallTupleSelector'</span><span>
</span><a name="line-460"></a><span class="hs-comment">-- but one-tuples are NOT flattened (see Note [Flattening one-tuples])</span><span>
</span><a name="line-461"></a><a name="mkSmallTupleSelector1"><a href="MkCore.html#mkSmallTupleSelector1"><span class="hs-identifier">mkSmallTupleSelector1</span></a></a><span> </span><a name="local-1627942219"><a href="#local-1627942219"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1627942220"><a href="#local-1627942220"><span class="hs-identifier">the_var</span></a></a><span> </span><a name="local-1627942221"><a href="#local-1627942221"><span class="hs-identifier">scrut_var</span></a></a><span> </span><a name="local-1627942222"><a href="#local-1627942222"><span class="hs-identifier">scrut</span></a></a><span>
</span><a name="line-462"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">notNull</span><span> </span><span class="hs-identifier">vars</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>    </span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-1627942222"><span class="hs-identifier hs-var">scrut</span></a><span> </span><a href="#local-1627942221"><span class="hs-identifier hs-var">scrut_var</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1627942220"><span class="hs-identifier hs-var">the_var</span></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>         </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627942219"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1627942219"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">,</span><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942220"><span class="hs-identifier hs-var">the_var</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span class="hs-comment">-- | A generalization of 'mkTupleSelector', allowing the body</span><span>
</span><a name="line-467"></a><span class="hs-comment">-- of the case to be an arbitrary expression.</span><span>
</span><a name="line-468"></a><span class="hs-comment">--</span><span>
</span><a name="line-469"></a><span class="hs-comment">-- To avoid shadowing, we use uniques to invent new variables.</span><span>
</span><a name="line-470"></a><span class="hs-comment">--</span><span>
</span><a name="line-471"></a><span class="hs-comment">-- If necessary we pattern match on a \&quot;big\&quot; tuple.</span><span>
</span><a name="line-472"></a><span class="hs-identifier">mkTupleCase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UniqSupply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a><span>       </span><span class="hs-comment">-- ^ For inventing names of intermediate variables</span><span>
</span><a name="line-473"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ The tuple identifiers to pattern match on</span><span>
</span><a name="line-474"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>         </span><span class="hs-comment">-- ^ Body of the case</span><span>
</span><a name="line-475"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>               </span><span class="hs-comment">-- ^ A variable of the same type as the scrutinee</span><span>
</span><a name="line-476"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>         </span><span class="hs-comment">-- ^ Scrutinee</span><span>
</span><a name="line-477"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-478"></a><span class="hs-comment">-- ToDo: eliminate cases where none of the variables are needed.</span><span>
</span><a name="line-479"></a><span class="hs-comment">--</span><span>
</span><a name="line-480"></a><span class="hs-comment">--         mkTupleCase uniqs [a,b,c,d] body v e</span><span>
</span><a name="line-481"></a><span class="hs-comment">--           = case e of v { (p,q) -&gt;</span><span>
</span><a name="line-482"></a><span class="hs-comment">--             case p of p { (a,b) -&gt;</span><span>
</span><a name="line-483"></a><span class="hs-comment">--             case q of q { (c,d) -&gt;</span><span>
</span><a name="line-484"></a><span class="hs-comment">--             body }}}</span><span>
</span><a name="line-485"></a><a name="mkTupleCase"><a href="MkCore.html#mkTupleCase"><span class="hs-identifier">mkTupleCase</span></a></a><span> </span><a name="local-1627942223"><a href="#local-1627942223"><span class="hs-identifier">uniqs</span></a></a><span> </span><a name="local-1627942224"><a href="#local-1627942224"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1627942225"><a href="#local-1627942225"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627942226"><a href="#local-1627942226"><span class="hs-identifier">scrut_var</span></a></a><span> </span><a name="local-1627942227"><a href="#local-1627942227"><span class="hs-identifier">scrut</span></a></a><span>
</span><a name="line-486"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627942228"><span class="hs-identifier hs-var">mk_tuple_case</span></a><span> </span><a href="#local-1627942223"><span class="hs-identifier hs-var">uniqs</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><a href="#local-1627942224"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942225"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-487"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-488"></a><span>    </span><span class="hs-comment">-- This is the case where don't need any nesting</span><span>
</span><a name="line-489"></a><span>    </span><a name="local-1627942228"><a href="#local-1627942228"><span class="hs-identifier">mk_tuple_case</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-1627942230"><a href="#local-1627942230"><span class="hs-identifier">vars</span></a></a><span class="hs-special">]</span><span> </span><a name="local-1627942231"><a href="#local-1627942231"><span class="hs-identifier">body</span></a></a><span>
</span><a name="line-490"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkSmallTupleCase"><span class="hs-identifier hs-var">mkSmallTupleCase</span></a><span> </span><a href="#local-1627942230"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-1627942231"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1627942226"><span class="hs-identifier hs-var">scrut_var</span></a><span> </span><a href="#local-1627942227"><span class="hs-identifier hs-var">scrut</span></a><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span>    </span><span class="hs-comment">-- This is the case where we must make nest tuples at least once</span><span>
</span><a name="line-493"></a><span>    </span><span class="hs-identifier">mk_tuple_case</span><span> </span><a name="local-1627942232"><a href="#local-1627942232"><span class="hs-identifier">us</span></a></a><span> </span><a name="local-1627942233"><a href="#local-1627942233"><span class="hs-identifier">vars_s</span></a></a><span> </span><a name="local-1627942234"><a href="#local-1627942234"><span class="hs-identifier">body</span></a></a><span>
</span><a name="line-494"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627942235"><a href="#local-1627942235"><span class="hs-identifier">us'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942236"><a href="#local-1627942236"><span class="hs-identifier">vars'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942237"><a href="#local-1627942237"><span class="hs-identifier">body'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-1627942229"><span class="hs-identifier hs-var">one_tuple_case</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627942232"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1627942234"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942233"><span class="hs-identifier hs-var">vars_s</span></a><span>
</span><a name="line-495"></a><span>            </span><span class="hs-keyword">in</span><span> </span><a href="#local-1627942228"><span class="hs-identifier hs-var">mk_tuple_case</span></a><span> </span><a href="#local-1627942235"><span class="hs-identifier hs-var">us'</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><a href="#local-1627942236"><span class="hs-identifier hs-var">vars'</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942237"><span class="hs-identifier hs-var">body'</span></a><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span>    </span><a name="local-1627942229"><a href="#local-1627942229"><span class="hs-identifier">one_tuple_case</span></a></a><span> </span><a name="local-1627942238"><a href="#local-1627942238"><span class="hs-identifier">chunk_vars</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627942239"><a href="#local-1627942239"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942240"><a href="#local-1627942240"><span class="hs-identifier">vs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942241"><a href="#local-1627942241"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627942242"><a href="#local-1627942242"><span class="hs-identifier">uniq</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942243"><a href="#local-1627942243"><span class="hs-identifier">us'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqSupply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a><span> </span><a href="#local-1627942239"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-499"></a><span>            </span><a name="local-1627942244"><a href="#local-1627942244"><span class="hs-identifier">scrut_var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkSysLocal"><span class="hs-identifier hs-var">mkSysLocal</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;ds&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1627942242"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-500"></a><span>              </span><span class="hs-special">(</span><a href="TysWiredIn.html#mkBoxedTupleTy"><span class="hs-identifier hs-var">mkBoxedTupleTy</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1627942238"><span class="hs-identifier hs-var">chunk_vars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-501"></a><span>            </span><a name="local-1627942245"><a href="#local-1627942245"><span class="hs-identifier">body'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkSmallTupleCase"><span class="hs-identifier hs-var">mkSmallTupleCase</span></a><span> </span><a href="#local-1627942238"><span class="hs-identifier hs-var">chunk_vars</span></a><span> </span><a href="#local-1627942241"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1627942244"><span class="hs-identifier hs-var">scrut_var</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942244"><span class="hs-identifier hs-var">scrut_var</span></a><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1627942243"><span class="hs-identifier hs-var">us'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942244"><span class="hs-identifier hs-var">scrut_var</span></a><span class="hs-glyph">:</span><a href="#local-1627942240"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942245"><span class="hs-identifier hs-var">body'</span></a><span class="hs-special">)</span><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><span class="hs-comment">-- | As 'mkTupleCase', but for a tuple that is small enough to be guaranteed</span><span>
</span><a name="line-505"></a><span class="hs-comment">-- not to need nesting.</span><span>
</span><a name="line-506"></a><span class="hs-identifier">mkSmallTupleCase</span><span>
</span><a name="line-507"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- ^ The tuple args</span><span>
</span><a name="line-508"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>     </span><span class="hs-comment">-- ^ Body of the case</span><span>
</span><a name="line-509"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>           </span><span class="hs-comment">-- ^ A variable of the same type as the scrutinee</span><span>
</span><a name="line-510"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>     </span><span class="hs-comment">-- ^ Scrutinee</span><span>
</span><a name="line-511"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><a name="mkSmallTupleCase"><a href="MkCore.html#mkSmallTupleCase"><span class="hs-identifier">mkSmallTupleCase</span></a></a><span> </span><span class="hs-special">[</span><a name="local-1627942246"><a href="#local-1627942246"><span class="hs-identifier">var</span></a></a><span class="hs-special">]</span><span> </span><a name="local-1627942247"><a href="#local-1627942247"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627942248"><a href="#local-1627942248"><span class="hs-identifier">_scrut_var</span></a></a><span> </span><a name="local-1627942249"><a href="#local-1627942249"><span class="hs-identifier">scrut</span></a></a><span>
</span><a name="line-514"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreUtils.html#bindNonRec"><span class="hs-identifier hs-var">bindNonRec</span></a><span> </span><a href="#local-1627942246"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-1627942249"><span class="hs-identifier hs-var">scrut</span></a><span> </span><a href="#local-1627942247"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-515"></a><span class="hs-identifier">mkSmallTupleCase</span><span> </span><a name="local-1627942250"><a href="#local-1627942250"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1627942251"><a href="#local-1627942251"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627942252"><a href="#local-1627942252"><span class="hs-identifier">scrut_var</span></a></a><span> </span><a name="local-1627942253"><a href="#local-1627942253"><span class="hs-identifier">scrut</span></a></a><span>
</span><a name="line-516"></a><span class="hs-comment">-- One branch no refinement?</span><span>
</span><a name="line-517"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-1627942253"><span class="hs-identifier hs-var">scrut</span></a><span> </span><a href="#local-1627942252"><span class="hs-identifier hs-var">scrut_var</span></a><span> </span><span class="hs-special">(</span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span> </span><a href="#local-1627942251"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-518"></a><span>         </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627942250"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1627942250"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942251"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Floats
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span class="hs-keyword">data</span><span> </span><a name="FloatBind"><a href="MkCore.html#FloatBind"><span class="hs-identifier">FloatBind</span></a></a><span>
</span><a name="line-529"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="FloatLet"><a href="MkCore.html#FloatLet"><span class="hs-identifier">FloatLet</span></a></a><span>  </span><a href="CoreSyn.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a><span>
</span><a name="line-530"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FloatCase"><a href="MkCore.html#FloatCase"><span class="hs-identifier">FloatCase</span></a></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="CoreSyn.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span>
</span><a name="line-531"></a><span>      </span><span class="hs-comment">-- case e of y { C ys -&gt; ... }</span><span>
</span><a name="line-532"></a><span>      </span><span class="hs-comment">-- See Note [Floating cases] in SetLevels</span><span>
</span><a name="line-533"></a><span>
</span><a name="line-534"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="MkCore.html#FloatBind"><span class="hs-identifier hs-type">FloatBind</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-535"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="MkCore.html#FloatLet"><span class="hs-identifier hs-var">FloatLet</span></a><span> </span><a name="local-1627942301"><a href="#local-1627942301"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;LET&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627942301"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-536"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="MkCore.html#FloatCase"><span class="hs-identifier hs-var">FloatCase</span></a><span> </span><a name="local-1627942302"><a href="#local-1627942302"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627942303"><a href="#local-1627942303"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627942304"><a href="#local-1627942304"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627942305"><a href="#local-1627942305"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CASE&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627942302"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;of&quot;</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627942303"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-537"></a><span>                                </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627942304"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627942305"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-identifier">wrapFloat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MkCore.html#FloatBind"><span class="hs-identifier hs-type">FloatBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-540"></a><a name="wrapFloat"><a href="MkCore.html#wrapFloat"><span class="hs-identifier">wrapFloat</span></a></a><span> </span><span class="hs-special">(</span><a href="MkCore.html#FloatLet"><span class="hs-identifier hs-var">FloatLet</span></a><span> </span><a name="local-1627942254"><a href="#local-1627942254"><span class="hs-identifier">defns</span></a></a><span class="hs-special">)</span><span>       </span><a name="local-1627942255"><a href="#local-1627942255"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><a href="#local-1627942254"><span class="hs-identifier hs-var">defns</span></a><span> </span><a href="#local-1627942255"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-541"></a><span class="hs-identifier">wrapFloat</span><span> </span><span class="hs-special">(</span><a href="MkCore.html#FloatCase"><span class="hs-identifier hs-var">FloatCase</span></a><span> </span><a name="local-1627942256"><a href="#local-1627942256"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627942257"><a href="#local-1627942257"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627942258"><a href="#local-1627942258"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1627942259"><a href="#local-1627942259"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627942260"><a href="#local-1627942260"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-1627942256"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-1627942257"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="CoreUtils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a><span> </span><a href="#local-1627942260"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627942258"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942259"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942260"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-542"></a><span>
</span><a name="line-543"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Common list manipulation expressions}
*                                                                      *
************************************************************************

Call the constructor Ids when building explicit lists, so that they
interact well with rules.
-}</span><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span class="hs-comment">-- | Makes a list @[]@ for lists of the specified type</span><span>
</span><a name="line-555"></a><span class="hs-identifier">mkNilExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-556"></a><a name="mkNilExpr"><a href="MkCore.html#mkNilExpr"><span class="hs-identifier">mkNilExpr</span></a></a><span> </span><a name="local-1627942261"><a href="#local-1627942261"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#nilDataCon"><span class="hs-identifier hs-var">nilDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942261"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-557"></a><span>
</span><a name="line-558"></a><span class="hs-comment">-- | Makes a list @(:)@ for lists of the specified type</span><span>
</span><a name="line-559"></a><span class="hs-identifier">mkConsExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-560"></a><a name="mkConsExpr"><a href="MkCore.html#mkConsExpr"><span class="hs-identifier">mkConsExpr</span></a></a><span> </span><a name="local-1627942262"><a href="#local-1627942262"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627942263"><a href="#local-1627942263"><span class="hs-identifier">hd</span></a></a><span> </span><a name="local-1627942264"><a href="#local-1627942264"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a><span> </span><a href="TysWiredIn.html#consDataCon"><span class="hs-identifier hs-var">consDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942262"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942263"><span class="hs-identifier hs-var">hd</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942264"><span class="hs-identifier hs-var">tl</span></a><span class="hs-special">]</span><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-comment">-- | Make a list containing the given expressions, where the list has the given type</span><span>
</span><a name="line-563"></a><span class="hs-identifier">mkListExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-564"></a><a name="mkListExpr"><a href="MkCore.html#mkListExpr"><span class="hs-identifier">mkListExpr</span></a></a><span> </span><a name="local-1627942265"><a href="#local-1627942265"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627942266"><a href="#local-1627942266"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="MkCore.html#mkConsExpr"><span class="hs-identifier hs-var">mkConsExpr</span></a><span> </span><a href="#local-1627942265"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="MkCore.html#mkNilExpr"><span class="hs-identifier hs-var">mkNilExpr</span></a><span> </span><a href="#local-1627942265"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942266"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-565"></a><span>
</span><a name="line-566"></a><span class="hs-comment">-- | Make a fully applied 'foldr' expression</span><span>
</span><a name="line-567"></a><span class="hs-identifier">mkFoldrExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a><span> </span><a href="#local-1627942101"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-568"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>             </span><span class="hs-comment">-- ^ Element type of the list</span><span>
</span><a name="line-569"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>             </span><span class="hs-comment">-- ^ Fold result type</span><span>
</span><a name="line-570"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>         </span><span class="hs-comment">-- ^ &quot;Cons&quot; function expression for the fold</span><span>
</span><a name="line-571"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>         </span><span class="hs-comment">-- ^ &quot;Nil&quot; expression for the fold</span><span>
</span><a name="line-572"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>         </span><span class="hs-comment">-- ^ List expression being folded acress</span><span>
</span><a name="line-573"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627942101"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-574"></a><a name="mkFoldrExpr"><a href="MkCore.html#mkFoldrExpr"><span class="hs-identifier">mkFoldrExpr</span></a></a><span> </span><a name="local-1627942267"><a href="#local-1627942267"><span class="hs-identifier">elt_ty</span></a></a><span> </span><a name="local-1627942268"><a href="#local-1627942268"><span class="hs-identifier">result_ty</span></a></a><span> </span><a name="local-1627942269"><a href="#local-1627942269"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627942270"><a href="#local-1627942270"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627942271"><a href="#local-1627942271"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-575"></a><span>    </span><a name="local-1627942272"><a href="#local-1627942272"><span class="hs-identifier">foldr_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HscTypes.html#lookupId"><span class="hs-identifier hs-var">lookupId</span></a><span> </span><a href="PrelNames.html#foldrName"><span class="hs-identifier hs-var">foldrName</span></a><span>
</span><a name="line-576"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942272"><span class="hs-identifier hs-var">foldr_id</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">`</span><span> </span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942267"><span class="hs-identifier hs-var">elt_ty</span></a><span>
</span><a name="line-577"></a><span>           </span><span class="hs-special">`</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">`</span><span> </span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942268"><span class="hs-identifier hs-var">result_ty</span></a><span>
</span><a name="line-578"></a><span>           </span><span class="hs-special">`</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627942269"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-579"></a><span>           </span><span class="hs-special">`</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627942270"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-580"></a><span>           </span><span class="hs-special">`</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627942271"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">)</span><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span class="hs-comment">-- | Make a 'build' expression applied to a locally-bound worker function</span><span>
</span><a name="line-583"></a><span class="hs-identifier">mkBuildExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HscTypes.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a><span> </span><a href="#local-1627942100"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="UniqSupply.html#MonadUnique"><span class="hs-identifier hs-type">MonadUnique</span></a><span> </span><a href="#local-1627942100"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-584"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                                     </span><span class="hs-comment">-- ^ Type of list elements to be built</span><span>
</span><a name="line-585"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627942100"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Function that, given information about the 'Id's</span><span>
</span><a name="line-586"></a><span>                                                        </span><span class="hs-comment">-- of the binders for the build worker function, returns</span><span>
</span><a name="line-587"></a><span>                                                        </span><span class="hs-comment">-- the body of that worker</span><span>
</span><a name="line-588"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627942100"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-589"></a><a name="mkBuildExpr"><a href="MkCore.html#mkBuildExpr"><span class="hs-identifier">mkBuildExpr</span></a></a><span> </span><a name="local-1627942273"><a href="#local-1627942273"><span class="hs-identifier">elt_ty</span></a></a><span> </span><a name="local-1627942274"><a href="#local-1627942274"><span class="hs-identifier">mk_build_inside</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-590"></a><span>    </span><span class="hs-special">[</span><a name="local-1627942278"><a href="#local-1627942278"><span class="hs-identifier">n_tyvar</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627942275"><span class="hs-identifier hs-var">newTyVars</span></a><span> </span><span class="hs-special">[</span><a href="TysPrim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-591"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1627942279"><a href="#local-1627942279"><span class="hs-identifier">n_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1627942278"><span class="hs-identifier hs-var">n_tyvar</span></a><span>
</span><a name="line-592"></a><span>        </span><a name="local-1627942280"><a href="#local-1627942280"><span class="hs-identifier">c_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627942273"><span class="hs-identifier hs-var">elt_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942279"><span class="hs-identifier hs-var">n_ty</span></a><span class="hs-special">]</span><span> </span><a href="#local-1627942279"><span class="hs-identifier hs-var">n_ty</span></a><span>
</span><a name="line-593"></a><span>    </span><span class="hs-special">[</span><a name="local-1627942281"><a href="#local-1627942281"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627942282"><a href="#local-1627942282"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><span class="hs-special">[</span><a href="Id.html#mkSysLocalM"><span class="hs-identifier hs-var">mkSysLocalM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;c&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1627942280"><span class="hs-identifier hs-var">c_ty</span></a><span class="hs-special">,</span><span> </span><a href="Id.html#mkSysLocalM"><span class="hs-identifier hs-var">mkSysLocalM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;n&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1627942279"><span class="hs-identifier hs-var">n_ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-594"></a><span>
</span><a name="line-595"></a><span>    </span><a name="local-1627942283"><a href="#local-1627942283"><span class="hs-identifier">build_inside</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627942274"><span class="hs-identifier hs-var">mk_build_inside</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627942281"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942280"><span class="hs-identifier hs-var">c_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627942282"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942279"><span class="hs-identifier hs-var">n_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span>    </span><a name="local-1627942284"><a href="#local-1627942284"><span class="hs-identifier">build_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HscTypes.html#lookupId"><span class="hs-identifier hs-var">lookupId</span></a><span> </span><a href="PrelNames.html#buildName"><span class="hs-identifier hs-var">buildName</span></a><span>
</span><a name="line-598"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942284"><span class="hs-identifier hs-var">build_id</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">`</span><span> </span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942273"><span class="hs-identifier hs-var">elt_ty</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">`</span><span> </span><a href="CoreSyn.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627942278"><span class="hs-identifier hs-var">n_tyvar</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942281"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942282"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span> </span><a href="#local-1627942283"><span class="hs-identifier hs-var">build_inside</span></a><span>
</span><a name="line-599"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-600"></a><span>    </span><a name="local-1627942275"><a href="#local-1627942275"><span class="hs-identifier">newTyVars</span></a></a><span> </span><a name="local-1627942276"><a href="#local-1627942276"><span class="hs-identifier">tyvar_tmpls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-601"></a><span>      </span><a name="local-1627942277"><a href="#local-1627942277"><span class="hs-identifier">uniqs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="UniqSupply.html#getUniquesM"><span class="hs-identifier hs-var">getUniquesM</span></a><span>
</span><a name="line-602"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><a href="Var.html#setTyVarUnique"><span class="hs-identifier hs-var">setTyVarUnique</span></a><span> </span><a href="#local-1627942276"><span class="hs-identifier hs-var">tyvar_tmpls</span></a><span> </span><a href="#local-1627942277"><span class="hs-identifier hs-var">uniqs</span></a><span class="hs-special">)</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
             Manipulating Maybe data type
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span>
</span><a name="line-613"></a><span class="hs-comment">-- | Makes a Nothing for the specified type</span><span>
</span><a name="line-614"></a><span class="hs-identifier">mkNothingExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-615"></a><a name="mkNothingExpr"><a href="MkCore.html#mkNothingExpr"><span class="hs-identifier">mkNothingExpr</span></a></a><span> </span><a name="local-1627942285"><a href="#local-1627942285"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#mkConApp"><span class="hs-identifier hs-var">mkConApp</span></a><span> </span><a href="TysWiredIn.html#nothingDataCon"><span class="hs-identifier hs-var">nothingDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942285"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-comment">-- | Makes a Just from a value of the specified type</span><span>
</span><a name="line-618"></a><span class="hs-identifier">mkJustExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-619"></a><a name="mkJustExpr"><a href="MkCore.html#mkJustExpr"><span class="hs-identifier">mkJustExpr</span></a></a><span> </span><a name="local-1627942286"><a href="#local-1627942286"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627942287"><a href="#local-1627942287"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#mkConApp"><span class="hs-identifier hs-var">mkConApp</span></a><span> </span><a href="TysWiredIn.html#justDataCon"><span class="hs-identifier hs-var">justDataCon</span></a><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942286"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942287"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">]</span><span>
</span><a name="line-620"></a><span>
</span><a name="line-621"></a><span>
</span><a name="line-622"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                      Error expressions
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-629"></a><span>
</span><a name="line-630"></a><span class="hs-identifier">mkRuntimeErrorApp</span><span>
</span><a name="line-631"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>           </span><span class="hs-comment">-- Should be of type (forall a. Addr# -&gt; a)</span><span>
</span><a name="line-632"></a><span>                        </span><span class="hs-comment">--      where Addr# points to a UTF8 encoded string</span><span>
</span><a name="line-633"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>         </span><span class="hs-comment">-- The type to instantiate 'a'</span><span>
</span><a name="line-634"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>       </span><span class="hs-comment">-- The string to print</span><span>
</span><a name="line-635"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-636"></a><span>
</span><a name="line-637"></a><a name="mkRuntimeErrorApp"><a href="MkCore.html#mkRuntimeErrorApp"><span class="hs-identifier">mkRuntimeErrorApp</span></a></a><span> </span><a name="local-1627942288"><a href="#local-1627942288"><span class="hs-identifier">err_id</span></a></a><span> </span><a name="local-1627942289"><a href="#local-1627942289"><span class="hs-identifier">res_ty</span></a></a><span> </span><a name="local-1627942290"><a href="#local-1627942290"><span class="hs-identifier">err_msg</span></a></a><span>
</span><a name="line-638"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#mkApps"><span class="hs-identifier hs-var">mkApps</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1627942288"><span class="hs-identifier hs-var">err_id</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><span class="hs-string">&quot;mkRuntimeErrorApp&quot;</span><span> </span><a href="#local-1627942289"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-1627942289"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627942291"><span class="hs-identifier hs-var">err_string</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-640"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-641"></a><span>    </span><a name="local-1627942291"><a href="#local-1627942291"><span class="hs-identifier">err_string</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Lit"><span class="hs-identifier hs-var">Lit</span></a><span> </span><span class="hs-special">(</span><a href="Literal.html#mkMachString"><span class="hs-identifier hs-var">mkMachString</span></a><span> </span><a href="#local-1627942290"><span class="hs-identifier hs-var">err_msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span>
</span><a name="line-643"></a><span class="hs-identifier">mkImpossibleExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-644"></a><a name="mkImpossibleExpr"><a href="MkCore.html#mkImpossibleExpr"><span class="hs-identifier">mkImpossibleExpr</span></a></a><span> </span><a name="local-1627942292"><a href="#local-1627942292"><span class="hs-identifier">res_ty</span></a></a><span>
</span><a name="line-645"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorApp"><span class="hs-identifier hs-var">mkRuntimeErrorApp</span></a><span> </span><a href="MkCore.html#rUNTIME_ERROR_ID"><span class="hs-identifier hs-var">rUNTIME_ERROR_ID</span></a><span> </span><a href="#local-1627942292"><span class="hs-identifier hs-var">res_ty</span></a><span> </span><span class="hs-string">&quot;Impossible case alternative&quot;</span><span>
</span><a name="line-646"></a><span>
</span><a name="line-647"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                     Error Ids
*                                                                      *
************************************************************************

GHC randomly injects these into the code.

@patError@ is just a version of @error@ for pattern-matching
failures.  It knows various ``codes'' which expand to longer
strings---this saves space!

@absentErr@ is a thing we put in for ``absent'' arguments.  They jolly
well shouldn't be yanked on, but if one is, then you will get a
friendly message from @absentErr@ (rather than a totally random
crash).

@parError@ is a special version of @error@ which the compiler does
not know to be a bottoming Id.  It is used in the @_par_@ and @_seq_@
templates, but we don't ever expect to generate code for it.
-}</span><span>
</span><a name="line-669"></a><span>
</span><a name="line-670"></a><span class="hs-identifier">errorIds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-671"></a><a name="errorIds"><a href="MkCore.html#errorIds"><span class="hs-identifier">errorIds</span></a></a><span>
</span><a name="line-672"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="MkCore.html#rUNTIME_ERROR_ID"><span class="hs-identifier hs-var">rUNTIME_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-673"></a><span>      </span><a href="MkCore.html#iRREFUT_PAT_ERROR_ID"><span class="hs-identifier hs-var">iRREFUT_PAT_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-674"></a><span>      </span><a href="MkCore.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier hs-var">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-675"></a><span>      </span><a href="MkCore.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier hs-var">nO_METHOD_BINDING_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-676"></a><span>      </span><a href="MkCore.html#pAT_ERROR_ID"><span class="hs-identifier hs-var">pAT_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-677"></a><span>      </span><a href="MkCore.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-var">rEC_CON_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-678"></a><span>      </span><a href="MkCore.html#rEC_SEL_ERROR_ID"><span class="hs-identifier hs-var">rEC_SEL_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-679"></a><span>      </span><a href="MkCore.html#aBSENT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_ERROR_ID</span></a><span class="hs-special">,</span><span>
</span><a name="line-680"></a><span>      </span><a href="MkCore.html#tYPE_ERROR_ID"><span class="hs-identifier hs-var">tYPE_ERROR_ID</span></a><span>   </span><span class="hs-comment">-- Used with Opt_DeferTypeErrors, see #10284</span><span>
</span><a name="line-681"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span class="hs-identifier">recSelErrorName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">runtimeErrorName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">absentErrorName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-684"></a><span class="hs-identifier">irrefutPatErrorName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recConErrorName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patErrorName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-685"></a><span class="hs-identifier">nonExhaustiveGuardsErrorName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">noMethodBindingErrorName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-686"></a><span class="hs-identifier">typeErrorName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><a name="recSelErrorName"><a href="MkCore.html#recSelErrorName"><span class="hs-identifier">recSelErrorName</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;recSelError&quot;</span><span>     </span><a href="PrelNames.html#recSelErrorIdKey"><span class="hs-identifier hs-var">recSelErrorIdKey</span></a><span>     </span><a href="MkCore.html#rEC_SEL_ERROR_ID"><span class="hs-identifier hs-var">rEC_SEL_ERROR_ID</span></a><span>
</span><a name="line-689"></a><a name="absentErrorName"><a href="MkCore.html#absentErrorName"><span class="hs-identifier">absentErrorName</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;absentError&quot;</span><span>     </span><a href="PrelNames.html#absentErrorIdKey"><span class="hs-identifier hs-var">absentErrorIdKey</span></a><span>     </span><a href="MkCore.html#aBSENT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_ERROR_ID</span></a><span>
</span><a name="line-690"></a><a name="runtimeErrorName"><a href="MkCore.html#runtimeErrorName"><span class="hs-identifier">runtimeErrorName</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;runtimeError&quot;</span><span>    </span><a href="PrelNames.html#runtimeErrorIdKey"><span class="hs-identifier hs-var">runtimeErrorIdKey</span></a><span>    </span><a href="MkCore.html#rUNTIME_ERROR_ID"><span class="hs-identifier hs-var">rUNTIME_ERROR_ID</span></a><span>
</span><a name="line-691"></a><a name="irrefutPatErrorName"><a href="MkCore.html#irrefutPatErrorName"><span class="hs-identifier">irrefutPatErrorName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;irrefutPatError&quot;</span><span> </span><a href="PrelNames.html#irrefutPatErrorIdKey"><span class="hs-identifier hs-var">irrefutPatErrorIdKey</span></a><span> </span><a href="MkCore.html#iRREFUT_PAT_ERROR_ID"><span class="hs-identifier hs-var">iRREFUT_PAT_ERROR_ID</span></a><span>
</span><a name="line-692"></a><a name="recConErrorName"><a href="MkCore.html#recConErrorName"><span class="hs-identifier">recConErrorName</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;recConError&quot;</span><span>     </span><a href="PrelNames.html#recConErrorIdKey"><span class="hs-identifier hs-var">recConErrorIdKey</span></a><span>     </span><a href="MkCore.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-var">rEC_CON_ERROR_ID</span></a><span>
</span><a name="line-693"></a><a name="patErrorName"><a href="MkCore.html#patErrorName"><span class="hs-identifier">patErrorName</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;patError&quot;</span><span>        </span><a href="PrelNames.html#patErrorIdKey"><span class="hs-identifier hs-var">patErrorIdKey</span></a><span>        </span><a href="MkCore.html#pAT_ERROR_ID"><span class="hs-identifier hs-var">pAT_ERROR_ID</span></a><span>
</span><a name="line-694"></a><a name="typeErrorName"><a href="MkCore.html#typeErrorName"><span class="hs-identifier">typeErrorName</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;typeError&quot;</span><span>       </span><a href="PrelNames.html#typeErrorIdKey"><span class="hs-identifier hs-var">typeErrorIdKey</span></a><span>       </span><a href="MkCore.html#tYPE_ERROR_ID"><span class="hs-identifier hs-var">tYPE_ERROR_ID</span></a><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><a name="noMethodBindingErrorName"><a href="MkCore.html#noMethodBindingErrorName"><span class="hs-identifier">noMethodBindingErrorName</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;noMethodBindingError&quot;</span><span>
</span><a name="line-697"></a><span>                                  </span><a href="PrelNames.html#noMethodBindingErrorIdKey"><span class="hs-identifier hs-var">noMethodBindingErrorIdKey</span></a><span> </span><a href="MkCore.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier hs-var">nO_METHOD_BINDING_ERROR_ID</span></a><span>
</span><a name="line-698"></a><a name="nonExhaustiveGuardsErrorName"><a href="MkCore.html#nonExhaustiveGuardsErrorName"><span class="hs-identifier">nonExhaustiveGuardsErrorName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a><span> </span><span class="hs-string">&quot;nonExhaustiveGuardsError&quot;</span><span>
</span><a name="line-699"></a><span>                                  </span><a href="PrelNames.html#nonExhaustiveGuardsErrorIdKey"><span class="hs-identifier hs-var">nonExhaustiveGuardsErrorIdKey</span></a><span> </span><a href="MkCore.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier hs-var">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a><span>
</span><a name="line-700"></a><span>
</span><a name="line-701"></a><span class="hs-identifier">err_nm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-702"></a><a name="err_nm"><a href="MkCore.html#err_nm"><span class="hs-identifier">err_nm</span></a></a><span> </span><a name="local-1627942293"><a href="#local-1627942293"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-1627942294"><a href="#local-1627942294"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-1627942295"><a href="#local-1627942295"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a><span> </span><a href="PrelNames.html#cONTROL_EXCEPTION_BASE"><span class="hs-identifier hs-var">cONTROL_EXCEPTION_BASE</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><a href="#local-1627942293"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627942294"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627942295"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-703"></a><span>
</span><a name="line-704"></a><span class="hs-identifier">rEC_SEL_ERROR_ID</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rUNTIME_ERROR_ID</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">iRREFUT_PAT_ERROR_ID</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rEC_CON_ERROR_ID</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-705"></a><span class="hs-identifier">pAT_ERROR_ID</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">nO_METHOD_BINDING_ERROR_ID</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-706"></a><span class="hs-identifier">tYPE_ERROR_ID</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-707"></a><span class="hs-identifier">aBSENT_ERROR_ID</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-708"></a><a name="rEC_SEL_ERROR_ID"><a href="MkCore.html#rEC_SEL_ERROR_ID"><span class="hs-identifier">rEC_SEL_ERROR_ID</span></a></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#recSelErrorName"><span class="hs-identifier hs-var">recSelErrorName</span></a><span>
</span><a name="line-709"></a><a name="rUNTIME_ERROR_ID"><a href="MkCore.html#rUNTIME_ERROR_ID"><span class="hs-identifier">rUNTIME_ERROR_ID</span></a></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#runtimeErrorName"><span class="hs-identifier hs-var">runtimeErrorName</span></a><span>
</span><a name="line-710"></a><a name="iRREFUT_PAT_ERROR_ID"><a href="MkCore.html#iRREFUT_PAT_ERROR_ID"><span class="hs-identifier">iRREFUT_PAT_ERROR_ID</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#irrefutPatErrorName"><span class="hs-identifier hs-var">irrefutPatErrorName</span></a><span>
</span><a name="line-711"></a><a name="rEC_CON_ERROR_ID"><a href="MkCore.html#rEC_CON_ERROR_ID"><span class="hs-identifier">rEC_CON_ERROR_ID</span></a></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#recConErrorName"><span class="hs-identifier hs-var">recConErrorName</span></a><span>
</span><a name="line-712"></a><a name="pAT_ERROR_ID"><a href="MkCore.html#pAT_ERROR_ID"><span class="hs-identifier">pAT_ERROR_ID</span></a></a><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#patErrorName"><span class="hs-identifier hs-var">patErrorName</span></a><span>
</span><a name="line-713"></a><a name="nO_METHOD_BINDING_ERROR_ID"><a href="MkCore.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier">nO_METHOD_BINDING_ERROR_ID</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#noMethodBindingErrorName"><span class="hs-identifier hs-var">noMethodBindingErrorName</span></a><span>
</span><a name="line-714"></a><a name="nON_EXHAUSTIVE_GUARDS_ERROR_ID"><a href="MkCore.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#nonExhaustiveGuardsErrorName"><span class="hs-identifier hs-var">nonExhaustiveGuardsErrorName</span></a><span>
</span><a name="line-715"></a><a name="aBSENT_ERROR_ID"><a href="MkCore.html#aBSENT_ERROR_ID"><span class="hs-identifier">aBSENT_ERROR_ID</span></a></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#absentErrorName"><span class="hs-identifier hs-var">absentErrorName</span></a><span>
</span><a name="line-716"></a><a name="tYPE_ERROR_ID"><a href="MkCore.html#tYPE_ERROR_ID"><span class="hs-identifier">tYPE_ERROR_ID</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a><span> </span><a href="MkCore.html#typeErrorName"><span class="hs-identifier hs-var">typeErrorName</span></a><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span class="hs-identifier">mkRuntimeErrorId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-719"></a><a name="mkRuntimeErrorId"><a href="MkCore.html#mkRuntimeErrorId"><span class="hs-identifier">mkRuntimeErrorId</span></a></a><span> </span><a name="local-1627942296"><a href="#local-1627942296"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkCore.html#pc_bottoming_Id1"><span class="hs-identifier hs-var">pc_bottoming_Id1</span></a><span> </span><a href="#local-1627942296"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="MkCore.html#runtimeErrorTy"><span class="hs-identifier hs-var">runtimeErrorTy</span></a><span>
</span><a name="line-720"></a><span>
</span><a name="line-721"></a><span class="hs-identifier">runtimeErrorTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-722"></a><span class="hs-comment">-- The runtime error Ids take a UTF8-encoded string as argument</span><span>
</span><a name="line-723"></a><a name="runtimeErrorTy"><a href="MkCore.html#runtimeErrorTy"><span class="hs-identifier">runtimeErrorTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><span class="hs-special">[</span><a href="TysPrim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TysPrim.html#openAlphaTyVar"><span class="hs-identifier hs-var">openAlphaTyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-724"></a><span>                               </span><span class="hs-special">(</span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span> </span><a href="TysPrim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-725"></a><span>
</span><a name="line-726"></a><span class="hs-comment">{-
Note [Error and friends have an &quot;open-tyvar&quot; forall]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
'error' and 'undefined' have types
        error     :: forall (v :: RuntimeRep) (a :: TYPE v). String -&gt; a
        undefined :: forall (v :: RuntimeRep) (a :: TYPE v). a
Notice the runtime-representation polymophism. This ensures that
&quot;error&quot; can be instantiated at unboxed as well as boxed types.
This is OK because it never returns, so the return type is irrelevant.


************************************************************************
*                                                                      *
\subsection{Utilities}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-743"></a><span>
</span><a name="line-744"></a><span class="hs-identifier">pc_bottoming_Id1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-745"></a><span class="hs-comment">-- Function of arity 1, which diverges after being given one argument</span><span>
</span><a name="line-746"></a><a name="pc_bottoming_Id1"><a href="MkCore.html#pc_bottoming_Id1"><span class="hs-identifier">pc_bottoming_Id1</span></a></a><span> </span><a name="local-1627942297"><a href="#local-1627942297"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1627942298"><a href="#local-1627942298"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-747"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkVanillaGlobalWithInfo"><span class="hs-identifier hs-var">mkVanillaGlobalWithInfo</span></a><span> </span><a href="#local-1627942297"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-1627942298"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627942299"><span class="hs-identifier hs-var">bottoming_info</span></a><span>
</span><a name="line-748"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-749"></a><span>    </span><a name="local-1627942299"><a href="#local-1627942299"><span class="hs-identifier">bottoming_info</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="IdInfo.html#vanillaIdInfo"><span class="hs-identifier hs-var">vanillaIdInfo</span></a><span> </span><span class="hs-special">`</span><a href="IdInfo.html#setStrictnessInfo"><span class="hs-identifier hs-var">setStrictnessInfo</span></a><span class="hs-special">`</span><span>    </span><a href="#local-1627942300"><span class="hs-identifier hs-var">strict_sig</span></a><span>
</span><a name="line-750"></a><span>                                   </span><span class="hs-special">`</span><a href="IdInfo.html#setArityInfo"><span class="hs-identifier hs-var">setArityInfo</span></a><span class="hs-special">`</span><span>         </span><span class="hs-number">1</span><span>
</span><a name="line-751"></a><span>                        </span><span class="hs-comment">-- Make arity and strictness agree</span><span>
</span><a name="line-752"></a><span>
</span><a name="line-753"></a><span>        </span><span class="hs-comment">-- Do *not* mark them as NoCafRefs, because they can indeed have</span><span>
</span><a name="line-754"></a><span>        </span><span class="hs-comment">-- CAF refs.  For example, pAT_ERROR_ID calls GHC.Err.untangle,</span><span>
</span><a name="line-755"></a><span>        </span><span class="hs-comment">-- which has some CAFs</span><span>
</span><a name="line-756"></a><span>        </span><span class="hs-comment">-- In due course we may arrange that these error-y things are</span><span>
</span><a name="line-757"></a><span>        </span><span class="hs-comment">-- regarded by the GC as permanently live, in which case we</span><span>
</span><a name="line-758"></a><span>        </span><span class="hs-comment">-- can give them NoCaf info.  As it is, any function that calls</span><span>
</span><a name="line-759"></a><span>        </span><span class="hs-comment">-- any pc_bottoming_Id will itself have CafRefs, which bloats</span><span>
</span><a name="line-760"></a><span>        </span><span class="hs-comment">-- SRTs.</span><span>
</span><a name="line-761"></a><span>
</span><a name="line-762"></a><span>    </span><a name="local-1627942300"><a href="#local-1627942300"><span class="hs-identifier">strict_sig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Demand.html#mkClosedStrictSig"><span class="hs-identifier hs-var">mkClosedStrictSig</span></a><span> </span><span class="hs-special">[</span><a href="Demand.html#evalDmd"><span class="hs-identifier hs-var">evalDmd</span></a><span class="hs-special">]</span><span> </span><a href="Demand.html#exnRes"><span class="hs-identifier hs-var">exnRes</span></a><span>
</span><a name="line-763"></a><span>              </span><span class="hs-comment">-- exnRes: these throw an exception, not just diverge</span><span>
</span><a name="line-764"></a></pre></body></html>