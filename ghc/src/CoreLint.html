<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1993-1998


A ``lint'' pass to check for Core correctness
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CoreLint</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-12"></a><span>    </span><a href="CoreLint.html#lintCoreBindings"><span class="hs-identifier hs-var">lintCoreBindings</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#lintUnfolding"><span class="hs-identifier hs-var">lintUnfolding</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>    </span><a href="CoreLint.html#lintPassResult"><span class="hs-identifier hs-var">lintPassResult</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#lintInteractiveExpr"><span class="hs-identifier hs-var">lintInteractiveExpr</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#lintExpr"><span class="hs-identifier hs-var">lintExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>    </span><a href="CoreLint.html#lintAnnots"><span class="hs-identifier hs-var">lintAnnots</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span>    </span><span class="hs-comment">-- ** Debug output</span><span>
</span><a name="line-17"></a><span>    </span><a href="CoreLint.html#showPass"><span class="hs-identifier hs-var">CoreLint</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">showPass</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#showPassIO"><span class="hs-identifier hs-var">showPassIO</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#endPass"><span class="hs-identifier hs-var">endPass</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#endPassIO"><span class="hs-identifier hs-var">endPassIO</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>    </span><a href="CoreLint.html#dumpPassResult"><span class="hs-identifier hs-var">dumpPassResult</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>    </span><a href="CoreLint.html#dumpIfSet"><span class="hs-identifier hs-var">CoreLint</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">dumpIfSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="CoreSyn.html"><span class="hs-identifier">CoreSyn</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="CoreFVs.html"><span class="hs-identifier">CoreFVs</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="CoreUtils.html"><span class="hs-identifier">CoreUtils</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="CoreStats.html"><span class="hs-identifier">CoreStats</span></a><span>   </span><span class="hs-special">(</span><span> </span><a href="CoreStats.html#coreBindsStats"><span class="hs-identifier hs-var">coreBindsStats</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="CoreMonad.html"><span class="hs-identifier">CoreMonad</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="Literal.html"><span class="hs-identifier">Literal</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TcType.html#isFloatingTy"><span class="hs-identifier hs-var">isFloatingTy</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="PprCore.html"><span class="hs-identifier">PprCore</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="ErrUtils.html"><span class="hs-identifier">ErrUtils</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="Kind.html"><span class="hs-identifier">Kind</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>       </span><span class="hs-comment">-- checks validity of types/coercions</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="CoAxiom.html"><span class="hs-identifier">CoAxiom</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="ErrUtils.html"><span class="hs-identifier">ErrUtils</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Err</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="StaticFlags.html"><span class="hs-identifier">StaticFlags</span></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="InstEnv.html"><span class="hs-identifier">InstEnv</span></a><span>     </span><span class="hs-special">(</span><span> </span><a href="InstEnv.html#instanceDFunId"><span class="hs-identifier hs-var">instanceDFunId</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="OptCoercion.html"><span class="hs-identifier">OptCoercion</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="OptCoercion.html#checkAxInstCo"><span class="hs-identifier hs-var">checkAxInstCo</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSupply.html"><span class="hs-identifier">UniqSupply</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="CoreArity.html"><span class="hs-identifier">CoreArity</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="CoreArity.html#typeArity"><span class="hs-identifier hs-var">typeArity</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Demand.html"><span class="hs-identifier">Demand</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Demand.html#splitStrictSig"><span class="hs-identifier hs-var">splitStrictSig</span></a><span class="hs-special">,</span><span> </span><a href="Demand.html#isBotRes"><span class="hs-identifier hs-var">isBotRes</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="HscTypes.html"><span class="hs-identifier">HscTypes</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>
</span><a name="line-65"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Fail</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">MonadFail</span><span>
</span><a name="line-67"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><a href="MonadUtils.html"><span class="hs-identifier">MonadUtils</span></a><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="Pair.html"><span class="hs-identifier">Pair</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">{-
Note [GHC Formalism]
~~~~~~~~~~~~~~~~~~~~
This file implements the type-checking algorithm for System FC, the &quot;official&quot;
name of the Core language. Type safety of FC is heart of the claim that
executables produced by GHC do not have segmentation faults. Thus, it is
useful to be able to reason about System FC independently of reading the code.
To this purpose, there is a document core-spec.pdf built in docs/core-spec that
contains a formalism of the types and functions dealt with here. If you change
just about anything in this file or you change other types/functions throughout
the Core language (all signposted to this note), you should update that
formalism. See docs/core-spec/README for more info about how to do so.

Note [check vs lint]
~~~~~~~~~~~~~~~~~~~~
This file implements both a type checking algorithm and also general sanity
checking. For example, the &quot;sanity checking&quot; checks for TyConApp on the left
of an AppTy, which should never happen. These sanity checks don't really
affect any notion of type soundness. Yet, it is convenient to do the sanity
checks at the same time as the type checks. So, we use the following naming
convention:

- Functions that begin with 'lint'... are involved in type checking. These
  functions might also do some sanity checking.

- Functions that begin with 'check'... are *not* involved in type checking.
  They exist only for sanity checking.

Issues surrounding variable naming, shadowing, and such are considered *not*
to be part of type checking, as the formalism omits these details.

Summary of checks
~~~~~~~~~~~~~~~~~
Checks that a set of core bindings is well-formed.  The PprStyle and String
just control what we print in the event of an error.  The Bool value
indicates whether we have done any specialisation yet (in which case we do
some extra checks).

We check for
        (a) type errors
        (b) Out-of-scope type variables
        (c) Out-of-scope local variables
        (d) Ill-kinded types
        (e) Incorrect unsafe coercions

If we have done specialisation the we check that there are
        (a) No top-level bindings of primitive (unboxed type)

Outstanding issues:

    -- Things are *not* OK if:
    --
    --  * Unsaturated type app before specialisation has been done;
    --
    --  * Oversaturated type app after specialisation (eta reduction
    --   may well be happening...);


Note [Linting type lets]
~~~~~~~~~~~~~~~~~~~~~~~~
In the desugarer, it's very very convenient to be able to say (in effect)
        let a = Type Int in &lt;body&gt;
That is, use a type let.   See Note [Type let] in CoreSyn.

However, when linting &lt;body&gt; we need to remember that a=Int, else we might
reject a correct program.  So we carry a type substitution (in this example
[a -&gt; Int]) and apply this substitution before comparing types.  The functin
        lintInTy :: Type -&gt; LintM (Type, Kind)
returns a substituted type.

When we encounter a binder (like x::a) we must apply the substitution
to the type of the binding variable.  lintBinders does this.

For Ids, the type-substituted Id is added to the in_scope set (which
itself is part of the TCvSubst we are carrying down), and when we
find an occurrence of an Id, we fetch it from the in-scope set.

Note [Bad unsafe coercion]
~~~~~~~~~~~~~~~~~~~~~~~~~~

For discussion see https://ghc.haskell.org/trac/ghc/wiki/BadUnsafeCoercions
Linter introduces additional rules that checks improper coercion between
different types, called bad coercions. Following coercions are forbidden:

  (a) coercions between boxed and unboxed values;
  (b) coercions between unlifted values of the different sizes, here
      active size is checked, i.e. size of the actual value but not
      the space allocated for value;
  (c) coercions between floating and integral boxed values, this check
      is not yet supported for unboxed tuples, as no semantics were
      specified for that;
  (d) coercions from / to vector type
  (e) If types are unboxed tuples then tuple (# A_1,..,A_n #) can be
      coerced to (# B_1,..,B_m #) if n=m and for each pair A_i, B_i rules
      (a-e) holds.

************************************************************************
*                                                                      *
                 Beginning and ending passes
*                                                                      *
************************************************************************

These functions are not CoreM monad stuff, but they probably ought to
be, and it makes a conveneint place.  place for them.  They print out
stuff before and after core passes, and do Core Lint when necessary.
-}</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-identifier">showPass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><a name="showPass"><a href="CoreLint.html#showPass"><span class="hs-identifier">showPass</span></a></a><span> </span><a name="local-1628078702"><a href="#local-1628078702"><span class="hs-identifier">pass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078703"><a href="#local-1628078703"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-181"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="CoreLint.html#showPassIO"><span class="hs-identifier hs-var">showPassIO</span></a><span> </span><a href="#local-1628078703"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078702"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">showPassIO</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-184"></a><a name="showPassIO"><a href="CoreLint.html#showPassIO"><span class="hs-identifier">showPassIO</span></a></a><span> </span><a name="local-1628078704"><a href="#local-1628078704"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628078705"><a href="#local-1628078705"><span class="hs-identifier">pass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ErrUtils.html#showPass"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">showPass</span></a><span> </span><a href="#local-1628078704"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#showPpr"><span class="hs-identifier hs-var">showPpr</span></a><span> </span><a href="#local-1628078704"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078705"><span class="hs-identifier hs-var">pass</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-identifier">endPass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-187"></a><a name="endPass"><a href="CoreLint.html#endPass"><span class="hs-identifier">endPass</span></a></a><span> </span><a name="local-1628078706"><a href="#local-1628078706"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1628078707"><a href="#local-1628078707"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-1628078708"><a href="#local-1628078708"><span class="hs-identifier">rules</span></a></a><span>
</span><a name="line-188"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078709"><a href="#local-1628078709"><span class="hs-identifier">hsc_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreMonad.html#getHscEnv"><span class="hs-identifier hs-var">getHscEnv</span></a><span>
</span><a name="line-189"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628078710"><a href="#local-1628078710"><span class="hs-identifier">print_unqual</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreMonad.html#getPrintUnqualified"><span class="hs-identifier hs-var">getPrintUnqualified</span></a><span>
</span><a name="line-190"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="CoreLint.html#endPassIO"><span class="hs-identifier hs-var">endPassIO</span></a><span> </span><a href="#local-1628078709"><span class="hs-identifier hs-var">hsc_env</span></a><span> </span><a href="#local-1628078710"><span class="hs-identifier hs-var">print_unqual</span></a><span> </span><a href="#local-1628078706"><span class="hs-identifier hs-var">pass</span></a><span> </span><a href="#local-1628078707"><span class="hs-identifier hs-var">binds</span></a><span> </span><a href="#local-1628078708"><span class="hs-identifier hs-var">rules</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-identifier">endPassIO</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#PrintUnqualified"><span class="hs-identifier hs-type">PrintUnqualified</span></a><span>
</span><a name="line-193"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- Used by the IO-is CorePrep too</span><span>
</span><a name="line-195"></a><a name="endPassIO"><a href="CoreLint.html#endPassIO"><span class="hs-identifier">endPassIO</span></a></a><span> </span><a name="local-1628078711"><a href="#local-1628078711"><span class="hs-identifier">hsc_env</span></a></a><span> </span><a name="local-1628078712"><a href="#local-1628078712"><span class="hs-identifier">print_unqual</span></a></a><span> </span><a name="local-1628078713"><a href="#local-1628078713"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1628078714"><a href="#local-1628078714"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-1628078715"><a href="#local-1628078715"><span class="hs-identifier">rules</span></a></a><span>
</span><a name="line-196"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#dumpPassResult"><span class="hs-identifier hs-var">dumpPassResult</span></a><span> </span><a href="#local-1628078716"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078712"><span class="hs-identifier hs-var">print_unqual</span></a><span> </span><a href="#local-1628078717"><span class="hs-identifier hs-var">mb_flag</span></a><span>
</span><a name="line-197"></a><span>                        </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078713"><span class="hs-identifier hs-var">pass</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreMonad.html#pprPassDetails"><span class="hs-identifier hs-var">pprPassDetails</span></a><span> </span><a href="#local-1628078713"><span class="hs-identifier hs-var">pass</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078714"><span class="hs-identifier hs-var">binds</span></a><span> </span><a href="#local-1628078715"><span class="hs-identifier hs-var">rules</span></a><span>
</span><a name="line-198"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintPassResult"><span class="hs-identifier hs-var">lintPassResult</span></a><span> </span><a href="#local-1628078711"><span class="hs-identifier hs-var">hsc_env</span></a><span> </span><a href="#local-1628078713"><span class="hs-identifier hs-var">pass</span></a><span> </span><a href="#local-1628078714"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-200"></a><span>    </span><a name="local-1628078716"><a href="#local-1628078716"><span class="hs-identifier">dflags</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsc_dflags</span><span> </span><a href="#local-1628078711"><span class="hs-identifier hs-var">hsc_env</span></a><span>
</span><a name="line-201"></a><span>    </span><a name="local-1628078717"><a href="#local-1628078717"><span class="hs-identifier">mb_flag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="CoreLint.html#coreDumpFlag"><span class="hs-identifier hs-var">coreDumpFlag</span></a><span> </span><a href="#local-1628078713"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-202"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628078718"><a href="#local-1628078718"><span class="hs-identifier">flag</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="DynFlags.html#dopt"><span class="hs-identifier hs-var">dopt</span></a><span> </span><a href="#local-1628078718"><span class="hs-identifier hs-var">flag</span></a><span> </span><a href="#local-1628078716"><span class="hs-identifier hs-var">dflags</span></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628078718"><span class="hs-identifier hs-var">flag</span></a><span>
</span><a name="line-203"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><a href="DynFlags.html#dopt"><span class="hs-identifier hs-var">dopt</span></a><span> </span><a href="DynFlags.html#Opt_D_verbose_core2core"><span class="hs-identifier hs-var">Opt_D_verbose_core2core</span></a><span> </span><a href="#local-1628078716"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628078718"><span class="hs-identifier hs-var">flag</span></a><span>
</span><a name="line-204"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-identifier">dumpIfSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-207"></a><a name="dumpIfSet"><a href="CoreLint.html#dumpIfSet"><span class="hs-identifier">dumpIfSet</span></a></a><span> </span><a name="local-1628078719"><a href="#local-1628078719"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628078720"><a href="#local-1628078720"><span class="hs-identifier">dump_me</span></a></a><span> </span><a name="local-1628078721"><a href="#local-1628078721"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1628078722"><a href="#local-1628078722"><span class="hs-identifier">extra_info</span></a></a><span> </span><a name="local-1628078723"><a href="#local-1628078723"><span class="hs-identifier">doc</span></a></a><span>
</span><a name="line-208"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="ErrUtils.html#dumpIfSet"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">dumpIfSet</span></a><span> </span><a href="#local-1628078719"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078720"><span class="hs-identifier hs-var">dump_me</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#showSDoc"><span class="hs-identifier hs-var">showSDoc</span></a><span> </span><a href="#local-1628078719"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078721"><span class="hs-identifier hs-var">pass</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628078722"><span class="hs-identifier hs-var">extra_info</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628078723"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-identifier">dumpPassResult</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-211"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#PrintUnqualified"><span class="hs-identifier hs-type">PrintUnqualified</span></a><span>
</span><a name="line-212"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="DynFlags.html#DumpFlag"><span class="hs-identifier hs-type">DumpFlag</span></a><span>        </span><span class="hs-comment">-- Just df =&gt; show details in a file whose</span><span>
</span><a name="line-213"></a><span>                                        </span><span class="hs-comment">--            name is specified by df</span><span>
</span><a name="line-214"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>                  </span><span class="hs-comment">-- Header</span><span>
</span><a name="line-215"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>                  </span><span class="hs-comment">-- Extra info to appear after header</span><span>
</span><a name="line-216"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a><span class="hs-special">]</span><span>
</span><a name="line-217"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><a name="dumpPassResult"><a href="CoreLint.html#dumpPassResult"><span class="hs-identifier">dumpPassResult</span></a></a><span> </span><a name="local-1628078724"><a href="#local-1628078724"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628078725"><a href="#local-1628078725"><span class="hs-identifier">unqual</span></a></a><span> </span><a name="local-1628078726"><a href="#local-1628078726"><span class="hs-identifier">mb_flag</span></a></a><span> </span><a name="local-1628078727"><a href="#local-1628078727"><span class="hs-identifier">hdr</span></a></a><span> </span><a name="local-1628078728"><a href="#local-1628078728"><span class="hs-identifier">extra_info</span></a></a><span> </span><a name="local-1628078729"><a href="#local-1628078729"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-1628078730"><a href="#local-1628078730"><span class="hs-identifier">rules</span></a></a><span>
</span><a name="line-219"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628078734"><a href="#local-1628078734"><span class="hs-identifier">flag</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628078726"><span class="hs-identifier hs-var">mb_flag</span></a><span>
</span><a name="line-220"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="ErrUtils.html#dumpSDoc"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">dumpSDoc</span></a><span> </span><a href="#local-1628078724"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078725"><span class="hs-identifier hs-var">unqual</span></a><span> </span><a href="#local-1628078734"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#showSDoc"><span class="hs-identifier hs-var">showSDoc</span></a><span> </span><a href="#local-1628078724"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078727"><span class="hs-identifier hs-var">hdr</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078732"><span class="hs-identifier hs-var">dump_doc</span></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-223"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="ErrUtils.html#debugTraceMsg"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">debugTraceMsg</span></a><span> </span><a href="#local-1628078724"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-1628078731"><span class="hs-identifier hs-var">size_doc</span></a><span>
</span><a name="line-224"></a><span>          </span><span class="hs-comment">-- Report result size</span><span>
</span><a name="line-225"></a><span>          </span><span class="hs-comment">-- This has the side effect of forcing the intermediate to be evaluated</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-228"></a><span>    </span><a name="local-1628078731"><a href="#local-1628078731"><span class="hs-identifier">size_doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Result size of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628078727"><span class="hs-identifier hs-var">hdr</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="CoreStats.html#coreBindsStats"><span class="hs-identifier hs-var">coreBindsStats</span></a><span> </span><a href="#local-1628078729"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span>    </span><a name="local-1628078732"><a href="#local-1628078732"><span class="hs-identifier">dump_doc</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-1628078728"><span class="hs-identifier hs-var">extra_info</span></a><span>
</span><a name="line-231"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="#local-1628078731"><span class="hs-identifier hs-var">size_doc</span></a><span>
</span><a name="line-232"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#blankLine"><span class="hs-identifier hs-var">blankLine</span></a><span>
</span><a name="line-233"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="PprCore.html#pprCoreBindingsWithSize"><span class="hs-identifier hs-var">pprCoreBindingsWithSize</span></a><span> </span><a href="#local-1628078729"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-234"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628078730"><span class="hs-identifier hs-var">rules</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078733"><span class="hs-identifier hs-var">pp_rules</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-235"></a><span>    </span><a name="local-1628078733"><a href="#local-1628078733"><span class="hs-identifier">pp_rules</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#blankLine"><span class="hs-identifier hs-var">blankLine</span></a><span>
</span><a name="line-236"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;------ Local rules for imported ids --------&quot;</span><span>
</span><a name="line-237"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="PprCore.html#pprRules"><span class="hs-identifier hs-var">pprRules</span></a><span> </span><a href="#local-1628078730"><span class="hs-identifier hs-var">rules</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="DynFlags.html#DumpFlag"><span class="hs-identifier hs-type">DumpFlag</span></a><span>
</span><a name="line-240"></a><a name="coreDumpFlag"><a href="CoreLint.html#coreDumpFlag"><span class="hs-identifier">coreDumpFlag</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreMonad.html#CoreDoSimplify"><span class="hs-identifier hs-var">CoreDoSimplify</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_verbose_core2core"><span class="hs-identifier hs-var">Opt_D_verbose_core2core</span></a><span>
</span><a name="line-241"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><span class="hs-special">(</span><a href="CoreMonad.html#CoreDoPluginPass"><span class="hs-identifier hs-var">CoreDoPluginPass</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_verbose_core2core"><span class="hs-identifier hs-var">Opt_D_verbose_core2core</span></a><span>
</span><a name="line-242"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoFloatInwards"><span class="hs-identifier hs-var">CoreDoFloatInwards</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_verbose_core2core"><span class="hs-identifier hs-var">Opt_D_verbose_core2core</span></a><span>
</span><a name="line-243"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><span class="hs-special">(</span><a href="CoreMonad.html#CoreDoFloatOutwards"><span class="hs-identifier hs-var">CoreDoFloatOutwards</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_verbose_core2core"><span class="hs-identifier hs-var">Opt_D_verbose_core2core</span></a><span>
</span><a name="line-244"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreLiberateCase"><span class="hs-identifier hs-var">CoreLiberateCase</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_verbose_core2core"><span class="hs-identifier hs-var">Opt_D_verbose_core2core</span></a><span>
</span><a name="line-245"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoStaticArgs"><span class="hs-identifier hs-var">CoreDoStaticArgs</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_verbose_core2core"><span class="hs-identifier hs-var">Opt_D_verbose_core2core</span></a><span>
</span><a name="line-246"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoCallArity"><span class="hs-identifier hs-var">CoreDoCallArity</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_call_arity"><span class="hs-identifier hs-var">Opt_D_dump_call_arity</span></a><span>
</span><a name="line-247"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoStrictness"><span class="hs-identifier hs-var">CoreDoStrictness</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_stranal"><span class="hs-identifier hs-var">Opt_D_dump_stranal</span></a><span>
</span><a name="line-248"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoWorkerWrapper"><span class="hs-identifier hs-var">CoreDoWorkerWrapper</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_worker_wrapper"><span class="hs-identifier hs-var">Opt_D_dump_worker_wrapper</span></a><span>
</span><a name="line-249"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoSpecialising"><span class="hs-identifier hs-var">CoreDoSpecialising</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_spec"><span class="hs-identifier hs-var">Opt_D_dump_spec</span></a><span>
</span><a name="line-250"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoSpecConstr"><span class="hs-identifier hs-var">CoreDoSpecConstr</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_spec"><span class="hs-identifier hs-var">Opt_D_dump_spec</span></a><span>
</span><a name="line-251"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreCSE"><span class="hs-identifier hs-var">CoreCSE</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_cse"><span class="hs-identifier hs-var">Opt_D_dump_cse</span></a><span>
</span><a name="line-252"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoVectorisation"><span class="hs-identifier hs-var">CoreDoVectorisation</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_vect"><span class="hs-identifier hs-var">Opt_D_dump_vect</span></a><span>
</span><a name="line-253"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDesugar"><span class="hs-identifier hs-var">CoreDesugar</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_ds"><span class="hs-identifier hs-var">Opt_D_dump_ds</span></a><span>
</span><a name="line-254"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDesugarOpt"><span class="hs-identifier hs-var">CoreDesugarOpt</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_ds"><span class="hs-identifier hs-var">Opt_D_dump_ds</span></a><span>
</span><a name="line-255"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreTidy"><span class="hs-identifier hs-var">CoreTidy</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_simpl"><span class="hs-identifier hs-var">Opt_D_dump_simpl</span></a><span>
</span><a name="line-256"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CorePrep"><span class="hs-identifier hs-var">CorePrep</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_D_dump_prep"><span class="hs-identifier hs-var">Opt_D_dump_prep</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoPrintCore"><span class="hs-identifier hs-var">CoreDoPrintCore</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-259"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><span class="hs-special">(</span><a href="CoreMonad.html#CoreDoRuleCheck"><span class="hs-identifier hs-var">CoreDoRuleCheck</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-260"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><a href="CoreMonad.html#CoreDoNothing"><span class="hs-identifier hs-var">CoreDoNothing</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-261"></a><span class="hs-identifier">coreDumpFlag</span><span> </span><span class="hs-special">(</span><a href="CoreMonad.html#CoreDoPasses"><span class="hs-identifier hs-var">CoreDoPasses</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                 Top-level interfaces
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-identifier">lintPassResult</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-272"></a><a name="lintPassResult"><a href="CoreLint.html#lintPassResult"><span class="hs-identifier">lintPassResult</span></a></a><span> </span><a name="local-1628078735"><a href="#local-1628078735"><span class="hs-identifier">hsc_env</span></a></a><span> </span><a name="local-1628078736"><a href="#local-1628078736"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1628078737"><a href="#local-1628078737"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-273"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_DoCoreLinting"><span class="hs-identifier hs-var">Opt_DoCoreLinting</span></a><span> </span><a href="#local-1628078738"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-276"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628078739"><a href="#local-1628078739"><span class="hs-identifier">warns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078740"><a href="#local-1628078740"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintCoreBindings"><span class="hs-identifier hs-var">lintCoreBindings</span></a><span> </span><a href="#local-1628078738"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078736"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#interactiveInScope"><span class="hs-identifier hs-var">interactiveInScope</span></a><span> </span><a href="#local-1628078735"><span class="hs-identifier hs-var">hsc_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078737"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-277"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="ErrUtils.html#showPass"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">showPass</span></a><span> </span><a href="#local-1628078738"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Core Linted result of &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="Outputable.html#showPpr"><span class="hs-identifier hs-var">showPpr</span></a><span> </span><a href="#local-1628078738"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078736"><span class="hs-identifier hs-var">pass</span></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#displayLintResults"><span class="hs-identifier hs-var">displayLintResults</span></a><span> </span><a href="#local-1628078738"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078736"><span class="hs-identifier hs-var">pass</span></a><span> </span><a href="#local-1628078739"><span class="hs-identifier hs-var">warns</span></a><span> </span><a href="#local-1628078740"><span class="hs-identifier hs-var">errs</span></a><span> </span><a href="#local-1628078737"><span class="hs-identifier hs-var">binds</span></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-280"></a><span>    </span><a name="local-1628078738"><a href="#local-1628078738"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsc_dflags</span><span> </span><a href="#local-1628078735"><span class="hs-identifier hs-var">hsc_env</span></a><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-identifier">displayLintResults</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span>
</span><a name="line-283"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">Err</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">Err</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a><span>
</span><a name="line-284"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-285"></a><a name="displayLintResults"><a href="CoreLint.html#displayLintResults"><span class="hs-identifier">displayLintResults</span></a></a><span> </span><a name="local-1628078741"><a href="#local-1628078741"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628078742"><a href="#local-1628078742"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1628078743"><a href="#local-1628078743"><span class="hs-identifier">warns</span></a></a><span> </span><a name="local-1628078744"><a href="#local-1628078744"><span class="hs-identifier">errs</span></a></a><span> </span><a name="local-1628078745"><a href="#local-1628078745"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-286"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-1628078744"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">log_action</span><span> </span><a href="#local-1628078741"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078741"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="DynFlags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a><span> </span><a href="ErrUtils.html#SevDump"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">SevDump</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><a href="Outputable.html#defaultDumpStyle"><span class="hs-identifier hs-var">defaultDumpStyle</span></a><span>
</span><a name="line-288"></a><span>           </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="CoreLint.html#lint_banner"><span class="hs-identifier hs-var">lint_banner</span></a><span> </span><span class="hs-string">&quot;errors&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078742"><span class="hs-identifier hs-var">pass</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="ErrUtils.html#pprMessageBag"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pprMessageBag</span></a><span> </span><a href="#local-1628078744"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-289"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;*** Offending Program ***&quot;</span><span>
</span><a name="line-290"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="PprCore.html#pprCoreBindings"><span class="hs-identifier hs-var">pprCoreBindings</span></a><span> </span><a href="#local-1628078745"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-291"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;*** End of Offense ***&quot;</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="ErrUtils.html#ghcExit"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ghcExit</span></a><span> </span><a href="#local-1628078741"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-1628078743"><span class="hs-identifier hs-var">warns</span></a><span class="hs-special">)</span><span>
</span><a name="line-295"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="StaticFlags.html#opt_NoDebugOutput"><span class="hs-identifier hs-var">opt_NoDebugOutput</span></a><span>
</span><a name="line-296"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="CoreLint.html#showLintWarnings"><span class="hs-identifier hs-var">showLintWarnings</span></a><span> </span><a href="#local-1628078742"><span class="hs-identifier hs-var">pass</span></a><span>
</span><a name="line-297"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">log_action</span><span> </span><a href="#local-1628078741"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078741"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="DynFlags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a><span> </span><a href="ErrUtils.html#SevDump"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">SevDump</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><a href="Outputable.html#defaultDumpStyle"><span class="hs-identifier hs-var">defaultDumpStyle</span></a><span>
</span><a name="line-298"></a><span>        </span><span class="hs-special">(</span><a href="CoreLint.html#lint_banner"><span class="hs-identifier hs-var">lint_banner</span></a><span> </span><span class="hs-string">&quot;warnings&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078742"><span class="hs-identifier hs-var">pass</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="ErrUtils.html#pprMessageBag"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pprMessageBag</span></a><span> </span><a href="#local-1628078743"><span class="hs-identifier hs-var">warns</span></a><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-identifier">lint_banner</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-304"></a><a name="lint_banner"><a href="CoreLint.html#lint_banner"><span class="hs-identifier">lint_banner</span></a></a><span> </span><a name="local-1628078746"><a href="#local-1628078746"><span class="hs-identifier">string</span></a></a><span> </span><a name="local-1628078747"><a href="#local-1628078747"><span class="hs-identifier">pass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;*** Core Lint&quot;</span><span>      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628078746"><span class="hs-identifier hs-var">string</span></a><span>
</span><a name="line-305"></a><span>                          </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;: in result of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628078747"><span class="hs-identifier hs-var">pass</span></a><span>
</span><a name="line-306"></a><span>                          </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;***&quot;</span><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><span class="hs-identifier">showLintWarnings</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-309"></a><span class="hs-comment">-- Disable Lint warnings on the first simplifier pass, because</span><span>
</span><a name="line-310"></a><span class="hs-comment">-- there may be some INLINE knots still tied, which is tiresomely noisy</span><span>
</span><a name="line-311"></a><a name="showLintWarnings"><a href="CoreLint.html#showLintWarnings"><span class="hs-identifier">showLintWarnings</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreMonad.html#CoreDoSimplify"><span class="hs-identifier hs-var">CoreDoSimplify</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CoreMonad.html#SimplMode"><span class="hs-identifier hs-var">SimplMode</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sm_phase</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#InitialPhase"><span class="hs-identifier hs-var">InitialPhase</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-312"></a><span class="hs-identifier">showLintWarnings</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-identifier">lintInteractiveExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HscTypes.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-315"></a><a name="lintInteractiveExpr"><a href="CoreLint.html#lintInteractiveExpr"><span class="hs-identifier">lintInteractiveExpr</span></a></a><span> </span><a name="local-1628078748"><a href="#local-1628078748"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-1628078749"><a href="#local-1628078749"><span class="hs-identifier">hsc_env</span></a></a><span> </span><a name="local-1628078750"><a href="#local-1628078750"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-316"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_DoCoreLinting"><span class="hs-identifier hs-var">Opt_DoCoreLinting</span></a><span> </span><a href="#local-1628078751"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-317"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628078754"><a href="#local-1628078754"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintExpr"><span class="hs-identifier hs-var">lintExpr</span></a><span> </span><a href="#local-1628078751"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#interactiveInScope"><span class="hs-identifier hs-var">interactiveInScope</span></a><span> </span><a href="#local-1628078749"><span class="hs-identifier hs-var">hsc_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078750"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-319"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="#local-1628078752"><span class="hs-identifier hs-var">display_lint_err</span></a><span> </span><a href="#local-1628078754"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-320"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="ErrUtils.html#ghcExit"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ghcExit</span></a><span> </span><a href="#local-1628078751"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-321"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-322"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-323"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-324"></a><span>    </span><a name="local-1628078751"><a href="#local-1628078751"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsc_dflags</span><span> </span><a href="#local-1628078749"><span class="hs-identifier hs-var">hsc_env</span></a><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span>    </span><a name="local-1628078752"><a href="#local-1628078752"><span class="hs-identifier">display_lint_err</span></a></a><span> </span><a name="local-1628078753"><a href="#local-1628078753"><span class="hs-identifier">err</span></a></a><span>
</span><a name="line-327"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">log_action</span><span> </span><a href="#local-1628078751"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078751"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="DynFlags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a><span> </span><a href="ErrUtils.html#SevDump"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">SevDump</span></a><span>
</span><a name="line-328"></a><span>               </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><a href="Outputable.html#defaultDumpStyle"><span class="hs-identifier hs-var">defaultDumpStyle</span></a><span>
</span><a name="line-329"></a><span>               </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="CoreLint.html#lint_banner"><span class="hs-identifier hs-var">lint_banner</span></a><span> </span><span class="hs-string">&quot;errors&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628078748"><span class="hs-identifier hs-var">what</span></a><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="#local-1628078753"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-331"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;*** Offending Program ***&quot;</span><span>
</span><a name="line-332"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="PprCore.html#pprCoreExpr"><span class="hs-identifier hs-var">pprCoreExpr</span></a><span> </span><a href="#local-1628078750"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-333"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;*** End of Offense ***&quot;</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="ErrUtils.html#ghcExit"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ghcExit</span></a><span> </span><a href="#local-1628078751"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-identifier">interactiveInScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span>
</span><a name="line-337"></a><span class="hs-comment">-- In GHCi we may lint expressions, or bindings arising from 'deriving'</span><span>
</span><a name="line-338"></a><span class="hs-comment">-- clauses, that mention variables bound in the interactive context.</span><span>
</span><a name="line-339"></a><span class="hs-comment">-- These are Local things (see Note [Interactively-bound Ids in GHCi] in HscTypes).</span><span>
</span><a name="line-340"></a><span class="hs-comment">-- So we have to tell Lint about them, lest it reports them as out of scope.</span><span>
</span><a name="line-341"></a><span class="hs-comment">--</span><span>
</span><a name="line-342"></a><span class="hs-comment">-- We do this by find local-named things that may appear free in interactive</span><span>
</span><a name="line-343"></a><span class="hs-comment">-- context.  This function is pretty revolting and quite possibly not quite right.</span><span>
</span><a name="line-344"></a><span class="hs-comment">-- When we are not in GHCi, the interactive context (hsc_IC hsc_env) is empty</span><span>
</span><a name="line-345"></a><span class="hs-comment">-- so this is a (cheap) no-op.</span><span>
</span><a name="line-346"></a><span class="hs-comment">--</span><span>
</span><a name="line-347"></a><span class="hs-comment">-- See Trac #8215 for an example</span><span>
</span><a name="line-348"></a><a name="interactiveInScope"><a href="CoreLint.html#interactiveInScope"><span class="hs-identifier">interactiveInScope</span></a></a><span> </span><a name="local-1628078755"><a href="#local-1628078755"><span class="hs-identifier">hsc_env</span></a></a><span>
</span><a name="line-349"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#varSetElems"><span class="hs-identifier hs-var">varSetElems</span></a><span> </span><a href="#local-1628078762"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628078761"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-350"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-351"></a><span>    </span><span class="hs-comment">-- C.f. TcRnDriver.setInteractiveContext, Desugar.deSugarExpr</span><span>
</span><a name="line-352"></a><span>    </span><a name="local-1628078756"><a href="#local-1628078756"><span class="hs-identifier">ictxt</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsc_IC</span><span> </span><a href="#local-1628078755"><span class="hs-identifier hs-var">hsc_env</span></a><span>
</span><a name="line-353"></a><span>    </span><span class="hs-special">(</span><a name="local-1628078757"><a href="#local-1628078757"><span class="hs-identifier">cls_insts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078758"><a href="#local-1628078758"><span class="hs-identifier">_fam_insts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ic_instances</span><span> </span><a href="#local-1628078756"><span class="hs-identifier hs-var">ictxt</span></a><span>
</span><a name="line-354"></a><span>    </span><a name="local-1628078759"><a href="#local-1628078759"><span class="hs-identifier">te1</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HscTypes.html#mkTypeEnvWithImplicits"><span class="hs-identifier hs-var">mkTypeEnvWithImplicits</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ic_tythings</span><span> </span><a href="#local-1628078756"><span class="hs-identifier hs-var">ictxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>    </span><a name="local-1628078760"><a href="#local-1628078760"><span class="hs-identifier">te</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HscTypes.html#extendTypeEnvWithIds"><span class="hs-identifier hs-var">extendTypeEnvWithIds</span></a><span> </span><a href="#local-1628078759"><span class="hs-identifier hs-var">te1</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="InstEnv.html#instanceDFunId"><span class="hs-identifier hs-var">instanceDFunId</span></a><span> </span><a href="#local-1628078757"><span class="hs-identifier hs-var">cls_insts</span></a><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>    </span><a name="local-1628078761"><a href="#local-1628078761"><span class="hs-identifier">ids</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HscTypes.html#typeEnvIds"><span class="hs-identifier hs-var">typeEnvIds</span></a><span> </span><a href="#local-1628078760"><span class="hs-identifier hs-var">te</span></a><span>
</span><a name="line-357"></a><span>    </span><a name="local-1628078762"><a href="#local-1628078762"><span class="hs-identifier">tyvars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#mapUnionVarSet"><span class="hs-identifier hs-var">mapUnionVarSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078761"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-358"></a><span>              </span><span class="hs-comment">-- Why the type variables?  How can the top level envt have free tyvars?</span><span>
</span><a name="line-359"></a><span>              </span><span class="hs-comment">-- I think it's because of the GHCi debugger, which can bind variables</span><span>
</span><a name="line-360"></a><span>              </span><span class="hs-comment">--   f :: [t] -&gt; [t]</span><span>
</span><a name="line-361"></a><span>              </span><span class="hs-comment">-- where t is a RuntimeUnk (see TcType)</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-identifier">lintCoreBindings</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreToDo"><span class="hs-identifier hs-type">CoreToDo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-364"></a><span class="hs-comment">--   Returns (warnings, errors)</span><span>
</span><a name="line-365"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-366"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-367"></a><a name="lintCoreBindings"><a href="CoreLint.html#lintCoreBindings"><span class="hs-identifier">lintCoreBindings</span></a></a><span> </span><a name="local-1628078763"><a href="#local-1628078763"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628078764"><a href="#local-1628078764"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1628078765"><a href="#local-1628078765"><span class="hs-identifier">local_in_scope</span></a></a><span> </span><a name="local-1628078766"><a href="#local-1628078766"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-368"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#initL"><span class="hs-identifier hs-var">initL</span></a><span> </span><a href="#local-1628078763"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628078767"><span class="hs-identifier hs-var">flags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-369"></a><span>    </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><a href="CoreLint.html#TopLevelBindings"><span class="hs-identifier hs-var">TopLevelBindings</span></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-370"></a><span>    </span><a href="CoreLint.html#addInScopeVars"><span class="hs-identifier hs-var">addInScopeVars</span></a><span> </span><a href="#local-1628078765"><span class="hs-identifier hs-var">local_in_scope</span></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-371"></a><span>    </span><a href="CoreLint.html#addInScopeVars"><span class="hs-identifier hs-var">addInScopeVars</span></a><span> </span><a href="#local-1628078770"><span class="hs-identifier hs-var">binders</span></a><span>         </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-372"></a><span>        </span><span class="hs-comment">-- Put all the top-level binders in scope at the start</span><span>
</span><a name="line-373"></a><span>        </span><span class="hs-comment">-- This is because transformation rules can bring something</span><span>
</span><a name="line-374"></a><span>        </span><span class="hs-comment">-- into use 'unexpectedly'</span><span>
</span><a name="line-375"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628078771"><span class="hs-identifier hs-var">dups</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#dupVars"><span class="hs-identifier hs-var">dupVars</span></a><span> </span><a href="#local-1628078771"><span class="hs-identifier hs-var">dups</span></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628078772"><span class="hs-identifier hs-var">ext_dups</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#dupExtVars"><span class="hs-identifier hs-var">dupExtVars</span></a><span> </span><a href="#local-1628078772"><span class="hs-identifier hs-var">ext_dups</span></a><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628078774"><span class="hs-identifier hs-var">lint_bind</span></a><span> </span><a href="#local-1628078766"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-378"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-379"></a><span>    </span><a name="local-1628078767"><a href="#local-1628078767"><span class="hs-identifier">flags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LF"><span class="hs-identifier hs-var">LF</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lf_check_global_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628078768"><span class="hs-identifier hs-var">check_globals</span></a><span>
</span><a name="line-380"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lf_check_inline_loop_breakers</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628078769"><span class="hs-identifier hs-var">check_lbs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span>    </span><span class="hs-comment">-- See Note [Checking for global Ids]</span><span>
</span><a name="line-383"></a><span>    </span><a name="local-1628078768"><a href="#local-1628078768"><span class="hs-identifier">check_globals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628078764"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-384"></a><span>                      </span><a href="CoreMonad.html#CoreTidy"><span class="hs-identifier hs-var">CoreTidy</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-385"></a><span>                      </span><a href="CoreMonad.html#CorePrep"><span class="hs-identifier hs-var">CorePrep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-386"></a><span>                      </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span>    </span><span class="hs-comment">-- See Note [Checking for INLINE loop breakers]</span><span>
</span><a name="line-389"></a><span>    </span><a name="local-1628078769"><a href="#local-1628078769"><span class="hs-identifier">check_lbs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628078764"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-390"></a><span>                      </span><a href="CoreMonad.html#CoreDesugar"><span class="hs-identifier hs-var">CoreDesugar</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-391"></a><span>                      </span><a href="CoreMonad.html#CoreDesugarOpt"><span class="hs-identifier hs-var">CoreDesugarOpt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-392"></a><span>                      </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span>    </span><a name="local-1628078770"><a href="#local-1628078770"><span class="hs-identifier">binders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#bindersOfBinds"><span class="hs-identifier hs-var">bindersOfBinds</span></a><span> </span><a href="#local-1628078766"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-395"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628078771"><a href="#local-1628078771"><span class="hs-identifier">dups</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-1628078770"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span>    </span><span class="hs-comment">-- dups_ext checks for names with different uniques</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-comment">-- but but the same External name M.n.  We don't</span><span>
</span><a name="line-399"></a><span>    </span><span class="hs-comment">-- allow this at top level:</span><span>
</span><a name="line-400"></a><span>    </span><span class="hs-comment">--    M.n{r3}  = ...</span><span>
</span><a name="line-401"></a><span>    </span><span class="hs-comment">--    M.n{r29} = ...</span><span>
</span><a name="line-402"></a><span>    </span><span class="hs-comment">-- because they both get the same linker symbol</span><span>
</span><a name="line-403"></a><span>    </span><a name="local-1628078772"><a href="#local-1628078772"><span class="hs-identifier">ext_dups</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><span class="hs-special">(</span><a href="ListSetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a><span> </span><a href="#local-1628078773"><span class="hs-identifier hs-var">ord_ext</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-identifier">Var</span><span class="hs-operator">.</span><span class="hs-identifier">varName</span><span> </span><a href="#local-1628078770"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>    </span><a name="local-1628078773"><a href="#local-1628078773"><span class="hs-identifier">ord_ext</span></a></a><span> </span><a name="local-1628078775"><a href="#local-1628078775"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-1628078776"><a href="#local-1628078776"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628078777"><a href="#local-1628078777"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-1628078775"><span class="hs-identifier hs-var">n1</span></a><span>
</span><a name="line-405"></a><span>                  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628078778"><a href="#local-1628078778"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-1628078776"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-406"></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><a href="#local-1628078777"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628078775"><span class="hs-identifier hs-var">n1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628078778"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628078776"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span>    </span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-410"></a><span>    </span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-411"></a><span>    </span><a name="local-1628078774"><a href="#local-1628078774"><span class="hs-identifier">lint_bind</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><a name="local-1628078779"><a href="#local-1628078779"><span class="hs-identifier">prs</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#lintSingleBinding"><span class="hs-identifier hs-var">lintSingleBinding</span></a><span> </span><a href="BasicTypes.html#TopLevel"><span class="hs-identifier hs-var">TopLevel</span></a><span> </span><a href="BasicTypes.html#Recursive"><span class="hs-identifier hs-var">Recursive</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078779"><span class="hs-identifier hs-var">prs</span></a><span>
</span><a name="line-412"></a><span>    </span><span class="hs-identifier">lint_bind</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-1628078780"><a href="#local-1628078780"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1628078781"><a href="#local-1628078781"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintSingleBinding"><span class="hs-identifier hs-var">lintSingleBinding</span></a><span> </span><a href="BasicTypes.html#TopLevel"><span class="hs-identifier hs-var">TopLevel</span></a><span> </span><a href="BasicTypes.html#NonRecursive"><span class="hs-identifier hs-var">NonRecursive</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078780"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">,</span><a href="#local-1628078781"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lintUnfolding]{lintUnfolding}
*                                                                      *
************************************************************************

We use this to check all unfoldings that come in from interfaces
(it is very painful to catch errors otherwise):
-}</span><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span class="hs-identifier">lintUnfolding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-426"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a><span>
</span><a name="line-427"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- Treat these as in scope</span><span>
</span><a name="line-428"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-429"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>   </span><span class="hs-comment">-- Nothing =&gt; OK</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><a name="lintUnfolding"><a href="CoreLint.html#lintUnfolding"><span class="hs-identifier">lintUnfolding</span></a></a><span> </span><a name="local-1628078782"><a href="#local-1628078782"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628078783"><a href="#local-1628078783"><span class="hs-identifier">locn</span></a></a><span> </span><a name="local-1628078784"><a href="#local-1628078784"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1628078785"><a href="#local-1628078785"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-432"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-1628078787"><span class="hs-identifier hs-var">errs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-433"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="ErrUtils.html#pprMessageBag"><span class="hs-identifier hs-var">pprMessageBag</span></a><span> </span><a href="#local-1628078787"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-435"></a><span>    </span><span class="hs-special">(</span><a name="local-1628078786"><a href="#local-1628078786"><span class="hs-identifier">_warns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078787"><a href="#local-1628078787"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#initL"><span class="hs-identifier hs-var">initL</span></a><span> </span><a href="#local-1628078782"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="CoreLint.html#defaultLintFlags"><span class="hs-identifier hs-var">defaultLintFlags</span></a><span> </span><a href="#local-1628078788"><span class="hs-identifier hs-var">linter</span></a><span>
</span><a name="line-436"></a><span>    </span><a name="local-1628078788"><a href="#local-1628078788"><span class="hs-identifier">linter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#ImportedUnfolding"><span class="hs-identifier hs-var">ImportedUnfolding</span></a><span> </span><a href="#local-1628078783"><span class="hs-identifier hs-var">locn</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-437"></a><span>             </span><a href="CoreLint.html#addInScopeVars"><span class="hs-identifier hs-var">addInScopeVars</span></a><span> </span><a href="#local-1628078784"><span class="hs-identifier hs-var">vars</span></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-438"></a><span>             </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078785"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-identifier">lintExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-441"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span>               </span><span class="hs-comment">-- Treat these as in scope</span><span>
</span><a name="line-442"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-443"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>        </span><span class="hs-comment">-- Nothing =&gt; OK</span><span>
</span><a name="line-444"></a><span>
</span><a name="line-445"></a><a name="lintExpr"><a href="CoreLint.html#lintExpr"><span class="hs-identifier">lintExpr</span></a></a><span> </span><a name="local-1628078789"><a href="#local-1628078789"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628078790"><a href="#local-1628078790"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1628078791"><a href="#local-1628078791"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-446"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-1628078793"><span class="hs-identifier hs-var">errs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-447"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="ErrUtils.html#pprMessageBag"><span class="hs-identifier hs-var">pprMessageBag</span></a><span> </span><a href="#local-1628078793"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-449"></a><span>    </span><span class="hs-special">(</span><a name="local-1628078792"><a href="#local-1628078792"><span class="hs-identifier">_warns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078793"><a href="#local-1628078793"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#initL"><span class="hs-identifier hs-var">initL</span></a><span> </span><a href="#local-1628078789"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="CoreLint.html#defaultLintFlags"><span class="hs-identifier hs-var">defaultLintFlags</span></a><span> </span><a href="#local-1628078794"><span class="hs-identifier hs-var">linter</span></a><span>
</span><a name="line-450"></a><span>    </span><a name="local-1628078794"><a href="#local-1628078794"><span class="hs-identifier">linter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><a href="CoreLint.html#TopLevelBindings"><span class="hs-identifier hs-var">TopLevelBindings</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-451"></a><span>             </span><a href="CoreLint.html#addInScopeVars"><span class="hs-identifier hs-var">addInScopeVars</span></a><span> </span><a href="#local-1628078790"><span class="hs-identifier hs-var">vars</span></a><span>     </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-452"></a><span>             </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078791"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lintCoreBinding]{lintCoreBinding}
*                                                                      *
************************************************************************

Check a core binding, returning the list of variables bound.
-}</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span class="hs-identifier">lintSingleBinding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-466"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-467"></a><a name="lintSingleBinding"><a href="CoreLint.html#lintSingleBinding"><span class="hs-identifier">lintSingleBinding</span></a></a><span> </span><a name="local-1628078795"><a href="#local-1628078795"><span class="hs-identifier">top_lvl_flag</span></a></a><span> </span><a name="local-1628078796"><a href="#local-1628078796"><span class="hs-identifier">rec_flag</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628078797"><a href="#local-1628078797"><span class="hs-identifier">binder</span></a></a><span class="hs-special">,</span><a name="local-1628078798"><a href="#local-1628078798"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#RhsOf"><span class="hs-identifier hs-var">RhsOf</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-469"></a><span>         </span><span class="hs-comment">-- Check the rhs</span><span>
</span><a name="line-470"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078801"><a href="#local-1628078801"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078798"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-471"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="#local-1628078799"><span class="hs-identifier hs-var">lintBinder</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span> </span><span class="hs-comment">-- Check match to RHS type</span><span>
</span><a name="line-472"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628078802"><a href="#local-1628078802"><span class="hs-identifier">binder_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#applySubstTy"><span class="hs-identifier hs-var">applySubstTy</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-473"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078802"><span class="hs-identifier hs-var">binder_ty</span></a><span> </span><a href="#local-1628078801"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkRhsMsg"><span class="hs-identifier hs-var">mkRhsMsg</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RHS&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628078801"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span>        </span><span class="hs-comment">-- Check the let/app invariant</span><span>
</span><a name="line-476"></a><span>        </span><span class="hs-comment">-- See Note [CoreSyn let/app invariant] in CoreSyn</span><span>
</span><a name="line-477"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1628078802"><span class="hs-identifier hs-var">binder_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-478"></a><span>            </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#isNonRec"><span class="hs-identifier hs-var">isNonRec</span></a><span> </span><a href="#local-1628078796"><span class="hs-identifier hs-var">rec_flag</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="CoreUtils.html#exprOkForSpeculation"><span class="hs-identifier hs-var">exprOkForSpeculation</span></a><span> </span><a href="#local-1628078798"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>           </span><span class="hs-special">(</span><a href="CoreLint.html#mkRhsPrimMsg"><span class="hs-identifier hs-var">mkRhsPrimMsg</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span> </span><a href="#local-1628078798"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>
</span><a name="line-481"></a><span>        </span><span class="hs-comment">-- Check that if the binder is top-level or recursive, it's not demanded</span><span>
</span><a name="line-482"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Id.html#isStrictId"><span class="hs-identifier hs-var">isStrictId</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-483"></a><span>            </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#isNonRec"><span class="hs-identifier hs-var">isNonRec</span></a><span> </span><a href="#local-1628078796"><span class="hs-identifier hs-var">rec_flag</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a><span> </span><a href="#local-1628078795"><span class="hs-identifier hs-var">top_lvl_flag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span>           </span><span class="hs-special">(</span><a href="CoreLint.html#mkStrictMsg"><span class="hs-identifier hs-var">mkStrictMsg</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span>        </span><span class="hs-comment">-- Check that if the binder is local, it is not marked as exported</span><span>
</span><a name="line-487"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Var.html#isExportedId"><span class="hs-identifier hs-var">isExportedId</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="BasicTypes.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a><span> </span><a href="#local-1628078795"><span class="hs-identifier hs-var">top_lvl_flag</span></a><span class="hs-special">)</span><span>
</span><a name="line-488"></a><span>           </span><span class="hs-special">(</span><a href="CoreLint.html#mkNonTopExportedMsg"><span class="hs-identifier hs-var">mkNonTopExportedMsg</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span>        </span><span class="hs-comment">-- Check that if the binder is local, it does not have an external name</span><span>
</span><a name="line-491"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Var</span><span class="hs-operator">.</span><span class="hs-identifier">varName</span><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="BasicTypes.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a><span> </span><a href="#local-1628078795"><span class="hs-identifier hs-var">top_lvl_flag</span></a><span class="hs-special">)</span><span>
</span><a name="line-492"></a><span>           </span><span class="hs-special">(</span><a href="CoreLint.html#mkNonTopExternalNameMsg"><span class="hs-identifier hs-var">mkNonTopExternalNameMsg</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628078803"><a href="#local-1628078803"><span class="hs-identifier">flags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a><span>
</span><a name="line-495"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">lf_check_inline_loop_breakers</span><span> </span><a href="#local-1628078803"><span class="hs-identifier hs-var">flags</span></a><span>
</span><a name="line-496"></a><span>               </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="BasicTypes.html#isStrongLoopBreaker"><span class="hs-identifier hs-var">isStrongLoopBreaker</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idOccInfo"><span class="hs-identifier hs-var">idOccInfo</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-497"></a><span>               </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="BasicTypes.html#isInlinePragma"><span class="hs-identifier hs-var">isInlinePragma</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idInlinePragma"><span class="hs-identifier hs-var">idInlinePragma</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>              </span><span class="hs-special">(</span><a href="CoreLint.html#addWarnL"><span class="hs-identifier hs-var">addWarnL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;INLINE binder is (non-rule) loop breaker:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-499"></a><span>              </span><span class="hs-comment">-- Only non-rule loop breakers inhibit inlining</span><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span>      </span><span class="hs-comment">-- Check whether arity and demand type are consistent (only if demand analysis</span><span>
</span><a name="line-502"></a><span>      </span><span class="hs-comment">-- already happened)</span><span>
</span><a name="line-503"></a><span>      </span><span class="hs-comment">--</span><span>
</span><a name="line-504"></a><span>      </span><span class="hs-comment">-- Note (Apr 2014): this is actually ok.  See Note [Demand analysis for trivial right-hand sides]</span><span>
</span><a name="line-505"></a><span>      </span><span class="hs-comment">--                  in DmdAnal.  After eta-expansion in CorePrep the rhs is no longer trivial.</span><span>
</span><a name="line-506"></a><span>      </span><span class="hs-comment">--       ; let dmdTy = idStrictness binder</span><span>
</span><a name="line-507"></a><span>      </span><span class="hs-comment">--       ; checkL (case dmdTy of</span><span>
</span><a name="line-508"></a><span>      </span><span class="hs-comment">--                  StrictSig dmd_ty -&gt; idArity binder &gt;= dmdTypeDepth dmd_ty || exprIsTrivial rhs)</span><span>
</span><a name="line-509"></a><span>      </span><span class="hs-comment">--           (mkArityMsg binder)</span><span>
</span><a name="line-510"></a><span>
</span><a name="line-511"></a><span>       </span><span class="hs-comment">-- Check that the binder's arity is within the bounds imposed by</span><span>
</span><a name="line-512"></a><span>       </span><span class="hs-comment">-- the type and the strictness signature. See Note [exprArity invariant]</span><span>
</span><a name="line-513"></a><span>       </span><span class="hs-comment">-- and Note [Trimming arity]</span><span>
</span><a name="line-514"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idArity"><span class="hs-identifier hs-var">idArity</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><span class="hs-special">(</span><a href="CoreArity.html#typeArity"><span class="hs-identifier hs-var">typeArity</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-515"></a><span>           </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;idArity&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idArity"><span class="hs-identifier hs-var">idArity</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-516"></a><span>           </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;exceeds typeArity&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-517"></a><span>           </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><span class="hs-special">(</span><a href="CoreArity.html#typeArity"><span class="hs-identifier hs-var">typeArity</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-518"></a><span>           </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Demand.html#splitStrictSig"><span class="hs-identifier hs-var">splitStrictSig</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idStrictness"><span class="hs-identifier hs-var">idStrictness</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-521"></a><span>           </span><span class="hs-special">(</span><a name="local-1628078804"><a href="#local-1628078804"><span class="hs-identifier">demands</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078805"><a href="#local-1628078805"><span class="hs-identifier">result_info</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Demand.html#isBotRes"><span class="hs-identifier hs-var">isBotRes</span></a><span> </span><a href="#local-1628078805"><span class="hs-identifier hs-var">result_info</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-522"></a><span>             </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idArity"><span class="hs-identifier hs-var">idArity</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628078804"><span class="hs-identifier hs-var">demands</span></a><span class="hs-special">)</span><span>
</span><a name="line-523"></a><span>               </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;idArity&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idArity"><span class="hs-identifier hs-var">idArity</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-524"></a><span>               </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;exceeds arity imposed by the strictness signature&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-525"></a><span>               </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idStrictness"><span class="hs-identifier hs-var">idStrictness</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-526"></a><span>               </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-527"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span>
</span><a name="line-529"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#lintCoreRule"><span class="hs-identifier hs-var">lintCoreRule</span></a><span> </span><a href="#local-1628078802"><span class="hs-identifier hs-var">binder_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Id.html#idCoreRules"><span class="hs-identifier hs-var">idCoreRules</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span>
</span><a name="line-530"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintIdUnfolding"><span class="hs-identifier hs-var">lintIdUnfolding</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span> </span><a href="#local-1628078802"><span class="hs-identifier hs-var">binder_ty</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idUnfolding"><span class="hs-identifier hs-var">idUnfolding</span></a><span> </span><a href="#local-1628078797"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-531"></a><span>
</span><a name="line-532"></a><span>        </span><span class="hs-comment">-- We should check the unfolding, if any, but this is tricky because</span><span>
</span><a name="line-533"></a><span>        </span><span class="hs-comment">-- the unfolding is a SimplifiableCoreExpr. Give up for now.</span><span>
</span><a name="line-534"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-535"></a><span>    </span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-536"></a><span>    </span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-537"></a><span>    </span><a name="local-1628078799"><a href="#local-1628078799"><span class="hs-identifier">lintBinder</span></a></a><span> </span><a name="local-1628078800"><a href="#local-1628078800"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isId"><span class="hs-identifier hs-var">isId</span></a><span> </span><a href="#local-1628078800"><span class="hs-identifier hs-var">var</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintIdBndr"><span class="hs-identifier hs-var">lintIdBndr</span></a><span> </span><a href="#local-1628078800"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-538"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>
</span><a name="line-540"></a><span class="hs-identifier">lintIdUnfolding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#Unfolding"><span class="hs-identifier hs-type">Unfolding</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-541"></a><a name="lintIdUnfolding"><a href="CoreLint.html#lintIdUnfolding"><span class="hs-identifier">lintIdUnfolding</span></a></a><span> </span><a name="local-1628078806"><a href="#local-1628078806"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1628078807"><a href="#local-1628078807"><span class="hs-identifier">bndr_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#CoreUnfolding"><span class="hs-identifier hs-var">CoreUnfolding</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">uf_tmpl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628078808"><a href="#local-1628078808"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">uf_src</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628078809"><a href="#local-1628078809"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-542"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="CoreSyn.html#isStableSource"><span class="hs-identifier hs-var">isStableSource</span></a><span> </span><a href="#local-1628078809"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-543"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078810"><a href="#local-1628078810"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078808"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-544"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078807"><span class="hs-identifier hs-var">bndr_ty</span></a><span> </span><a href="#local-1628078810"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkRhsMsg"><span class="hs-identifier hs-var">mkRhsMsg</span></a><span> </span><a href="#local-1628078806"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;unfolding&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628078810"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-545"></a><span class="hs-identifier">lintIdUnfolding</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-546"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- Do not Lint unstable unfoldings, because that leads</span><span>
</span><a name="line-547"></a><span>                    </span><span class="hs-comment">-- to exponential behaviour; c.f. CoreFVs.idUnfoldingVars</span><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-comment">{-
Note [Checking for INLINE loop breakers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's very suspicious if a strong loop breaker is marked INLINE.

However, the desugarer generates instance methods with INLINE pragmas
that form a mutually recursive group.  Only after a round of
simplification are they unravelled.  So we suppress the test for
the desugarer.

************************************************************************
*                                                                      *
\subsection[lintCoreExpr]{lintCoreExpr}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-565"></a><span>
</span><a name="line-566"></a><span class="hs-keyword">type</span><span> </span><a name="InType"><a href="CoreLint.html#InType"><span class="hs-identifier">InType</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-567"></a><span class="hs-keyword">type</span><span> </span><a name="InCoercion"><a href="CoreLint.html#InCoercion"><span class="hs-identifier">InCoercion</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-568"></a><span class="hs-keyword">type</span><span> </span><a name="InVar"><a href="CoreLint.html#InVar"><span class="hs-identifier">InVar</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-569"></a><span class="hs-keyword">type</span><span> </span><a name="InTyVar"><a href="CoreLint.html#InTyVar"><span class="hs-identifier">InTyVar</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-570"></a><span class="hs-keyword">type</span><span> </span><a name="InCoVar"><a href="CoreLint.html#InCoVar"><span class="hs-identifier">InCoVar</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span class="hs-keyword">type</span><span> </span><a name="OutType"><a href="CoreLint.html#OutType"><span class="hs-identifier">OutType</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-comment">-- Substitution has been applied to this,</span><span>
</span><a name="line-573"></a><span>                        </span><span class="hs-comment">-- but has not been linted yet</span><span>
</span><a name="line-574"></a><span class="hs-keyword">type</span><span> </span><a name="OutKind"><a href="CoreLint.html#OutKind"><span class="hs-identifier">OutKind</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span class="hs-keyword">type</span><span> </span><a name="LintedType"><a href="CoreLint.html#LintedType"><span class="hs-identifier">LintedType</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-comment">-- Substitution applied, and type is linted</span><span>
</span><a name="line-577"></a><span class="hs-keyword">type</span><span> </span><a name="LintedKind"><a href="CoreLint.html#LintedKind"><span class="hs-identifier">LintedKind</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-keyword">type</span><span> </span><a name="OutCoercion"><a href="CoreLint.html#OutCoercion"><span class="hs-identifier">OutCoercion</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-580"></a><span class="hs-keyword">type</span><span> </span><a name="OutVar"><a href="CoreLint.html#OutVar"><span class="hs-identifier">OutVar</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-581"></a><span class="hs-keyword">type</span><span> </span><a name="OutTyVar"><a href="CoreLint.html#OutTyVar"><span class="hs-identifier">OutTyVar</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-582"></a><span class="hs-keyword">type</span><span> </span><a name="OutCoVar"><a href="CoreLint.html#OutCoVar"><span class="hs-identifier">OutCoVar</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-583"></a><span>
</span><a name="line-584"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>
</span><a name="line-585"></a><span class="hs-comment">-- The returned type has the substitution from the monad</span><span>
</span><a name="line-586"></a><span class="hs-comment">-- already applied to it:</span><span>
</span><a name="line-587"></a><span class="hs-comment">--      lintCoreExpr e subst = exprType (subst e)</span><span>
</span><a name="line-588"></a><span class="hs-comment">--</span><span>
</span><a name="line-589"></a><span class="hs-comment">-- The returned &quot;type&quot; can be a kind, if the expression is (Type ty)</span><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-592"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-593"></a><a name="lintCoreExpr"><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier">lintCoreExpr</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-1628078811"><a href="#local-1628078811"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-594"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#isId"><span class="hs-identifier hs-var">isId</span></a><span> </span><a href="#local-1628078811"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span> </span><a href="#local-1628078811"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-595"></a><span>                 </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Non term variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078811"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkDeadIdOcc"><span class="hs-identifier hs-var">checkDeadIdOcc</span></a><span> </span><a href="#local-1628078811"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-598"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628078812"><a href="#local-1628078812"><span class="hs-identifier">var'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lookupIdInScope"><span class="hs-identifier hs-var">lookupIdInScope</span></a><span> </span><a href="#local-1628078811"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-599"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078812"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-600"></a><span>
</span><a name="line-601"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Lit"><span class="hs-identifier hs-var">Lit</span></a><span> </span><a name="local-1628078813"><a href="#local-1628078813"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-602"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Literal.html#literalType"><span class="hs-identifier hs-var">literalType</span></a><span> </span><a href="#local-1628078813"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Cast"><span class="hs-identifier hs-var">Cast</span></a><span> </span><a name="local-1628078814"><a href="#local-1628078814"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628078815"><a href="#local-1628078815"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078816"><a href="#local-1628078816"><span class="hs-identifier">expr_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078814"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-606"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628078817"><a href="#local-1628078817"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#applySubstCo"><span class="hs-identifier hs-var">applySubstCo</span></a><span> </span><a href="#local-1628078815"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-607"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628078818"><a href="#local-1628078818"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078819"><a href="#local-1628078819"><span class="hs-identifier">from_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078820"><a href="#local-1628078820"><span class="hs-identifier">to_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078821"><a href="#local-1628078821"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628078817"><span class="hs-identifier hs-var">co'</span></a><span>
</span><a name="line-608"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="Kind.html#classifiesTypeWithValues"><span class="hs-identifier hs-var">classifiesTypeWithValues</span></a><span> </span><a href="#local-1628078818"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">)</span><span>
</span><a name="line-609"></a><span>               </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Target of cast not # or *:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078815"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628078817"><span class="hs-identifier hs-var">co'</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><a href="#local-1628078821"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-611"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078819"><span class="hs-identifier hs-var">from_ty</span></a><span> </span><a href="#local-1628078816"><span class="hs-identifier hs-var">expr_ty</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkCastErr"><span class="hs-identifier hs-var">mkCastErr</span></a><span> </span><a href="#local-1628078814"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-1628078817"><span class="hs-identifier hs-var">co'</span></a><span> </span><a href="#local-1628078819"><span class="hs-identifier hs-var">from_ty</span></a><span> </span><a href="#local-1628078816"><span class="hs-identifier hs-var">expr_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-612"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628078820"><span class="hs-identifier hs-var">to_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Tick"><span class="hs-identifier hs-var">Tick</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Breakpoint"><span class="hs-identifier hs-var">Breakpoint</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628078822"><a href="#local-1628078822"><span class="hs-identifier">ids</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628078823"><a href="#local-1628078823"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-615"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a><span> </span><a href="#local-1628078822"><span class="hs-identifier hs-var">ids</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628078824"><a href="#local-1628078824"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-616"></a><span>         </span><a href="CoreLint.html#checkDeadIdOcc"><span class="hs-identifier hs-var">checkDeadIdOcc</span></a><span> </span><a href="#local-1628078824"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-617"></a><span>         </span><a href="CoreLint.html#lookupIdInScope"><span class="hs-identifier hs-var">lookupIdInScope</span></a><span> </span><a href="#local-1628078824"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-618"></a><span>       </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078823"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-619"></a><span>
</span><a name="line-620"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Tick"><span class="hs-identifier hs-var">Tick</span></a><span> </span><a name="local-1628078825"><a href="#local-1628078825"><span class="hs-identifier">_other_tickish</span></a></a><span> </span><a name="local-1628078826"><a href="#local-1628078826"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078826"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-622"></a><span>
</span><a name="line-623"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-1628078827"><a href="#local-1628078827"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-1628078828"><a href="#local-1628078828"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1628078829"><a href="#local-1628078829"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1628078827"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-625"></a><span>  </span><span class="hs-glyph">=</span><span>     </span><span class="hs-comment">-- See Note [Linting type lets]</span><span>
</span><a name="line-626"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628078830"><a href="#local-1628078830"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#applySubstTy"><span class="hs-identifier hs-var">applySubstTy</span></a><span> </span><a href="#local-1628078828"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-627"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintTyBndr"><span class="hs-identifier hs-var">lintTyBndr</span></a><span> </span><a href="#local-1628078827"><span class="hs-identifier hs-var">tv</span></a><span>              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628078831"><a href="#local-1628078831"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-628"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#RhsOf"><span class="hs-identifier hs-var">RhsOf</span></a><span> </span><a href="#local-1628078827"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="CoreLint.html#lintTyKind"><span class="hs-identifier hs-var">lintTyKind</span></a><span> </span><a href="#local-1628078831"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-1628078830"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-629"></a><span>                </span><span class="hs-comment">-- Now extend the substitution so we</span><span>
</span><a name="line-630"></a><span>                </span><span class="hs-comment">-- take advantage of it in the body</span><span>
</span><a name="line-631"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#extendSubstL"><span class="hs-identifier hs-var">extendSubstL</span></a><span> </span><a href="#local-1628078831"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-1628078830"><span class="hs-identifier hs-var">ty'</span></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-632"></a><span>          </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#BodyOfLetRec"><span class="hs-identifier hs-var">BodyOfLetRec</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628078827"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-633"></a><span>          </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078829"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-634"></a><span>
</span><a name="line-635"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-1628078832"><a href="#local-1628078832"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1628078833"><a href="#local-1628078833"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628078834"><a href="#local-1628078834"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-636"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isId"><span class="hs-identifier hs-var">isId</span></a><span> </span><a href="#local-1628078832"><span class="hs-identifier hs-var">bndr</span></a><span>
</span><a name="line-637"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintSingleBinding"><span class="hs-identifier hs-var">lintSingleBinding</span></a><span> </span><a href="BasicTypes.html#NotTopLevel"><span class="hs-identifier hs-var">NotTopLevel</span></a><span> </span><a href="BasicTypes.html#NonRecursive"><span class="hs-identifier hs-var">NonRecursive</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078832"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">,</span><a href="#local-1628078833"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-638"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#BodyOfLetRec"><span class="hs-identifier hs-var">BodyOfLetRec</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628078832"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>                 </span><span class="hs-special">(</span><a href="CoreLint.html#lintAndScopeId"><span class="hs-identifier hs-var">lintAndScopeId</span></a><span> </span><a href="#local-1628078832"><span class="hs-identifier hs-var">bndr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078834"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-642"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkLetErr"><span class="hs-identifier hs-var">mkLetErr</span></a><span> </span><a href="#local-1628078832"><span class="hs-identifier hs-var">bndr</span></a><span> </span><a href="#local-1628078833"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- Not quite accurate</span><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><a name="local-1628078835"><a href="#local-1628078835"><span class="hs-identifier">pairs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628078836"><a href="#local-1628078836"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintAndScopeIds"><span class="hs-identifier hs-var">lintAndScopeIds</span></a><span> </span><a href="#local-1628078837"><span class="hs-identifier hs-var">bndrs</span></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-646"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628078838"><span class="hs-identifier hs-var">dups</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#dupVars"><span class="hs-identifier hs-var">dupVars</span></a><span> </span><a href="#local-1628078838"><span class="hs-identifier hs-var">dups</span></a><span class="hs-special">)</span><span>
</span><a name="line-647"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#lintSingleBinding"><span class="hs-identifier hs-var">lintSingleBinding</span></a><span> </span><a href="BasicTypes.html#NotTopLevel"><span class="hs-identifier hs-var">NotTopLevel</span></a><span> </span><a href="BasicTypes.html#Recursive"><span class="hs-identifier hs-var">Recursive</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078835"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-648"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#BodyOfLetRec"><span class="hs-identifier hs-var">BodyOfLetRec</span></a><span> </span><a href="#local-1628078837"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078836"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-649"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-650"></a><span>    </span><a name="local-1628078837"><a href="#local-1628078837"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="#local-1628078835"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-651"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628078838"><a href="#local-1628078838"><span class="hs-identifier">dups</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-1628078837"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-652"></a><span>
</span><a name="line-653"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><a name="local-1628078839"><a href="#local-1628078839"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-654"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078842"><a href="#local-1628078842"><span class="hs-identifier">fun_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078840"><span class="hs-identifier hs-var">fun</span></a><span>
</span><a name="line-655"></a><span>         </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#AnExpr"><span class="hs-identifier hs-var">AnExpr</span></a><span> </span><a href="#local-1628078839"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#foldM"><span class="hs-identifier hs-var">foldM</span></a><span> </span><a href="CoreLint.html#lintCoreArg"><span class="hs-identifier hs-var">lintCoreArg</span></a><span> </span><a href="#local-1628078842"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><a href="#local-1628078841"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-656"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-657"></a><span>    </span><span class="hs-special">(</span><a name="local-1628078840"><a href="#local-1628078840"><span class="hs-identifier">fun</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078841"><a href="#local-1628078841"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#collectArgs"><span class="hs-identifier hs-var">collectArgs</span></a><span> </span><a href="#local-1628078839"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-1628078843"><a href="#local-1628078843"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-1628078844"><a href="#local-1628078844"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-660"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#LambdaBodyOf"><span class="hs-identifier hs-var">LambdaBodyOf</span></a><span> </span><a href="#local-1628078843"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-661"></a><span>    </span><a href="CoreLint.html#lintBinder"><span class="hs-identifier hs-var">lintBinder</span></a><span> </span><a href="#local-1628078843"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628078845"><a href="#local-1628078845"><span class="hs-identifier">var'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-662"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078846"><a href="#local-1628078846"><span class="hs-identifier">body_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078844"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-663"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#mkPiType"><span class="hs-identifier hs-var">mkPiType</span></a><span> </span><a href="#local-1628078845"><span class="hs-identifier hs-var">var'</span></a><span> </span><a href="#local-1628078846"><span class="hs-identifier hs-var">body_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-664"></a><span>
</span><a name="line-665"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><a name="local-1628078847"><a href="#local-1628078847"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a name="local-1628078848"><a href="#local-1628078848"><span class="hs-identifier">scrut</span></a></a><span> </span><a name="local-1628078849"><a href="#local-1628078849"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-1628078850"><a href="#local-1628078850"><span class="hs-identifier">alt_ty</span></a></a><span> </span><a name="local-1628078851"><a href="#local-1628078851"><span class="hs-identifier">alts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-666"></a><span>       </span><span class="hs-comment">-- Check the scrutinee</span><span>
</span><a name="line-667"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078852"><a href="#local-1628078852"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078848"><span class="hs-identifier hs-var">scrut</span></a><span>
</span><a name="line-668"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628078853"><a href="#local-1628078853"><span class="hs-identifier">alt_ty</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintInTy"><span class="hs-identifier hs-var">lintInTy</span></a><span> </span><a href="#local-1628078850"><span class="hs-identifier hs-var">alt_ty</span></a><span>
</span><a name="line-669"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628078854"><a href="#local-1628078854"><span class="hs-identifier">var_ty</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintInTy"><span class="hs-identifier hs-var">lintInTy</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078849"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-670"></a><span>
</span><a name="line-671"></a><span>     </span><span class="hs-comment">-- See Note [No alternatives lint check]</span><span>
</span><a name="line-672"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628078851"><span class="hs-identifier hs-var">alts</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-673"></a><span>     </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="CoreUtils.html#exprIsHNF"><span class="hs-identifier hs-var">exprIsHNF</span></a><span> </span><a href="#local-1628078848"><span class="hs-identifier hs-var">scrut</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-674"></a><span>          </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;No alternatives for a case scrutinee in head-normal form:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078848"><span class="hs-identifier hs-var">scrut</span></a><span class="hs-special">)</span><span>
</span><a name="line-675"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="CoreUtils.html#exprIsBottom"><span class="hs-identifier hs-var">exprIsBottom</span></a><span> </span><a href="#local-1628078848"><span class="hs-identifier hs-var">scrut</span></a><span class="hs-special">)</span><span>
</span><a name="line-676"></a><span>          </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;No alternatives for a case scrutinee not known to diverge for sure:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078848"><span class="hs-identifier hs-var">scrut</span></a><span class="hs-special">)</span><span>
</span><a name="line-677"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span>     </span><span class="hs-comment">-- See Note [Rules for floating-point comparisons] in PrelRules</span><span>
</span><a name="line-680"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628078855"><a href="#local-1628078855"><span class="hs-identifier">isLitPat</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-681"></a><span>           </span><span class="hs-identifier">isLitPat</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-682"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcType.html#isFloatingTy"><span class="hs-identifier hs-var">isFloatingTy</span></a><span> </span><a href="#local-1628078852"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="#local-1628078855"><span class="hs-identifier hs-var">isLitPat</span></a><span> </span><a href="#local-1628078851"><span class="hs-identifier hs-var">alts</span></a><span class="hs-special">)</span><span>
</span><a name="line-683"></a><span>         </span><span class="hs-special">(</span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-string">&quot;Lint warning: Scrutinising floating-point &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-684"></a><span>                        </span><span class="hs-string">&quot;expression with literal pattern in case &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-685"></a><span>                        </span><span class="hs-string">&quot;analysis (see Trac #9238).&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-686"></a><span>          </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;scrut&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078848"><span class="hs-identifier hs-var">scrut</span></a><span class="hs-special">)</span><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078849"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-689"></a><span>         </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628078856"><a href="#local-1628078856"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-690"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-691"></a><span>                </span><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a><span> </span><a href="#local-1628078856"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-692"></a><span>                </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isFamilyTyCon"><span class="hs-identifier hs-var">isFamilyTyCon</span></a><span> </span><a href="#local-1628078856"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="TyCon.html#isAbstractTyCon"><span class="hs-identifier hs-var">isAbstractTyCon</span></a><span> </span><a href="#local-1628078856"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-693"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628078856"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-694"></a><span>                  </span><a href="Outputable.html#pprTrace"><span class="hs-identifier hs-var">pprTrace</span></a><span> </span><span class="hs-string">&quot;Lint warning: case binder's type has no constructors&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078849"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078849"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-695"></a><span>                        </span><span class="hs-comment">-- This can legitimately happen for type families</span><span>
</span><a name="line-696"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-697"></a><span>         </span><a name="local-1628078857"><a href="#local-1628078857"><span class="hs-identifier">_otherwise</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-698"></a><span>
</span><a name="line-699"></a><span>        </span><span class="hs-comment">-- Don't use lintIdBndr on var, because unboxed tuple is legitimate</span><span>
</span><a name="line-700"></a><span>
</span><a name="line-701"></a><span>     </span><span class="hs-special">;</span><span> </span><a name="local-1628078858"><a href="#local-1628078858"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier hs-var">getTCvSubst</span></a><span>
</span><a name="line-702"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078854"><span class="hs-identifier hs-var">var_ty</span></a><span> </span><a href="#local-1628078852"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkScrutMsg"><span class="hs-identifier hs-var">mkScrutMsg</span></a><span> </span><a href="#local-1628078849"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-1628078854"><span class="hs-identifier hs-var">var_ty</span></a><span> </span><a href="#local-1628078852"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><a href="#local-1628078858"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span>
</span><a name="line-703"></a><span>
</span><a name="line-704"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintAndScopeId"><span class="hs-identifier hs-var">lintAndScopeId</span></a><span> </span><a href="#local-1628078849"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-705"></a><span>       </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Check the alternatives</span><span>
</span><a name="line-706"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#lintCoreAlt"><span class="hs-identifier hs-var">lintCoreAlt</span></a><span> </span><a href="#local-1628078852"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><a href="#local-1628078853"><span class="hs-identifier hs-var">alt_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078851"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-707"></a><span>          </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkCaseAlts"><span class="hs-identifier hs-var">checkCaseAlts</span></a><span> </span><a href="#local-1628078847"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-1628078852"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><a href="#local-1628078851"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-708"></a><span>          </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628078853"><span class="hs-identifier hs-var">alt_ty</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-709"></a><span>
</span><a name="line-710"></a><span class="hs-comment">-- This case can't happen; linting types in expressions gets routed through</span><span>
</span><a name="line-711"></a><span class="hs-comment">-- lintCoreArgs</span><span>
</span><a name="line-712"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-1628078859"><a href="#local-1628078859"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-713"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type found as expression&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078859"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-714"></a><span>
</span><a name="line-715"></a><span class="hs-identifier">lintCoreExpr</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a name="local-1628078860"><a href="#local-1628078860"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-716"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628078861"><a href="#local-1628078861"><span class="hs-identifier">k1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078862"><a href="#local-1628078862"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078863"><a href="#local-1628078863"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078864"><a href="#local-1628078864"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078865"><a href="#local-1628078865"><span class="hs-identifier">role</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintInCo"><span class="hs-identifier hs-var">lintInCo</span></a><span> </span><a href="#local-1628078860"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-717"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Coercion.html#mkHeteroCoercionType"><span class="hs-identifier hs-var">mkHeteroCoercionType</span></a><span> </span><a href="#local-1628078865"><span class="hs-identifier hs-var">role</span></a><span> </span><a href="#local-1628078861"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1628078862"><span class="hs-identifier hs-var">k2</span></a><span> </span><a href="#local-1628078863"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628078864"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-718"></a><span>
</span><a name="line-719"></a><span class="hs-comment">{-
Note [No alternatives lint check]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Case expressions with no alternatives are odd beasts, and worth looking at
in the linter (cf Trac #10180).  We check two things:

* exprIsHNF is false: certainly, it would be terribly wrong if the
  scrutinee was already in head normal form.

* exprIsBottom is true: we should be able to see why GHC believes the
  scrutinee is diverging for sure.

In principle, the first check is redundant: exprIsBottom == True will
always imply exprIsHNF == False.  But the first check is reliable: If
exprIsHNF == True, then there definitely is a problem (exprIsHNF errs
on the right side).  If the second check triggers then it may be the
case that the compiler got smarter elsewhere, and the empty case is
correct, but that exprIsBottom is unable to see it. In particular, the
empty-type check in exprIsBottom is an approximation. Therefore, this
check is not fully reliable, and we keep both around.

************************************************************************
*                                                                      *
\subsection[lintCoreArgs]{lintCoreArgs}
*                                                                      *
************************************************************************

The basic version of these functions checks that the argument is a
subtype of the required type, as one would expect.
-}</span><span>
</span><a name="line-749"></a><span>
</span><a name="line-750"></a><span class="hs-identifier">lintCoreArg</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>
</span><a name="line-751"></a><a name="lintCoreArg"><a href="CoreLint.html#lintCoreArg"><span class="hs-identifier">lintCoreArg</span></a></a><span> </span><a name="local-1628078866"><a href="#local-1628078866"><span class="hs-identifier">fun_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-1628078867"><a href="#local-1628078867"><span class="hs-identifier">arg_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-752"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a><span> </span><a href="#local-1628078867"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-753"></a><span>                </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unnecessary coercion-to-type injection:&quot;</span><span>
</span><a name="line-754"></a><span>                  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078867"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-755"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628078868"><a href="#local-1628078868"><span class="hs-identifier">arg_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#applySubstTy"><span class="hs-identifier hs-var">applySubstTy</span></a><span> </span><a href="#local-1628078867"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-756"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintTyApp"><span class="hs-identifier hs-var">lintTyApp</span></a><span> </span><a href="#local-1628078866"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><a href="#local-1628078868"><span class="hs-identifier hs-var">arg_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span class="hs-identifier">lintCoreArg</span><span> </span><a name="local-1628078869"><a href="#local-1628078869"><span class="hs-identifier">fun_ty</span></a></a><span> </span><a name="local-1628078870"><a href="#local-1628078870"><span class="hs-identifier">arg</span></a></a><span>
</span><a name="line-759"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078871"><a href="#local-1628078871"><span class="hs-identifier">arg_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078870"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-760"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1628078871"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="CoreUtils.html#exprOkForSpeculation"><span class="hs-identifier hs-var">exprOkForSpeculation</span></a><span> </span><a href="#local-1628078870"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-761"></a><span>                </span><span class="hs-special">(</span><a href="CoreLint.html#mkLetAppMsg"><span class="hs-identifier hs-var">mkLetAppMsg</span></a><span> </span><a href="#local-1628078870"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-762"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintValApp"><span class="hs-identifier hs-var">lintValApp</span></a><span> </span><a href="#local-1628078870"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-1628078869"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><a href="#local-1628078871"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-763"></a><span>
</span><a name="line-764"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-765"></a><span class="hs-identifier">lintAltBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>     </span><span class="hs-comment">-- Scrutinee type</span><span>
</span><a name="line-766"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>     </span><span class="hs-comment">-- Constructor type</span><span>
</span><a name="line-767"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreLint.html#OutVar"><span class="hs-identifier hs-type">OutVar</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- Binders</span><span>
</span><a name="line-768"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-769"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-770"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-771"></a><a name="lintAltBinders"><a href="CoreLint.html#lintAltBinders"><span class="hs-identifier">lintAltBinders</span></a></a><span> </span><a name="local-1628078872"><a href="#local-1628078872"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><a name="local-1628078873"><a href="#local-1628078873"><span class="hs-identifier">con_ty</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-772"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078873"><span class="hs-identifier hs-var">con_ty</span></a><span> </span><a href="#local-1628078872"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkBadPatMsg"><span class="hs-identifier hs-var">mkBadPatMsg</span></a><span> </span><a href="#local-1628078873"><span class="hs-identifier hs-var">con_ty</span></a><span> </span><a href="#local-1628078872"><span class="hs-identifier hs-var">scrut_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-773"></a><span class="hs-identifier">lintAltBinders</span><span> </span><a name="local-1628078874"><a href="#local-1628078874"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><a name="local-1628078875"><a href="#local-1628078875"><span class="hs-identifier">con_ty</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628078876"><a href="#local-1628078876"><span class="hs-identifier">bndr</span></a></a><span class="hs-glyph">:</span><a name="local-1628078877"><a href="#local-1628078877"><span class="hs-identifier">bndrs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1628078876"><span class="hs-identifier hs-var">bndr</span></a><span>
</span><a name="line-775"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078878"><a href="#local-1628078878"><span class="hs-identifier">con_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintTyApp"><span class="hs-identifier hs-var">lintTyApp</span></a><span> </span><a href="#local-1628078875"><span class="hs-identifier hs-var">con_ty</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1628078876"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span>
</span><a name="line-776"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintAltBinders"><span class="hs-identifier hs-var">lintAltBinders</span></a><span> </span><a href="#local-1628078874"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><a href="#local-1628078878"><span class="hs-identifier hs-var">con_ty'</span></a><span> </span><a href="#local-1628078877"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-777"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-778"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078879"><a href="#local-1628078879"><span class="hs-identifier">con_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintValApp"><span class="hs-identifier hs-var">lintValApp</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-1628078876"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078875"><span class="hs-identifier hs-var">con_ty</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078876"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span>
</span><a name="line-779"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintAltBinders"><span class="hs-identifier hs-var">lintAltBinders</span></a><span> </span><a href="#local-1628078874"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><a href="#local-1628078879"><span class="hs-identifier hs-var">con_ty'</span></a><span> </span><a href="#local-1628078877"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-780"></a><span>
</span><a name="line-781"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-782"></a><span class="hs-identifier">lintTyApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>
</span><a name="line-783"></a><a name="lintTyApp"><a href="CoreLint.html#lintTyApp"><span class="hs-identifier">lintTyApp</span></a></a><span> </span><a name="local-1628078880"><a href="#local-1628078880"><span class="hs-identifier">fun_ty</span></a></a><span> </span><a name="local-1628078881"><a href="#local-1628078881"><span class="hs-identifier">arg_ty</span></a></a><span>
</span><a name="line-784"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628078882"><a href="#local-1628078882"><span class="hs-identifier">tv</span></a></a><span class="hs-special">,</span><a name="local-1628078883"><a href="#local-1628078883"><span class="hs-identifier">body_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span> </span><a href="#local-1628078880"><span class="hs-identifier hs-var">fun_ty</span></a><span>
</span><a name="line-785"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintTyKind"><span class="hs-identifier hs-var">lintTyKind</span></a><span> </span><a href="#local-1628078882"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1628078881"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-786"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628078884"><a href="#local-1628078884"><span class="hs-identifier">in_scope</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getInScope"><span class="hs-identifier hs-var">getInScope</span></a><span>
</span><a name="line-787"></a><span>        </span><span class="hs-comment">-- substTy needs the set of tyvars in scope to avoid generating</span><span>
</span><a name="line-788"></a><span>        </span><span class="hs-comment">-- uniques that are already in scope.</span><span>
</span><a name="line-789"></a><span>        </span><span class="hs-comment">-- See Note [The substitution invariant] in TyCoRep</span><span>
</span><a name="line-790"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyWithInScope"><span class="hs-identifier hs-var">substTyWithInScope</span></a><span> </span><a href="#local-1628078884"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628078882"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-1628078881"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628078883"><span class="hs-identifier hs-var">body_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-791"></a><span>
</span><a name="line-792"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-793"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkTyAppMsg"><span class="hs-identifier hs-var">mkTyAppMsg</span></a><span> </span><a href="#local-1628078880"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><a href="#local-1628078881"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-794"></a><span>
</span><a name="line-795"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-796"></a><span class="hs-identifier">lintValApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>
</span><a name="line-797"></a><a name="lintValApp"><a href="CoreLint.html#lintValApp"><span class="hs-identifier">lintValApp</span></a></a><span> </span><a name="local-1628078885"><a href="#local-1628078885"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-1628078886"><a href="#local-1628078886"><span class="hs-identifier">fun_ty</span></a></a><span> </span><a name="local-1628078887"><a href="#local-1628078887"><span class="hs-identifier">arg_ty</span></a></a><span>
</span><a name="line-798"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628078890"><a href="#local-1628078890"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><a name="local-1628078891"><a href="#local-1628078891"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a><span> </span><a href="#local-1628078886"><span class="hs-identifier hs-var">fun_ty</span></a><span>
</span><a name="line-799"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078890"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-1628078887"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="#local-1628078888"><span class="hs-identifier hs-var">err1</span></a><span>
</span><a name="line-800"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628078891"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-801"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-802"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><a href="#local-1628078889"><span class="hs-identifier hs-var">err2</span></a><span>
</span><a name="line-803"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-804"></a><span>    </span><a name="local-1628078888"><a href="#local-1628078888"><span class="hs-identifier">err1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#mkAppMsg"><span class="hs-identifier hs-var">mkAppMsg</span></a><span>       </span><a href="#local-1628078886"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><a href="#local-1628078887"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="#local-1628078885"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-805"></a><span>    </span><a name="local-1628078889"><a href="#local-1628078889"><span class="hs-identifier">err2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#mkNonFunAppMsg"><span class="hs-identifier hs-var">mkNonFunAppMsg</span></a><span> </span><a href="#local-1628078886"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><a href="#local-1628078887"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="#local-1628078885"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-806"></a><span>
</span><a name="line-807"></a><span class="hs-identifier">lintTyKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutTyVar"><span class="hs-identifier hs-type">OutTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-808"></a><span class="hs-comment">-- Both args have had substitution applied</span><span>
</span><a name="line-809"></a><span>
</span><a name="line-810"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-811"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-812"></a><a name="lintTyKind"><a href="CoreLint.html#lintTyKind"><span class="hs-identifier">lintTyKind</span></a></a><span> </span><a name="local-1628078892"><a href="#local-1628078892"><span class="hs-identifier">tyvar</span></a></a><span> </span><a name="local-1628078893"><a href="#local-1628078893"><span class="hs-identifier">arg_ty</span></a></a><span>
</span><a name="line-813"></a><span>        </span><span class="hs-comment">-- Arg type might be boxed for a function with an uncommitted</span><span>
</span><a name="line-814"></a><span>        </span><span class="hs-comment">-- tyvar; notably this is used so that we can give</span><span>
</span><a name="line-815"></a><span>        </span><span class="hs-comment">--      error :: forall a:*. String -&gt; a</span><span>
</span><a name="line-816"></a><span>        </span><span class="hs-comment">-- and then apply it to both boxed and unboxed types.</span><span>
</span><a name="line-817"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078895"><a href="#local-1628078895"><span class="hs-identifier">arg_kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078893"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-818"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078895"><span class="hs-identifier hs-var">arg_kind</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628078894"><span class="hs-identifier hs-var">tyvar_kind</span></a><span class="hs-special">)</span><span>
</span><a name="line-819"></a><span>                </span><span class="hs-special">(</span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkKindErrMsg"><span class="hs-identifier hs-var">mkKindErrMsg</span></a><span> </span><a href="#local-1628078892"><span class="hs-identifier hs-var">tyvar</span></a><span> </span><a href="#local-1628078893"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;xx&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078895"><span class="hs-identifier hs-var">arg_kind</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-820"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-821"></a><span>    </span><a name="local-1628078894"><a href="#local-1628078894"><span class="hs-identifier">tyvar_kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628078892"><span class="hs-identifier hs-var">tyvar</span></a><span>
</span><a name="line-822"></a><span>
</span><a name="line-823"></a><span class="hs-identifier">checkDeadIdOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-824"></a><span class="hs-comment">-- Occurrences of an Id should never be dead....</span><span>
</span><a name="line-825"></a><span class="hs-comment">-- except when we are checking a case pattern</span><span>
</span><a name="line-826"></a><a name="checkDeadIdOcc"><a href="CoreLint.html#checkDeadIdOcc"><span class="hs-identifier">checkDeadIdOcc</span></a></a><span> </span><a name="local-1628078896"><a href="#local-1628078896"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-827"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="BasicTypes.html#isDeadOcc"><span class="hs-identifier hs-var">isDeadOcc</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idOccInfo"><span class="hs-identifier hs-var">idOccInfo</span></a><span> </span><a href="#local-1628078896"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-828"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078897"><a href="#local-1628078897"><span class="hs-identifier">in_case</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#inCasePat"><span class="hs-identifier hs-var">inCasePat</span></a><span>
</span><a name="line-829"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><a href="#local-1628078897"><span class="hs-identifier hs-var">in_case</span></a><span>
</span><a name="line-830"></a><span>                </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Occurrence of a dead Id&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078896"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-831"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-832"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-833"></a><span>
</span><a name="line-834"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lintCoreAlts]{lintCoreAlts}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-841"></a><span>
</span><a name="line-842"></a><span class="hs-identifier">checkCaseAlts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-843"></a><span class="hs-comment">-- a) Check that the alts are non-empty</span><span>
</span><a name="line-844"></a><span class="hs-comment">-- b1) Check that the DEFAULT comes first, if it exists</span><span>
</span><a name="line-845"></a><span class="hs-comment">-- b2) Check that the others are in increasing order</span><span>
</span><a name="line-846"></a><span class="hs-comment">-- c) Check that there's a default for infinite types</span><span>
</span><a name="line-847"></a><span class="hs-comment">-- NB: Algebraic cases are not necessarily exhaustive, because</span><span>
</span><a name="line-848"></a><span class="hs-comment">--     the simplifer correctly eliminates case that can't</span><span>
</span><a name="line-849"></a><span class="hs-comment">--     possibly match.</span><span>
</span><a name="line-850"></a><span>
</span><a name="line-851"></a><a name="checkCaseAlts"><a href="CoreLint.html#checkCaseAlts"><span class="hs-identifier">checkCaseAlts</span></a></a><span> </span><a name="local-1628078898"><a href="#local-1628078898"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1628078899"><a href="#local-1628078899"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628078900"><a href="#local-1628078900"><span class="hs-identifier">alts</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-852"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="#local-1628078904"><span class="hs-identifier hs-var">non_deflt</span></a><span> </span><a href="#local-1628078901"><span class="hs-identifier hs-var">con_alts</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkNonDefltMsg"><span class="hs-identifier hs-var">mkNonDefltMsg</span></a><span> </span><a href="#local-1628078898"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-853"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078903"><span class="hs-identifier hs-var">increasing_tag</span></a><span> </span><a href="#local-1628078901"><span class="hs-identifier hs-var">con_alts</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkNonIncreasingAltsMsg"><span class="hs-identifier hs-var">mkNonIncreasingAltsMsg</span></a><span> </span><a href="#local-1628078898"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-854"></a><span>
</span><a name="line-855"></a><span>          </span><span class="hs-comment">-- For types Int#, Word# with an infinite (well, large!) number of</span><span>
</span><a name="line-856"></a><span>          </span><span class="hs-comment">-- possible values, there should usually be a DEFAULT case</span><span>
</span><a name="line-857"></a><span>          </span><span class="hs-comment">-- But (see Note [Empty case alternatives] in CoreSyn) it's ok to</span><span>
</span><a name="line-858"></a><span>          </span><span class="hs-comment">-- have *no* case alternatives.</span><span>
</span><a name="line-859"></a><span>          </span><span class="hs-comment">-- In effect, this is a kind of partial test. I suppose it's possible</span><span>
</span><a name="line-860"></a><span>          </span><span class="hs-comment">-- that we might *know* that 'x' was 1 or 2, in which case</span><span>
</span><a name="line-861"></a><span>          </span><span class="hs-comment">--   case x of { 1 -&gt; e1; 2 -&gt; e2 }</span><span>
</span><a name="line-862"></a><span>          </span><span class="hs-comment">-- would be fine.</span><span>
</span><a name="line-863"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><a href="#local-1628078902"><span class="hs-identifier hs-var">maybe_deflt</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628078905"><span class="hs-identifier hs-var">is_infinite_ty</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628078900"><span class="hs-identifier hs-var">alts</span></a><span class="hs-special">)</span><span>
</span><a name="line-864"></a><span>              </span><span class="hs-special">(</span><a href="CoreLint.html#nonExhaustiveAltsMsg"><span class="hs-identifier hs-var">nonExhaustiveAltsMsg</span></a><span> </span><a href="#local-1628078898"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-865"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-866"></a><span>    </span><span class="hs-special">(</span><a name="local-1628078901"><a href="#local-1628078901"><span class="hs-identifier">con_alts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078902"><a href="#local-1628078902"><span class="hs-identifier">maybe_deflt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreUtils.html#findDefault"><span class="hs-identifier hs-var">findDefault</span></a><span> </span><a href="#local-1628078900"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-867"></a><span>
</span><a name="line-868"></a><span>        </span><span class="hs-comment">-- Check that successive alternatives have increasing tags</span><span>
</span><a name="line-869"></a><span>    </span><a name="local-1628078903"><a href="#local-1628078903"><span class="hs-identifier">increasing_tag</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628078906"><a href="#local-1628078906"><span class="hs-identifier">alt1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628078907"><a href="#local-1628078907"><span class="hs-identifier">rest</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span> </span><a name="local-1628078908"><a href="#local-1628078908"><span class="hs-identifier">alt2</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628078906"><span class="hs-identifier hs-var">alt1</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#ltAlt"><span class="hs-identifier hs-var">ltAlt</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628078908"><span class="hs-identifier hs-var">alt2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628078903"><span class="hs-identifier hs-var">increasing_tag</span></a><span> </span><a href="#local-1628078907"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-870"></a><span>    </span><span class="hs-identifier">increasing_tag</span><span> </span><span class="hs-identifier">_</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-871"></a><span>
</span><a name="line-872"></a><span>    </span><a name="local-1628078904"><a href="#local-1628078904"><span class="hs-identifier">non_deflt</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-873"></a><span>    </span><span class="hs-identifier">non_deflt</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-874"></a><span>
</span><a name="line-875"></a><span>    </span><a name="local-1628078905"><a href="#local-1628078905"><span class="hs-identifier">is_infinite_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-1628078899"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-876"></a><span>                        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-877"></a><span>                        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628078909"><a href="#local-1628078909"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#isPrimTyCon"><span class="hs-identifier hs-var">isPrimTyCon</span></a><span> </span><a href="#local-1628078909"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-878"></a><span>
</span><a name="line-879"></a><span class="hs-identifier">lintAltExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-880"></a><a name="lintAltExpr"><a href="CoreLint.html#lintAltExpr"><span class="hs-identifier">lintAltExpr</span></a></a><span> </span><a name="local-1628078910"><a href="#local-1628078910"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628078911"><a href="#local-1628078911"><span class="hs-identifier">ann_ty</span></a></a><span>
</span><a name="line-881"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078912"><a href="#local-1628078912"><span class="hs-identifier">actual_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628078910"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-882"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078912"><span class="hs-identifier hs-var">actual_ty</span></a><span> </span><a href="#local-1628078911"><span class="hs-identifier hs-var">ann_ty</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkCaseAltMsg"><span class="hs-identifier hs-var">mkCaseAltMsg</span></a><span> </span><a href="#local-1628078910"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-1628078912"><span class="hs-identifier hs-var">actual_ty</span></a><span> </span><a href="#local-1628078911"><span class="hs-identifier hs-var">ann_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-883"></a><span>
</span><a name="line-884"></a><span class="hs-identifier">lintCoreAlt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>          </span><span class="hs-comment">-- Type of scrutinee</span><span>
</span><a name="line-885"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>          </span><span class="hs-comment">-- Type of the alternative</span><span>
</span><a name="line-886"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span>
</span><a name="line-887"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-888"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-889"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-890"></a><a name="lintCoreAlt"><a href="CoreLint.html#lintCoreAlt"><span class="hs-identifier">lintCoreAlt</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628078913"><a href="#local-1628078913"><span class="hs-identifier">alt_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span> </span><a name="local-1628078914"><a href="#local-1628078914"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078915"><a href="#local-1628078915"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-891"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628078914"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkDefaultArgsMsg"><span class="hs-identifier hs-var">mkDefaultArgsMsg</span></a><span> </span><a href="#local-1628078914"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-892"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintAltExpr"><span class="hs-identifier hs-var">lintAltExpr</span></a><span> </span><a href="#local-1628078915"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-1628078913"><span class="hs-identifier hs-var">alt_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-893"></a><span>
</span><a name="line-894"></a><span class="hs-identifier">lintCoreAlt</span><span> </span><a name="local-1628078916"><a href="#local-1628078916"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><a name="local-1628078917"><a href="#local-1628078917"><span class="hs-identifier">alt_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a><span> </span><a name="local-1628078918"><a href="#local-1628078918"><span class="hs-identifier">lit</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078919"><a href="#local-1628078919"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078920"><a href="#local-1628078920"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-895"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Literal.html#litIsLifted"><span class="hs-identifier hs-var">litIsLifted</span></a><span> </span><a href="#local-1628078918"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-896"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><a href="CoreLint.html#integerScrutinisedMsg"><span class="hs-identifier hs-var">integerScrutinisedMsg</span></a><span>
</span><a name="line-897"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-898"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628078919"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkDefaultArgsMsg"><span class="hs-identifier hs-var">mkDefaultArgsMsg</span></a><span> </span><a href="#local-1628078919"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-899"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078921"><span class="hs-identifier hs-var">lit_ty</span></a><span> </span><a href="#local-1628078916"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkBadPatMsg"><span class="hs-identifier hs-var">mkBadPatMsg</span></a><span> </span><a href="#local-1628078921"><span class="hs-identifier hs-var">lit_ty</span></a><span> </span><a href="#local-1628078916"><span class="hs-identifier hs-var">scrut_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-900"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintAltExpr"><span class="hs-identifier hs-var">lintAltExpr</span></a><span> </span><a href="#local-1628078920"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-1628078917"><span class="hs-identifier hs-var">alt_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-901"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-902"></a><span>    </span><a name="local-1628078921"><a href="#local-1628078921"><span class="hs-identifier">lit_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#literalType"><span class="hs-identifier hs-var">literalType</span></a><span> </span><a href="#local-1628078918"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-903"></a><span>
</span><a name="line-904"></a><span class="hs-identifier">lintCoreAlt</span><span> </span><a name="local-1628078922"><a href="#local-1628078922"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><a name="local-1628078923"><a href="#local-1628078923"><span class="hs-identifier">alt_ty</span></a></a><span> </span><a name="local-1628078924"><a href="#local-1628078924"><span class="hs-identifier">alt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><a name="local-1628078925"><a href="#local-1628078925"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078926"><a href="#local-1628078926"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078927"><a href="#local-1628078927"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-905"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-1628078925"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-906"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkNewTyDataConAltMsg"><span class="hs-identifier hs-var">mkNewTyDataConAltMsg</span></a><span> </span><a href="#local-1628078922"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><a href="#local-1628078924"><span class="hs-identifier hs-var">alt</span></a><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628078928"><a href="#local-1628078928"><span class="hs-identifier">tycon</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078929"><a href="#local-1628078929"><span class="hs-identifier">tycon_arg_tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628078922"><span class="hs-identifier hs-var">scrut_ty</span></a><span>
</span><a name="line-908"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a><span> </span><a href="#local-1628078924"><span class="hs-identifier hs-var">alt</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-909"></a><span>    </span><span class="hs-special">{</span><span>   </span><span class="hs-comment">-- First instantiate the universally quantified</span><span>
</span><a name="line-910"></a><span>        </span><span class="hs-comment">-- type variables of the data constructor</span><span>
</span><a name="line-911"></a><span>        </span><span class="hs-comment">-- We've already check</span><span>
</span><a name="line-912"></a><span>      </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078928"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-1628078925"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkBadConMsg"><span class="hs-identifier hs-var">mkBadConMsg</span></a><span> </span><a href="#local-1628078928"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628078925"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-913"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628078930"><a href="#local-1628078930"><span class="hs-identifier">con_payload_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConRepType"><span class="hs-identifier hs-var">dataConRepType</span></a><span> </span><a href="#local-1628078925"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628078929"><span class="hs-identifier hs-var">tycon_arg_tys</span></a><span>
</span><a name="line-914"></a><span>
</span><a name="line-915"></a><span>        </span><span class="hs-comment">-- And now bring the new binders into scope</span><span>
</span><a name="line-916"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintBinders"><span class="hs-identifier hs-var">lintBinders</span></a><span> </span><a href="#local-1628078926"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628078931"><a href="#local-1628078931"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-917"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#CasePat"><span class="hs-identifier hs-var">CasePat</span></a><span> </span><a href="#local-1628078924"><span class="hs-identifier hs-var">alt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#lintAltBinders"><span class="hs-identifier hs-var">lintAltBinders</span></a><span> </span><a href="#local-1628078922"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><a href="#local-1628078930"><span class="hs-identifier hs-var">con_payload_ty</span></a><span> </span><a href="#local-1628078931"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintAltExpr"><span class="hs-identifier hs-var">lintAltExpr</span></a><span> </span><a href="#local-1628078927"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-1628078923"><span class="hs-identifier hs-var">alt_ty</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-919"></a><span>
</span><a name="line-920"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-comment">-- Scrut-ty is wrong shape</span><span>
</span><a name="line-921"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkBadAltMsg"><span class="hs-identifier hs-var">mkBadAltMsg</span></a><span> </span><a href="#local-1628078922"><span class="hs-identifier hs-var">scrut_ty</span></a><span> </span><a href="#local-1628078924"><span class="hs-identifier hs-var">alt</span></a><span class="hs-special">)</span><span>
</span><a name="line-922"></a><span>
</span><a name="line-923"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lint-types]{Types}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-930"></a><span>
</span><a name="line-931"></a><span class="hs-comment">-- When we lint binders, we (one at a time and in order):</span><span>
</span><a name="line-932"></a><span class="hs-comment">--  1. Lint var types or kinds (possibly substituting)</span><span>
</span><a name="line-933"></a><span class="hs-comment">--  2. Add the binder to the in scope set, and if its a coercion var,</span><span>
</span><a name="line-934"></a><span class="hs-comment">--     we may extend the substitution to reflect its (possibly) new kind</span><span>
</span><a name="line-935"></a><span class="hs-identifier">lintBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078701"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078701"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-936"></a><a name="lintBinders"><a href="CoreLint.html#lintBinders"><span class="hs-identifier">lintBinders</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1628078932"><a href="#local-1628078932"><span class="hs-identifier">linterF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628078932"><span class="hs-identifier hs-var">linterF</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-937"></a><span class="hs-identifier">lintBinders</span><span> </span><span class="hs-special">(</span><a name="local-1628078933"><a href="#local-1628078933"><span class="hs-identifier">var</span></a></a><span class="hs-glyph">:</span><a name="local-1628078934"><a href="#local-1628078934"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628078935"><a href="#local-1628078935"><span class="hs-identifier">linterF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintBinder"><span class="hs-identifier hs-var">lintBinder</span></a><span> </span><a href="#local-1628078933"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628078936"><a href="#local-1628078936"><span class="hs-identifier">var'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-938"></a><span>                                 </span><a href="CoreLint.html#lintBinders"><span class="hs-identifier hs-var">lintBinders</span></a><span> </span><a href="#local-1628078934"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628078937"><a href="#local-1628078937"><span class="hs-identifier">vars'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-939"></a><span>                                 </span><a href="#local-1628078935"><span class="hs-identifier hs-var">linterF</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078936"><span class="hs-identifier hs-var">var'</span></a><span class="hs-glyph">:</span><a href="#local-1628078937"><span class="hs-identifier hs-var">vars'</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><span>
</span><a name="line-941"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-942"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-943"></a><span class="hs-identifier">lintBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078700"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078700"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-944"></a><a name="lintBinder"><a href="CoreLint.html#lintBinder"><span class="hs-identifier">lintBinder</span></a></a><span> </span><a name="local-1628078938"><a href="#local-1628078938"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-1628078939"><a href="#local-1628078939"><span class="hs-identifier">linterF</span></a></a><span>
</span><a name="line-945"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1628078938"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintTyBndr"><span class="hs-identifier hs-var">lintTyBndr</span></a><span> </span><a href="#local-1628078938"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-1628078939"><span class="hs-identifier hs-var">linterF</span></a><span>
</span><a name="line-946"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span> </span><a href="#local-1628078938"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintCoBndr"><span class="hs-identifier hs-var">lintCoBndr</span></a><span> </span><a href="#local-1628078938"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-1628078939"><span class="hs-identifier hs-var">linterF</span></a><span>
</span><a name="line-947"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintIdBndr"><span class="hs-identifier hs-var">lintIdBndr</span></a><span> </span><a href="#local-1628078938"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-1628078939"><span class="hs-identifier hs-var">linterF</span></a><span>
</span><a name="line-948"></a><span>
</span><a name="line-949"></a><span class="hs-identifier">lintTyBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#InTyVar"><span class="hs-identifier hs-type">InTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#OutTyVar"><span class="hs-identifier hs-type">OutTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078699"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078699"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-950"></a><a name="lintTyBndr"><a href="CoreLint.html#lintTyBndr"><span class="hs-identifier">lintTyBndr</span></a></a><span> </span><a name="local-1628078940"><a href="#local-1628078940"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1628078941"><a href="#local-1628078941"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-951"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078942"><a href="#local-1628078942"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier hs-var">getTCvSubst</span></a><span>
</span><a name="line-952"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628078943"><a href="#local-1628078943"><span class="hs-identifier">subst'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078944"><a href="#local-1628078944"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTyVarBndr"><span class="hs-identifier hs-var">substTyVarBndr</span></a><span> </span><a href="#local-1628078942"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1628078940"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-953"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintKind"><span class="hs-identifier hs-var">lintKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628078944"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span>
</span><a name="line-954"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#updateTCvSubst"><span class="hs-identifier hs-var">updateTCvSubst</span></a><span> </span><a href="#local-1628078943"><span class="hs-identifier hs-var">subst'</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078941"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-1628078944"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-955"></a><span>
</span><a name="line-956"></a><span class="hs-identifier">lintCoBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#InCoVar"><span class="hs-identifier hs-type">InCoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#OutCoVar"><span class="hs-identifier hs-type">OutCoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078698"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078698"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-957"></a><a name="lintCoBndr"><a href="CoreLint.html#lintCoBndr"><span class="hs-identifier">lintCoBndr</span></a></a><span> </span><a name="local-1628078945"><a href="#local-1628078945"><span class="hs-identifier">cv</span></a></a><span> </span><a name="local-1628078946"><a href="#local-1628078946"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-958"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078947"><a href="#local-1628078947"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier hs-var">getTCvSubst</span></a><span>
</span><a name="line-959"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628078948"><a href="#local-1628078948"><span class="hs-identifier">subst'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078949"><a href="#local-1628078949"><span class="hs-identifier">cv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substCoVarBndr"><span class="hs-identifier hs-var">substCoVarBndr</span></a><span> </span><a href="#local-1628078947"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1628078945"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-960"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintKind"><span class="hs-identifier hs-var">lintKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628078949"><span class="hs-identifier hs-var">cv'</span></a><span class="hs-special">)</span><span>
</span><a name="line-961"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#isCoercionType"><span class="hs-identifier hs-var">isCoercionType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628078949"><span class="hs-identifier hs-var">cv'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-962"></a><span>               </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CoVar with non-coercion type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprTvBndr"><span class="hs-identifier hs-var">pprTvBndr</span></a><span> </span><a href="#local-1628078945"><span class="hs-identifier hs-var">cv</span></a><span class="hs-special">)</span><span>
</span><a name="line-963"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#updateTCvSubst"><span class="hs-identifier hs-var">updateTCvSubst</span></a><span> </span><a href="#local-1628078948"><span class="hs-identifier hs-var">subst'</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078946"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-1628078949"><span class="hs-identifier hs-var">cv'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-964"></a><span>
</span><a name="line-965"></a><span class="hs-identifier">lintIdBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078697"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078697"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-966"></a><span class="hs-comment">-- Do substitution on the type of a binder and add the var with this</span><span>
</span><a name="line-967"></a><span class="hs-comment">-- new type to the in-scope set of the second argument</span><span>
</span><a name="line-968"></a><span class="hs-comment">-- ToDo: lint its rules</span><span>
</span><a name="line-969"></a><span>
</span><a name="line-970"></a><a name="lintIdBndr"><a href="CoreLint.html#lintIdBndr"><span class="hs-identifier">lintIdBndr</span></a></a><span> </span><a name="local-1628078950"><a href="#local-1628078950"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-1628078951"><a href="#local-1628078951"><span class="hs-identifier">linterF</span></a></a><span>
</span><a name="line-971"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintAndScopeId"><span class="hs-identifier hs-var">lintAndScopeId</span></a><span> </span><a href="#local-1628078950"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628078952"><a href="#local-1628078952"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628078951"><span class="hs-identifier hs-var">linterF</span></a><span> </span><a href="#local-1628078952"><span class="hs-identifier hs-var">id'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-972"></a><span>
</span><a name="line-973"></a><span class="hs-identifier">lintAndScopeIds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078696"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078696"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-974"></a><a name="lintAndScopeIds"><a href="CoreLint.html#lintAndScopeIds"><span class="hs-identifier">lintAndScopeIds</span></a></a><span> </span><a name="local-1628078953"><a href="#local-1628078953"><span class="hs-identifier">ids</span></a></a><span> </span><a name="local-1628078954"><a href="#local-1628078954"><span class="hs-identifier">linterF</span></a></a><span>
</span><a name="line-975"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628078955"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628078953"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-976"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-977"></a><span>    </span><a name="local-1628078955"><a href="#local-1628078955"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628078954"><span class="hs-identifier hs-var">linterF</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-978"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-1628078956"><a href="#local-1628078956"><span class="hs-identifier">id</span></a></a><span class="hs-glyph">:</span><a name="local-1628078957"><a href="#local-1628078957"><span class="hs-identifier">ids</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintAndScopeId"><span class="hs-identifier hs-var">lintAndScopeId</span></a><span> </span><a href="#local-1628078956"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628078958"><a href="#local-1628078958"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-979"></a><span>                  </span><a href="CoreLint.html#lintAndScopeIds"><span class="hs-identifier hs-var">lintAndScopeIds</span></a><span> </span><a href="#local-1628078957"><span class="hs-identifier hs-var">ids</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628078959"><a href="#local-1628078959"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-980"></a><span>                  </span><a href="#local-1628078954"><span class="hs-identifier hs-var">linterF</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078958"><span class="hs-identifier hs-var">id</span></a><span class="hs-glyph">:</span><a href="#local-1628078959"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-981"></a><span>
</span><a name="line-982"></a><span class="hs-identifier">lintAndScopeId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#InVar"><span class="hs-identifier hs-type">InVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#OutVar"><span class="hs-identifier hs-type">OutVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078695"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078695"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-983"></a><a name="lintAndScopeId"><a href="CoreLint.html#lintAndScopeId"><span class="hs-identifier">lintAndScopeId</span></a></a><span> </span><a name="local-1628078960"><a href="#local-1628078960"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-1628078961"><a href="#local-1628078961"><span class="hs-identifier">linterF</span></a></a><span>
</span><a name="line-984"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078962"><a href="#local-1628078962"><span class="hs-identifier">flags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a><span>
</span><a name="line-985"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lf_check_global_ids</span><span> </span><a href="#local-1628078962"><span class="hs-identifier hs-var">flags</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Var.html#isLocalId"><span class="hs-identifier hs-var">isLocalId</span></a><span> </span><a href="#local-1628078960"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-986"></a><span>                </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Non-local Id binder&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078960"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-987"></a><span>                </span><span class="hs-comment">-- See Note [Checking for global Ids]</span><span>
</span><a name="line-988"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628078963"><a href="#local-1628078963"><span class="hs-identifier">ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078964"><a href="#local-1628078964"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintInTy"><span class="hs-identifier hs-var">lintInTy</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628078960"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-989"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Kind.html#isRuntimeRepPolymorphic"><span class="hs-identifier hs-var">isRuntimeRepPolymorphic</span></a><span> </span><a href="#local-1628078964"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-990"></a><span>           </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RuntimeRep-polymorphic binder:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-991"></a><span>                 </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078960"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078963"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078964"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-992"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628078965"><a href="#local-1628078965"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#setIdType"><span class="hs-identifier hs-var">setIdType</span></a><span> </span><a href="#local-1628078960"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-1628078963"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-993"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#addInScopeVar"><span class="hs-identifier hs-var">addInScopeVar</span></a><span> </span><a href="#local-1628078965"><span class="hs-identifier hs-var">id'</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078961"><span class="hs-identifier hs-var">linterF</span></a><span> </span><a href="#local-1628078965"><span class="hs-identifier hs-var">id'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-994"></a><span>
</span><a name="line-995"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
             Types
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-1002"></a><span>
</span><a name="line-1003"></a><span class="hs-identifier">lintInTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#InType"><span class="hs-identifier hs-type">InType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1004"></a><span class="hs-comment">-- Types only, not kinds</span><span>
</span><a name="line-1005"></a><span class="hs-comment">-- Check the type, and apply the substitution to it</span><span>
</span><a name="line-1006"></a><span class="hs-comment">-- See Note [Linting type lets]</span><span>
</span><a name="line-1007"></a><a name="lintInTy"><a href="CoreLint.html#lintInTy"><span class="hs-identifier">lintInTy</span></a></a><span> </span><a name="local-1628078966"><a href="#local-1628078966"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1008"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#InType"><span class="hs-identifier hs-var">InType</span></a><span> </span><a href="#local-1628078966"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1009"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628078967"><a href="#local-1628078967"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#applySubstTy"><span class="hs-identifier hs-var">applySubstTy</span></a><span> </span><a href="#local-1628078966"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1010"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628078968"><a href="#local-1628078968"><span class="hs-identifier">k</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078967"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1011"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintKind"><span class="hs-identifier hs-var">lintKind</span></a><span> </span><a href="#local-1628078968"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1012"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628078967"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628078968"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1013"></a><span>
</span><a name="line-1014"></a><span class="hs-identifier">checkTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1015"></a><a name="checkTyCon"><a href="CoreLint.html#checkTyCon"><span class="hs-identifier">checkTyCon</span></a></a><span> </span><a name="local-1628078969"><a href="#local-1628078969"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-1016"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isTcTyCon"><span class="hs-identifier hs-var">isTcTyCon</span></a><span> </span><a href="#local-1628078969"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Found TcTyCon:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078969"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1017"></a><span>
</span><a name="line-1018"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1019"></a><span class="hs-identifier">lintType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span>
</span><a name="line-1020"></a><span class="hs-comment">-- The returned Kind has itself been linted</span><span>
</span><a name="line-1021"></a><span>
</span><a name="line-1022"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-1023"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-1024"></a><a name="lintType"><a href="CoreLint.html#lintType"><span class="hs-identifier">lintType</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1628078970"><a href="#local-1628078970"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1025"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1628078970"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkBadTyVarMsg"><span class="hs-identifier hs-var">mkBadTyVarMsg</span></a><span> </span><a href="#local-1628078970"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1026"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintTyCoVarInScope"><span class="hs-identifier hs-var">lintTyCoVarInScope</span></a><span> </span><a href="#local-1628078970"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1027"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628078970"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1028"></a><span>         </span><span class="hs-comment">-- We checked its kind when we added it to the envt</span><span>
</span><a name="line-1029"></a><span>
</span><a name="line-1030"></a><span class="hs-identifier">lintType</span><span> </span><a name="local-1628078971"><a href="#local-1628078971"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1628078972"><a href="#local-1628078972"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1628078973"><a href="#local-1628078973"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1031"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628078972"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1032"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TyConApp to the left of AppTy:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078971"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1033"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1034"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078974"><a href="#local-1628078974"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078972"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1035"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628078975"><a href="#local-1628078975"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078973"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1036"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lint_ty_app"><span class="hs-identifier hs-var">lint_ty_app</span></a><span> </span><a href="#local-1628078971"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1628078974"><span class="hs-identifier hs-var">k1</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1628078973"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">,</span><a href="#local-1628078975"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1037"></a><span>
</span><a name="line-1038"></a><span class="hs-identifier">lintType</span><span> </span><a name="local-1628078976"><a href="#local-1628078976"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1628078977"><a href="#local-1628078977"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1628078978"><a href="#local-1628078978"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1039"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628078979"><a href="#local-1628078979"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1628078976"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1040"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078979"><span class="hs-identifier hs-var">ty'</span></a><span>   </span><span class="hs-comment">-- Expand type synonyms, so that we do not bogusly complain</span><span>
</span><a name="line-1041"></a><span>                   </span><span class="hs-comment">--  about un-saturated type synonyms</span><span>
</span><a name="line-1042"></a><span>
</span><a name="line-1043"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isUnliftedTyCon"><span class="hs-identifier hs-var">isUnliftedTyCon</span></a><span> </span><a href="#local-1628078977"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="TyCon.html#isTypeSynonymTyCon"><span class="hs-identifier hs-var">isTypeSynonymTyCon</span></a><span> </span><a href="#local-1628078977"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a><span> </span><a href="#local-1628078977"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1044"></a><span>       </span><span class="hs-comment">-- Also type synonyms and type families</span><span>
</span><a name="line-1045"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628078978"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1628078977"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1046"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Un-saturated type application&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078976"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1047"></a><span>
</span><a name="line-1048"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1049"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkTyCon"><span class="hs-identifier hs-var">checkTyCon</span></a><span> </span><a href="#local-1628078977"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1050"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628078980"><a href="#local-1628078980"><span class="hs-identifier">ks</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078978"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1051"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lint_ty_app"><span class="hs-identifier hs-var">lint_ty_app</span></a><span> </span><a href="#local-1628078976"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1628078977"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628078978"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628078980"><span class="hs-identifier hs-var">ks</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1052"></a><span>
</span><a name="line-1053"></a><span class="hs-comment">-- arrows can related *unlifted* kinds, so this has to be separate from</span><span>
</span><a name="line-1054"></a><span class="hs-comment">-- a dependent forall.</span><span>
</span><a name="line-1055"></a><span class="hs-identifier">lintType</span><span> </span><a name="local-1628078981"><a href="#local-1628078981"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1628078982"><a href="#local-1628078982"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628078983"><a href="#local-1628078983"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1056"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078984"><a href="#local-1628078984"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078982"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1057"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628078985"><a href="#local-1628078985"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078983"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1058"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintArrow"><span class="hs-identifier hs-var">lintArrow</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type or kind&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078981"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628078984"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1628078985"><span class="hs-identifier hs-var">k2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1059"></a><span>
</span><a name="line-1060"></a><span class="hs-identifier">lintType</span><span> </span><a name="local-1628078986"><a href="#local-1628078986"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1628078987"><a href="#local-1628078987"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1628078988"><a href="#local-1628078988"><span class="hs-identifier">_vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628078989"><a href="#local-1628078989"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1061"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1628078987"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Covar bound in type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078986"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1062"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintTyBndr"><span class="hs-identifier hs-var">lintTyBndr</span></a><span> </span><a href="#local-1628078987"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628078990"><a href="#local-1628078990"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1063"></a><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078991"><a href="#local-1628078991"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078989"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1064"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-1628078990"><span class="hs-identifier hs-var">tv'</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628078991"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1065"></a><span>                     </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Variable escape in forall:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078986"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1066"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="Kind.html#classifiesTypeWithValues"><span class="hs-identifier hs-var">classifiesTypeWithValues</span></a><span> </span><a href="#local-1628078991"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-1067"></a><span>                     </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Non-* and non-# kind in forall:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628078986"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1068"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628078991"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-1069"></a><span>
</span><a name="line-1070"></a><span class="hs-identifier">lintType</span><span> </span><a name="local-1628078992"><a href="#local-1628078992"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-1628078993"><a href="#local-1628078993"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintTyLit"><span class="hs-identifier hs-var">lintTyLit</span></a><span> </span><a href="#local-1628078993"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628078992"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1071"></a><span>
</span><a name="line-1072"></a><span class="hs-identifier">lintType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1628078994"><a href="#local-1628078994"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628078995"><a href="#local-1628078995"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1073"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628078996"><a href="#local-1628078996"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628078994"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1074"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628078997"><a href="#local-1628078997"><span class="hs-identifier">k1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628078998"><a href="#local-1628078998"><span class="hs-identifier">k2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintStarCoercion"><span class="hs-identifier hs-var">lintStarCoercion</span></a><span> </span><a href="#local-1628078995"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1075"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628078996"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1628078997"><span class="hs-identifier hs-var">k1'</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkCastErr"><span class="hs-identifier hs-var">mkCastErr</span></a><span> </span><a href="#local-1628078994"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1628078995"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628078997"><span class="hs-identifier hs-var">k1'</span></a><span> </span><a href="#local-1628078996"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1076"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628078998"><span class="hs-identifier hs-var">k2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1077"></a><span>
</span><a name="line-1078"></a><span class="hs-identifier">lintType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1628078999"><a href="#local-1628078999"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1079"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079000"><a href="#local-1628079000"><span class="hs-identifier">k1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079001"><a href="#local-1628079001"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079002"><a href="#local-1628079002"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079003"><a href="#local-1628079003"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079004"><a href="#local-1628079004"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628078999"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1080"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#mkHeteroCoercionType"><span class="hs-identifier hs-var">mkHeteroCoercionType</span></a><span> </span><a href="#local-1628079004"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628079000"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1628079001"><span class="hs-identifier hs-var">k2</span></a><span> </span><a href="#local-1628079002"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628079003"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1081"></a><span>
</span><a name="line-1082"></a><span class="hs-identifier">lintKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutKind"><span class="hs-identifier hs-type">OutKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1083"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-1084"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-1085"></a><a name="lintKind"><a href="CoreLint.html#lintKind"><span class="hs-identifier">lintKind</span></a></a><span> </span><a name="local-1628079005"><a href="#local-1628079005"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079006"><a href="#local-1628079006"><span class="hs-identifier">sk</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628079005"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1086"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Kind.html#isStarKind"><span class="hs-identifier hs-var">isStarKind</span></a><span> </span><a href="#local-1628079006"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#isUnliftedTypeKind"><span class="hs-identifier hs-var">isUnliftedTypeKind</span></a><span> </span><a href="#local-1628079006"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1087"></a><span>                         </span><span class="hs-special">(</span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Ill-kinded kind:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079005"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-1088"></a><span>                                      </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;has kind:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079006"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1089"></a><span>
</span><a name="line-1090"></a><span class="hs-comment">-- confirms that a type is really *</span><span>
</span><a name="line-1091"></a><span class="hs-identifier">lintStar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutKind"><span class="hs-identifier hs-type">OutKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1092"></a><a name="lintStar"><a href="CoreLint.html#lintStar"><span class="hs-identifier">lintStar</span></a></a><span> </span><a name="local-1628079007"><a href="#local-1628079007"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-1628079008"><a href="#local-1628079008"><span class="hs-identifier">k</span></a></a><span>
</span><a name="line-1093"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="Kind.html#classifiesTypeWithValues"><span class="hs-identifier hs-var">classifiesTypeWithValues</span></a><span> </span><a href="#local-1628079008"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-1094"></a><span>          </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Non-*-like kind when *-like expected:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079008"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1095"></a><span>           </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;when checking&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628079007"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1096"></a><span>
</span><a name="line-1097"></a><span class="hs-identifier">lintArrow</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span>
</span><a name="line-1098"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-1099"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-1100"></a><a name="lintArrow"><a href="CoreLint.html#lintArrow"><span class="hs-identifier">lintArrow</span></a></a><span> </span><a name="local-1628079009"><a href="#local-1628079009"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-1628079010"><a href="#local-1628079010"><span class="hs-identifier">k1</span></a></a><span> </span><a name="local-1628079011"><a href="#local-1628079011"><span class="hs-identifier">k2</span></a></a><span>   </span><span class="hs-comment">-- Eg lintArrow &quot;type or kind `blah'&quot; k1 k2</span><span>
</span><a name="line-1101"></a><span>                       </span><span class="hs-comment">-- or lintarrow &quot;coercion `blah'&quot; k1 k2</span><span>
</span><a name="line-1102"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="Kind.html#okArrowArgKind"><span class="hs-identifier hs-var">okArrowArgKind</span></a><span> </span><a href="#local-1628079010"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079012"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;argument&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628079010"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1103"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="Kind.html#okArrowResultKind"><span class="hs-identifier hs-var">okArrowResultKind</span></a><span> </span><a href="#local-1628079011"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079012"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;result&quot;</span><span class="hs-special">)</span><span>   </span><a href="#local-1628079011"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1104"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1105"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1106"></a><span>    </span><a name="local-1628079012"><a href="#local-1628079012"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-1628079013"><a href="#local-1628079013"><span class="hs-identifier">ar</span></a></a><span> </span><a name="local-1628079014"><a href="#local-1628079014"><span class="hs-identifier">k</span></a></a><span>
</span><a name="line-1107"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Ill-kinded&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628079013"><span class="hs-identifier hs-var">ar</span></a><span class="hs-special">)</span><span>
</span><a name="line-1108"></a><span>                  </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628079009"><span class="hs-identifier hs-var">what</span></a><span class="hs-special">)</span><span>
</span><a name="line-1109"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="#local-1628079009"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kind:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079014"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1110"></a><span>
</span><a name="line-1111"></a><span class="hs-identifier">lint_ty_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span>
</span><a name="line-1112"></a><a name="lint_ty_app"><a href="CoreLint.html#lint_ty_app"><span class="hs-identifier">lint_ty_app</span></a></a><span> </span><a name="local-1628079015"><a href="#local-1628079015"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628079016"><a href="#local-1628079016"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-1628079017"><a href="#local-1628079017"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1113"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lint_app"><span class="hs-identifier hs-var">lint_app</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079015"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628079016"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1628079017"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1114"></a><span>
</span><a name="line-1115"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-1116"></a><span class="hs-identifier">lint_co_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span>
</span><a name="line-1117"></a><a name="lint_co_app"><a href="CoreLint.html#lint_co_app"><span class="hs-identifier">lint_co_app</span></a></a><span> </span><a name="local-1628079018"><a href="#local-1628079018"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628079019"><a href="#local-1628079019"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-1628079020"><a href="#local-1628079020"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1118"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lint_app"><span class="hs-identifier hs-var">lint_app</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;coercion&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079018"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628079019"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1628079020"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1119"></a><span>
</span><a name="line-1120"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-1121"></a><span class="hs-identifier">lintTyLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1122"></a><a name="lintTyLit"><a href="CoreLint.html#lintTyLit"><span class="hs-identifier">lintTyLit</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a name="local-1628079021"><a href="#local-1628079021"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1123"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628079021"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1124"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><a href="#local-1628079022"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-1125"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-1628079022"><a href="#local-1628079022"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Negative type literal:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#integer"><span class="hs-identifier hs-var">integer</span></a><span> </span><a href="#local-1628079021"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1126"></a><span class="hs-identifier">lintTyLit</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1127"></a><span>
</span><a name="line-1128"></a><span class="hs-identifier">lint_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-1129"></a><span class="hs-comment">-- (lint_app d fun_kind arg_tys)</span><span>
</span><a name="line-1130"></a><span class="hs-comment">--    We have an application (f arg_ty1 .. arg_tyn),</span><span>
</span><a name="line-1131"></a><span class="hs-comment">--    where f :: fun_kind</span><span>
</span><a name="line-1132"></a><span class="hs-comment">-- Takes care of linting the OutTypes</span><span>
</span><a name="line-1133"></a><span>
</span><a name="line-1134"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-1135"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-1136"></a><a name="lint_app"><a href="CoreLint.html#lint_app"><span class="hs-identifier">lint_app</span></a></a><span> </span><a name="local-1628079023"><a href="#local-1628079023"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-1628079024"><a href="#local-1628079024"><span class="hs-identifier">kfn</span></a></a><span> </span><a name="local-1628079025"><a href="#local-1628079025"><span class="hs-identifier">kas</span></a></a><span>
</span><a name="line-1137"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079041"><a href="#local-1628079041"><span class="hs-identifier">in_scope</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getInScope"><span class="hs-identifier hs-var">getInScope</span></a><span>
</span><a name="line-1138"></a><span>         </span><span class="hs-comment">-- We need the in_scope set to satisfy the invariant in</span><span>
</span><a name="line-1139"></a><span>         </span><span class="hs-comment">-- Note [The substitution invariant] in TyCoRep</span><span>
</span><a name="line-1140"></a><span>         </span><span class="hs-special">;</span><span> </span><a href="MonadUtils.html#foldlM"><span class="hs-identifier hs-var">foldlM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079027"><span class="hs-identifier hs-var">go_app</span></a><span> </span><a href="#local-1628079041"><span class="hs-identifier hs-var">in_scope</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079024"><span class="hs-identifier hs-var">kfn</span></a><span> </span><a href="#local-1628079025"><span class="hs-identifier hs-var">kas</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1141"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1142"></a><span>    </span><a name="local-1628079026"><a href="#local-1628079026"><span class="hs-identifier">fail_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Kind application error in&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-1628079023"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-1143"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Function kind =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079024"><span class="hs-identifier hs-var">kfn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1144"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Arg kinds =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079025"><span class="hs-identifier hs-var">kas</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1145"></a><span>
</span><a name="line-1146"></a><span>    </span><a name="local-1628079027"><a href="#local-1628079027"><span class="hs-identifier">go_app</span></a></a><span> </span><a name="local-1628079028"><a href="#local-1628079028"><span class="hs-identifier">in_scope</span></a></a><span> </span><a name="local-1628079029"><a href="#local-1628079029"><span class="hs-identifier">kfn</span></a></a><span> </span><a name="local-1628079030"><a href="#local-1628079030"><span class="hs-identifier">ka</span></a></a><span>
</span><a name="line-1147"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628079031"><a href="#local-1628079031"><span class="hs-identifier">kfn'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1628079029"><span class="hs-identifier hs-var">kfn</span></a><span>
</span><a name="line-1148"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079027"><span class="hs-identifier hs-var">go_app</span></a><span> </span><a href="#local-1628079028"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-1628079031"><span class="hs-identifier hs-var">kfn'</span></a><span> </span><a href="#local-1628079030"><span class="hs-identifier hs-var">ka</span></a><span>
</span><a name="line-1149"></a><span>
</span><a name="line-1150"></a><span>    </span><span class="hs-identifier">go_app</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1628079032"><a href="#local-1628079032"><span class="hs-identifier">kfa</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628079033"><a href="#local-1628079033"><span class="hs-identifier">kfb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1628079034"><a href="#local-1628079034"><span class="hs-identifier">ka</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1151"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079034"><span class="hs-identifier hs-var">ka</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079032"><span class="hs-identifier hs-var">kfa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><a href="#local-1628079026"><span class="hs-identifier hs-var">fail_msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-1152"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628079033"><span class="hs-identifier hs-var">kfb</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1153"></a><span>
</span><a name="line-1154"></a><span>    </span><span class="hs-identifier">go_app</span><span> </span><a name="local-1628079035"><a href="#local-1628079035"><span class="hs-identifier">in_scope</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1628079036"><a href="#local-1628079036"><span class="hs-identifier">kv</span></a></a><span> </span><a name="local-1628079037"><a href="#local-1628079037"><span class="hs-identifier">_vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628079038"><a href="#local-1628079038"><span class="hs-identifier">kfn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1628079039"><a href="#local-1628079039"><span class="hs-identifier">ta</span></a></a><span class="hs-special">,</span><a name="local-1628079040"><a href="#local-1628079040"><span class="hs-identifier">ka</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1155"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079040"><span class="hs-identifier hs-var">ka</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079036"><span class="hs-identifier hs-var">kv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><a href="#local-1628079026"><span class="hs-identifier hs-var">fail_msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-1156"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyWithInScope"><span class="hs-identifier hs-var">substTyWithInScope</span></a><span> </span><a href="#local-1628079035"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628079036"><span class="hs-identifier hs-var">kv</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-1628079039"><span class="hs-identifier hs-var">ta</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628079038"><span class="hs-identifier hs-var">kfn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1157"></a><span>
</span><a name="line-1158"></a><span>    </span><span class="hs-identifier">go_app</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><a href="#local-1628079026"><span class="hs-identifier hs-var">fail_msg</span></a><span>
</span><a name="line-1159"></a><span>
</span><a name="line-1160"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
        Linting rules
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-1165"></a><span>
</span><a name="line-1166"></a><span class="hs-identifier">lintCoreRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1167"></a><a name="lintCoreRule"><a href="CoreLint.html#lintCoreRule"><span class="hs-identifier">lintCoreRule</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#BuiltinRule"><span class="hs-identifier hs-var">BuiltinRule</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1168"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Don't bother</span><span>
</span><a name="line-1169"></a><span>
</span><a name="line-1170"></a><span class="hs-identifier">lintCoreRule</span><span> </span><a name="local-1628079042"><a href="#local-1628079042"><span class="hs-identifier">fun_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Rule"><span class="hs-identifier hs-var">Rule</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ru_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079043"><a href="#local-1628079043"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ru_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079044"><a href="#local-1628079044"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-1171"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ru_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079045"><a href="#local-1628079045"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ru_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079046"><a href="#local-1628079046"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1172"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintBinders"><span class="hs-identifier hs-var">lintBinders</span></a><span> </span><a href="#local-1628079044"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1173"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079048"><a href="#local-1628079048"><span class="hs-identifier">lhs_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#foldM"><span class="hs-identifier hs-var">foldM</span></a><span> </span><a href="CoreLint.html#lintCoreArg"><span class="hs-identifier hs-var">lintCoreArg</span></a><span> </span><a href="#local-1628079042"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><a href="#local-1628079045"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1174"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079049"><a href="#local-1628079049"><span class="hs-identifier">rhs_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a><span> </span><a href="#local-1628079046"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1175"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628079048"><span class="hs-identifier hs-var">lhs_ty</span></a><span> </span><a href="#local-1628079049"><span class="hs-identifier hs-var">rhs_ty</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1176"></a><span>         </span><span class="hs-special">(</span><a href="#local-1628079047"><span class="hs-identifier hs-var">rule_doc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lhs type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079048"><span class="hs-identifier hs-var">lhs_ty</span></a><span>
</span><a name="line-1177"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;rhs type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079049"><span class="hs-identifier hs-var">rhs_ty</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1178"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079050"><a href="#local-1628079050"><span class="hs-identifier">bad_bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="CoreFVs.html#exprsFreeVars"><span class="hs-identifier hs-var">exprsFreeVars</span></a><span> </span><a href="#local-1628079045"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079044"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1179"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628079050"><span class="hs-identifier hs-var">bad_bndrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1180"></a><span>                </span><span class="hs-special">(</span><a href="#local-1628079047"><span class="hs-identifier hs-var">rule_doc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;unbound&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079050"><span class="hs-identifier hs-var">bad_bndrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1181"></a><span>            </span><span class="hs-comment">-- See Note [Linting rules]</span><span>
</span><a name="line-1182"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1183"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1184"></a><span>    </span><a name="local-1628079047"><a href="#local-1628079047"><span class="hs-identifier">rule_doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Rule&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#doubleQuotes"><span class="hs-identifier hs-var">doubleQuotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a><span> </span><a href="#local-1628079043"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span>
</span><a name="line-1185"></a><span>
</span><a name="line-1186"></a><span class="hs-comment">{- Note [Linting rules]
~~~~~~~~~~~~~~~~~~~~~~~
It's very bad if simplifying a rule means that one of the template
variables (ru_bndrs) becomes not-mentioned in the template argumments
(ru_args).  How can that happen?  Well, in Trac #10602, SpecConstr
stupidly constructed a rule like

  forall x,c1,c2.
     f (x |&gt; c1 |&gt; c2) = ....

But simplExpr collapses those coercions into one.  (Indeed in
Trac #10602, it collapsed to the identity and was removed altogether.)

We don't have a great story for what to do here, but at least
this check will nail it.
-}</span><span>
</span><a name="line-1202"></a><span>
</span><a name="line-1203"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
         Linting coercions
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1210"></a><span>
</span><a name="line-1211"></a><span class="hs-identifier">lintInCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#InCoercion"><span class="hs-identifier hs-type">InCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">)</span><span>
</span><a name="line-1212"></a><span class="hs-comment">-- Check the coercion, and apply the substitution to it</span><span>
</span><a name="line-1213"></a><span class="hs-comment">-- See Note [Linting type lets]</span><span>
</span><a name="line-1214"></a><a name="lintInCo"><a href="CoreLint.html#lintInCo"><span class="hs-identifier">lintInCo</span></a></a><span> </span><a name="local-1628079051"><a href="#local-1628079051"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1215"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#InCo"><span class="hs-identifier hs-var">InCo</span></a><span> </span><a href="#local-1628079051"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1216"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628079052"><a href="#local-1628079052"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#applySubstCo"><span class="hs-identifier hs-var">applySubstCo</span></a><span> </span><a href="#local-1628079051"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1217"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079052"><span class="hs-identifier hs-var">co'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1218"></a><span>
</span><a name="line-1219"></a><span class="hs-comment">-- lints a coercion, confirming that its lh kind and its rh kind are both *</span><span>
</span><a name="line-1220"></a><span class="hs-comment">-- also ensures that the role is Nominal</span><span>
</span><a name="line-1221"></a><span class="hs-identifier">lintStarCoercion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutCoercion"><span class="hs-identifier hs-type">OutCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">)</span><span>
</span><a name="line-1222"></a><a name="lintStarCoercion"><a href="CoreLint.html#lintStarCoercion"><span class="hs-identifier">lintStarCoercion</span></a></a><span> </span><a name="local-1628079053"><a href="#local-1628079053"><span class="hs-identifier">g</span></a></a><span>
</span><a name="line-1223"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079054"><a href="#local-1628079054"><span class="hs-identifier">k1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079055"><a href="#local-1628079055"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079056"><a href="#local-1628079056"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079057"><a href="#local-1628079057"><span class="hs-identifier">t2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079058"><a href="#local-1628079058"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079053"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1224"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintStar"><span class="hs-identifier hs-var">lintStar</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the kind of the left type in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079053"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079054"><span class="hs-identifier hs-var">k1</span></a><span>
</span><a name="line-1225"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintStar"><span class="hs-identifier hs-var">lintStar</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the kind of the right type in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079053"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079055"><span class="hs-identifier hs-var">k2</span></a><span>
</span><a name="line-1226"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079053"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><a href="#local-1628079058"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1227"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079056"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079057"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1228"></a><span>
</span><a name="line-1229"></a><span class="hs-identifier">lintCoercion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutCoercion"><span class="hs-identifier hs-type">OutCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">)</span><span>
</span><a name="line-1230"></a><span class="hs-comment">-- Check the kind of a coercion term, returning the kind</span><span>
</span><a name="line-1231"></a><span class="hs-comment">-- Post-condition: the returned OutTypes are lint-free</span><span>
</span><a name="line-1232"></a><span class="hs-comment">--</span><span>
</span><a name="line-1233"></a><span class="hs-comment">-- If   lintCorecion co = (k1, k2, s1, s2, r)</span><span>
</span><a name="line-1234"></a><span class="hs-comment">-- then co :: s1 ~r s2</span><span>
</span><a name="line-1235"></a><span class="hs-comment">--      s1 :: k2</span><span>
</span><a name="line-1236"></a><span class="hs-comment">--      s2 :: k2</span><span>
</span><a name="line-1237"></a><span>
</span><a name="line-1238"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-1239"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-1240"></a><a name="lintCoercion"><a href="CoreLint.html#lintCoercion"><span class="hs-identifier">lintCoercion</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><a name="local-1628079059"><a href="#local-1628079059"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1628079060"><a href="#local-1628079060"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1241"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079061"><a href="#local-1628079061"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628079060"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1242"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079061"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079061"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079060"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079060"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079059"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1243"></a><span>
</span><a name="line-1244"></a><span class="hs-identifier">lintCoercion</span><span> </span><a name="local-1628079062"><a href="#local-1628079062"><span class="hs-identifier">co</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span> </span><a name="local-1628079063"><a href="#local-1628079063"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1628079064"><a href="#local-1628079064"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1628079065"><a href="#local-1628079065"><span class="hs-identifier">cos</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1245"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628079064"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#funTyConKey"><span class="hs-identifier hs-var">funTyConKey</span></a><span>
</span><a name="line-1246"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-1628079066"><a href="#local-1628079066"><span class="hs-identifier">co1</span></a></a><span class="hs-special">,</span><a name="local-1628079067"><a href="#local-1628079067"><span class="hs-identifier">co2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628079065"><span class="hs-identifier hs-var">cos</span></a><span>
</span><a name="line-1247"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079068"><a href="#local-1628079068"><span class="hs-identifier">k1</span></a></a><span class="hs-special">,</span><a name="local-1628079069"><a href="#local-1628079069"><span class="hs-identifier">k'1</span></a></a><span class="hs-special">,</span><a name="local-1628079070"><a href="#local-1628079070"><span class="hs-identifier">s1</span></a></a><span class="hs-special">,</span><a name="local-1628079071"><a href="#local-1628079071"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-1628079072"><a href="#local-1628079072"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079066"><span class="hs-identifier hs-var">co1</span></a><span>
</span><a name="line-1248"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628079073"><a href="#local-1628079073"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><a name="local-1628079074"><a href="#local-1628079074"><span class="hs-identifier">k'2</span></a></a><span class="hs-special">,</span><a name="local-1628079075"><a href="#local-1628079075"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><a name="local-1628079076"><a href="#local-1628079076"><span class="hs-identifier">t2</span></a></a><span class="hs-special">,</span><a name="local-1628079077"><a href="#local-1628079077"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079067"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-1249"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079078"><a href="#local-1628079078"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintArrow"><span class="hs-identifier hs-var">lintArrow</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;coercion&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079062"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628079068"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1628079073"><span class="hs-identifier hs-var">k2</span></a><span>
</span><a name="line-1250"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079079"><a href="#local-1628079079"><span class="hs-identifier">k'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintArrow"><span class="hs-identifier hs-var">lintArrow</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;coercion&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079062"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628079069"><span class="hs-identifier hs-var">k'1</span></a><span> </span><a href="#local-1628079074"><span class="hs-identifier hs-var">k'2</span></a><span>
</span><a name="line-1251"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079066"><span class="hs-identifier hs-var">co1</span></a><span> </span><a href="#local-1628079063"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628079072"><span class="hs-identifier hs-var">r1</span></a><span>
</span><a name="line-1252"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079067"><span class="hs-identifier hs-var">co2</span></a><span> </span><a href="#local-1628079063"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628079077"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-1253"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079078"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079079"><span class="hs-identifier hs-var">k'</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><a href="#local-1628079070"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-1628079075"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><a href="#local-1628079071"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1628079076"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079063"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1254"></a><span>
</span><a name="line-1255"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#synTyConDefn_maybe"><span class="hs-identifier hs-var">synTyConDefn_maybe</span></a><span> </span><a href="#local-1628079064"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1256"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Synonym in TyConAppCo:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079062"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1257"></a><span>
</span><a name="line-1258"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1259"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#checkTyCon"><span class="hs-identifier hs-var">checkTyCon</span></a><span> </span><a href="#local-1628079064"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1260"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628079080"><a href="#local-1628079080"><span class="hs-identifier">k's</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079081"><a href="#local-1628079081"><span class="hs-identifier">ks</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079082"><a href="#local-1628079082"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079083"><a href="#local-1628079083"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079084"><a href="#local-1628079084"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapAndUnzip5M"><span class="hs-identifier hs-var">mapAndUnzip5M</span></a><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079065"><span class="hs-identifier hs-var">cos</span></a><span>
</span><a name="line-1261"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079085"><a href="#local-1628079085"><span class="hs-identifier">k'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lint_co_app"><span class="hs-identifier hs-var">lint_co_app</span></a><span> </span><a href="#local-1628079062"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1628079064"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628079082"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079080"><span class="hs-identifier hs-var">k's</span></a><span class="hs-special">)</span><span>
</span><a name="line-1262"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079086"><a href="#local-1628079086"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lint_co_app"><span class="hs-identifier hs-var">lint_co_app</span></a><span> </span><a href="#local-1628079062"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1628079064"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628079083"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079081"><span class="hs-identifier hs-var">ks</span></a><span class="hs-special">)</span><span>
</span><a name="line-1263"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#zipWith3M"><span class="hs-identifier hs-var">zipWith3M</span></a><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079065"><span class="hs-identifier hs-var">cos</span></a><span> </span><span class="hs-special">(</span><a href="Coercion.html#tyConRolesX"><span class="hs-identifier hs-var">tyConRolesX</span></a><span> </span><a href="#local-1628079063"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628079064"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079084"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1264"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079085"><span class="hs-identifier hs-var">k'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079086"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1628079064"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1628079082"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1628079064"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1628079083"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079063"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1265"></a><span>
</span><a name="line-1266"></a><span class="hs-identifier">lintCoercion</span><span> </span><a name="local-1628079087"><a href="#local-1628079087"><span class="hs-identifier">co</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span> </span><a name="local-1628079088"><a href="#local-1628079088"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-1628079089"><a href="#local-1628079089"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1267"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628079088"><span class="hs-identifier hs-var">co1</span></a><span>
</span><a name="line-1268"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TyConAppCo to the left of AppCo:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079087"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1269"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628079088"><span class="hs-identifier hs-var">co1</span></a><span>
</span><a name="line-1270"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Refl (TyConApp ...) to the left of AppCo:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079087"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1272"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079090"><a href="#local-1628079090"><span class="hs-identifier">k1</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-1628079091"><a href="#local-1628079091"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-1628079092"><a href="#local-1628079092"><span class="hs-identifier">s1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079093"><a href="#local-1628079093"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079094"><a href="#local-1628079094"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079088"><span class="hs-identifier hs-var">co1</span></a><span>
</span><a name="line-1273"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628079095"><a href="#local-1628079095"><span class="hs-identifier">k'1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079096"><a href="#local-1628079096"><span class="hs-identifier">k'2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079097"><a href="#local-1628079097"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079098"><a href="#local-1628079098"><span class="hs-identifier">t2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079099"><a href="#local-1628079099"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079089"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-1274"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079100"><a href="#local-1628079100"><span class="hs-identifier">k3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lint_co_app"><span class="hs-identifier hs-var">lint_co_app</span></a><span> </span><a href="#local-1628079087"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628079090"><span class="hs-identifier hs-var">k1</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1628079097"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><a href="#local-1628079095"><span class="hs-identifier hs-var">k'1</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1275"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079101"><a href="#local-1628079101"><span class="hs-identifier">k4</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lint_co_app"><span class="hs-identifier hs-var">lint_co_app</span></a><span> </span><a href="#local-1628079087"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628079091"><span class="hs-identifier hs-var">k2</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1628079098"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">,</span><a href="#local-1628079096"><span class="hs-identifier hs-var">k'2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1276"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628079094"><span class="hs-identifier hs-var">r1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span>
</span><a name="line-1277"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079099"><span class="hs-identifier hs-var">r2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1628079099"><span class="hs-identifier hs-var">r2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">)</span><span>
</span><a name="line-1278"></a><span>                     </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Second argument in AppCo cannot be R:&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1279"></a><span>                      </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079087"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1280"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079087"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><a href="#local-1628079099"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-1281"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079100"><span class="hs-identifier hs-var">k3</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079101"><span class="hs-identifier hs-var">k4</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span> </span><a href="#local-1628079092"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-1628079097"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span> </span><a href="#local-1628079093"><span class="hs-identifier hs-var">s2</span></a><span> </span><a href="#local-1628079098"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079094"><span class="hs-identifier hs-var">r1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1282"></a><span>
</span><a name="line-1283"></a><span class="hs-comment">----------</span><span>
</span><a name="line-1284"></a><span class="hs-identifier">lintCoercion</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><a name="local-1628079102"><a href="#local-1628079102"><span class="hs-identifier">tv1</span></a></a><span> </span><a name="local-1628079103"><a href="#local-1628079103"><span class="hs-identifier">kind_co</span></a></a><span> </span><a name="local-1628079104"><a href="#local-1628079104"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1285"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628079105"><a href="#local-1628079105"><span class="hs-identifier">k2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintStarCoercion"><span class="hs-identifier hs-var">lintStarCoercion</span></a><span> </span><a href="#local-1628079103"><span class="hs-identifier hs-var">kind_co</span></a><span>
</span><a name="line-1286"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079106"><a href="#local-1628079106"><span class="hs-identifier">tv2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#setTyVarKind"><span class="hs-identifier hs-var">setTyVarKind</span></a><span> </span><a href="#local-1628079102"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628079105"><span class="hs-identifier hs-var">k2</span></a><span>
</span><a name="line-1287"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628079107"><a href="#local-1628079107"><span class="hs-identifier">k3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079108"><a href="#local-1628079108"><span class="hs-identifier">k4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079109"><a href="#local-1628079109"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079110"><a href="#local-1628079110"><span class="hs-identifier">t2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079111"><a href="#local-1628079111"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#addInScopeVar"><span class="hs-identifier hs-var">addInScopeVar</span></a><span> </span><a href="#local-1628079102"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079104"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1288"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079112"><a href="#local-1628079112"><span class="hs-identifier">tyl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkNamedForAllTy"><span class="hs-identifier hs-var">mkNamedForAllTy</span></a><span> </span><a href="#local-1628079102"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="TyCoRep.html#Invisible"><span class="hs-identifier hs-var">Invisible</span></a><span> </span><a href="#local-1628079109"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1289"></a><span>             </span><a name="local-1628079113"><a href="#local-1628079113"><span class="hs-identifier">tyr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkNamedForAllTy"><span class="hs-identifier hs-var">mkNamedForAllTy</span></a><span> </span><a href="#local-1628079106"><span class="hs-identifier hs-var">tv2</span></a><span> </span><a href="TyCoRep.html#Invisible"><span class="hs-identifier hs-var">Invisible</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1290"></a><span>                   </span><a href="TyCoRep.html#substTyWithUnchecked"><span class="hs-identifier hs-var">substTyWithUnchecked</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628079102"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a href="#local-1628079106"><span class="hs-identifier hs-var">tv2</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span class="hs-special">`</span><span> </span><a href="Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a><span> </span><a href="#local-1628079103"><span class="hs-identifier hs-var">kind_co</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628079110"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1291"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079107"><span class="hs-identifier hs-var">k3</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079108"><span class="hs-identifier hs-var">k4</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079112"><span class="hs-identifier hs-var">tyl</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079113"><span class="hs-identifier hs-var">tyr</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079111"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1292"></a><span>
</span><a name="line-1293"></a><span class="hs-identifier">lintCoercion</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a><span> </span><a name="local-1628079114"><a href="#local-1628079114"><span class="hs-identifier">cv</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1294"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span> </span><a href="#local-1628079114"><span class="hs-identifier hs-var">cv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1295"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Bad CoVarCo:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079114"><span class="hs-identifier hs-var">cv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1296"></a><span>                  </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;With offending type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628079114"><span class="hs-identifier hs-var">cv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1297"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1298"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintTyCoVarInScope"><span class="hs-identifier hs-var">lintTyCoVarInScope</span></a><span> </span><a href="#local-1628079114"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-1299"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079115"><a href="#local-1628079115"><span class="hs-identifier">cv'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lookupIdInScope"><span class="hs-identifier hs-var">lookupIdInScope</span></a><span> </span><a href="#local-1628079114"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-1300"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintUnliftedCoVar"><span class="hs-identifier hs-var">lintUnliftedCoVar</span></a><span> </span><a href="#local-1628079114"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-1301"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#coVarKindsTypesRole"><span class="hs-identifier hs-var">coVarKindsTypesRole</span></a><span> </span><a href="#local-1628079115"><span class="hs-identifier hs-var">cv'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1302"></a><span>
</span><a name="line-1303"></a><span class="hs-comment">-- See Note [Bad unsafe coercion]</span><span>
</span><a name="line-1304"></a><span class="hs-identifier">lintCoercion</span><span> </span><a name="local-1628079116"><a href="#local-1628079116"><span class="hs-identifier">co</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span> </span><a name="local-1628079117"><a href="#local-1628079117"><span class="hs-identifier">prov</span></a></a><span> </span><a name="local-1628079118"><a href="#local-1628079118"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1628079119"><a href="#local-1628079119"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628079120"><a href="#local-1628079120"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1305"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079140"><a href="#local-1628079140"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628079119"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1306"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079141"><a href="#local-1628079141"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628079120"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1307"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628079117"><span class="hs-identifier hs-var">prov</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1308"></a><span>           </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- no extra checks</span><span>
</span><a name="line-1309"></a><span>
</span><a name="line-1310"></a><span>           </span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a name="local-1628079142"><a href="#local-1628079142"><span class="hs-identifier">kco</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079116"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span> </span><a href="#local-1628079118"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1311"></a><span>                                    </span><span class="hs-special">;</span><span> </span><a href="#local-1628079125"><span class="hs-identifier hs-var">check_kinds</span></a><span> </span><a href="#local-1628079142"><span class="hs-identifier hs-var">kco</span></a><span> </span><a href="#local-1628079140"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1628079141"><span class="hs-identifier hs-var">k2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1312"></a><span>
</span><a name="line-1313"></a><span>           </span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a name="local-1628079143"><a href="#local-1628079143"><span class="hs-identifier">kco</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a><span> </span><a href="#local-1628079119"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1314"></a><span>                                          </span><a href="CoreLint.html#mkBadProofIrrelMsg"><span class="hs-identifier hs-var">mkBadProofIrrelMsg</span></a><span> </span><a href="#local-1628079119"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628079116"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1315"></a><span>                                    </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a><span> </span><a href="#local-1628079120"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1316"></a><span>                                          </span><a href="CoreLint.html#mkBadProofIrrelMsg"><span class="hs-identifier hs-var">mkBadProofIrrelMsg</span></a><span> </span><a href="#local-1628079120"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-1628079116"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1317"></a><span>                                    </span><span class="hs-special">;</span><span> </span><a href="#local-1628079125"><span class="hs-identifier hs-var">check_kinds</span></a><span> </span><a href="#local-1628079143"><span class="hs-identifier hs-var">kco</span></a><span> </span><a href="#local-1628079140"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1628079141"><span class="hs-identifier hs-var">k2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1318"></a><span>
</span><a name="line-1319"></a><span>           </span><a href="TyCoRep.html#PluginProv"><span class="hs-identifier hs-var">PluginProv</span></a><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- no extra checks</span><span>
</span><a name="line-1320"></a><span>           </span><a href="TyCoRep.html#HoleProv"><span class="hs-identifier hs-var">HoleProv</span></a><span> </span><a name="local-1628079144"><a href="#local-1628079144"><span class="hs-identifier">h</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1321"></a><span>                               </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unfilled coercion hole:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079144"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-1322"></a><span>
</span><a name="line-1323"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079118"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Kind.html#classifiesTypeWithValues"><span class="hs-identifier hs-var">classifiesTypeWithValues</span></a><span> </span><a href="#local-1628079140"><span class="hs-identifier hs-var">k1</span></a><span>
</span><a name="line-1324"></a><span>                            </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Kind.html#classifiesTypeWithValues"><span class="hs-identifier hs-var">classifiesTypeWithValues</span></a><span> </span><a href="#local-1628079141"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1325"></a><span>              </span><span class="hs-special">(</span><a href="#local-1628079123"><span class="hs-identifier hs-var">checkTypes</span></a><span> </span><a href="#local-1628079119"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628079120"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1326"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079140"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079141"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079119"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079120"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079118"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1327"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1328"></a><span>     </span><a name="local-1628079121"><a href="#local-1628079121"><span class="hs-identifier">report</span></a></a><span> </span><a name="local-1628079126"><a href="#local-1628079126"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-string">&quot;Unsafe coercion between &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628079126"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-1329"></a><span>                     </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;From:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079119"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1330"></a><span>                             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;  To:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079120"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1331"></a><span>     </span><span class="hs-identifier">isUnBoxed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1332"></a><span>     </span><a name="local-1628079122"><a href="#local-1628079122"><span class="hs-identifier">isUnBoxed</span></a></a><span> </span><a href="TyCon.html#PtrRep"><span class="hs-identifier hs-var">PtrRep</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1333"></a><span>     </span><span class="hs-identifier">isUnBoxed</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1334"></a><span>     </span><a name="local-1628079123"><a href="#local-1628079123"><span class="hs-identifier">checkTypes</span></a></a><span> </span><a name="local-1628079127"><a href="#local-1628079127"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1628079128"><a href="#local-1628079128"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-1335"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#repType"><span class="hs-identifier hs-var">repType</span></a><span> </span><a href="#local-1628079127"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repType"><span class="hs-identifier hs-var">repType</span></a><span> </span><a href="#local-1628079128"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1336"></a><span>           </span><span class="hs-special">(</span><a href="Type.html#UnaryRep"><span class="hs-identifier hs-var">UnaryRep</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Type.html#UnaryRep"><span class="hs-identifier hs-var">UnaryRep</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1337"></a><span>              </span><a href="#local-1628079124"><span class="hs-identifier hs-var">validateCoercion</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a><span> </span><a href="#local-1628079127"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1338"></a><span>                               </span><span class="hs-special">(</span><a href="Type.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a><span> </span><a href="#local-1628079128"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1339"></a><span>           </span><span class="hs-special">(</span><a href="Type.html#UbxTupleRep"><span class="hs-identifier hs-var">UbxTupleRep</span></a><span> </span><a name="local-1628079129"><a href="#local-1628079129"><span class="hs-identifier">rep1</span></a></a><span class="hs-special">,</span><span> </span><a href="Type.html#UbxTupleRep"><span class="hs-identifier hs-var">UbxTupleRep</span></a><span> </span><a name="local-1628079130"><a href="#local-1628079130"><span class="hs-identifier">rep2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1340"></a><span>              </span><a href="CoreLint.html#checkWarnL"><span class="hs-identifier hs-var">checkWarnL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628079129"><span class="hs-identifier hs-var">rep1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628079130"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1341"></a><span>                         </span><span class="hs-special">(</span><a href="#local-1628079121"><span class="hs-identifier hs-var">report</span></a><span> </span><span class="hs-string">&quot;unboxed tuples of different length&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1342"></a><span>              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#zipWithM_"><span class="hs-identifier hs-var">zipWithM_</span></a><span> </span><a href="#local-1628079123"><span class="hs-identifier hs-var">checkTypes</span></a><span> </span><a href="#local-1628079129"><span class="hs-identifier hs-var">rep1</span></a><span> </span><a href="#local-1628079130"><span class="hs-identifier hs-var">rep2</span></a><span>
</span><a name="line-1343"></a><span>           </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#addWarnL"><span class="hs-identifier hs-var">addWarnL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079121"><span class="hs-identifier hs-var">report</span></a><span> </span><span class="hs-string">&quot;unboxed tuple and ordinary type&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1344"></a><span>     </span><span class="hs-identifier">validateCoercion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1345"></a><span>     </span><a name="local-1628079124"><a href="#local-1628079124"><span class="hs-identifier">validateCoercion</span></a></a><span> </span><a name="local-1628079131"><a href="#local-1628079131"><span class="hs-identifier">rep1</span></a></a><span> </span><a name="local-1628079132"><a href="#local-1628079132"><span class="hs-identifier">rep2</span></a></a><span>
</span><a name="line-1346"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079133"><a href="#local-1628079133"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-1347"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkWarnL"><span class="hs-identifier hs-var">checkWarnL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079122"><span class="hs-identifier hs-var">isUnBoxed</span></a><span> </span><a href="#local-1628079131"><span class="hs-identifier hs-var">rep1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628079122"><span class="hs-identifier hs-var">isUnBoxed</span></a><span> </span><a href="#local-1628079132"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1348"></a><span>                         </span><span class="hs-special">(</span><a href="#local-1628079121"><span class="hs-identifier hs-var">report</span></a><span> </span><span class="hs-string">&quot;unboxed and boxed value&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1349"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#checkWarnL"><span class="hs-identifier hs-var">checkWarnL</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#primRepSizeW"><span class="hs-identifier hs-var">TyCon</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">primRepSizeW</span></a><span> </span><a href="#local-1628079133"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628079131"><span class="hs-identifier hs-var">rep1</span></a><span>
</span><a name="line-1350"></a><span>                           </span><span class="hs-operator hs-var">==</span><span> </span><a href="TyCon.html#primRepSizeW"><span class="hs-identifier hs-var">TyCon</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">primRepSizeW</span></a><span> </span><a href="#local-1628079133"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628079132"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1351"></a><span>                         </span><span class="hs-special">(</span><a href="#local-1628079121"><span class="hs-identifier hs-var">report</span></a><span> </span><span class="hs-string">&quot;unboxed values of different size&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1352"></a><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079134"><a href="#local-1628079134"><span class="hs-identifier">fl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM2"><span class="hs-identifier hs-var">liftM2</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#primRepIsFloat"><span class="hs-identifier hs-var">TyCon</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">primRepIsFloat</span></a><span> </span><a href="#local-1628079131"><span class="hs-identifier hs-var">rep1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1353"></a><span>                                   </span><span class="hs-special">(</span><a href="TyCon.html#primRepIsFloat"><span class="hs-identifier hs-var">TyCon</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">primRepIsFloat</span></a><span> </span><a href="#local-1628079132"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1354"></a><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628079134"><span class="hs-identifier hs-var">fl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1355"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#addWarnL"><span class="hs-identifier hs-var">addWarnL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079121"><span class="hs-identifier hs-var">report</span></a><span> </span><span class="hs-string">&quot;vector types&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1356"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#addWarnL"><span class="hs-identifier hs-var">addWarnL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079121"><span class="hs-identifier hs-var">report</span></a><span> </span><span class="hs-string">&quot;float and integral values&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1357"></a><span>                </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1358"></a><span>            </span><span class="hs-special">}</span><span>
</span><a name="line-1359"></a><span>
</span><a name="line-1360"></a><span>     </span><a name="local-1628079125"><a href="#local-1628079125"><span class="hs-identifier">check_kinds</span></a></a><span> </span><a name="local-1628079135"><a href="#local-1628079135"><span class="hs-identifier">kco</span></a></a><span> </span><a name="local-1628079136"><a href="#local-1628079136"><span class="hs-identifier">k1</span></a></a><span> </span><a name="local-1628079137"><a href="#local-1628079137"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079138"><a href="#local-1628079138"><span class="hs-identifier">k1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079139"><a href="#local-1628079139"><span class="hs-identifier">k2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintStarCoercion"><span class="hs-identifier hs-var">lintStarCoercion</span></a><span> </span><a href="#local-1628079135"><span class="hs-identifier hs-var">kco</span></a><span>
</span><a name="line-1361"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628079136"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1628079138"><span class="hs-identifier hs-var">k1'</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkBadUnivCoMsg"><span class="hs-identifier hs-var">mkBadUnivCoMsg</span></a><span> </span><a href="TyCoRep.html#CLeft"><span class="hs-identifier hs-var">CLeft</span></a><span>  </span><a href="#local-1628079116"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1362"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628079137"><span class="hs-identifier hs-var">k2</span></a><span> </span><a href="#local-1628079139"><span class="hs-identifier hs-var">k2'</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#mkBadUnivCoMsg"><span class="hs-identifier hs-var">mkBadUnivCoMsg</span></a><span> </span><a href="TyCoRep.html#CRight"><span class="hs-identifier hs-var">CRight</span></a><span> </span><a href="#local-1628079116"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1363"></a><span>
</span><a name="line-1364"></a><span>
</span><a name="line-1365"></a><span class="hs-identifier">lintCoercion</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span> </span><a name="local-1628079145"><a href="#local-1628079145"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1366"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079146"><a href="#local-1628079146"><span class="hs-identifier">k1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079147"><a href="#local-1628079147"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079148"><a href="#local-1628079148"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079149"><a href="#local-1628079149"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079150"><a href="#local-1628079150"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079145"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1367"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079147"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079146"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079149"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079148"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079150"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1368"></a><span>
</span><a name="line-1369"></a><span class="hs-identifier">lintCoercion</span><span> </span><a name="local-1628079151"><a href="#local-1628079151"><span class="hs-identifier">co</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span> </span><a name="local-1628079152"><a href="#local-1628079152"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-1628079153"><a href="#local-1628079153"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1370"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079154"><a href="#local-1628079154"><span class="hs-identifier">k1a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079155"><a href="#local-1628079155"><span class="hs-identifier">_k1b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079156"><a href="#local-1628079156"><span class="hs-identifier">ty1a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079157"><a href="#local-1628079157"><span class="hs-identifier">ty1b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079158"><a href="#local-1628079158"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079152"><span class="hs-identifier hs-var">co1</span></a><span>
</span><a name="line-1371"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628079159"><a href="#local-1628079159"><span class="hs-identifier">_k2a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079160"><a href="#local-1628079160"><span class="hs-identifier">k2b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079161"><a href="#local-1628079161"><span class="hs-identifier">ty2a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079162"><a href="#local-1628079162"><span class="hs-identifier">ty2b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079163"><a href="#local-1628079163"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079153"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-1372"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a><span> </span><a href="#local-1628079157"><span class="hs-identifier hs-var">ty1b</span></a><span> </span><a href="#local-1628079161"><span class="hs-identifier hs-var">ty2a</span></a><span>
</span><a name="line-1373"></a><span>               </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Trans coercion mis-match:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079151"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1374"></a><span>                   </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079156"><span class="hs-identifier hs-var">ty1a</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079157"><span class="hs-identifier hs-var">ty1b</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079161"><span class="hs-identifier hs-var">ty2a</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079162"><span class="hs-identifier hs-var">ty2b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1375"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079151"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628079158"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-1628079163"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-1376"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079154"><span class="hs-identifier hs-var">k1a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079160"><span class="hs-identifier hs-var">k2b</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079156"><span class="hs-identifier hs-var">ty1a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079162"><span class="hs-identifier hs-var">ty2b</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079158"><span class="hs-identifier hs-var">r1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1377"></a><span>
</span><a name="line-1378"></a><span class="hs-identifier">lintCoercion</span><span> </span><a name="local-1628079164"><a href="#local-1628079164"><span class="hs-identifier">the_co</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span> </span><a name="local-1628079165"><a href="#local-1628079165"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1628079166"><a href="#local-1628079166"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1379"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628079167"><a href="#local-1628079167"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079168"><a href="#local-1628079168"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079169"><a href="#local-1628079169"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079166"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1380"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span> </span><a href="#local-1628079167"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span> </span><a href="#local-1628079168"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1381"></a><span>         </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628079170"><a href="#local-1628079170"><span class="hs-identifier">tv_s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079171"><a href="#local-1628079171"><span class="hs-identifier">_ty_s</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628079172"><a href="#local-1628079172"><span class="hs-identifier">tv_t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079173"><a href="#local-1628079173"><span class="hs-identifier">_ty_t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1382"></a><span>             </span><span class="hs-glyph">|</span><span>  </span><a href="#local-1628079165"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1383"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079176"><span class="hs-identifier hs-var">ks</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079177"><span class="hs-identifier hs-var">kt</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079174"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079175"><span class="hs-identifier hs-var">tt</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">)</span><span>
</span><a name="line-1384"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-1385"></a><span>               </span><a name="local-1628079174"><a href="#local-1628079174"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079170"><span class="hs-identifier hs-var">tv_s</span></a><span>
</span><a name="line-1386"></a><span>               </span><a name="local-1628079175"><a href="#local-1628079175"><span class="hs-identifier">tt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079172"><span class="hs-identifier hs-var">tv_t</span></a><span>
</span><a name="line-1387"></a><span>               </span><a name="local-1628079176"><a href="#local-1628079176"><span class="hs-identifier">ks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079174"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-1388"></a><span>               </span><a name="local-1628079177"><a href="#local-1628079177"><span class="hs-identifier">kt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079175"><span class="hs-identifier hs-var">tt</span></a><span>
</span><a name="line-1389"></a><span>
</span><a name="line-1390"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628079167"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628079168"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1391"></a><span>         </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628079178"><a href="#local-1628079178"><span class="hs-identifier">tc_s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079179"><a href="#local-1628079179"><span class="hs-identifier">tys_s</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628079180"><a href="#local-1628079180"><span class="hs-identifier">tc_t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079181"><a href="#local-1628079181"><span class="hs-identifier">tys_t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1392"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628079178"><span class="hs-identifier hs-var">tc_s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628079180"><span class="hs-identifier hs-var">tc_t</span></a><span>
</span><a name="line-1393"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="TyCon.html#isInjectiveTyCon"><span class="hs-identifier hs-var">isInjectiveTyCon</span></a><span> </span><a href="#local-1628079178"><span class="hs-identifier hs-var">tc_s</span></a><span> </span><a href="#local-1628079169"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1394"></a><span>                 </span><span class="hs-comment">-- see Note [NthCo and newtypes] in TyCoRep</span><span>
</span><a name="line-1395"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="#local-1628079179"><span class="hs-identifier hs-var">tys_s</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#equalLength"><span class="hs-identifier hs-var">equalLength</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079181"><span class="hs-identifier hs-var">tys_t</span></a><span>
</span><a name="line-1396"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="#local-1628079165"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628079179"><span class="hs-identifier hs-var">tys_s</span></a><span>
</span><a name="line-1397"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079185"><span class="hs-identifier hs-var">ks</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079186"><span class="hs-identifier hs-var">kt</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079182"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079183"><span class="hs-identifier hs-var">tt</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079184"><span class="hs-identifier hs-var">tr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1398"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-1399"></a><span>               </span><a name="local-1628079182"><a href="#local-1628079182"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#getNth"><span class="hs-identifier hs-var">getNth</span></a><span> </span><a href="#local-1628079179"><span class="hs-identifier hs-var">tys_s</span></a><span> </span><a href="#local-1628079165"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1400"></a><span>               </span><a name="local-1628079183"><a href="#local-1628079183"><span class="hs-identifier">tt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#getNth"><span class="hs-identifier hs-var">getNth</span></a><span> </span><a href="#local-1628079181"><span class="hs-identifier hs-var">tys_t</span></a><span> </span><a href="#local-1628079165"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1401"></a><span>               </span><a name="local-1628079184"><a href="#local-1628079184"><span class="hs-identifier">tr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#nthRole"><span class="hs-identifier hs-var">nthRole</span></a><span> </span><a href="#local-1628079169"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628079178"><span class="hs-identifier hs-var">tc_s</span></a><span> </span><a href="#local-1628079165"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1402"></a><span>               </span><a name="local-1628079185"><a href="#local-1628079185"><span class="hs-identifier">ks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079182"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-1403"></a><span>               </span><a name="local-1628079186"><a href="#local-1628079186"><span class="hs-identifier">kt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079183"><span class="hs-identifier hs-var">tt</span></a><span>
</span><a name="line-1404"></a><span>
</span><a name="line-1405"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Bad getNth:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1406"></a><span>                              </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079164"><span class="hs-identifier hs-var">the_co</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079167"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079168"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-1407"></a><span>
</span><a name="line-1408"></a><span class="hs-identifier">lintCoercion</span><span> </span><a name="local-1628079187"><a href="#local-1628079187"><span class="hs-identifier">the_co</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span> </span><a name="local-1628079188"><a href="#local-1628079188"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-1628079189"><a href="#local-1628079189"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1409"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1628079190"><a href="#local-1628079190"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-1628079191"><a href="#local-1628079191"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><a name="local-1628079192"><a href="#local-1628079192"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079189"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1410"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079189"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><a href="#local-1628079192"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1411"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span> </span><a href="#local-1628079190"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span> </span><a href="#local-1628079191"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1412"></a><span>           </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628079193"><a href="#local-1628079193"><span class="hs-identifier">s_pr</span></a></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628079194"><a href="#local-1628079194"><span class="hs-identifier">t_pr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1413"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079197"><span class="hs-identifier hs-var">ks_pick</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079198"><span class="hs-identifier hs-var">kt_pick</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079195"><span class="hs-identifier hs-var">s_pick</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079196"><span class="hs-identifier hs-var">t_pick</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">)</span><span>
</span><a name="line-1414"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-1415"></a><span>               </span><a name="local-1628079195"><a href="#local-1628079195"><span class="hs-identifier">s_pick</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#pickLR"><span class="hs-identifier hs-var">pickLR</span></a><span> </span><a href="#local-1628079188"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="#local-1628079193"><span class="hs-identifier hs-var">s_pr</span></a><span>
</span><a name="line-1416"></a><span>               </span><a name="local-1628079196"><a href="#local-1628079196"><span class="hs-identifier">t_pick</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#pickLR"><span class="hs-identifier hs-var">pickLR</span></a><span> </span><a href="#local-1628079188"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="#local-1628079194"><span class="hs-identifier hs-var">t_pr</span></a><span>
</span><a name="line-1417"></a><span>               </span><a name="local-1628079197"><a href="#local-1628079197"><span class="hs-identifier">ks_pick</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079195"><span class="hs-identifier hs-var">s_pick</span></a><span>
</span><a name="line-1418"></a><span>               </span><a name="local-1628079198"><a href="#local-1628079198"><span class="hs-identifier">kt_pick</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079196"><span class="hs-identifier hs-var">t_pick</span></a><span>
</span><a name="line-1419"></a><span>
</span><a name="line-1420"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Bad LRCo:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1421"></a><span>                              </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079187"><span class="hs-identifier hs-var">the_co</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079190"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079191"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1422"></a><span>
</span><a name="line-1423"></a><span class="hs-identifier">lintCoercion</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span> </span><a name="local-1628079199"><a href="#local-1628079199"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1628079200"><a href="#local-1628079200"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1424"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079201"><a href="#local-1628079201"><span class="hs-identifier">k3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079202"><a href="#local-1628079202"><span class="hs-identifier">k4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079203"><a href="#local-1628079203"><span class="hs-identifier">t1'</span></a></a><span class="hs-special">,</span><a name="local-1628079204"><a href="#local-1628079204"><span class="hs-identifier">t2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079205"><a href="#local-1628079205"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079199"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1425"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628079206"><a href="#local-1628079206"><span class="hs-identifier">k1'</span></a></a><span class="hs-special">,</span><a name="local-1628079207"><a href="#local-1628079207"><span class="hs-identifier">k2'</span></a></a><span class="hs-special">,</span><a name="local-1628079208"><a href="#local-1628079208"><span class="hs-identifier">s1</span></a></a><span class="hs-special">,</span><a name="local-1628079209"><a href="#local-1628079209"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079210"><a href="#local-1628079210"><span class="hs-identifier">r'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079200"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1426"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079200"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><a href="#local-1628079210"><span class="hs-identifier hs-var">r'</span></a><span>
</span><a name="line-1427"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span> </span><a href="#local-1628079203"><span class="hs-identifier hs-var">t1'</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span> </span><a href="#local-1628079204"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1428"></a><span>          </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628079211"><a href="#local-1628079211"><span class="hs-identifier">tv1</span></a></a><span class="hs-special">,</span><a name="local-1628079212"><a href="#local-1628079212"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628079213"><a href="#local-1628079213"><span class="hs-identifier">tv2</span></a></a><span class="hs-special">,</span><a name="local-1628079214"><a href="#local-1628079214"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1429"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628079206"><span class="hs-identifier hs-var">k1'</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079211"><span class="hs-identifier hs-var">tv1</span></a><span>
</span><a name="line-1430"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="#local-1628079207"><span class="hs-identifier hs-var">k2'</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079213"><span class="hs-identifier hs-var">tv2</span></a><span>
</span><a name="line-1431"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079201"><span class="hs-identifier hs-var">k3</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079202"><span class="hs-identifier hs-var">k4</span></a><span class="hs-special">,</span><span>
</span><a name="line-1432"></a><span>                       </span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628079211"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-1628079208"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628079212"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span>
</span><a name="line-1433"></a><span>                       </span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628079213"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-1628079209"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628079214"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079205"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1434"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1435"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Kind mis-match in inst coercion&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1436"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Bad argument of inst&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1437"></a><span>
</span><a name="line-1438"></a><span class="hs-identifier">lintCoercion</span><span> </span><a name="local-1628079215"><a href="#local-1628079215"><span class="hs-identifier">co</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span> </span><a name="local-1628079216"><a href="#local-1628079216"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628079217"><a href="#local-1628079217"><span class="hs-identifier">ind</span></a></a><span> </span><a name="local-1628079218"><a href="#local-1628079218"><span class="hs-identifier">cos</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1439"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-1628079217"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628079217"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="CoAxiom.html#numBranches"><span class="hs-identifier hs-var">numBranches</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxiomBranches"><span class="hs-identifier hs-var">coAxiomBranches</span></a><span> </span><a href="#local-1628079216"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1440"></a><span>                </span><span class="hs-special">(</span><a href="#local-1628079219"><span class="hs-identifier hs-var">bad_ax</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;index out of range&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1441"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="CoAxiom.html#CoAxBranch"><span class="hs-identifier hs-var">CoAxBranch</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cab_tvs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079234"><a href="#local-1628079234"><span class="hs-identifier">ktvs</span></a></a><span>
</span><a name="line-1442"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cab_cvs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079235"><a href="#local-1628079235"><span class="hs-identifier">cvs</span></a></a><span>
</span><a name="line-1443"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cab_roles</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079236"><a href="#local-1628079236"><span class="hs-identifier">roles</span></a></a><span>
</span><a name="line-1444"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cab_lhs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079237"><a href="#local-1628079237"><span class="hs-identifier">lhs</span></a></a><span>
</span><a name="line-1445"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cab_rhs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1628079238"><a href="#local-1628079238"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoAxiom.html#coAxiomNthBranch"><span class="hs-identifier hs-var">coAxiomNthBranch</span></a><span> </span><a href="#local-1628079216"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1628079217"><span class="hs-identifier hs-var">ind</span></a><span>
</span><a name="line-1446"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628079234"><span class="hs-identifier hs-var">ktvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628079235"><span class="hs-identifier hs-var">cvs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628079218"><span class="hs-identifier hs-var">cos</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1447"></a><span>           </span><a href="#local-1628079219"><span class="hs-identifier hs-var">bad_ax</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lengths&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1448"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079239"><a href="#local-1628079239"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier hs-var">getTCvSubst</span></a><span>
</span><a name="line-1449"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079240"><a href="#local-1628079240"><span class="hs-identifier">empty_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#zapTCvSubst"><span class="hs-identifier hs-var">zapTCvSubst</span></a><span> </span><a href="#local-1628079239"><span class="hs-identifier hs-var">subst</span></a><span>
</span><a name="line-1450"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628079241"><a href="#local-1628079241"><span class="hs-identifier">subst_l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079242"><a href="#local-1628079242"><span class="hs-identifier">subst_r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#foldlM"><span class="hs-identifier hs-var">foldlM</span></a><span> </span><a href="#local-1628079220"><span class="hs-identifier hs-var">check_ki</span></a><span>
</span><a name="line-1451"></a><span>                                      </span><span class="hs-special">(</span><a href="#local-1628079240"><span class="hs-identifier hs-var">empty_subst</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079240"><span class="hs-identifier hs-var">empty_subst</span></a><span class="hs-special">)</span><span>
</span><a name="line-1452"></a><span>                                      </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079234"><span class="hs-identifier hs-var">ktvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628079235"><span class="hs-identifier hs-var">cvs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079236"><span class="hs-identifier hs-var">roles</span></a><span> </span><a href="#local-1628079218"><span class="hs-identifier hs-var">cos</span></a><span class="hs-special">)</span><span>
</span><a name="line-1453"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079243"><a href="#local-1628079243"><span class="hs-identifier">lhs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTys"><span class="hs-identifier hs-var">substTys</span></a><span> </span><a href="#local-1628079241"><span class="hs-identifier hs-var">subst_l</span></a><span> </span><a href="#local-1628079237"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1454"></a><span>             </span><a name="local-1628079244"><a href="#local-1628079244"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span>  </span><a href="#local-1628079242"><span class="hs-identifier hs-var">subst_r</span></a><span> </span><a href="#local-1628079238"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1455"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="OptCoercion.html#checkAxInstCo"><span class="hs-identifier hs-var">checkAxInstCo</span></a><span> </span><a href="#local-1628079215"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1456"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628079245"><a href="#local-1628079245"><span class="hs-identifier">bad_branch</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628079219"><span class="hs-identifier hs-var">bad_ax</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;inconsistent with&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1457"></a><span>                                       </span><a href="Coercion.html#pprCoAxBranch"><span class="hs-identifier hs-var">pprCoAxBranch</span></a><span> </span><a href="#local-1628079216"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1628079245"><span class="hs-identifier hs-var">bad_branch</span></a><span>
</span><a name="line-1458"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079246"><a href="#local-1628079246"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a><span> </span><a href="#local-1628079216"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079243"><span class="hs-identifier hs-var">lhs'</span></a><span>
</span><a name="line-1460"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079246"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079244"><span class="hs-identifier hs-var">rhs'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079246"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079244"><span class="hs-identifier hs-var">rhs'</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#coAxiomRole"><span class="hs-identifier hs-var">coAxiomRole</span></a><span> </span><a href="#local-1628079216"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1461"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1462"></a><span>    </span><a name="local-1628079219"><a href="#local-1628079219"><span class="hs-identifier">bad_ax</span></a></a><span> </span><a name="local-1628079221"><a href="#local-1628079221"><span class="hs-identifier">what</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span>  </span><span class="hs-string">&quot;Bad axiom application&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><a href="#local-1628079221"><span class="hs-identifier hs-var">what</span></a><span class="hs-special">)</span><span>
</span><a name="line-1463"></a><span>                        </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079215"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1464"></a><span>
</span><a name="line-1465"></a><span>    </span><a name="local-1628079220"><a href="#local-1628079220"><span class="hs-identifier">check_ki</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628079222"><a href="#local-1628079222"><span class="hs-identifier">subst_l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079223"><a href="#local-1628079223"><span class="hs-identifier">subst_r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1628079224"><a href="#local-1628079224"><span class="hs-identifier">ktv</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079225"><a href="#local-1628079225"><span class="hs-identifier">role</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079226"><a href="#local-1628079226"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1466"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079227"><a href="#local-1628079227"><span class="hs-identifier">k'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079228"><a href="#local-1628079228"><span class="hs-identifier">k''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079229"><a href="#local-1628079229"><span class="hs-identifier">s'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079230"><a href="#local-1628079230"><span class="hs-identifier">t'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079231"><a href="#local-1628079231"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079226"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1467"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079226"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-1628079225"><span class="hs-identifier hs-var">role</span></a><span> </span><a href="#local-1628079231"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1468"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079232"><a href="#local-1628079232"><span class="hs-identifier">ktv_kind_l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><a href="#local-1628079222"><span class="hs-identifier hs-var">subst_l</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079224"><span class="hs-identifier hs-var">ktv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1469"></a><span>                 </span><a name="local-1628079233"><a href="#local-1628079233"><span class="hs-identifier">ktv_kind_r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><a href="#local-1628079223"><span class="hs-identifier hs-var">subst_r</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079224"><span class="hs-identifier hs-var">ktv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079227"><span class="hs-identifier hs-var">k'</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079232"><span class="hs-identifier hs-var">ktv_kind_l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1471"></a><span>                    </span><span class="hs-special">(</span><a href="#local-1628079219"><span class="hs-identifier hs-var">bad_ax</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;check_ki1&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079215"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079227"><span class="hs-identifier hs-var">k'</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079224"><span class="hs-identifier hs-var">ktv</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079232"><span class="hs-identifier hs-var">ktv_kind_l</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1472"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079228"><span class="hs-identifier hs-var">k''</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079233"><span class="hs-identifier hs-var">ktv_kind_r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1473"></a><span>                    </span><span class="hs-special">(</span><a href="#local-1628079219"><span class="hs-identifier hs-var">bad_ax</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;check_ki2&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079215"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079228"><span class="hs-identifier hs-var">k''</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079224"><span class="hs-identifier hs-var">ktv</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079233"><span class="hs-identifier hs-var">ktv_kind_r</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1474"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a><span> </span><a href="#local-1628079222"><span class="hs-identifier hs-var">subst_l</span></a><span> </span><a href="#local-1628079224"><span class="hs-identifier hs-var">ktv</span></a><span> </span><a href="#local-1628079229"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">,</span><span>
</span><a name="line-1475"></a><span>                     </span><a href="TyCoRep.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a><span> </span><a href="#local-1628079223"><span class="hs-identifier hs-var">subst_r</span></a><span> </span><a href="#local-1628079224"><span class="hs-identifier hs-var">ktv</span></a><span> </span><a href="#local-1628079230"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1476"></a><span>
</span><a name="line-1477"></a><span class="hs-identifier">lintCoercion</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span> </span><a name="local-1628079247"><a href="#local-1628079247"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-1628079248"><a href="#local-1628079248"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1478"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628079249"><a href="#local-1628079249"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079250"><a href="#local-1628079250"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079251"><a href="#local-1628079251"><span class="hs-identifier">t2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079252"><a href="#local-1628079252"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079247"><span class="hs-identifier hs-var">co1</span></a><span>
</span><a name="line-1479"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079253"><a href="#local-1628079253"><span class="hs-identifier">lhsty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span> </span><a href="#local-1628079250"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1628079248"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-1480"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628079254"><a href="#local-1628079254"><span class="hs-identifier">k1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a><span> </span><a href="#local-1628079253"><span class="hs-identifier hs-var">lhsty</span></a><span>
</span><a name="line-1481"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079254"><span class="hs-identifier hs-var">k1'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079249"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079253"><span class="hs-identifier hs-var">lhsty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079251"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079252"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1482"></a><span>
</span><a name="line-1483"></a><span class="hs-identifier">lintCoercion</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span> </span><a name="local-1628079255"><a href="#local-1628079255"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1484"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079256"><a href="#local-1628079256"><span class="hs-identifier">k1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079257"><a href="#local-1628079257"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079255"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1485"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079256"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079257"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1486"></a><span>
</span><a name="line-1487"></a><span class="hs-identifier">lintCoercion</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span> </span><a name="local-1628079258"><a href="#local-1628079258"><span class="hs-identifier">co'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1488"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628079259"><a href="#local-1628079259"><span class="hs-identifier">k1</span></a></a><span class="hs-special">,</span><a name="local-1628079260"><a href="#local-1628079260"><span class="hs-identifier">k2</span></a></a><span class="hs-special">,</span><a name="local-1628079261"><a href="#local-1628079261"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-1628079262"><a href="#local-1628079262"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><a name="local-1628079263"><a href="#local-1628079263"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079258"><span class="hs-identifier hs-var">co'</span></a><span>
</span><a name="line-1489"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a><span> </span><a href="#local-1628079258"><span class="hs-identifier hs-var">co'</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><a href="#local-1628079263"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1490"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079259"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><a href="#local-1628079260"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><a href="#local-1628079261"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-1628079262"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1491"></a><span>
</span><a name="line-1492"></a><span class="hs-identifier">lintCoercion</span><span> </span><a name="local-1628079264"><a href="#local-1628079264"><span class="hs-identifier">this</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a name="local-1628079265"><a href="#local-1628079265"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1628079266"><a href="#local-1628079266"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1493"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079280"><a href="#local-1628079280"><span class="hs-identifier">eqs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="CoreLint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a><span> </span><a href="#local-1628079266"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1494"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="#local-1628079268"><span class="hs-identifier hs-var">lintRoles</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">coaxrAsmpRoles</span><span> </span><a href="#local-1628079265"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079280"><span class="hs-identifier hs-var">eqs</span></a><span>
</span><a name="line-1495"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">coaxrProves</span><span> </span><a href="#local-1628079265"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-1628079281"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628079282"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1628079281"><a href="#local-1628079281"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-1628079282"><a href="#local-1628079282"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628079280"><span class="hs-identifier hs-var">eqs</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1496"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628079267"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;Malformed use of AxiomRuleCo&quot;</span><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079264"><span class="hs-identifier hs-var">this</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1497"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-1628079283"><a href="#local-1628079283"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628079284"><a href="#local-1628079284"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1498"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079283"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079284"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079283"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079284"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrRole</span><span> </span><a href="#local-1628079265"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1499"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1500"></a><span>  </span><a name="local-1628079267"><a href="#local-1628079267"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-1628079269"><a href="#local-1628079269"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1628079270"><a href="#local-1628079270"><span class="hs-identifier">xs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1501"></a><span>                </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628079269"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Rule:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">coaxrName</span><span> </span><a href="#local-1628079265"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628079270"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1502"></a><span>
</span><a name="line-1503"></a><span>  </span><a name="local-1628079268"><a href="#local-1628079268"><span class="hs-identifier">lintRoles</span></a></a><span> </span><a name="local-1628079271"><a href="#local-1628079271"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628079272"><a href="#local-1628079272"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628079273"><a href="#local-1628079273"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1628079274"><a href="#local-1628079274"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628079275"><a href="#local-1628079275"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1504"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628079272"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628079274"><span class="hs-identifier hs-var">r</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079268"><span class="hs-identifier hs-var">lintRoles</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079271"><span class="hs-identifier hs-var">n</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1628079273"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-1628079275"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1505"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079267"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;Argument roles mismatch&quot;</span><span>
</span><a name="line-1506"></a><span>                      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In argument:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079271"><span class="hs-identifier hs-var">n</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1507"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expected:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079272"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1508"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Found:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079274"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1509"></a><span>  </span><span class="hs-identifier">lintRoles</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1510"></a><span>  </span><span class="hs-identifier">lintRoles</span><span> </span><a name="local-1628079276"><a href="#local-1628079276"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1628079277"><a href="#local-1628079277"><span class="hs-identifier">rs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079267"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;Too many coercion arguments&quot;</span><span>
</span><a name="line-1511"></a><span>                          </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expected:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="#local-1628079276"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1512"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Provided:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079276"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628079277"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1513"></a><span>
</span><a name="line-1514"></a><span>  </span><span class="hs-identifier">lintRoles</span><span> </span><a name="local-1628079278"><a href="#local-1628079278"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1628079279"><a href="#local-1628079279"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079267"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-string">&quot;Not enough coercion arguments&quot;</span><span>
</span><a name="line-1515"></a><span>                          </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expected:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079278"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628079279"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-1516"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Provided:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="#local-1628079278"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1517"></a><span>
</span><a name="line-1518"></a><span class="hs-comment">----------</span><span>
</span><a name="line-1519"></a><span class="hs-identifier">lintUnliftedCoVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1520"></a><a name="lintUnliftedCoVar"><a href="CoreLint.html#lintUnliftedCoVar"><span class="hs-identifier">lintUnliftedCoVar</span></a></a><span> </span><a name="local-1628079285"><a href="#local-1628079285"><span class="hs-identifier">cv</span></a></a><span>
</span><a name="line-1521"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><span class="hs-special">(</span><a href="Coercion.html#coVarKind"><span class="hs-identifier hs-var">coVarKind</span></a><span> </span><a href="#local-1628079285"><span class="hs-identifier hs-var">cv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1522"></a><span>    </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Bad lifted equality:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079285"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-1523"></a><span>                 </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Coercion.html#coVarKind"><span class="hs-identifier hs-var">coVarKind</span></a><span> </span><a href="#local-1628079285"><span class="hs-identifier hs-var">cv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1524"></a><span>
</span><a name="line-1525"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lint-monad]{The Lint monad}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1532"></a><span>
</span><a name="line-1533"></a><span class="hs-comment">-- If you edit this type, you may need to update the GHC formalism</span><span>
</span><a name="line-1534"></a><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><a name="line-1535"></a><span class="hs-keyword">data</span><span> </span><a name="LintEnv"><a href="CoreLint.html#LintEnv"><span class="hs-identifier">LintEnv</span></a></a><span>
</span><a name="line-1536"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LE"><a href="CoreLint.html#LE"><span class="hs-identifier">LE</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#le_flags"><span class="hs-identifier">le_flags</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a><span>       </span><span class="hs-comment">-- Linting the result of this pass</span><span>
</span><a name="line-1537"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="CoreLint.html#le_loc"><span class="hs-identifier">le_loc</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoreLint.html#LintLocInfo"><span class="hs-identifier hs-type">LintLocInfo</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Locations</span><span>
</span><a name="line-1538"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="CoreLint.html#le_subst"><span class="hs-identifier">le_subst</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a><span>        </span><span class="hs-comment">-- Current type substitution; we also use this</span><span>
</span><a name="line-1539"></a><span>                                     </span><span class="hs-comment">-- to keep track of all the variables in scope,</span><span>
</span><a name="line-1540"></a><span>                                     </span><span class="hs-comment">-- both Ids and TyVars</span><span>
</span><a name="line-1541"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="CoreLint.html#le_dynflags"><span class="hs-identifier">le_dynflags</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>     </span><span class="hs-comment">-- DynamicFlags</span><span>
</span><a name="line-1542"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-1543"></a><span>
</span><a name="line-1544"></a><span class="hs-keyword">data</span><span> </span><a name="LintFlags"><a href="CoreLint.html#LintFlags"><span class="hs-identifier">LintFlags</span></a></a><span>
</span><a name="line-1545"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LF"><a href="CoreLint.html#LF"><span class="hs-identifier">LF</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#lf_check_global_ids"><span class="hs-identifier">lf_check_global_ids</span></a><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">-- See Note [Checking for global Ids]</span><span>
</span><a name="line-1546"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="CoreLint.html#lf_check_inline_loop_breakers"><span class="hs-identifier">lf_check_inline_loop_breakers</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">-- See Note [Checking for INLINE loop breakers]</span><span>
</span><a name="line-1547"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1548"></a><span>
</span><a name="line-1549"></a><span class="hs-identifier">defaultLintFlags</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a><span>
</span><a name="line-1550"></a><a name="defaultLintFlags"><a href="CoreLint.html#defaultLintFlags"><span class="hs-identifier">defaultLintFlags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LF"><span class="hs-identifier hs-var">LF</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lf_check_global_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1551"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lf_check_inline_loop_breakers</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1552"></a><span>
</span><a name="line-1553"></a><span class="hs-keyword">newtype</span><span> </span><a name="LintM"><a href="CoreLint.html#LintM"><span class="hs-identifier">LintM</span></a></a><span> </span><a name="local-1628078685"><a href="#local-1628078685"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1554"></a><span>   </span><a name="LintM"><a href="CoreLint.html#LintM"><span class="hs-identifier">LintM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#unLintM"><span class="hs-identifier">unLintM</span></a><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-1555"></a><span>            </span><a href="CoreLint.html#LintEnv"><span class="hs-identifier hs-type">LintEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1556"></a><span>            </span><a href="CoreLint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>           </span><span class="hs-comment">-- Error and warning messages so far</span><span>
</span><a name="line-1557"></a><span>            </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1628078685"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- Result and messages (if any)</span><span>
</span><a name="line-1558"></a><span>
</span><a name="line-1559"></a><span class="hs-keyword">type</span><span> </span><a name="WarnsAndErrs"><a href="CoreLint.html#WarnsAndErrs"><span class="hs-identifier">WarnsAndErrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1560"></a><span>
</span><a name="line-1561"></a><span class="hs-comment">{- Note [Checking for global Ids]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Before CoreTidy, all locally-bound Ids must be LocalIds, even
top-level ones. See Note [Exported LocalIds] and Trac #9857.

Note [Type substitution]
~~~~~~~~~~~~~~~~~~~~~~~~
Why do we need a type substitution?  Consider
        /\(a:*). \(x:a). /\(a:*). id a x
This is ill typed, because (renaming variables) it is really
        /\(a:*). \(x:a). /\(b:*). id b x
Hence, when checking an application, we can't naively compare x's type
(at its binding site) with its expected type (at a use site).  So we
rename type binders as we go, maintaining a substitution.

The same substitution also supports let-type, current expressed as
        (/\(a:*). body) ty
Here we substitute 'ty' for 'a' in 'body', on the fly.
-}</span><span>
</span><a name="line-1580"></a><span>
</span><a name="line-1581"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1582"></a><span>      </span><a name="local-805306541"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span>
</span><a name="line-1583"></a><span>
</span><a name="line-1584"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1585"></a><span>      </span><a name="local-805307120"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier">pure</span></a></a><span> </span><a name="local-1628079467"><a href="#local-1628079467"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628079468"><a href="#local-1628079468"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628079467"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079468"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1586"></a><span>      </span><span class="hs-special">(</span><a name="local-805307119"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator">&lt;*&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#ap"><span class="hs-identifier hs-var">ap</span></a><span>
</span><a name="line-1587"></a><span>
</span><a name="line-1588"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1589"></a><span>  </span><a name="local-805306538"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><a name="local-1628079459"><a href="#local-1628079459"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628079459"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-1590"></a><span>  </span><a name="local-1628079460"><a href="#local-1628079460"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-805306539"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E%3D"><span class="hs-operator">&gt;&gt;=</span></a></a><span> </span><a name="local-1628079461"><a href="#local-1628079461"><span class="hs-identifier">k</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1628079462"><a href="#local-1628079462"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079463"><a href="#local-1628079463"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1591"></a><span>                       </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628079464"><a href="#local-1628079464"><span class="hs-identifier">res</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079465"><a href="#local-1628079465"><span class="hs-identifier">errs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unLintM</span><span> </span><a href="#local-1628079460"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1628079462"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628079463"><span class="hs-identifier hs-var">errs</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1592"></a><span>                         </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628079464"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1593"></a><span>                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628079466"><a href="#local-1628079466"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">unLintM</span><span> </span><span class="hs-special">(</span><a href="#local-1628079461"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1628079466"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079462"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628079465"><span class="hs-identifier hs-var">errs'</span></a><span>
</span><a name="line-1594"></a><span>                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079465"><span class="hs-identifier hs-var">errs'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1595"></a><span>
</span><a name="line-1596"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710</span><span>
</span><a name="line-1597"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html#MonadFail"><span class="hs-identifier hs-type">MonadFail</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MonadFail</span></a><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1598"></a><span>    </span><a name="local-805306544"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><a name="local-1628079458"><a href="#local-1628079458"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628079458"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-1599"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1600"></a><span>
</span><a name="line-1601"></a><span class="hs-keyword">instance</span><span> </span><a href="DynFlags.html#HasDynFlags"><span class="hs-identifier hs-type">HasDynFlags</span></a><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1602"></a><span>  </span><a name="local-1912741864"><a href="DynFlags.html#getDynFlags"><span class="hs-identifier">getDynFlags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1628079456"><a href="#local-1628079456"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1628079457"><a href="#local-1628079457"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">le_dynflags</span><span> </span><a href="#local-1628079456"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1628079457"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1603"></a><span>
</span><a name="line-1604"></a><span class="hs-keyword">data</span><span> </span><a name="LintLocInfo"><a href="CoreLint.html#LintLocInfo"><span class="hs-identifier">LintLocInfo</span></a></a><span>
</span><a name="line-1605"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="RhsOf"><a href="CoreLint.html#RhsOf"><span class="hs-identifier">RhsOf</span></a></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>            </span><span class="hs-comment">-- The variable bound</span><span>
</span><a name="line-1606"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LambdaBodyOf"><a href="CoreLint.html#LambdaBodyOf"><span class="hs-identifier">LambdaBodyOf</span></a></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>     </span><span class="hs-comment">-- The lambda-binder</span><span>
</span><a name="line-1607"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BodyOfLetRec"><a href="CoreLint.html#BodyOfLetRec"><span class="hs-identifier">BodyOfLetRec</span></a></a><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- One of the binders</span><span>
</span><a name="line-1608"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CaseAlt"><a href="CoreLint.html#CaseAlt"><span class="hs-identifier">CaseAlt</span></a></a><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span>     </span><span class="hs-comment">-- Case alternative</span><span>
</span><a name="line-1609"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CasePat"><a href="CoreLint.html#CasePat"><span class="hs-identifier">CasePat</span></a></a><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span>     </span><span class="hs-comment">-- The *pattern* of the case alternative</span><span>
</span><a name="line-1610"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AnExpr"><a href="CoreLint.html#AnExpr"><span class="hs-identifier">AnExpr</span></a></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>     </span><span class="hs-comment">-- Some expression</span><span>
</span><a name="line-1611"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ImportedUnfolding"><a href="CoreLint.html#ImportedUnfolding"><span class="hs-identifier">ImportedUnfolding</span></a></a><span> </span><a href="SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a><span> </span><span class="hs-comment">-- Some imported unfolding (ToDo: say which)</span><span>
</span><a name="line-1612"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TopLevelBindings"><a href="CoreLint.html#TopLevelBindings"><span class="hs-identifier">TopLevelBindings</span></a></a><span>
</span><a name="line-1613"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InType"><a href="CoreLint.html#InType"><span class="hs-identifier">InType</span></a></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>         </span><span class="hs-comment">-- Inside a type</span><span>
</span><a name="line-1614"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InCo"><a href="CoreLint.html#InCo"><span class="hs-identifier">InCo</span></a></a><span>   </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>     </span><span class="hs-comment">-- Inside a coercion</span><span>
</span><a name="line-1615"></a><span>
</span><a name="line-1616"></a><span class="hs-identifier">initL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078694"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a><span>    </span><span class="hs-comment">-- Errors and warnings</span><span>
</span><a name="line-1617"></a><a name="initL"><a href="CoreLint.html#initL"><span class="hs-identifier">initL</span></a></a><span> </span><a name="local-1628079286"><a href="#local-1628079286"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628079287"><a href="#local-1628079287"><span class="hs-identifier">flags</span></a></a><span> </span><a name="local-1628079288"><a href="#local-1628079288"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1618"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">unLintM</span><span> </span><a href="#local-1628079288"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1628079289"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1619"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628079290"><a href="#local-1628079290"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628079290"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-1620"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1621"></a><span>    </span><a name="local-1628079289"><a href="#local-1628079289"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LE"><span class="hs-identifier hs-var">LE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">le_flags</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079287"><span class="hs-identifier hs-var">flags</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">le_subst</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#emptyTCvSubst"><span class="hs-identifier hs-var">emptyTCvSubst</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">le_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">le_dynflags</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079286"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1622"></a><span>
</span><a name="line-1623"></a><span class="hs-identifier">getLintFlags</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a><span>
</span><a name="line-1624"></a><a name="getLintFlags"><a href="CoreLint.html#getLintFlags"><span class="hs-identifier">getLintFlags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079291"><a href="#local-1628079291"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079292"><a href="#local-1628079292"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">le_flags</span><span> </span><a href="#local-1628079291"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1628079292"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1625"></a><span>
</span><a name="line-1626"></a><span class="hs-identifier">checkL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1627"></a><a name="checkL"><a href="CoreLint.html#checkL"><span class="hs-identifier">checkL</span></a></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1628"></a><span class="hs-identifier">checkL</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-1628079293"><a href="#local-1628079293"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a><span> </span><a href="#local-1628079293"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-1629"></a><span>
</span><a name="line-1630"></a><span class="hs-comment">-- like checkL, but relevant to type checking</span><span>
</span><a name="line-1631"></a><span class="hs-identifier">lintL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1632"></a><a name="lintL"><a href="CoreLint.html#lintL"><span class="hs-identifier">lintL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a><span>
</span><a name="line-1633"></a><span>
</span><a name="line-1634"></a><span class="hs-identifier">checkWarnL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1635"></a><a name="checkWarnL"><a href="CoreLint.html#checkWarnL"><span class="hs-identifier">checkWarnL</span></a></a><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1636"></a><span class="hs-identifier">checkWarnL</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-1628079294"><a href="#local-1628079294"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#addWarnL"><span class="hs-identifier hs-var">addWarnL</span></a><span> </span><a href="#local-1628079294"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-1637"></a><span>
</span><a name="line-1638"></a><span class="hs-identifier">failWithL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078693"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1639"></a><a name="failWithL"><a href="CoreLint.html#failWithL"><span class="hs-identifier">failWithL</span></a></a><span> </span><a name="local-1628079295"><a href="#local-1628079295"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079296"><a href="#local-1628079296"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628079297"><a href="#local-1628079297"><span class="hs-identifier">warns</span></a></a><span class="hs-special">,</span><a name="local-1628079298"><a href="#local-1628079298"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1640"></a><span>                </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-1628079297"><span class="hs-identifier hs-var">warns</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#addMsg"><span class="hs-identifier hs-var">addMsg</span></a><span> </span><a href="#local-1628079296"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628079298"><span class="hs-identifier hs-var">errs</span></a><span> </span><a href="#local-1628079295"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1641"></a><span>
</span><a name="line-1642"></a><span class="hs-identifier">addErrL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1643"></a><a name="addErrL"><a href="CoreLint.html#addErrL"><span class="hs-identifier">addErrL</span></a></a><span> </span><a name="local-1628079299"><a href="#local-1628079299"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079300"><a href="#local-1628079300"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628079301"><a href="#local-1628079301"><span class="hs-identifier">warns</span></a></a><span class="hs-special">,</span><a name="local-1628079302"><a href="#local-1628079302"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1644"></a><span>              </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-1628079301"><span class="hs-identifier hs-var">warns</span></a><span class="hs-special">,</span><span> </span><a href="CoreLint.html#addMsg"><span class="hs-identifier hs-var">addMsg</span></a><span> </span><a href="#local-1628079300"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628079302"><span class="hs-identifier hs-var">errs</span></a><span> </span><a href="#local-1628079299"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1645"></a><span>
</span><a name="line-1646"></a><span class="hs-identifier">addWarnL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1647"></a><a name="addWarnL"><a href="CoreLint.html#addWarnL"><span class="hs-identifier">addWarnL</span></a></a><span> </span><a name="local-1628079303"><a href="#local-1628079303"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079304"><a href="#local-1628079304"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628079305"><a href="#local-1628079305"><span class="hs-identifier">warns</span></a></a><span class="hs-special">,</span><a name="local-1628079306"><a href="#local-1628079306"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1648"></a><span>              </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#addMsg"><span class="hs-identifier hs-var">addMsg</span></a><span> </span><a href="#local-1628079304"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628079305"><span class="hs-identifier hs-var">warns</span></a><span> </span><a href="#local-1628079303"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079306"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1649"></a><span>
</span><a name="line-1650"></a><span class="hs-identifier">addMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintEnv"><span class="hs-identifier hs-type">LintEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1651"></a><a name="addMsg"><a href="CoreLint.html#addMsg"><span class="hs-identifier">addMsg</span></a></a><span> </span><a name="local-1628079307"><a href="#local-1628079307"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079308"><a href="#local-1628079308"><span class="hs-identifier">msgs</span></a></a><span> </span><a name="local-1628079309"><a href="#local-1628079309"><span class="hs-identifier">msg</span></a></a><span>
</span><a name="line-1652"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">notNull</span><span> </span><span class="hs-identifier">locs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1653"></a><span>    </span><a href="#local-1628079308"><span class="hs-identifier hs-var">msgs</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#snocBag"><span class="hs-identifier hs-var">snocBag</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079315"><span class="hs-identifier hs-var">mk_msg</span></a><span> </span><a href="#local-1628079309"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-1654"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1655"></a><span>   </span><a name="local-1628079310"><a href="#local-1628079310"><span class="hs-identifier">locs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">le_loc</span><span> </span><a href="#local-1628079307"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-1656"></a><span>   </span><span class="hs-special">(</span><a name="local-1628079311"><a href="#local-1628079311"><span class="hs-identifier">loc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079312"><a href="#local-1628079312"><span class="hs-identifier">cxt1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628079310"><span class="hs-identifier hs-var">locs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1657"></a><span>   </span><a name="local-1628079313"><a href="#local-1628079313"><span class="hs-identifier">cxts</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a><span> </span><a href="#local-1628079316"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628079316"><a href="#local-1628079316"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628079310"><span class="hs-identifier hs-var">locs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1658"></a><span>   </span><a name="local-1628079314"><a href="#local-1628079314"><span class="hs-identifier">context</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a href="StaticFlags.html#opt_PprStyle_Debug"><span class="hs-identifier hs-var">opt_PprStyle_Debug</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1628079313"><span class="hs-identifier hs-var">cxts</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628079312"><span class="hs-identifier hs-var">cxt1</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1659"></a><span>                                      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Substitution:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">le_subst</span><span> </span><a href="#local-1628079307"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-1660"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079312"><span class="hs-identifier hs-var">cxt1</span></a><span>
</span><a name="line-1661"></a><span>
</span><a name="line-1662"></a><span>   </span><a name="local-1628079315"><a href="#local-1628079315"><span class="hs-identifier">mk_msg</span></a></a><span> </span><a name="local-1628079317"><a href="#local-1628079317"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ErrUtils.html#mkLocMessage"><span class="hs-identifier hs-var">mkLocMessage</span></a><span> </span><a href="ErrUtils.html#SevWarning"><span class="hs-identifier hs-var">SevWarning</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#mkSrcSpan"><span class="hs-identifier hs-var">mkSrcSpan</span></a><span> </span><a href="#local-1628079311"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628079311"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628079314"><span class="hs-identifier hs-var">context</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628079317"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-1663"></a><span>
</span><a name="line-1664"></a><span class="hs-identifier">addLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintLocInfo"><span class="hs-identifier hs-type">LintLocInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078692"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078692"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1665"></a><a name="addLoc"><a href="CoreLint.html#addLoc"><span class="hs-identifier">addLoc</span></a></a><span> </span><a name="local-1628079318"><a href="#local-1628079318"><span class="hs-identifier">extra_loc</span></a></a><span> </span><a name="local-1628079319"><a href="#local-1628079319"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1666"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079320"><a href="#local-1628079320"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079321"><a href="#local-1628079321"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1667"></a><span>    </span><span class="hs-identifier">unLintM</span><span> </span><a href="#local-1628079319"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079320"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">le_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079318"><span class="hs-identifier hs-var">extra_loc</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">le_loc</span><span> </span><a href="#local-1628079320"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-1628079321"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-1668"></a><span>
</span><a name="line-1669"></a><span class="hs-identifier">inCasePat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>         </span><span class="hs-comment">-- A slight hack; see the unique call site</span><span>
</span><a name="line-1670"></a><a name="inCasePat"><a href="CoreLint.html#inCasePat"><span class="hs-identifier">inCasePat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079324"><a href="#local-1628079324"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079325"><a href="#local-1628079325"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079322"><span class="hs-identifier hs-var">is_case_pat</span></a><span> </span><a href="#local-1628079324"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1628079325"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1671"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1672"></a><span>    </span><a name="local-1628079322"><a href="#local-1628079322"><span class="hs-identifier">is_case_pat</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#LE"><span class="hs-identifier hs-var">LE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">le_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#CasePat"><span class="hs-identifier hs-var">CasePat</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1673"></a><span>    </span><span class="hs-identifier">is_case_pat</span><span> </span><a name="local-1628079323"><a href="#local-1628079323"><span class="hs-identifier">_other</span></a></a><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1674"></a><span>
</span><a name="line-1675"></a><span class="hs-identifier">addInScopeVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078691"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078691"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1676"></a><a name="addInScopeVars"><a href="CoreLint.html#addInScopeVars"><span class="hs-identifier">addInScopeVars</span></a></a><span> </span><a name="local-1628079326"><a href="#local-1628079326"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1628079327"><a href="#local-1628079327"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1677"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079328"><a href="#local-1628079328"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079329"><a href="#local-1628079329"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1678"></a><span>    </span><span class="hs-identifier">unLintM</span><span> </span><a href="#local-1628079327"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079328"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">le_subst</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#extendTCvInScopeList"><span class="hs-identifier hs-var">extendTCvInScopeList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">le_subst</span><span> </span><a href="#local-1628079328"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079326"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1679"></a><span>              </span><a href="#local-1628079329"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-1680"></a><span>
</span><a name="line-1681"></a><span class="hs-identifier">addInScopeVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078690"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078690"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1682"></a><a name="addInScopeVar"><a href="CoreLint.html#addInScopeVar"><span class="hs-identifier">addInScopeVar</span></a></a><span> </span><a name="local-1628079330"><a href="#local-1628079330"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-1628079331"><a href="#local-1628079331"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1683"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079332"><a href="#local-1628079332"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079333"><a href="#local-1628079333"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1684"></a><span>    </span><span class="hs-identifier">unLintM</span><span> </span><a href="#local-1628079331"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079332"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">le_subst</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#extendTCvInScope"><span class="hs-identifier hs-var">extendTCvInScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">le_subst</span><span> </span><a href="#local-1628079332"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079330"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-1628079333"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-1685"></a><span>
</span><a name="line-1686"></a><span class="hs-identifier">extendSubstL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078689"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078689"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1687"></a><a name="extendSubstL"><a href="CoreLint.html#extendSubstL"><span class="hs-identifier">extendSubstL</span></a></a><span> </span><a name="local-1628079334"><a href="#local-1628079334"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1628079335"><a href="#local-1628079335"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628079336"><a href="#local-1628079336"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1688"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079337"><a href="#local-1628079337"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079338"><a href="#local-1628079338"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1689"></a><span>    </span><span class="hs-identifier">unLintM</span><span> </span><a href="#local-1628079336"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079337"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">le_subst</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#extendTvSubst"><span class="hs-identifier hs-var">Type</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">extendTvSubst</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">le_subst</span><span> </span><a href="#local-1628079337"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079334"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1628079335"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-1628079338"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-1690"></a><span>
</span><a name="line-1691"></a><span class="hs-identifier">updateTCvSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078688"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="#local-1628078688"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1692"></a><a name="updateTCvSubst"><a href="CoreLint.html#updateTCvSubst"><span class="hs-identifier">updateTCvSubst</span></a></a><span> </span><a name="local-1628079339"><a href="#local-1628079339"><span class="hs-identifier">subst'</span></a></a><span> </span><a name="local-1628079340"><a href="#local-1628079340"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1693"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628079341"><a href="#local-1628079341"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079342"><a href="#local-1628079342"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">unLintM</span><span> </span><a href="#local-1628079340"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079341"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">le_subst</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079339"><span class="hs-identifier hs-var">subst'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-1628079342"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-1694"></a><span>
</span><a name="line-1695"></a><span class="hs-identifier">getTCvSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="TyCoRep.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a><span>
</span><a name="line-1696"></a><a name="getTCvSubst"><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier">getTCvSubst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1628079343"><a href="#local-1628079343"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079344"><a href="#local-1628079344"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">le_subst</span><span> </span><a href="#local-1628079343"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1628079344"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1697"></a><span>
</span><a name="line-1698"></a><span class="hs-identifier">getInScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="VarEnv.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a><span>
</span><a name="line-1699"></a><a name="getInScope"><a href="CoreLint.html#getInScope"><span class="hs-identifier">getInScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1628079345"><a href="#local-1628079345"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628079346"><a href="#local-1628079346"><span class="hs-identifier">errs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#getTCvInScope"><span class="hs-identifier hs-var">getTCvInScope</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">le_subst</span><span> </span><a href="#local-1628079345"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1628079346"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1700"></a><span>
</span><a name="line-1701"></a><span class="hs-identifier">applySubstTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#InType"><span class="hs-identifier hs-type">InType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span>
</span><a name="line-1702"></a><a name="applySubstTy"><a href="CoreLint.html#applySubstTy"><span class="hs-identifier">applySubstTy</span></a></a><span> </span><a name="local-1628079347"><a href="#local-1628079347"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079348"><a href="#local-1628079348"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier hs-var">getTCvSubst</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><a href="#local-1628079348"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1628079347"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1703"></a><span>
</span><a name="line-1704"></a><span class="hs-identifier">applySubstCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#InCoercion"><span class="hs-identifier hs-type">InCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="CoreLint.html#OutCoercion"><span class="hs-identifier hs-type">OutCoercion</span></a><span>
</span><a name="line-1705"></a><a name="applySubstCo"><a href="CoreLint.html#applySubstCo"><span class="hs-identifier">applySubstCo</span></a></a><span> </span><a name="local-1628079349"><a href="#local-1628079349"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079350"><a href="#local-1628079350"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier hs-var">getTCvSubst</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substCo"><span class="hs-identifier hs-var">substCo</span></a><span> </span><a href="#local-1628079350"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1628079349"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1706"></a><span>
</span><a name="line-1707"></a><span class="hs-identifier">lookupIdInScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-1708"></a><a name="lookupIdInScope"><a href="CoreLint.html#lookupIdInScope"><span class="hs-identifier">lookupIdInScope</span></a></a><span> </span><a name="local-1628079351"><a href="#local-1628079351"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-1709"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Var.html#mustHaveLocalBinding"><span class="hs-identifier hs-var">mustHaveLocalBinding</span></a><span> </span><a href="#local-1628079351"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1710"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628079351"><span class="hs-identifier hs-var">id</span></a><span>   </span><span class="hs-comment">-- An imported Id</span><span>
</span><a name="line-1711"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1712"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628079353"><a href="#local-1628079353"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier hs-var">getTCvSubst</span></a><span>
</span><a name="line-1713"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VarEnv.html#lookupInScope"><span class="hs-identifier hs-var">lookupInScope</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#getTCvInScope"><span class="hs-identifier hs-var">getTCvInScope</span></a><span> </span><a href="#local-1628079353"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079351"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1714"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628079354"><a href="#local-1628079354"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628079354"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1715"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="CoreLint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a><span> </span><a href="#local-1628079352"><span class="hs-identifier hs-var">out_of_scope</span></a><span>
</span><a name="line-1716"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628079351"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1717"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1718"></a><span>    </span><a name="local-1628079352"><a href="#local-1628079352"><span class="hs-identifier">out_of_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprBndr"><span class="hs-identifier hs-var">pprBndr</span></a><span> </span><a href="Outputable.html#LetBind"><span class="hs-identifier hs-var">LetBind</span></a><span> </span><a href="#local-1628079351"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is out of scope&quot;</span><span>
</span><a name="line-1719"></a><span>
</span><a name="line-1720"></a><span class="hs-identifier">lintTyCoVarInScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1721"></a><a name="lintTyCoVarInScope"><a href="CoreLint.html#lintTyCoVarInScope"><span class="hs-identifier">lintTyCoVarInScope</span></a></a><span> </span><a name="local-1628079355"><a href="#local-1628079355"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintInScope"><span class="hs-identifier hs-var">lintInScope</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is out of scope&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628079355"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1722"></a><span>
</span><a name="line-1723"></a><span class="hs-identifier">lintInScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1724"></a><a name="lintInScope"><a href="CoreLint.html#lintInScope"><span class="hs-identifier">lintInScope</span></a></a><span> </span><a name="local-1628079356"><a href="#local-1628079356"><span class="hs-identifier">loc_msg</span></a></a><span> </span><a name="local-1628079357"><a href="#local-1628079357"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1725"></a><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628079358"><a href="#local-1628079358"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#getTCvSubst"><span class="hs-identifier hs-var">getTCvSubst</span></a><span>
</span><a name="line-1726"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Var.html#mustHaveLocalBinding"><span class="hs-identifier hs-var">mustHaveLocalBinding</span></a><span> </span><a href="#local-1628079357"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-1628079357"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">`</span><a href="TyCoRep.html#isInScope"><span class="hs-identifier hs-var">isInScope</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079358"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1727"></a><span>             </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#pprBndr"><span class="hs-identifier hs-var">pprBndr</span></a><span> </span><a href="Outputable.html#LetBind"><span class="hs-identifier hs-var">LetBind</span></a><span> </span><a href="#local-1628079357"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079356"><span class="hs-identifier hs-var">loc_msg</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1728"></a><span>
</span><a name="line-1729"></a><span class="hs-identifier">ensureEqTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#OutType"><span class="hs-identifier hs-type">OutType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1730"></a><span class="hs-comment">-- check ty2 is subtype of ty1 (ie, has same structure but usage</span><span>
</span><a name="line-1731"></a><span class="hs-comment">-- annotations need only be consistent, not equal)</span><span>
</span><a name="line-1732"></a><span class="hs-comment">-- Assumes ty1,ty2 are have alrady had the substitution applied</span><span>
</span><a name="line-1733"></a><a name="ensureEqTys"><a href="CoreLint.html#ensureEqTys"><span class="hs-identifier">ensureEqTys</span></a></a><span> </span><a name="local-1628079359"><a href="#local-1628079359"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628079360"><a href="#local-1628079360"><span class="hs-identifier">ty2</span></a></a><span> </span><a name="local-1628079361"><a href="#local-1628079361"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079359"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628079360"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079361"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-1734"></a><span>
</span><a name="line-1735"></a><span class="hs-identifier">lintRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1628078687"><span class="hs-identifier hs-type">thing</span></a><span>
</span><a name="line-1736"></a><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1628078687"><span class="hs-identifier hs-type">thing</span></a><span>     </span><span class="hs-comment">-- where the role appeared</span><span>
</span><a name="line-1737"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>      </span><span class="hs-comment">-- expected</span><span>
</span><a name="line-1738"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>      </span><span class="hs-comment">-- actual</span><span>
</span><a name="line-1739"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreLint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1740"></a><a name="lintRole"><a href="CoreLint.html#lintRole"><span class="hs-identifier">lintRole</span></a></a><span> </span><a name="local-1628079362"><a href="#local-1628079362"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1628079363"><a href="#local-1628079363"><span class="hs-identifier">r1</span></a></a><span> </span><a name="local-1628079364"><a href="#local-1628079364"><span class="hs-identifier">r2</span></a></a><span>
</span><a name="line-1741"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoreLint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079363"><span class="hs-identifier hs-var">r1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628079364"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1742"></a><span>          </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Role incompatibility: expected&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079363"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1743"></a><span>           </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;got&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079364"><span class="hs-identifier hs-var">r2</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1744"></a><span>           </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079362"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1745"></a><span>
</span><a name="line-1746"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Error messages}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1753"></a><span>
</span><a name="line-1754"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreLint.html#LintLocInfo"><span class="hs-identifier hs-type">LintLocInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1755"></a><span>
</span><a name="line-1756"></a><a name="dumpLoc"><a href="CoreLint.html#dumpLoc"><span class="hs-identifier">dumpLoc</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreLint.html#RhsOf"><span class="hs-identifier hs-var">RhsOf</span></a><span> </span><a name="local-1628079365"><a href="#local-1628079365"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1757"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a><span> </span><a href="#local-1628079365"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RHS of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="CoreLint.html#pp_binders"><span class="hs-identifier hs-var">pp_binders</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628079365"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1758"></a><span>
</span><a name="line-1759"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#LambdaBodyOf"><span class="hs-identifier hs-var">LambdaBodyOf</span></a><span> </span><a name="local-1628079366"><a href="#local-1628079366"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1760"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a><span> </span><a href="#local-1628079366"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in body of lambda with binder&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="CoreLint.html#pp_binder"><span class="hs-identifier hs-var">pp_binder</span></a><span> </span><a href="#local-1628079366"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1761"></a><span>
</span><a name="line-1762"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#BodyOfLetRec"><span class="hs-identifier hs-var">BodyOfLetRec</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1763"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In body of a letrec with no binders&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1764"></a><span>
</span><a name="line-1765"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#BodyOfLetRec"><span class="hs-identifier hs-var">BodyOfLetRec</span></a><span> </span><a name="local-1628079367"><a href="#local-1628079367"><span class="hs-identifier">bs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1766"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628079367"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in body of letrec with binders&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="CoreLint.html#pp_binders"><span class="hs-identifier hs-var">pp_binders</span></a><span> </span><a href="#local-1628079367"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1767"></a><span>
</span><a name="line-1768"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#AnExpr"><span class="hs-identifier hs-var">AnExpr</span></a><span> </span><a name="local-1628079368"><a href="#local-1628079368"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1769"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the expression:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079368"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1770"></a><span>
</span><a name="line-1771"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a><span> </span><span class="hs-special">(</span><a name="local-1628079369"><a href="#local-1628079369"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079370"><a href="#local-1628079370"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1772"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In a case alternative:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079369"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="CoreLint.html#pp_binders"><span class="hs-identifier hs-var">pp_binders</span></a><span> </span><a href="#local-1628079370"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1773"></a><span>
</span><a name="line-1774"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#CasePat"><span class="hs-identifier hs-var">CasePat</span></a><span> </span><span class="hs-special">(</span><a name="local-1628079371"><a href="#local-1628079371"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628079372"><a href="#local-1628079372"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1775"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the pattern of a case alternative:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079371"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="CoreLint.html#pp_binders"><span class="hs-identifier hs-var">pp_binders</span></a><span> </span><a href="#local-1628079372"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1776"></a><span>
</span><a name="line-1777"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#ImportedUnfolding"><span class="hs-identifier hs-var">ImportedUnfolding</span></a><span> </span><a name="local-1628079373"><a href="#local-1628079373"><span class="hs-identifier">locn</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1778"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628079373"><span class="hs-identifier hs-var">locn</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in an imported unfolding&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1779"></a><span class="hs-identifier">dumpLoc</span><span> </span><a href="CoreLint.html#TopLevelBindings"><span class="hs-identifier hs-var">TopLevelBindings</span></a><span>
</span><a name="line-1780"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1781"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#InType"><span class="hs-identifier hs-var">InType</span></a><span> </span><a name="local-1628079374"><a href="#local-1628079374"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1782"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079374"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1783"></a><span class="hs-identifier">dumpLoc</span><span> </span><span class="hs-special">(</span><a href="CoreLint.html#InCo"><span class="hs-identifier hs-var">InCo</span></a><span> </span><a name="local-1628079375"><a href="#local-1628079375"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1784"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the coercion&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079375"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1785"></a><span>
</span><a name="line-1786"></a><span class="hs-identifier">pp_binders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1787"></a><a name="pp_binders"><a href="CoreLint.html#pp_binders"><span class="hs-identifier">pp_binders</span></a></a><span> </span><a name="local-1628079376"><a href="#local-1628079376"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a><span> </span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="CoreLint.html#pp_binder"><span class="hs-identifier hs-var">pp_binder</span></a><span> </span><a href="#local-1628079376"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1788"></a><span>
</span><a name="line-1789"></a><span class="hs-identifier">pp_binder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1790"></a><a name="pp_binder"><a href="CoreLint.html#pp_binder"><span class="hs-identifier">pp_binder</span></a></a><span> </span><a name="local-1628079377"><a href="#local-1628079377"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isId"><span class="hs-identifier hs-var">isId</span></a><span> </span><a href="#local-1628079377"><span class="hs-identifier hs-var">b</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079377"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628079377"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1791"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079377"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079377"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1792"></a><span>
</span><a name="line-1793"></a><span class="hs-comment">------------------------------------------------------</span><span>
</span><a name="line-1794"></a><span class="hs-comment">--      Messages for case expressions</span><span>
</span><a name="line-1795"></a><span>
</span><a name="line-1796"></a><span class="hs-identifier">mkDefaultArgsMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1797"></a><a name="mkDefaultArgsMsg"><a href="CoreLint.html#mkDefaultArgsMsg"><span class="hs-identifier">mkDefaultArgsMsg</span></a></a><span> </span><a name="local-1628079378"><a href="#local-1628079378"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-1798"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;DEFAULT case with binders&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1799"></a><span>         </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079378"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1800"></a><span>
</span><a name="line-1801"></a><span class="hs-identifier">mkCaseAltMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1802"></a><a name="mkCaseAltMsg"><a href="CoreLint.html#mkCaseAltMsg"><span class="hs-identifier">mkCaseAltMsg</span></a></a><span> </span><a name="local-1628079379"><a href="#local-1628079379"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1628079380"><a href="#local-1628079380"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628079381"><a href="#local-1628079381"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1803"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type of case alternatives not the same as the annotation on case:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1804"></a><span>         </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079380"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079381"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079379"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1805"></a><span>
</span><a name="line-1806"></a><span class="hs-identifier">mkScrutMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1807"></a><a name="mkScrutMsg"><a href="CoreLint.html#mkScrutMsg"><span class="hs-identifier">mkScrutMsg</span></a></a><span> </span><a name="local-1628079382"><a href="#local-1628079382"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-1628079383"><a href="#local-1628079383"><span class="hs-identifier">var_ty</span></a></a><span> </span><a name="local-1628079384"><a href="#local-1628079384"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><a name="local-1628079385"><a href="#local-1628079385"><span class="hs-identifier">subst</span></a></a><span>
</span><a name="line-1808"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Result binder in case doesn't match scrutinee:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079382"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span>
</span><a name="line-1809"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Result binder type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079383"><span class="hs-identifier hs-var">var_ty</span></a><span class="hs-special">,</span><span class="hs-comment">--(idType var),</span><span>
</span><a name="line-1810"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Scrutinee type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079384"><span class="hs-identifier hs-var">scrut_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-1811"></a><span>     </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Current TCv subst&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079385"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1812"></a><span>
</span><a name="line-1813"></a><span class="hs-identifier">mkNonDefltMsg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkNonIncreasingAltsMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1814"></a><a name="mkNonDefltMsg"><a href="CoreLint.html#mkNonDefltMsg"><span class="hs-identifier">mkNonDefltMsg</span></a></a><span> </span><a name="local-1628079386"><a href="#local-1628079386"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-1815"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Case expression with DEFAULT not at the beginnning&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079386"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1816"></a><a name="mkNonIncreasingAltsMsg"><a href="CoreLint.html#mkNonIncreasingAltsMsg"><span class="hs-identifier">mkNonIncreasingAltsMsg</span></a></a><span> </span><a name="local-1628079387"><a href="#local-1628079387"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-1817"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Case expression with badly-ordered alternatives&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079387"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1818"></a><span>
</span><a name="line-1819"></a><span class="hs-identifier">nonExhaustiveAltsMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1820"></a><a name="nonExhaustiveAltsMsg"><a href="CoreLint.html#nonExhaustiveAltsMsg"><span class="hs-identifier">nonExhaustiveAltsMsg</span></a></a><span> </span><a name="local-1628079388"><a href="#local-1628079388"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-1821"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Case expression with non-exhaustive alternatives&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079388"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1822"></a><span>
</span><a name="line-1823"></a><span class="hs-identifier">mkBadConMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1824"></a><a name="mkBadConMsg"><a href="CoreLint.html#mkBadConMsg"><span class="hs-identifier">mkBadConMsg</span></a></a><span> </span><a name="local-1628079389"><a href="#local-1628079389"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1628079390"><a href="#local-1628079390"><span class="hs-identifier">datacon</span></a></a><span>
</span><a name="line-1825"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1826"></a><span>        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In a case alternative, data constructor isn't in scrutinee type:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1827"></a><span>        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Scrutinee type constructor:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079389"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">,</span><span>
</span><a name="line-1828"></a><span>        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data con:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079390"><span class="hs-identifier hs-var">datacon</span></a><span>
</span><a name="line-1829"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1830"></a><span>
</span><a name="line-1831"></a><span class="hs-identifier">mkBadPatMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1832"></a><a name="mkBadPatMsg"><a href="CoreLint.html#mkBadPatMsg"><span class="hs-identifier">mkBadPatMsg</span></a></a><span> </span><a name="local-1628079391"><a href="#local-1628079391"><span class="hs-identifier">con_result_ty</span></a></a><span> </span><a name="local-1628079392"><a href="#local-1628079392"><span class="hs-identifier">scrut_ty</span></a></a><span>
</span><a name="line-1833"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1834"></a><span>        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In a case alternative, pattern result type doesn't match scrutinee type:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1835"></a><span>        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Pattern result type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079391"><span class="hs-identifier hs-var">con_result_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-1836"></a><span>        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Scrutinee type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079392"><span class="hs-identifier hs-var">scrut_ty</span></a><span>
</span><a name="line-1837"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1838"></a><span>
</span><a name="line-1839"></a><span class="hs-identifier">integerScrutinisedMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1840"></a><a name="integerScrutinisedMsg"><a href="CoreLint.html#integerScrutinisedMsg"><span class="hs-identifier">integerScrutinisedMsg</span></a></a><span>
</span><a name="line-1841"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In a LitAlt, the literal is lifted (probably Integer)&quot;</span><span>
</span><a name="line-1842"></a><span>
</span><a name="line-1843"></a><span class="hs-identifier">mkBadAltMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1844"></a><a name="mkBadAltMsg"><a href="CoreLint.html#mkBadAltMsg"><span class="hs-identifier">mkBadAltMsg</span></a></a><span> </span><a name="local-1628079393"><a href="#local-1628079393"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><a name="local-1628079394"><a href="#local-1628079394"><span class="hs-identifier">alt</span></a></a><span>
</span><a name="line-1845"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data alternative when scrutinee is not a tycon application&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1846"></a><span>           </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Scrutinee type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079393"><span class="hs-identifier hs-var">scrut_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-1847"></a><span>           </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Alternative:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="PprCore.html#pprCoreAlt"><span class="hs-identifier hs-var">pprCoreAlt</span></a><span> </span><a href="#local-1628079394"><span class="hs-identifier hs-var">alt</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1848"></a><span>
</span><a name="line-1849"></a><span class="hs-identifier">mkNewTyDataConAltMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1850"></a><a name="mkNewTyDataConAltMsg"><a href="CoreLint.html#mkNewTyDataConAltMsg"><span class="hs-identifier">mkNewTyDataConAltMsg</span></a></a><span> </span><a name="local-1628079395"><a href="#local-1628079395"><span class="hs-identifier">scrut_ty</span></a></a><span> </span><a name="local-1628079396"><a href="#local-1628079396"><span class="hs-identifier">alt</span></a></a><span>
</span><a name="line-1851"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data alternative for newtype datacon&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1852"></a><span>           </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Scrutinee type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079395"><span class="hs-identifier hs-var">scrut_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-1853"></a><span>           </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Alternative:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="PprCore.html#pprCoreAlt"><span class="hs-identifier hs-var">pprCoreAlt</span></a><span> </span><a href="#local-1628079396"><span class="hs-identifier hs-var">alt</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1854"></a><span>
</span><a name="line-1855"></a><span>
</span><a name="line-1856"></a><span class="hs-comment">------------------------------------------------------</span><span>
</span><a name="line-1857"></a><span class="hs-comment">--      Other error messages</span><span>
</span><a name="line-1858"></a><span>
</span><a name="line-1859"></a><span class="hs-identifier">mkAppMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1860"></a><a name="mkAppMsg"><a href="CoreLint.html#mkAppMsg"><span class="hs-identifier">mkAppMsg</span></a></a><span> </span><a name="local-1628079397"><a href="#local-1628079397"><span class="hs-identifier">fun_ty</span></a></a><span> </span><a name="local-1628079398"><a href="#local-1628079398"><span class="hs-identifier">arg_ty</span></a></a><span> </span><a name="local-1628079399"><a href="#local-1628079399"><span class="hs-identifier">arg</span></a></a><span>
</span><a name="line-1861"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Argument value doesn't match argument type:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1862"></a><span>              </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Fun type:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079397"><span class="hs-identifier hs-var">fun_ty</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1863"></a><span>              </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Arg type:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079398"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1864"></a><span>              </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Arg:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079399"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1865"></a><span>
</span><a name="line-1866"></a><span class="hs-identifier">mkNonFunAppMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1867"></a><a name="mkNonFunAppMsg"><a href="CoreLint.html#mkNonFunAppMsg"><span class="hs-identifier">mkNonFunAppMsg</span></a></a><span> </span><a name="local-1628079400"><a href="#local-1628079400"><span class="hs-identifier">fun_ty</span></a></a><span> </span><a name="local-1628079401"><a href="#local-1628079401"><span class="hs-identifier">arg_ty</span></a></a><span> </span><a name="local-1628079402"><a href="#local-1628079402"><span class="hs-identifier">arg</span></a></a><span>
</span><a name="line-1868"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Non-function type in function position&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1869"></a><span>              </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Fun type:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079400"><span class="hs-identifier hs-var">fun_ty</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1870"></a><span>              </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Arg type:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079401"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1871"></a><span>              </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Arg:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079402"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1872"></a><span>
</span><a name="line-1873"></a><span class="hs-identifier">mkLetErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1874"></a><a name="mkLetErr"><a href="CoreLint.html#mkLetErr"><span class="hs-identifier">mkLetErr</span></a></a><span> </span><a name="local-1628079403"><a href="#local-1628079403"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1628079404"><a href="#local-1628079404"><span class="hs-identifier">rhs</span></a></a><span>
</span><a name="line-1875"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Bad `let' binding:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1876"></a><span>          </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Variable:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1877"></a><span>                 </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079403"><span class="hs-identifier hs-var">bndr</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628079403"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1878"></a><span>          </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Rhs:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1879"></a><span>                 </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079404"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1880"></a><span>
</span><a name="line-1881"></a><span class="hs-identifier">mkTyAppMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1882"></a><a name="mkTyAppMsg"><a href="CoreLint.html#mkTyAppMsg"><span class="hs-identifier">mkTyAppMsg</span></a></a><span> </span><a name="local-1628079405"><a href="#local-1628079405"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628079406"><a href="#local-1628079406"><span class="hs-identifier">arg_ty</span></a></a><span>
</span><a name="line-1883"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal type application:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1884"></a><span>              </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Exp type:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1885"></a><span>                 </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079405"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079405"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1886"></a><span>              </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Arg type:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1887"></a><span>                 </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079406"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079406"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1888"></a><span>
</span><a name="line-1889"></a><span class="hs-identifier">mkRhsMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1890"></a><a name="mkRhsMsg"><a href="CoreLint.html#mkRhsMsg"><span class="hs-identifier">mkRhsMsg</span></a></a><span> </span><a name="local-1628079407"><a href="#local-1628079407"><span class="hs-identifier">binder</span></a></a><span> </span><a name="local-1628079408"><a href="#local-1628079408"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-1628079409"><a href="#local-1628079409"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1891"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-1892"></a><span>    </span><span class="hs-special">[</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The type of this binder doesn't match the type of its&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628079408"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span class="hs-special">,</span><span>
</span><a name="line-1893"></a><span>            </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079407"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1894"></a><span>     </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Binder's type:&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628079407"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1895"></a><span>     </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Rhs type:&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079409"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1896"></a><span>
</span><a name="line-1897"></a><span class="hs-identifier">mkLetAppMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1898"></a><a name="mkLetAppMsg"><a href="CoreLint.html#mkLetAppMsg"><span class="hs-identifier">mkLetAppMsg</span></a></a><span> </span><a name="local-1628079410"><a href="#local-1628079410"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-1899"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;This argument does not satisfy the let/app invariant:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1900"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079410"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1901"></a><span>
</span><a name="line-1902"></a><span class="hs-identifier">mkRhsPrimMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1903"></a><a name="mkRhsPrimMsg"><a href="CoreLint.html#mkRhsPrimMsg"><span class="hs-identifier">mkRhsPrimMsg</span></a></a><span> </span><a name="local-1628079411"><a href="#local-1628079411"><span class="hs-identifier">binder</span></a></a><span> </span><a name="local-1628079412"><a href="#local-1628079412"><span class="hs-identifier">_rhs</span></a></a><span>
</span><a name="line-1904"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The type of this binder is primitive:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1905"></a><span>                     </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079411"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1906"></a><span>              </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Binder's type:&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628079411"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1907"></a><span>             </span><span class="hs-special">]</span><span>
</span><a name="line-1908"></a><span>
</span><a name="line-1909"></a><span class="hs-identifier">mkStrictMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1910"></a><a name="mkStrictMsg"><a href="CoreLint.html#mkStrictMsg"><span class="hs-identifier">mkStrictMsg</span></a></a><span> </span><a name="local-1628079413"><a href="#local-1628079413"><span class="hs-identifier">binder</span></a></a><span>
</span><a name="line-1911"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Recursive or top-level binder has strict demand info:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1912"></a><span>                     </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079413"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1913"></a><span>              </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Binder's demand info:&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idDemandInfo"><span class="hs-identifier hs-var">idDemandInfo</span></a><span> </span><a href="#local-1628079413"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1914"></a><span>             </span><span class="hs-special">]</span><span>
</span><a name="line-1915"></a><span>
</span><a name="line-1916"></a><span class="hs-identifier">mkNonTopExportedMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1917"></a><a name="mkNonTopExportedMsg"><a href="CoreLint.html#mkNonTopExportedMsg"><span class="hs-identifier">mkNonTopExportedMsg</span></a></a><span> </span><a name="local-1628079414"><a href="#local-1628079414"><span class="hs-identifier">binder</span></a></a><span>
</span><a name="line-1918"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Non-top-level binder is marked as exported:&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079414"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1919"></a><span>
</span><a name="line-1920"></a><span class="hs-identifier">mkNonTopExternalNameMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1921"></a><a name="mkNonTopExternalNameMsg"><a href="CoreLint.html#mkNonTopExternalNameMsg"><span class="hs-identifier">mkNonTopExternalNameMsg</span></a></a><span> </span><a name="local-1628079415"><a href="#local-1628079415"><span class="hs-identifier">binder</span></a></a><span>
</span><a name="line-1922"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Non-top-level binder has an external name:&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079415"><span class="hs-identifier hs-var">binder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1923"></a><span>
</span><a name="line-1924"></a><span class="hs-identifier">mkKindErrMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1925"></a><a name="mkKindErrMsg"><a href="CoreLint.html#mkKindErrMsg"><span class="hs-identifier">mkKindErrMsg</span></a></a><span> </span><a name="local-1628079416"><a href="#local-1628079416"><span class="hs-identifier">tyvar</span></a></a><span> </span><a name="local-1628079417"><a href="#local-1628079417"><span class="hs-identifier">arg_ty</span></a></a><span>
</span><a name="line-1926"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Kinds don't match in type application:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1927"></a><span>          </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type variable:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1928"></a><span>                 </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079416"><span class="hs-identifier hs-var">tyvar</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628079416"><span class="hs-identifier hs-var">tyvar</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1929"></a><span>          </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Arg type:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1930"></a><span>                 </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079417"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628079417"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1931"></a><span>
</span><a name="line-1932"></a><span class="hs-comment">{- Not needed now
mkArityMsg :: Id -&gt; MsgDoc
mkArityMsg binder
  = vcat [hsep [text &quot;Demand type has&quot;,
                ppr (dmdTypeDepth dmd_ty),
                text &quot;arguments, rhs has&quot;,
                ppr (idArity binder),
                text &quot;arguments,&quot;,
                ppr binder],
              hsep [text &quot;Binder's strictness signature:&quot;, ppr dmd_ty]

         ]
           where (StrictSig dmd_ty) = idStrictness binder
-}</span><span>
</span><a name="line-1946"></a><span class="hs-identifier">mkCastErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1628078686"><span class="hs-identifier hs-type">casted</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1628078686"><span class="hs-identifier hs-type">casted</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1947"></a><a name="mkCastErr"><a href="CoreLint.html#mkCastErr"><span class="hs-identifier">mkCastErr</span></a></a><span> </span><a name="local-1628079418"><a href="#local-1628079418"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628079419"><a href="#local-1628079419"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1628079420"><a href="#local-1628079420"><span class="hs-identifier">from_ty</span></a></a><span> </span><a name="local-1628079421"><a href="#local-1628079421"><span class="hs-identifier">expr_ty</span></a></a><span>
</span><a name="line-1948"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;From-type of Cast differs from type of enclosed expression&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1949"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;From-type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079420"><span class="hs-identifier hs-var">from_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-1950"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type of enclosed expr:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079421"><span class="hs-identifier hs-var">expr_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-1951"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Actual enclosed expr:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079418"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">,</span><span>
</span><a name="line-1952"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Coercion used in cast:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079419"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1953"></a><span>         </span><span class="hs-special">]</span><span>
</span><a name="line-1954"></a><span>
</span><a name="line-1955"></a><span class="hs-identifier">mkBadUnivCoMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#LeftOrRight"><span class="hs-identifier hs-type">LeftOrRight</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1956"></a><a name="mkBadUnivCoMsg"><a href="CoreLint.html#mkBadUnivCoMsg"><span class="hs-identifier">mkBadUnivCoMsg</span></a></a><span> </span><a name="local-1628079422"><a href="#local-1628079422"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-1628079423"><a href="#local-1628079423"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1957"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Kind mismatch on the&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="CoreLint.html#pprLeftOrRight"><span class="hs-identifier hs-var">pprLeftOrRight</span></a><span> </span><a href="#local-1628079422"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1958"></a><span>    </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;side of a UnivCo:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079423"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1959"></a><span>
</span><a name="line-1960"></a><span class="hs-identifier">mkBadProofIrrelMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1961"></a><a name="mkBadProofIrrelMsg"><a href="CoreLint.html#mkBadProofIrrelMsg"><span class="hs-identifier">mkBadProofIrrelMsg</span></a></a><span> </span><a name="local-1628079424"><a href="#local-1628079424"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628079425"><a href="#local-1628079425"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1962"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Found a non-coercion in a proof-irrelevance UnivCo:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1963"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079424"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1964"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;co:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079425"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1965"></a><span>
</span><a name="line-1966"></a><span class="hs-identifier">mkBadTyVarMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1967"></a><a name="mkBadTyVarMsg"><a href="CoreLint.html#mkBadTyVarMsg"><span class="hs-identifier">mkBadTyVarMsg</span></a></a><span> </span><a name="local-1628079426"><a href="#local-1628079426"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1968"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Non-tyvar used in TyVarTy:&quot;</span><span>
</span><a name="line-1969"></a><span>      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079426"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628079426"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1970"></a><span>
</span><a name="line-1971"></a><span class="hs-identifier">pprLeftOrRight</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#LeftOrRight"><span class="hs-identifier hs-type">LeftOrRight</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1972"></a><a name="pprLeftOrRight"><a href="CoreLint.html#pprLeftOrRight"><span class="hs-identifier">pprLeftOrRight</span></a></a><span> </span><a href="TyCoRep.html#CLeft"><span class="hs-identifier hs-var">CLeft</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;left&quot;</span><span>
</span><a name="line-1973"></a><span class="hs-identifier">pprLeftOrRight</span><span> </span><a href="TyCoRep.html#CRight"><span class="hs-identifier hs-var">CRight</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;right&quot;</span><span>
</span><a name="line-1974"></a><span>
</span><a name="line-1975"></a><span class="hs-identifier">dupVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1976"></a><a name="dupVars"><a href="CoreLint.html#dupVars"><span class="hs-identifier">dupVars</span></a></a><span> </span><a name="local-1628079427"><a href="#local-1628079427"><span class="hs-identifier">vars</span></a></a><span>
</span><a name="line-1977"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Duplicate variables brought into scope&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1978"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079427"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1979"></a><span>
</span><a name="line-1980"></a><span class="hs-identifier">dupExtVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-1981"></a><a name="dupExtVars"><a href="CoreLint.html#dupExtVars"><span class="hs-identifier">dupExtVars</span></a></a><span> </span><a name="local-1628079428"><a href="#local-1628079428"><span class="hs-identifier">vars</span></a></a><span>
</span><a name="line-1982"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Duplicate top-level variables with the same qualified name&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1983"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628079428"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1984"></a><span>
</span><a name="line-1985"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Annotation Linting}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1992"></a><span>
</span><a name="line-1993"></a><span class="hs-comment">-- | This checks whether a pass correctly looks through debug</span><span>
</span><a name="line-1994"></a><span class="hs-comment">-- annotations (@SourceNote@). This works a bit different from other</span><span>
</span><a name="line-1995"></a><span class="hs-comment">-- consistency checks: We check this by running the given task twice,</span><span>
</span><a name="line-1996"></a><span class="hs-comment">-- noting all differences between the results.</span><span>
</span><a name="line-1997"></a><span class="hs-identifier">lintAnnots</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a><span> </span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a><span> </span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a><span>
</span><a name="line-1998"></a><a name="lintAnnots"><a href="CoreLint.html#lintAnnots"><span class="hs-identifier">lintAnnots</span></a></a><span> </span><a name="local-1628079429"><a href="#local-1628079429"><span class="hs-identifier">pname</span></a></a><span> </span><a name="local-1628079430"><a href="#local-1628079430"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1628079431"><a href="#local-1628079431"><span class="hs-identifier">guts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1999"></a><span>  </span><span class="hs-comment">-- Run the pass as we normally would</span><span>
</span><a name="line-2000"></a><span>  </span><a name="local-1628079432"><a href="#local-1628079432"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-2001"></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_DoAnnotationLinting"><span class="hs-identifier hs-var">Opt_DoAnnotationLinting</span></a><span> </span><a href="#local-1628079432"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2002"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="ErrUtils.html#showPass"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">showPass</span></a><span> </span><a href="#local-1628079432"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-string">&quot;Annotation linting - first run&quot;</span><span>
</span><a name="line-2003"></a><span>  </span><a name="local-1628079433"><a href="#local-1628079433"><span class="hs-identifier">nguts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628079430"><span class="hs-identifier hs-var">pass</span></a><span> </span><a href="#local-1628079431"><span class="hs-identifier hs-var">guts</span></a><span>
</span><a name="line-2004"></a><span>  </span><span class="hs-comment">-- If appropriate re-run it without debug annotations to make sure</span><span>
</span><a name="line-2005"></a><span>  </span><span class="hs-comment">-- that they made no difference.</span><span>
</span><a name="line-2006"></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_DoAnnotationLinting"><span class="hs-identifier hs-var">Opt_DoAnnotationLinting</span></a><span> </span><a href="#local-1628079432"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2007"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="ErrUtils.html#showPass"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">showPass</span></a><span> </span><a href="#local-1628079432"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-string">&quot;Annotation linting - second run&quot;</span><span>
</span><a name="line-2008"></a><span>    </span><a name="local-1628079434"><a href="#local-1628079434"><span class="hs-identifier">nguts'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CoreLint.html#withoutAnnots"><span class="hs-identifier hs-var">withoutAnnots</span></a><span> </span><a href="#local-1628079430"><span class="hs-identifier hs-var">pass</span></a><span> </span><a href="#local-1628079431"><span class="hs-identifier hs-var">guts</span></a><span>
</span><a name="line-2009"></a><span>    </span><span class="hs-comment">-- Finally compare the resulting bindings</span><span>
</span><a name="line-2010"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="ErrUtils.html#showPass"><span class="hs-identifier hs-var">Err</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">showPass</span></a><span> </span><a href="#local-1628079432"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-string">&quot;Annotation linting - comparison&quot;</span><span>
</span><a name="line-2011"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079435"><a href="#local-1628079435"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#flattenBinds"><span class="hs-identifier hs-var">flattenBinds</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">mg_binds</span><span> </span><a href="#local-1628079433"><span class="hs-identifier hs-var">nguts</span></a><span>
</span><a name="line-2012"></a><span>        </span><a name="local-1628079436"><a href="#local-1628079436"><span class="hs-identifier">binds'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#flattenBinds"><span class="hs-identifier hs-var">flattenBinds</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">mg_binds</span><span> </span><a href="#local-1628079434"><span class="hs-identifier hs-var">nguts'</span></a><span>
</span><a name="line-2013"></a><span>        </span><span class="hs-special">(</span><a name="local-1628079437"><a href="#local-1628079437"><span class="hs-identifier">diffs</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreUtils.html#diffBinds"><span class="hs-identifier hs-var">diffBinds</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">(</span><a href="VarEnv.html#mkRnEnv2"><span class="hs-identifier hs-var">mkRnEnv2</span></a><span> </span><a href="VarEnv.html#emptyInScopeSet"><span class="hs-identifier hs-var">emptyInScopeSet</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628079435"><span class="hs-identifier hs-var">binds</span></a><span> </span><a href="#local-1628079436"><span class="hs-identifier hs-var">binds'</span></a><span>
</span><a name="line-2014"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628079437"><span class="hs-identifier hs-var">diffs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="CoreMonad.html#putMsg"><span class="hs-identifier hs-var">CoreMonad</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">putMsg</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-2015"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="CoreLint.html#lint_banner"><span class="hs-identifier hs-var">lint_banner</span></a><span> </span><span class="hs-string">&quot;warning&quot;</span><span> </span><a href="#local-1628079429"><span class="hs-identifier hs-var">pname</span></a><span>
</span><a name="line-2016"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Core changes with annotations:&quot;</span><span>
</span><a name="line-2017"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#withPprStyle"><span class="hs-identifier hs-var">withPprStyle</span></a><span> </span><a href="Outputable.html#defaultDumpStyle"><span class="hs-identifier hs-var">defaultDumpStyle</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-1628079437"><span class="hs-identifier hs-var">diffs</span></a><span>
</span><a name="line-2018"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-2019"></a><span>  </span><span class="hs-comment">-- Return actual new guts</span><span>
</span><a name="line-2020"></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628079433"><span class="hs-identifier hs-var">nguts</span></a><span>
</span><a name="line-2021"></a><span>
</span><a name="line-2022"></a><span class="hs-comment">-- | Run the given pass without annotations. This means that we both</span><span>
</span><a name="line-2023"></a><span class="hs-comment">-- set the debugLevel setting to 0 in the environment as well as all</span><span>
</span><a name="line-2024"></a><span class="hs-comment">-- annotations from incoming modules.</span><span>
</span><a name="line-2025"></a><span class="hs-identifier">withoutAnnots</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a><span> </span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreMonad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a><span> </span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a><span>
</span><a name="line-2026"></a><a name="withoutAnnots"><a href="CoreLint.html#withoutAnnots"><span class="hs-identifier">withoutAnnots</span></a></a><span> </span><a name="local-1628079438"><a href="#local-1628079438"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1628079439"><a href="#local-1628079439"><span class="hs-identifier">guts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2027"></a><span>  </span><span class="hs-comment">-- Remove debug flag from environment.</span><span>
</span><a name="line-2028"></a><span>  </span><a name="local-1628079440"><a href="#local-1628079440"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-2029"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079441"><a href="#local-1628079441"><span class="hs-identifier">removeFlag</span></a></a><span> </span><a name="local-1628079443"><a href="#local-1628079443"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079443"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsc_dflags</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079440"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">debugLevel</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2030"></a><span>      </span><a name="local-1628079442"><a href="#local-1628079442"><span class="hs-identifier">withoutFlag</span></a></a><span> </span><a name="local-1628079444"><a href="#local-1628079444"><span class="hs-identifier">corem</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2031"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span> </span><a href="CoreMonad.html#runCoreM"><span class="hs-identifier hs-var">runCoreM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-1628079441"><span class="hs-identifier hs-var">removeFlag</span></a><span> </span><a href="CoreMonad.html#getHscEnv"><span class="hs-identifier hs-var">getHscEnv</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="CoreMonad.html#getRuleBase"><span class="hs-identifier hs-var">getRuleBase</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span>
</span><a name="line-2032"></a><span>                                </span><a href="UniqSupply.html#getUniqueSupplyM"><span class="hs-identifier hs-var">getUniqueSupplyM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span>
</span><a name="line-2033"></a><span>                                </span><a href="CoreMonad.html#getVisibleOrphanMods"><span class="hs-identifier hs-var">getVisibleOrphanMods</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span>
</span><a name="line-2034"></a><span>                                </span><a href="CoreMonad.html#getPrintUnqualified"><span class="hs-identifier hs-var">getPrintUnqualified</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="CoreMonad.html#getSrcSpanM"><span class="hs-identifier hs-var">getSrcSpanM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span>
</span><a name="line-2035"></a><span>                                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="#local-1628079444"><span class="hs-identifier hs-var">corem</span></a><span>
</span><a name="line-2036"></a><span>  </span><span class="hs-comment">-- Nuke existing ticks in module.</span><span>
</span><a name="line-2037"></a><span>  </span><span class="hs-comment">-- TODO: Ticks in unfoldings. Maybe change unfolding so it removes</span><span>
</span><a name="line-2038"></a><span>  </span><span class="hs-comment">-- them in absence of debugLevel &gt; 0.</span><span>
</span><a name="line-2039"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1628079445"><a href="#local-1628079445"><span class="hs-identifier">nukeTicks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreUtils.html#stripTicksE"><span class="hs-identifier hs-var">stripTicksE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="CoreSyn.html#tickishIsCode"><span class="hs-identifier hs-var">tickishIsCode</span></a><span class="hs-special">)</span><span>
</span><a name="line-2040"></a><span>      </span><span class="hs-identifier">nukeAnnotsBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a><span>
</span><a name="line-2041"></a><span>      </span><a name="local-1628079446"><a href="#local-1628079446"><span class="hs-identifier">nukeAnnotsBind</span></a></a><span> </span><a name="local-1628079448"><a href="#local-1628079448"><span class="hs-identifier">bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628079448"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2042"></a><span>        </span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><a name="local-1628079449"><a href="#local-1628079449"><span class="hs-identifier">bs</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-1628079450"><a href="#local-1628079450"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-1628079451"><a href="#local-1628079451"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1628079450"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628079445"><span class="hs-identifier hs-var">nukeTicks</span></a><span> </span><a href="#local-1628079451"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628079449"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-2043"></a><span>        </span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-1628079452"><a href="#local-1628079452"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1628079453"><a href="#local-1628079453"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a href="#local-1628079452"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628079445"><span class="hs-identifier hs-var">nukeTicks</span></a><span> </span><a href="#local-1628079453"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2044"></a><span>      </span><a name="local-1628079447"><a href="#local-1628079447"><span class="hs-identifier">nukeAnnotsMod</span></a></a><span> </span><a name="local-1628079454"><a href="#local-1628079454"><span class="hs-identifier">mg</span></a></a><span class="hs-glyph">@</span><a href="HscTypes.html#ModGuts"><span class="hs-identifier hs-var">ModGuts</span></a><span class="hs-special">{</span><span class="hs-identifier">mg_binds</span><span class="hs-glyph">=</span><a name="local-1628079455"><a href="#local-1628079455"><span class="hs-identifier">binds</span></a></a><span class="hs-special">}</span><span>
</span><a name="line-2045"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628079454"><span class="hs-identifier hs-var">mg</span></a><span class="hs-special">{</span><span class="hs-identifier">mg_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628079446"><span class="hs-identifier hs-var">nukeAnnotsBind</span></a><span> </span><a href="#local-1628079455"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">}</span><span>
</span><a name="line-2046"></a><span>  </span><span class="hs-comment">-- Perform pass with all changes applied</span><span>
</span><a name="line-2047"></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628079442"><span class="hs-identifier hs-var">withoutFlag</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628079438"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628079447"><span class="hs-identifier hs-var">nukeAnnotsMod</span></a><span> </span><a href="#local-1628079439"><span class="hs-identifier hs-var">guts</span></a><span class="hs-special">)</span><span>
</span><a name="line-2048"></a></pre></body></html>