<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1998

\section[PatSyn]{@PatSyn@: Pattern synonyms}
-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE CPP, DeriveDataTypeable #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PatSyn</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-comment">-- * Main data types</span><span>
</span><a name="line-12"></a><span>        </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#mkPatSyn"><span class="hs-identifier hs-var">mkPatSyn</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span>        </span><span class="hs-comment">-- ** Type deconstruction</span><span>
</span><a name="line-15"></a><span>        </span><a href="PatSyn.html#patSynName"><span class="hs-identifier hs-var">patSynName</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#patSynArity"><span class="hs-identifier hs-var">patSynArity</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#patSynIsInfix"><span class="hs-identifier hs-var">patSynIsInfix</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="PatSyn.html#patSynArgs"><span class="hs-identifier hs-var">patSynArgs</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#patSynType"><span class="hs-identifier hs-var">patSynType</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="PatSyn.html#patSynMatcher"><span class="hs-identifier hs-var">patSynMatcher</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#patSynBuilder"><span class="hs-identifier hs-var">patSynBuilder</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>        </span><a href="PatSyn.html#patSynExTyVars"><span class="hs-identifier hs-var">patSynExTyVars</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#patSynSig"><span class="hs-identifier hs-var">patSynSig</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>        </span><a href="PatSyn.html#patSynInstArgTys"><span class="hs-identifier hs-var">patSynInstArgTys</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#patSynInstResTy"><span class="hs-identifier hs-var">patSynInstResTy</span></a><span class="hs-special">,</span><span> </span><a href="PatSyn.html#patSynFieldLabels"><span class="hs-identifier hs-var">patSynFieldLabels</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>        </span><a href="PatSyn.html#patSynFieldType"><span class="hs-identifier hs-var">patSynFieldType</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span>        </span><a href="PatSyn.html#tidyPatSynIds"><span class="hs-identifier hs-var">tidyPatSynIds</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span class="hs-special">(</span><span> </span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="FieldLabel.html"><span class="hs-identifier">FieldLabel</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Data</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Function</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Pattern synonyms}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | A pattern synonym</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- See Note [Pattern synonym representation]</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- See Note [Pattern synonym signatures]</span><span>
</span><a name="line-53"></a><span class="hs-keyword">data</span><span> </span><a name="PatSyn"><a href="PatSyn.html#PatSyn"><span class="hs-identifier">PatSyn</span></a></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="MkPatSyn"><a href="PatSyn.html#MkPatSyn"><span class="hs-identifier">MkPatSyn</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-55"></a><span>        </span><a href="PatSyn.html#psName"><span class="hs-identifier">psName</span></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>        </span><a href="PatSyn.html#psUnique"><span class="hs-identifier">psUnique</span></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Cached from Name</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>        </span><a href="PatSyn.html#psArgs"><span class="hs-identifier">psArgs</span></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>        </span><a href="PatSyn.html#psArity"><span class="hs-identifier">psArity</span></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- == length psArgs</span><span>
</span><a name="line-60"></a><span>        </span><a href="PatSyn.html#psInfix"><span class="hs-identifier">psInfix</span></a><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- True &lt;=&gt; declared infix</span><span>
</span><a name="line-61"></a><span>        </span><a href="PatSyn.html#psFieldLabels"><span class="hs-identifier">psFieldLabels</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- List of fields for a</span><span>
</span><a name="line-62"></a><span>                                       </span><span class="hs-comment">-- record pattern synonym</span><span>
</span><a name="line-63"></a><span>                                       </span><span class="hs-comment">-- INVARIANT: either empty if no</span><span>
</span><a name="line-64"></a><span>                                       </span><span class="hs-comment">-- record pat syn or same length as</span><span>
</span><a name="line-65"></a><span>                                       </span><span class="hs-comment">-- psArgs</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>        </span><a href="PatSyn.html#psUnivTyVars"><span class="hs-identifier">psUnivTyVars</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- Universially-quantified type variables</span><span>
</span><a name="line-68"></a><span>        </span><a href="PatSyn.html#psReqTheta"><span class="hs-identifier">psReqTheta</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Required dictionaries</span><span>
</span><a name="line-69"></a><span>                                       </span><span class="hs-comment">-- these constraints are very much like</span><span>
</span><a name="line-70"></a><span>                                       </span><span class="hs-comment">-- stupid thetas (which is a useful</span><span>
</span><a name="line-71"></a><span>                                       </span><span class="hs-comment">-- guideline when implementing)</span><span>
</span><a name="line-72"></a><span>                                       </span><span class="hs-comment">-- but are actually needed.</span><span>
</span><a name="line-73"></a><span>        </span><a href="PatSyn.html#psExTyVars"><span class="hs-identifier">psExTyVars</span></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- Existentially-quantified type vars</span><span>
</span><a name="line-74"></a><span>        </span><a href="PatSyn.html#psProvTheta"><span class="hs-identifier">psProvTheta</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Provided dictionaries</span><span>
</span><a name="line-75"></a><span>        </span><a href="PatSyn.html#psOrigResTy"><span class="hs-identifier">psOrigResTy</span></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- Mentions only psUnivTyVars</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span>        </span><span class="hs-comment">-- See Note [Matchers and builders for pattern synonyms]</span><span>
</span><a name="line-78"></a><span>        </span><a href="PatSyn.html#psMatcher"><span class="hs-identifier">psMatcher</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>             </span><span class="hs-comment">-- Matcher function.</span><span>
</span><a name="line-80"></a><span>             </span><span class="hs-comment">-- If Bool is True then prov_theta and arg_tys are empty</span><span>
</span><a name="line-81"></a><span>             </span><span class="hs-comment">-- and type is</span><span>
</span><a name="line-82"></a><span>             </span><span class="hs-comment">--   forall (p :: RuntimeRep) (r :: TYPE p) univ_tvs.</span><span>
</span><a name="line-83"></a><span>             </span><span class="hs-comment">--                          req_theta</span><span>
</span><a name="line-84"></a><span>             </span><span class="hs-comment">--                       =&gt; res_ty</span><span>
</span><a name="line-85"></a><span>             </span><span class="hs-comment">--                       -&gt; (forall ex_tvs. Void# -&gt; r)</span><span>
</span><a name="line-86"></a><span>             </span><span class="hs-comment">--                       -&gt; (Void# -&gt; r)</span><span>
</span><a name="line-87"></a><span>             </span><span class="hs-comment">--                       -&gt; r</span><span>
</span><a name="line-88"></a><span>             </span><span class="hs-comment">--</span><span>
</span><a name="line-89"></a><span>             </span><span class="hs-comment">-- Otherwise type is</span><span>
</span><a name="line-90"></a><span>             </span><span class="hs-comment">--   forall (p :: RuntimeRep) (r :: TYPE r) univ_tvs.</span><span>
</span><a name="line-91"></a><span>             </span><span class="hs-comment">--                          req_theta</span><span>
</span><a name="line-92"></a><span>             </span><span class="hs-comment">--                       =&gt; res_ty</span><span>
</span><a name="line-93"></a><span>             </span><span class="hs-comment">--                       -&gt; (forall ex_tvs. prov_theta =&gt; arg_tys -&gt; r)</span><span>
</span><a name="line-94"></a><span>             </span><span class="hs-comment">--                       -&gt; (Void# -&gt; r)</span><span>
</span><a name="line-95"></a><span>             </span><span class="hs-comment">--                       -&gt; r</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span>        </span><a href="PatSyn.html#psBuilder"><span class="hs-identifier">psBuilder</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>             </span><span class="hs-comment">-- Nothing  =&gt; uni-directional pattern synonym</span><span>
</span><a name="line-99"></a><span>             </span><span class="hs-comment">-- Just (builder, is_unlifted) =&gt; bi-directional</span><span>
</span><a name="line-100"></a><span>             </span><span class="hs-comment">-- Builder function, of type</span><span>
</span><a name="line-101"></a><span>             </span><span class="hs-comment">--  forall univ_tvs, ex_tvs. (req_theta, prov_theta)</span><span>
</span><a name="line-102"></a><span>             </span><span class="hs-comment">--                       =&gt;  arg_tys -&gt; res_ty</span><span>
</span><a name="line-103"></a><span>             </span><span class="hs-comment">-- See Note [Builder for pattern synonyms with unboxed type]</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Typeable</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Typeable</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">{- Note [Pattern synonym signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In a pattern synonym signature we write
   pattern P :: req =&gt; prov =&gt; t1 -&gt; ... tn -&gt; res_ty

Note that the &quot;required&quot; context comes first, then the &quot;provided&quot;
context.  Moreover, the &quot;required&quot; context must not mention
existentially-bound type variables; that is, ones not mentioned in
res_ty.  See lots of discussion in Trac #10928.

If there is no &quot;provided&quot; context, you can omit it; but you
can't omit the &quot;required&quot; part (unless you omit both).

Example 1:
      pattern P1 :: (Num a, Eq a) =&gt; b -&gt; Maybe (a,b)
      pattern P1 x = Just (3,x)

  We require (Num a, Eq a) to match the 3; there is no provided
  context.

Example 2:
      data T2 where
        MkT2 :: (Num a, Eq a) =&gt; a -&gt; a -&gt; T2

      pattern P2 :: () =&gt; (Num a, Eq a) =&gt; a -&gt; T2
      pattern P2 x = MkT2 3 x

  When we match against P2 we get a Num dictionary provided.
  We can use that to check the match against 3.

Example 3:
      pattern P3 :: Eq a =&gt; a -&gt; b -&gt; T3 b

   This signature is illegal because the (Eq a) is a required
   constraint, but it mentions the existentially-bound variable 'a'.
   You can see it's existential because it doesn't appear in the
   result type (T3 b).

Note [Pattern synonym representation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider the following pattern synonym declaration

        pattern P x = MkT [x] (Just 42)

where
        data T a where
              MkT :: (Show a, Ord b) =&gt; [b] -&gt; a -&gt; T a

so pattern P has type

        b -&gt; T (Maybe t)

with the following typeclass constraints:

        requires: (Eq t, Num t)
        provides: (Show (Maybe t), Ord b)

In this case, the fields of MkPatSyn will be set as follows:

  psArgs       = [b]
  psArity      = 1
  psInfix      = False

  psUnivTyVars = [t]
  psExTyVars   = [b]
  psProvTheta  = (Show (Maybe t), Ord b)
  psReqTheta   = (Eq t, Num t)
  psOrigResTy  = T (Maybe t)

Note [Matchers and builders for pattern synonyms]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For each pattern synonym P, we generate

  * a &quot;matcher&quot; function, used to desugar uses of P in patterns,
    which implements pattern matching

  * A &quot;builder&quot; function (for bidirectional pattern synonyms only),
    used to desugar uses of P in expressions, which constructs P-values.

For the above example, the matcher function has type:

        $mP :: forall (r :: ?) t. (Eq t, Num t)
            =&gt; T (Maybe t)
            -&gt; (forall b. (Show (Maybe t), Ord b) =&gt; b -&gt; r)
            -&gt; (Void# -&gt; r)
            -&gt; r

with the following implementation:

        $mP @r @t $dEq $dNum scrut cont fail
          = case scrut of
              MkT @b $dShow $dOrd [x] (Just 42) -&gt; cont @b $dShow $dOrd x
              _                                 -&gt; fail Void#

Notice that the return type 'r' has an open kind, so that it can
be instantiated by an unboxed type; for example where we see
     f (P x) = 3#

The extra Void# argument for the failure continuation is needed so that
it is lazy even when the result type is unboxed.

For the same reason, if the pattern has no arguments, an extra Void#
argument is added to the success continuation as well.

For *bidirectional* pattern synonyms, we also generate a &quot;builder&quot;
function which implements the pattern synonym in an expression
context. For our running example, it will be:

        $bP :: forall t b. (Eq t, Num t, Show (Maybe t), Ord b)
            =&gt; b -&gt; T (Maybe t)
        $bP x = MkT [x] (Just 42)

NB: the existential/universal and required/provided split does not
apply to the builder since you are only putting stuff in, not getting
stuff out.

Injectivity of bidirectional pattern synonyms is checked in
tcPatToExpr which walks the pattern and returns its corresponding
expression when available.

Note [Builder for pattern synonyms with unboxed type]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For bidirectional pattern synonyms that have no arguments and have an
unboxed type, we add an extra Void# argument to the builder, else it
would be a top-level declaration with an unboxed type.

        pattern P = 0#

        $bP :: Void# -&gt; Int#
        $bP _ = 0#

This means that when typechecking an occurrence of P in an expression,
we must remember that the builder has this void argument. This is
done by TcPatSyn.patSynBuilderOcc.


************************************************************************
*                                                                      *
\subsection{Instances}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-251"></a><span>    </span><span class="hs-special">(</span><a name="local-805306535"><span class="hs-operator">==</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span>
</span><a name="line-252"></a><span>    </span><span class="hs-special">(</span><a name="local-1912608688"><span class="hs-operator">/=</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-255"></a><span>    </span><span class="hs-special">(</span><a name="local-1912608690"><span class="hs-operator">&lt;=</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span>
</span><a name="line-256"></a><span>    </span><span class="hs-special">(</span><a name="local-1912608694"><span class="hs-operator">&lt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span>
</span><a name="line-257"></a><span>    </span><span class="hs-special">(</span><a name="local-805306536"><span class="hs-operator">&gt;=</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span>
</span><a name="line-258"></a><span>    </span><span class="hs-special">(</span><a name="local-1912608695"><span class="hs-operator">&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span>
</span><a name="line-259"></a><span>    </span><a name="local-1912608689"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-keyword">instance</span><span> </span><a href="Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-262"></a><span>    </span><a name="local-1912706050"><a href="Unique.html#getUnique"><span class="hs-identifier">getUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psUnique</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-keyword">instance</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-265"></a><span>    </span><a name="local-1912759012"><a href="Name.html#getName"><span class="hs-identifier">getName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PatSyn.html#patSynName"><span class="hs-identifier hs-var">patSynName</span></a><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-268"></a><span>    </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#OutputableBndr"><span class="hs-identifier hs-type">OutputableBndr</span></a><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-271"></a><span>    </span><a name="local-1912686309"><a href="Outputable.html#pprInfixOcc"><span class="hs-identifier">pprInfixOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#pprInfixName"><span class="hs-identifier hs-var">pprInfixName</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span>
</span><a name="line-272"></a><span>    </span><a name="local-1912686308"><a href="Outputable.html#pprPrefixOcc"><span class="hs-identifier">pprPrefixOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#pprPrefixName"><span class="hs-identifier hs-var">pprPrefixName</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Data</span></a><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-275"></a><span>    </span><span class="hs-comment">-- don't traverse?</span><span>
</span><a name="line-276"></a><span>    </span><a name="local-1912605886"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#toConstr"><span class="hs-identifier">toConstr</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#abstractConstr"><span class="hs-identifier hs-var">abstractConstr</span></a><span> </span><span class="hs-string">&quot;PatSyn&quot;</span><span>
</span><a name="line-277"></a><span>    </span><a name="local-1912605887"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#gunfold"><span class="hs-identifier">gunfold</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-278"></a><span>    </span><a name="local-1912605885"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#dataTypeOf"><span class="hs-identifier">dataTypeOf</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Data.html#mkNoRepType"><span class="hs-identifier hs-var">mkNoRepType</span></a><span> </span><span class="hs-string">&quot;PatSyn&quot;</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Construction}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-comment">-- | Build a new pattern synonym</span><span>
</span><a name="line-289"></a><span class="hs-identifier">mkPatSyn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-290"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                 </span><span class="hs-comment">-- ^ Is the pattern synonym declared infix?</span><span>
</span><a name="line-291"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Universially-quantified type variables</span><span>
</span><a name="line-292"></a><span>                                 </span><span class="hs-comment">--   and required dicts</span><span>
</span><a name="line-293"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Existentially-quantified type variables</span><span>
</span><a name="line-294"></a><span>                                 </span><span class="hs-comment">--   and provided dicts</span><span>
</span><a name="line-295"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>               </span><span class="hs-comment">-- ^ Original arguments</span><span>
</span><a name="line-296"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>                 </span><span class="hs-comment">-- ^ Original result type</span><span>
</span><a name="line-297"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- ^ Name of matcher</span><span>
</span><a name="line-298"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ Name of builder</span><span>
</span><a name="line-299"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- ^ Names of fields for</span><span>
</span><a name="line-300"></a><span>                                 </span><span class="hs-comment">--   a record pattern synonym</span><span>
</span><a name="line-301"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span>
</span><a name="line-302"></a><a name="mkPatSyn"><a href="PatSyn.html#mkPatSyn"><span class="hs-identifier">mkPatSyn</span></a></a><span> </span><a name="local-1627804288"><a href="#local-1627804288"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1627804289"><a href="#local-1627804289"><span class="hs-identifier">declared_infix</span></a></a><span>
</span><a name="line-303"></a><span>         </span><span class="hs-special">(</span><a name="local-1627804290"><a href="#local-1627804290"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627804291"><a href="#local-1627804291"><span class="hs-identifier">req_theta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>         </span><span class="hs-special">(</span><a name="local-1627804292"><a href="#local-1627804292"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627804293"><a href="#local-1627804293"><span class="hs-identifier">prov_theta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>         </span><a name="local-1627804294"><a href="#local-1627804294"><span class="hs-identifier">orig_args</span></a></a><span>
</span><a name="line-306"></a><span>         </span><a name="local-1627804295"><a href="#local-1627804295"><span class="hs-identifier">orig_res_ty</span></a></a><span>
</span><a name="line-307"></a><span>         </span><a name="local-1627804296"><a href="#local-1627804296"><span class="hs-identifier">matcher</span></a></a><span> </span><a name="local-1627804297"><a href="#local-1627804297"><span class="hs-identifier">builder</span></a></a><span> </span><a name="local-1627804298"><a href="#local-1627804298"><span class="hs-identifier">field_labels</span></a></a><span>
</span><a name="line-308"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PatSyn.html#MkPatSyn"><span class="hs-identifier hs-var">MkPatSyn</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">psName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804288"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psUnique</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1627804288"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-309"></a><span>                </span><span class="hs-identifier">psUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804290"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804292"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span>
</span><a name="line-310"></a><span>                </span><span class="hs-identifier">psProvTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804293"><span class="hs-identifier hs-var">prov_theta</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psReqTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804291"><span class="hs-identifier hs-var">req_theta</span></a><span class="hs-special">,</span><span>
</span><a name="line-311"></a><span>                </span><span class="hs-identifier">psInfix</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804289"><span class="hs-identifier hs-var">declared_infix</span></a><span class="hs-special">,</span><span>
</span><a name="line-312"></a><span>                </span><span class="hs-identifier">psArgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804294"><span class="hs-identifier hs-var">orig_args</span></a><span class="hs-special">,</span><span>
</span><a name="line-313"></a><span>                </span><span class="hs-identifier">psArity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627804294"><span class="hs-identifier hs-var">orig_args</span></a><span class="hs-special">,</span><span>
</span><a name="line-314"></a><span>                </span><span class="hs-identifier">psOrigResTy</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804295"><span class="hs-identifier hs-var">orig_res_ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-315"></a><span>                </span><span class="hs-identifier">psMatcher</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804296"><span class="hs-identifier hs-var">matcher</span></a><span class="hs-special">,</span><span>
</span><a name="line-316"></a><span>                </span><span class="hs-identifier">psBuilder</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804297"><span class="hs-identifier hs-var">builder</span></a><span class="hs-special">,</span><span>
</span><a name="line-317"></a><span>                </span><span class="hs-identifier">psFieldLabels</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804298"><span class="hs-identifier hs-var">field_labels</span></a><span>
</span><a name="line-318"></a><span>                </span><span class="hs-special">}</span><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-comment">-- | The 'Name' of the 'PatSyn', giving it a unique, rooted identification</span><span>
</span><a name="line-321"></a><span class="hs-identifier">patSynName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-322"></a><a name="patSynName"><a href="PatSyn.html#patSynName"><span class="hs-identifier">patSynName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psName</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-identifier">patSynType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-325"></a><span class="hs-comment">-- The full pattern type, used only in error messages</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- See Note [Pattern synonym signatures]</span><span>
</span><a name="line-327"></a><a name="patSynType"><a href="PatSyn.html#patSynType"><span class="hs-identifier">patSynType</span></a></a><span> </span><span class="hs-special">(</span><a href="PatSyn.html#MkPatSyn"><span class="hs-identifier hs-var">MkPatSyn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804299"><a href="#local-1627804299"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psReqTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804300"><a href="#local-1627804300"><span class="hs-identifier">req_theta</span></a></a><span>
</span><a name="line-328"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psExTyVars</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804301"><a href="#local-1627804301"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span>   </span><span class="hs-identifier">psProvTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804302"><a href="#local-1627804302"><span class="hs-identifier">prov_theta</span></a></a><span>
</span><a name="line-329"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psArgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804303"><a href="#local-1627804303"><span class="hs-identifier">orig_args</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psOrigResTy</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804304"><a href="#local-1627804304"><span class="hs-identifier">orig_res_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><a href="#local-1627804299"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="#local-1627804300"><span class="hs-identifier hs-var">req_theta</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>  </span><span class="hs-comment">-- use mkSpecSigmaTy because it</span><span>
</span><a name="line-331"></a><span>    </span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><a href="#local-1627804301"><span class="hs-identifier hs-var">ex_tvs</span></a><span> </span><a href="#local-1627804302"><span class="hs-identifier hs-var">prov_theta</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>   </span><span class="hs-comment">-- prints better</span><span>
</span><a name="line-332"></a><span>    </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><a href="#local-1627804303"><span class="hs-identifier hs-var">orig_args</span></a><span> </span><a href="#local-1627804304"><span class="hs-identifier hs-var">orig_res_ty</span></a><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-comment">-- | Should the 'PatSyn' be presented infix?</span><span>
</span><a name="line-335"></a><span class="hs-identifier">patSynIsInfix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-336"></a><a name="patSynIsInfix"><a href="PatSyn.html#patSynIsInfix"><span class="hs-identifier">patSynIsInfix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psInfix</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- | Arity of the pattern synonym</span><span>
</span><a name="line-339"></a><span class="hs-identifier">patSynArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span>
</span><a name="line-340"></a><a name="patSynArity"><a href="PatSyn.html#patSynArity"><span class="hs-identifier">patSynArity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psArity</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-identifier">patSynArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-343"></a><a name="patSynArgs"><a href="PatSyn.html#patSynArgs"><span class="hs-identifier">patSynArgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psArgs</span><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-identifier">patSynFieldLabels</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span>
</span><a name="line-346"></a><a name="patSynFieldLabels"><a href="PatSyn.html#patSynFieldLabels"><span class="hs-identifier">patSynFieldLabels</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psFieldLabels</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-comment">-- | Extract the type for any given labelled field of the 'DataCon'</span><span>
</span><a name="line-349"></a><span class="hs-identifier">patSynFieldType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FieldLabel.html#FieldLabelString"><span class="hs-identifier hs-type">FieldLabelString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-350"></a><a name="patSynFieldType"><a href="PatSyn.html#patSynFieldType"><span class="hs-identifier">patSynFieldType</span></a></a><span> </span><a name="local-1627804305"><a href="#local-1627804305"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-1627804306"><a href="#local-1627804306"><span class="hs-identifier">label</span></a></a><span>
</span><a name="line-351"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627804306"><span class="hs-identifier hs-var">label</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">flLabel</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psFieldLabels</span><span> </span><a href="#local-1627804305"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">psArgs</span><span> </span><a href="#local-1627804305"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-352"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627804307"><a href="#local-1627804307"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627804307"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-353"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;dataConFieldType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627804305"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627804306"><span class="hs-identifier hs-var">label</span></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-identifier">patSynExTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-356"></a><a name="patSynExTyVars"><a href="PatSyn.html#patSynExTyVars"><span class="hs-identifier">patSynExTyVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psExTyVars</span><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-identifier">patSynSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><a name="patSynSig"><a href="PatSyn.html#patSynSig"><span class="hs-identifier">patSynSig</span></a></a><span> </span><span class="hs-special">(</span><a href="PatSyn.html#MkPatSyn"><span class="hs-identifier hs-var">MkPatSyn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804308"><a href="#local-1627804308"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804309"><a href="#local-1627804309"><span class="hs-identifier">ex_tvs</span></a></a><span>
</span><a name="line-360"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psProvTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804310"><a href="#local-1627804310"><span class="hs-identifier">prov</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psReqTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804311"><a href="#local-1627804311"><span class="hs-identifier">req</span></a></a><span>
</span><a name="line-361"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psArgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804312"><a href="#local-1627804312"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psOrigResTy</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804313"><a href="#local-1627804313"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627804308"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627804311"><span class="hs-identifier hs-var">req</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627804309"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627804310"><span class="hs-identifier hs-var">prov</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627804312"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627804313"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-identifier">patSynMatcher</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-365"></a><a name="patSynMatcher"><a href="PatSyn.html#patSynMatcher"><span class="hs-identifier">patSynMatcher</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psMatcher</span><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span class="hs-identifier">patSynBuilder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-368"></a><a name="patSynBuilder"><a href="PatSyn.html#patSynBuilder"><span class="hs-identifier">patSynBuilder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psBuilder</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-identifier">tidyPatSynIds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span>
</span><a name="line-371"></a><a name="tidyPatSynIds"><a href="PatSyn.html#tidyPatSynIds"><span class="hs-identifier">tidyPatSynIds</span></a></a><span> </span><a name="local-1627804314"><a href="#local-1627804314"><span class="hs-identifier">tidy_fn</span></a></a><span> </span><a name="local-1627804315"><a href="#local-1627804315"><span class="hs-identifier">ps</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="PatSyn.html#MkPatSyn"><span class="hs-identifier hs-var">MkPatSyn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psMatcher</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804316"><a href="#local-1627804316"><span class="hs-identifier">matcher</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psBuilder</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804317"><a href="#local-1627804317"><span class="hs-identifier">builder</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804315"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psMatcher</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804318"><span class="hs-identifier hs-var">tidy_pr</span></a><span> </span><a href="#local-1627804316"><span class="hs-identifier hs-var">matcher</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psBuilder</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-1627804318"><span class="hs-identifier hs-var">tidy_pr</span></a><span> </span><a href="#local-1627804317"><span class="hs-identifier hs-var">builder</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-373"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-374"></a><span>    </span><a name="local-1627804318"><a href="#local-1627804318"><span class="hs-identifier">tidy_pr</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627804319"><a href="#local-1627804319"><span class="hs-identifier">id</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627804320"><a href="#local-1627804320"><span class="hs-identifier">dummy</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627804314"><span class="hs-identifier hs-var">tidy_fn</span></a><span> </span><a href="#local-1627804319"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627804320"><span class="hs-identifier hs-var">dummy</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>
</span><a name="line-376"></a><span class="hs-identifier">patSynInstArgTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-377"></a><span class="hs-comment">-- Return the types of the argument patterns</span><span>
</span><a name="line-378"></a><span class="hs-comment">-- e.g.  data D a = forall b. MkD a b (b-&gt;a)</span><span>
</span><a name="line-379"></a><span class="hs-comment">--       pattern P f x y = MkD (x,True) y f</span><span>
</span><a name="line-380"></a><span class="hs-comment">--          D :: forall a. forall b. a -&gt; b -&gt; (b-&gt;a) -&gt; D a</span><span>
</span><a name="line-381"></a><span class="hs-comment">--          P :: forall c. forall b. (b-&gt;(c,Bool)) -&gt; c -&gt; b -&gt; P c</span><span>
</span><a name="line-382"></a><span class="hs-comment">--   patSynInstArgTys P [Int,bb] = [bb-&gt;(Int,Bool), Int, bb]</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- NB: the inst_tys should be both universal and existential</span><span>
</span><a name="line-384"></a><a name="patSynInstArgTys"><a href="PatSyn.html#patSynInstArgTys"><span class="hs-identifier">patSynInstArgTys</span></a></a><span> </span><span class="hs-special">(</span><a href="PatSyn.html#MkPatSyn"><span class="hs-identifier hs-var">MkPatSyn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804321"><a href="#local-1627804321"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804322"><a href="#local-1627804322"><span class="hs-identifier">univ_tvs</span></a></a><span>
</span><a name="line-385"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psExTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804323"><a href="#local-1627804323"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psArgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804324"><a href="#local-1627804324"><span class="hs-identifier">arg_tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>                 </span><a name="local-1627804325"><a href="#local-1627804325"><span class="hs-identifier">inst_tys</span></a></a><span>
</span><a name="line-387"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">tyvars</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">inst_tys</span><span>
</span><a name="line-388"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;patSynInstArgTys&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tyvars</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">inst_tys</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-389"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span> </span><a href="#local-1627804326"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><a href="#local-1627804325"><span class="hs-identifier hs-var">inst_tys</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627804324"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-390"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-391"></a><span>    </span><a name="local-1627804326"><a href="#local-1627804326"><span class="hs-identifier">tyvars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627804322"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627804323"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-identifier">patSynInstResTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-394"></a><span class="hs-comment">-- Return the type of whole pattern</span><span>
</span><a name="line-395"></a><span class="hs-comment">-- E.g.  pattern P x y = Just (x,x,y)</span><span>
</span><a name="line-396"></a><span class="hs-comment">--         P :: a -&gt; b -&gt; Just (a,a,b)</span><span>
</span><a name="line-397"></a><span class="hs-comment">--         (patSynInstResTy P [Int,Bool] = Maybe (Int,Int,Bool)</span><span>
</span><a name="line-398"></a><span class="hs-comment">-- NB: unlikepatSynInstArgTys, the inst_tys should be just the *universal* tyvars</span><span>
</span><a name="line-399"></a><a name="patSynInstResTy"><a href="PatSyn.html#patSynInstResTy"><span class="hs-identifier">patSynInstResTy</span></a></a><span> </span><span class="hs-special">(</span><a href="PatSyn.html#MkPatSyn"><span class="hs-identifier hs-var">MkPatSyn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804327"><a href="#local-1627804327"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psUnivTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804328"><a href="#local-1627804328"><span class="hs-identifier">univ_tvs</span></a></a><span>
</span><a name="line-400"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psOrigResTy</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627804329"><a href="#local-1627804329"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>                </span><a name="local-1627804330"><a href="#local-1627804330"><span class="hs-identifier">inst_tys</span></a></a><span>
</span><a name="line-402"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">univ_tvs</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">inst_tys</span><span>
</span><a name="line-403"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;patSynInstResTy&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">univ_tvs</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">inst_tys</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>    </span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span> </span><a href="#local-1627804328"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="#local-1627804330"><span class="hs-identifier hs-var">inst_tys</span></a><span> </span><a href="#local-1627804329"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-405"></a></pre></body></html>