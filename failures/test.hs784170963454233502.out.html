<a href="Test.hs6855834541351345223.out.html">prev</a></br><a href="failures.html">home</a></br><a href="test.hs8235644401115438165.out.html">next</a></br></br><pre>42c42
< main = $quickCheckAll
---
> main = quickCheckAll
42a43
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}

import Test.QuickCheck
import Test.QuickCheck.All
import System.Terminfo.Internal

import Data.Maybe

prop_useOverride ovr =
    forAll notLikely $ \usr ->
    forAll notLikely $ \tds ->
    forAll oftenNull $ \defs ->
    classify (isNothing usr && isNothing tds && null defs)
        "Nothing else specified"$
    classify (isJust usr && isJust tds && not (null defs))
        "Everything else specified"$
    locationsPure (Just ovr) usr tds defs == [ovr]

notLikely = frequency [(2, return Nothing), (1, fmap Just arbitrary)]
oftenNull = frequency [(2, return []), (1, arbitrary)]

prop_includeHome usr =
    forAll notLikely $ \tds ->
    forAll oftenNull $ \defs ->
    let
        withUsr    = locationsPure Nothing (Just usr) tds defs
        withoutUsr = locationsPure Nothing Nothing    tds defs
    in
    classify (isJust tds || not (null defs))
        "Something besides HOME specified"$
    withUsr == usr : withoutUsr

prop_terminfoDirsOverridesDefaults tds =
    forAll (oneof [return [], listOf1 arbitrary]) $ \defs ->
    classify (not $ null defs) "Defaults specified"$
    locationsPure Nothing Nothing (Just tds) defs
        == parseTDVar defs tds

prop_useDefaults defs =
    locationsPure Nothing Nothing Nothing defs == defs

main = $quickCheckAll
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}

import Test.QuickCheck
import Test.QuickCheck.All
import System.Terminfo.Internal

import Data.Maybe

prop_useOverride ovr =
    forAll notLikely $ \usr ->
    forAll notLikely $ \tds ->
    forAll oftenNull $ \defs ->
    classify (isNothing usr && isNothing tds && null defs)
        "Nothing else specified"$
    classify (isJust usr && isJust tds && not (null defs))
        "Everything else specified"$
    locationsPure (Just ovr) usr tds defs == [ovr]

notLikely = frequency [(2, return Nothing), (1, fmap Just arbitrary)]
oftenNull = frequency [(2, return []), (1, arbitrary)]

prop_includeHome usr =
    forAll notLikely $ \tds ->
    forAll oftenNull $ \defs ->
    let
        withUsr    = locationsPure Nothing (Just usr) tds defs
        withoutUsr = locationsPure Nothing Nothing    tds defs
    in
    classify (isJust tds || not (null defs))
        "Something besides HOME specified"$
    withUsr == usr : withoutUsr

prop_terminfoDirsOverridesDefaults tds =
    forAll (oneof [return [], listOf1 arbitrary]) $ \defs ->
    classify (not $ null defs) "Defaults specified"$
    locationsPure Nothing Nothing (Just tds) defs
        == parseTDVar defs tds

prop_useDefaults defs =
    locationsPure Nothing Nothing Nothing defs == defs

main = quickCheckAll

</pre>